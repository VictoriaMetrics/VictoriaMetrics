var mi=Object.defineProperty;var ui=(t,n,a)=>n in t?mi(t,n,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[n]=a;var Ye=(t,n,a)=>ui(t,typeof n!="symbol"?n+"":n,a);import{d as B,t as hi,a as pi,u as gi,q as Ea,g as pt,K as vt,h as xt,T as L,b as e,x as De,N as To,c as D,A as Q,y as A,e as C,k as U,f as X,i as On,j as lt,$ as Ut,M as La,D as Rn,I as vi,l as ae,F as Ma,O as Da,m as Fn,n as qt,o as Bt,_ as fi,L as zn,H as Ia,R as Pa,p as ge,r as Hn,s as _i,v as bi}from"./vendor-PQqNLyna.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function a(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(o){if(o.ep)return;o.ep=!0;const s=a(o);fetch(o.href,s)}})();B.extend(hi);B.extend(pi);B.extend(gi);var rt=(t=>(t.victoriametrics="victoriametrics",t.victorialogs="victorialogs",t.vmanomaly="vmanomaly",t))(rt||{});const jt="victorialogs",Ao=jt==="victorialogs",yi=jt==="vmanomaly",J={home:"/",metrics:"/metrics",dashboards:"/dashboards",cardinality:"/cardinality",topQueries:"/top-queries",trace:"/trace",withTemplate:"/expand-with-exprs",relabel:"/relabeling",logs:"/logs",activeQueries:"/active-queries",queryAnalyzer:"/query-analyzer",icons:"/icons",anomaly:"/anomaly",query:"/query",rawQuery:"/raw-query",downsamplingDebug:"/downsampling-filters-debug",retentionDebug:"/retention-filters-debug"},Jt={header:{tenant:!0,stepControl:!1,timeSelector:!1,executionControls:!1}},ct={[J.home]:{title:"Query",...Jt},[J.rawQuery]:{title:"Raw query",...Jt},[J.metrics]:{title:"Explore Prometheus metrics",header:{tenant:!0,stepControl:!0,timeSelector:!0}},[J.cardinality]:{title:"Explore cardinality",header:{tenant:!0,cardinalityDatePicker:!0}},[J.topQueries]:{title:"Top queries",header:{tenant:!0}},[J.trace]:{title:"Trace analyzer",header:{}},[J.queryAnalyzer]:{title:"Query analyzer",header:{}},[J.dashboards]:{title:"Dashboards",...Jt},[J.withTemplate]:{title:"WITH templates",header:{}},[J.relabel]:{title:"Metric relabel debug",header:{}},[J.logs]:{title:"Logs Explorer",header:{}},[J.activeQueries]:{title:"Active Queries",header:{}},[J.icons]:{title:"Icons",header:{}},[J.anomaly]:{title:"Anomaly exploration",...Jt},[J.query]:{title:"Query",...Jt},[J.downsamplingDebug]:{title:"Downsampling filters debug",header:{}},[J.retentionDebug]:{title:"Retention filters debug",header:{}}},rn=()=>{var n;const t=((n=document.getElementById("root"))==null?void 0:n.dataset.params)||"{}";try{return JSON.parse(t)}catch(a){return console.error(a),{}}},Ce=()=>!!Object.keys(rn()).length,xo=/(\/select\/)(\d+|\d.+)(\/)(.+)/,Eo=(t,n)=>t.replace(xo,`$1${n}/$4`),on=t=>{var n;return((n=t.match(xo))==null?void 0:n[2])||""},Te=(t,n)=>{n?window.localStorage.setItem(t,JSON.stringify({value:n})):Lo([t]),window.dispatchEvent(new Event("storage"))},xe=t=>{var a;const n=window.localStorage.getItem(t);if(n!==null)try{return(a=JSON.parse(n))==null?void 0:a.value}catch{return n}},Lo=t=>t.forEach(n=>window.localStorage.removeItem(n)),wi=t=>{const{serverURL:n}=rn(),a=xe("SERVER_URL"),r=window.location.href.replace(/\/(select\/)?(vmui)\/.*/,""),o=`${window.location.origin}${window.location.pathname.replace(/^\/vmui/,"")}`,s=window.location.href.replace(/\/(?:prometheus\/)?(?:graph|vmui)\/.*/,"/prometheus"),i=n||a||s;switch(jt){case rt.victorialogs:return r;case rt.vmanomaly:return a||o;default:return t?Eo(i,t):i}},Sn=10,Mo=25,Do={table:100,chart:20,code:1e3},Tn=[{id:"small",isDefault:!0,height:()=>window.innerHeight*.2},{id:"medium",height:()=>window.innerHeight*.4},{id:"large",height:()=>window.innerHeight*.8}],$a=["min","median","max"],Oe=(t,n)=>{const a=window.location.hash.split("?")[1],r=Ea.parse(a,{ignoreQueryPrefix:!0});return pt(r,t,n||"")},Io=()=>{var a;const n=((a=(window.location.hash.split("?")[1]||"").match(/g\d+\.expr/g))==null?void 0:a.length)||1;return new Array(n>Sn?Sn:n).fill(1).map((r,o)=>Oe(`g${o}.expr`,""))};var ne=(t=>(t.yhat="yhat",t.yhatUpper="yhat_upper",t.yhatLower="yhat_lower",t.anomaly="vmui_anomalies_points",t.training="vmui_training_data",t.actual="actual",t.anomalyScore="anomaly_score",t))(ne||{}),we=(t=>(t.table="table",t.chart="chart",t.code="code",t))(we||{}),be=(t=>(t.emptyServer="Please enter Server URL",t.validServer="Please provide a valid Server URL",t.validQuery="Please enter a valid Query and execute it",t.traceNotFound="Not found the tracing information",t.emptyTitle="Please enter title",t.positiveNumber="Please enter positive number",t.validStep="Please enter a valid step",t.unknownType="Unknown server response format: must have 'errorType'",t))(be||{}),Be=(t=>(t.system="system",t.light="light",t.dark="dark",t))(Be||{}),Le=(t=>(t.empty="empty",t.metricsql="metricsql",t.label="label",t.labelValue="labelValue",t))(Le||{});const Ze=t=>getComputedStyle(document.documentElement).getPropertyValue(`--${t}`),Pt=(t,n)=>{document.documentElement.style.setProperty(`--${t}`,n)},An=()=>window.matchMedia("(prefers-color-scheme: dark)").matches,Ci=t=>t===Be.system&&An()||t===Be.dark,Oa=t=>{let n;try{n=new URL(t)}catch{return!1}return n.protocol==="http:"||n.protocol==="https:"},Po=t=>t.replace(/\/$/,""),Ni=(t,n)=>{if(Array.from(t.entries()).length!==Array.from(n.entries()).length)return!1;for(const[a,r]of t)if(n.get(a)!==r)return!1;return!0},ki=t=>{try{const n=t.match(/\/api\/v1\/[^?]+/);return n?n[0]:null}catch(n){return console.error("Invalid URL:",n),null}},qr=Oe("g0.tenantID",""),Si={serverUrl:Po(wi(qr)),tenantId:qr,theme:xe("THEME")||Be.system,isDarkTheme:null,flags:{},appConfig:{}};function Ti(t,n){switch(n.type){case"SET_SERVER":return{...t,serverUrl:Po(n.payload)};case"SET_TENANT_ID":return{...t,tenantId:n.payload};case"SET_THEME":return Te("THEME",n.payload),{...t,theme:n.payload};case"SET_DARK_THEME":return{...t,isDarkTheme:Ci(t.theme)};case"SET_FLAGS":return{...t,flags:n.payload};case"SET_APP_CONFIG":return{...t,appConfig:n.payload};default:throw new Error}}const Ra=vt({}),re=()=>De(Ra).state,Et=()=>De(Ra).dispatch,Ai=Object.entries(Si).reduce((t,[n,a])=>({...t,[n]:Oe(n)||a}),{}),xi=({children:t})=>{const[n,a]=xt(Ti,Ai),r=L(()=>({state:n,dispatch:a}),[n,a]);return e(Ra.Provider,{value:r,children:t})},Nt="YYYY-MM-DD",Ge="YYYY-MM-DD HH:mm:ss",xn="YYYY-MM-DD HH:mm:ss:SSS (Z)",Fa="YYYY-MM-DD[T]HH:mm:ss",$o="YYYY-MM-DD_HHmmss",Ei=["Africa/Abidjan","Africa/Accra","Africa/Addis_Ababa","Africa/Algiers","Africa/Asmera","Africa/Bamako","Africa/Bangui","Africa/Banjul","Africa/Bissau","Africa/Blantyre","Africa/Brazzaville","Africa/Bujumbura","Africa/Cairo","Africa/Casablanca","Africa/Ceuta","Africa/Conakry","Africa/Dakar","Africa/Dar_es_Salaam","Africa/Djibouti","Africa/Douala","Africa/El_Aaiun","Africa/Freetown","Africa/Gaborone","Africa/Harare","Africa/Johannesburg","Africa/Juba","Africa/Kampala","Africa/Khartoum","Africa/Kigali","Africa/Kinshasa","Africa/Lagos","Africa/Libreville","Africa/Lome","Africa/Luanda","Africa/Lubumbashi","Africa/Lusaka","Africa/Malabo","Africa/Maputo","Africa/Maseru","Africa/Mbabane","Africa/Mogadishu","Africa/Monrovia","Africa/Nairobi","Africa/Ndjamena","Africa/Niamey","Africa/Nouakchott","Africa/Ouagadougou","Africa/Porto-Novo","Africa/Sao_Tome","Africa/Tripoli","Africa/Tunis","Africa/Windhoek","America/Adak","America/Anchorage","America/Anguilla","America/Antigua","America/Araguaina","America/Argentina/La_Rioja","America/Argentina/Rio_Gallegos","America/Argentina/Salta","America/Argentina/San_Juan","America/Argentina/San_Luis","America/Argentina/Tucuman","America/Argentina/Ushuaia","America/Aruba","America/Asuncion","America/Bahia","America/Bahia_Banderas","America/Barbados","America/Belem","America/Belize","America/Blanc-Sablon","America/Boa_Vista","America/Bogota","America/Boise","America/Buenos_Aires","America/Cambridge_Bay","America/Campo_Grande","America/Cancun","America/Caracas","America/Catamarca","America/Cayenne","America/Cayman","America/Chicago","America/Chihuahua","America/Coral_Harbour","America/Cordoba","America/Costa_Rica","America/Creston","America/Cuiaba","America/Curacao","America/Danmarkshavn","America/Dawson","America/Dawson_Creek","America/Denver","America/Detroit","America/Dominica","America/Edmonton","America/Eirunepe","America/El_Salvador","America/Fort_Nelson","America/Fortaleza","America/Glace_Bay","America/Godthab","America/Goose_Bay","America/Grand_Turk","America/Grenada","America/Guadeloupe","America/Guatemala","America/Guayaquil","America/Guyana","America/Halifax","America/Havana","America/Hermosillo","America/Indiana/Knox","America/Indiana/Marengo","America/Indiana/Petersburg","America/Indiana/Tell_City","America/Indiana/Vevay","America/Indiana/Vincennes","America/Indiana/Winamac","America/Indianapolis","America/Inuvik","America/Iqaluit","America/Jamaica","America/Jujuy","America/Juneau","America/Kentucky/Monticello","America/Kralendijk","America/La_Paz","America/Lima","America/Los_Angeles","America/Louisville","America/Lower_Princes","America/Maceio","America/Managua","America/Manaus","America/Marigot","America/Martinique","America/Matamoros","America/Mazatlan","America/Mendoza","America/Menominee","America/Merida","America/Metlakatla","America/Mexico_City","America/Miquelon","America/Moncton","America/Monterrey","America/Montevideo","America/Montreal","America/Montserrat","America/Nassau","America/New_York","America/Nipigon","America/Nome","America/Noronha","America/North_Dakota/Beulah","America/North_Dakota/Center","America/North_Dakota/New_Salem","America/Ojinaga","America/Panama","America/Pangnirtung","America/Paramaribo","America/Phoenix","America/Port-au-Prince","America/Port_of_Spain","America/Porto_Velho","America/Puerto_Rico","America/Punta_Arenas","America/Rainy_River","America/Rankin_Inlet","America/Recife","America/Regina","America/Resolute","America/Rio_Branco","America/Santa_Isabel","America/Santarem","America/Santiago","America/Santo_Domingo","America/Sao_Paulo","America/Scoresbysund","America/Sitka","America/St_Barthelemy","America/St_Johns","America/St_Kitts","America/St_Lucia","America/St_Thomas","America/St_Vincent","America/Swift_Current","America/Tegucigalpa","America/Thule","America/Thunder_Bay","America/Tijuana","America/Toronto","America/Tortola","America/Vancouver","America/Whitehorse","America/Winnipeg","America/Yakutat","America/Yellowknife","Antarctica/Casey","Antarctica/Davis","Antarctica/DumontDUrville","Antarctica/Macquarie","Antarctica/Mawson","Antarctica/McMurdo","Antarctica/Palmer","Antarctica/Rothera","Antarctica/Syowa","Antarctica/Troll","Antarctica/Vostok","Arctic/Longyearbyen","Asia/Aden","Asia/Almaty","Asia/Amman","Asia/Anadyr","Asia/Aqtau","Asia/Aqtobe","Asia/Ashgabat","Asia/Atyrau","Asia/Baghdad","Asia/Bahrain","Asia/Baku","Asia/Bangkok","Asia/Barnaul","Asia/Beirut","Asia/Bishkek","Asia/Brunei","Asia/Calcutta","Asia/Chita","Asia/Choibalsan","Asia/Colombo","Asia/Damascus","Asia/Dhaka","Asia/Dili","Asia/Dubai","Asia/Dushanbe","Asia/Famagusta","Asia/Gaza","Asia/Hebron","Asia/Hong_Kong","Asia/Hovd","Asia/Irkutsk","Asia/Jakarta","Asia/Jayapura","Asia/Jerusalem","Asia/Kabul","Asia/Kamchatka","Asia/Karachi","Asia/Katmandu","Asia/Khandyga","Asia/Krasnoyarsk","Asia/Kuala_Lumpur","Asia/Kuching","Asia/Kuwait","Asia/Macau","Asia/Magadan","Asia/Makassar","Asia/Manila","Asia/Muscat","Asia/Nicosia","Asia/Novokuznetsk","Asia/Novosibirsk","Asia/Omsk","Asia/Oral","Asia/Phnom_Penh","Asia/Pontianak","Asia/Pyongyang","Asia/Qatar","Asia/Qostanay","Asia/Qyzylorda","Asia/Rangoon","Asia/Riyadh","Asia/Saigon","Asia/Sakhalin","Asia/Samarkand","Asia/Seoul","Asia/Shanghai","Asia/Singapore","Asia/Srednekolymsk","Asia/Taipei","Asia/Tashkent","Asia/Tbilisi","Asia/Tehran","Asia/Thimphu","Asia/Tokyo","Asia/Tomsk","Asia/Ulaanbaatar","Asia/Urumqi","Asia/Ust-Nera","Asia/Vientiane","Asia/Vladivostok","Asia/Yakutsk","Asia/Yekaterinburg","Asia/Yerevan","Atlantic/Azores","Atlantic/Bermuda","Atlantic/Canary","Atlantic/Cape_Verde","Atlantic/Faeroe","Atlantic/Madeira","Atlantic/Reykjavik","Atlantic/South_Georgia","Atlantic/St_Helena","Atlantic/Stanley","Australia/Adelaide","Australia/Brisbane","Australia/Broken_Hill","Australia/Currie","Australia/Darwin","Australia/Eucla","Australia/Hobart","Australia/Lindeman","Australia/Lord_Howe","Australia/Melbourne","Australia/Perth","Australia/Sydney","Europe/Amsterdam","Europe/Andorra","Europe/Astrakhan","Europe/Athens","Europe/Belgrade","Europe/Berlin","Europe/Bratislava","Europe/Brussels","Europe/Bucharest","Europe/Budapest","Europe/Busingen","Europe/Chisinau","Europe/Copenhagen","Europe/Dublin","Europe/Gibraltar","Europe/Guernsey","Europe/Helsinki","Europe/Isle_of_Man","Europe/Istanbul","Europe/Jersey","Europe/Kaliningrad","Europe/Kiev","Europe/Kirov","Europe/Lisbon","Europe/Ljubljana","Europe/London","Europe/Luxembourg","Europe/Madrid","Europe/Malta","Europe/Mariehamn","Europe/Minsk","Europe/Monaco","Europe/Moscow","Europe/Oslo","Europe/Paris","Europe/Podgorica","Europe/Prague","Europe/Riga","Europe/Rome","Europe/Samara","Europe/San_Marino","Europe/Sarajevo","Europe/Saratov","Europe/Simferopol","Europe/Skopje","Europe/Sofia","Europe/Stockholm","Europe/Tallinn","Europe/Tirane","Europe/Ulyanovsk","Europe/Uzhgorod","Europe/Vaduz","Europe/Vatican","Europe/Vienna","Europe/Vilnius","Europe/Volgograd","Europe/Warsaw","Europe/Zagreb","Europe/Zaporozhye","Europe/Zurich","Indian/Antananarivo","Indian/Chagos","Indian/Christmas","Indian/Cocos","Indian/Comoro","Indian/Kerguelen","Indian/Mahe","Indian/Maldives","Indian/Mauritius","Indian/Mayotte","Indian/Reunion","Pacific/Apia","Pacific/Auckland","Pacific/Bougainville","Pacific/Chatham","Pacific/Easter","Pacific/Efate","Pacific/Enderbury","Pacific/Fakaofo","Pacific/Fiji","Pacific/Funafuti","Pacific/Galapagos","Pacific/Gambier","Pacific/Guadalcanal","Pacific/Guam","Pacific/Honolulu","Pacific/Johnston","Pacific/Kiritimati","Pacific/Kosrae","Pacific/Kwajalein","Pacific/Majuro","Pacific/Marquesas","Pacific/Midway","Pacific/Nauru","Pacific/Niue","Pacific/Norfolk","Pacific/Noumea","Pacific/Pago_Pago","Pacific/Palau","Pacific/Pitcairn","Pacific/Ponape","Pacific/Port_Moresby","Pacific/Rarotonga","Pacific/Saipan","Pacific/Tahiti","Pacific/Tarawa","Pacific/Tongatapu","Pacific/Truk","Pacific/Wake","Pacific/Wallis"],Li=window.innerWidth/4,Mi=window.innerWidth/40,Br={min:1,max:1578e8},jr=Intl.supportedValuesOf,Di=jr?jr("timeZone"):Ei,za=[{long:"years",short:"y",possible:"year"},{long:"weeks",short:"w",possible:"week"},{long:"days",short:"d",possible:"day"},{long:"hours",short:"h",possible:"hour"},{long:"minutes",short:"m",possible:"min"},{long:"seconds",short:"s",possible:"sec"},{long:"milliseconds",short:"ms",possible:"millisecond"}],Ii=za.map(t=>t.short),Cn=t=>Math.round(t*1e3)/1e3,Ha=t=>Vn(B.duration(t,"seconds").asMilliseconds()),wa=t=>{let n=Cn(t);const a=Math.round(t);return t>=100&&(n=a-a%10),t<100&&t>=10&&(n=a-a%5),t<10&&t>=1&&(n=a),t<1&&t>.01&&(n=Math.round(t*40)/40),Ha(n||.001).replace(/\s/g,"")},Oo=t=>{const n=t.match(/\d+/g),a=t.match(/[a-zA-Z]+/g);if(a&&n&&Ii.includes(a[0]))return{[a[0]]:n[0]}},Va=t=>{const n=za.map(s=>s.short).join("|"),a=new RegExp(`\\d+(\\.\\d+)?[${n}]+`,"g"),o=(t.match(a)||[]).reduce((s,i)=>{const c=Oo(i);return c?{...s,...c}:{...s}},{});return B.duration(o).asSeconds()},Pi=[we.table,we.code],sn=(t,n,a)=>a&&Pi.includes(a)?wa(t):wa(t/(n?Mi:Li)),yt=(t,n)=>{const a=(n||B().toDate()).valueOf()/1e3,r=Va(t);return{start:a-r,end:a,step:sn(r),date:Ro(n||B().toDate())}},$i=t=>B(t).utcOffset(0,!0).toDate(),Ro=t=>B.tz(t).utc().format(Fa),Rt=t=>B.tz(t).format(Fa),Oi=()=>B().utc().format(Fa),Vn=t=>{const n=Math.floor(t%1e3),a=Math.floor(t/1e3%60),r=Math.floor(t/1e3/60%60),o=Math.floor(t/1e3/3600%24),s=Math.floor(t/(1e3*60*60*24)),i=["d","h","m","s","ms"];return[s,o,r,a,n].map((l,m)=>l?`${l}${i[m]}`:"").filter(l=>l).join("")},Ri=t=>{const n=t.to.valueOf()-t.from.valueOf();return Vn(n)},je=t=>{const n=B(t*1e3);return n.isValid()?n.toDate():new Date},Fi=()=>B().tz().subtract(1,"day").endOf("day").toDate(),zi=()=>B().tz().endOf("day").toDate(),Xt=[{title:"Last 5 minutes",duration:"5m",isDefault:Ao},{title:"Last 15 minutes",duration:"15m"},{title:"Last 30 minutes",duration:"30m",isDefault:!1},{title:"Last 1 hour",duration:"1h"},{title:"Last 3 hours",duration:"3h"},{title:"Last 6 hours",duration:"6h"},{title:"Last 12 hours",duration:"12h"},{title:"Last 24 hours",duration:"24h"},{title:"Last 2 days",duration:"2d"},{title:"Last 7 days",duration:"7d"},{title:"Last 30 days",duration:"30d"},{title:"Last 90 days",duration:"90d"},{title:"Last 180 days",duration:"180d"},{title:"Last 1 year",duration:"1y"},{title:"Yesterday",duration:"1d",until:Fi},{title:"Today",duration:"1d",until:zi}].map(t=>({id:t.title.replace(/\s/g,"_").toLocaleLowerCase(),until:t.until?t.until:()=>B().tz().toDate(),...t})),Ua=({relativeTimeId:t,defaultDuration:n,defaultEndInput:a})=>{var i;const r=(i=Xt.find(c=>c.isDefault))==null?void 0:i.id,o=t||Oe("g0.relative_time",r),s=Xt.find(c=>c.id===o);return{relativeTimeId:s?o:"none",duration:s?s.duration:n,endInput:s?s.until():a}},Zt=t=>`UTC${B().tz(t).format("Z")}`,Qr=(t="")=>{const n=new RegExp(t,"i");return Di.reduce((a,r)=>{const o=(r.match(/^(.*?)\//)||[])[1]||"unknown",s=Zt(r),i=s.replace(/UTC|0/,""),c=r.replace(/[/_]/g," "),l={region:r,utc:s,search:`${r} ${s} ${c} ${i}`},m=!t||t&&n.test(l.search);return m&&a[o]?a[o].push(l):m&&(a[o]=[l]),a},{})},Fo=t=>{B.tz.setDefault(t)},Hi=t=>{try{return B().tz(t),!0}catch{return!1}},zo=()=>{const t=B.tz.guess(),n=Hi(t);return{isValid:n,title:n?`Browser Time (${t})`:"Browser timezone (UTC)",region:n?t:"UTC"}},En=t=>{if(!t)return 0n;const n=B(t).valueOf();if(!t.includes("."))return BigInt(n)*1000000n;const a=t.match(/\.(\d+)Z/);if(!a)return BigInt(n)*1000000n;let r=a[1];r=r.padEnd(9,"0");const o=parseInt(r.slice(3),10);return BigInt(n)*1000000n+BigInt(o)},Ho=xe("TIMEZONE")||zo().region;Fo(Ho);const Vo=()=>{const t=Oe("g0.range_input"),{duration:n,endInput:a,relativeTimeId:r}=Ua({defaultDuration:t||"1h",defaultEndInput:$i(Oe("g0.end_input",Oi())),relativeTimeId:t?Oe("g0.relative_time","none"):void 0});return{duration:n,period:yt(n,a),relativeTime:r}},Vi={...Vo(),timezone:Ho};function Ui(t,n){switch(n.type){case"SET_TIME_STATE":return{...t,...n.payload};case"SET_DURATION":return{...t,duration:n.payload,period:yt(n.payload,je(t.period.end)),relativeTime:"none"};case"SET_RELATIVE_TIME":return{...t,duration:n.payload.duration,period:yt(n.payload.duration,n.payload.until),relativeTime:n.payload.id};case"SET_PERIOD":const a=Ri(n.payload);return{...t,duration:a,period:yt(a,n.payload.to),relativeTime:"none"};case"RUN_QUERY":const{duration:r,endInput:o}=Ua({relativeTimeId:t.relativeTime,defaultDuration:t.duration,defaultEndInput:je(t.period.end)});return{...t,period:yt(r,o)};case"RUN_QUERY_TO_NOW":return{...t,period:yt(t.duration)};case"SET_TIMEZONE":return Fo(n.payload),Te("TIMEZONE",n.payload),t.defaultTimezone&&Te("DISABLED_DEFAULT_TIMEZONE",n.payload!==t.defaultTimezone),{...t,timezone:n.payload};case"SET_DEFAULT_TIMEZONE":return{...t,defaultTimezone:n.payload};default:throw new Error}}const qa=vt({}),he=()=>De(qa).state,Ve=()=>De(qa).dispatch,qi=({children:t})=>{const[n,a]=xt(Ui,Vi),r=L(()=>({state:n,dispatch:a}),[n,a]);return e(qa.Provider,{value:r,children:t})},$t=t=>{const n=xe(t);return n?JSON.parse(n):[]},Bi=t=>{const n=t.map(s=>s.values[s.index]),a=$t("QUERY_HISTORY");a[0]||(a[0]=[]);const r=a[0],o=Mo*Sn;n.forEach(s=>{!r.includes(s)&&s&&r.unshift(s),r.length>o&&r.shift()}),Te("QUERY_HISTORY",JSON.stringify(a))},St={displayResults:50,queryLimit:1e3,cacheLimit:1e3};class ji{constructor(){Ye(this,"maxSize");Ye(this,"map");this.maxSize=St.cacheLimit,this.map=new Map}get(n){for(const[a,r]of this.map){const o=JSON.parse(a),s=o.start===n.start&&o.end===n.end,i=o.type===n.type,c=n.value&&o.value&&n.value.includes(o.value),l=o.match===n.match||c,m=r.length<St.queryLimit;if(l&&s&&i&&m)return r}return this.map.get(JSON.stringify(n))}put(n,a){if(this.map.size>=this.maxSize){const r=this.map.keys().next().value;r&&this.map.delete(r)}this.map.set(JSON.stringify(n),a)}}const Yr=Io(),Qi={query:Yr,queryHistory:Yr.map(t=>({index:0,values:[t]})),autocomplete:xe("AUTOCOMPLETE")||!1,autocompleteQuick:!1,autocompleteCache:new ji,metricsQLFunctions:[]};function Yi(t,n){switch(n.type){case"SET_QUERY":return{...t,query:n.payload.map(a=>a)};case"SET_QUERY_HISTORY":return Bi(n.payload),{...t,queryHistory:n.payload};case"SET_QUERY_HISTORY_BY_INDEX":return t.queryHistory.splice(n.payload.queryNumber,1,n.payload.value),{...t,queryHistory:t.queryHistory};case"TOGGLE_AUTOCOMPLETE":return Te("AUTOCOMPLETE",!t.autocomplete),{...t,autocomplete:!t.autocomplete};case"SET_AUTOCOMPLETE_QUICK":return{...t,autocompleteQuick:n.payload};case"SET_AUTOCOMPLETE_CACHE":return t.autocompleteCache.put(n.payload.key,n.payload.value),{...t};case"SET_METRICSQL_FUNCTIONS":return{...t,metricsQLFunctions:n.payload};default:throw new Error}}const Ba=vt({}),Ee=()=>De(Ba).state,Qt=()=>De(Ba).dispatch,Gi=({children:t})=>{const[n,a]=xt(Yi,Qi),r=L(()=>({state:n,dispatch:a}),[n,a]);return e(Ba.Provider,{value:r,children:t})},Uo=()=>e("svg",{viewBox:"0 0 74 24",fill:"currentColor",children:e("path",{d:"M6.12 10.48c.36.28.8.43 1.26.43h.05c.48 0 .96-.19 1.25-.44 1.5-1.28 5.88-5.29 5.88-5.29C15.73 4.1 12.46 3.01 7.43 3h-.06C2.33 3-.93 4.1.24 5.18c0 0 4.37 4 5.88 5.3Zm2.56 2.16c-.36.28-.8.44-1.26.45h-.04c-.46 0-.9-.17-1.26-.45-1.04-.88-4.74-4.22-6.12-5.5v1.94c0 .21.08.5.22.63l.07.06c1.05.96 4.55 4.16 5.83 5.25.36.28.8.43 1.26.44h.04c.49-.02.96-.2 1.26-.44 1.3-1.11 4.94-4.45 5.88-5.31.15-.14.23-.42.23-.63V7.15a454.94 454.94 0 0 1-6.11 5.5Zm-1.26 4.99c.46 0 .9-.16 1.26-.44a454.4 454.4 0 0 0 6.1-5.5v1.94c0 .2-.07.48-.22.62-.94.87-4.57 4.2-5.88 5.3-.3.26-.77.44-1.26.45h-.04c-.46 0-.9-.16-1.26-.44-1.2-1.02-4.38-3.92-5.62-5.06l-.28-.25c-.14-.14-.22-.42-.22-.62v-1.94c1.38 1.26 5.08 4.6 6.12 5.5.36.28.8.43 1.26.44h.04ZM35 5l-5.84 14.46h-2.43L20.89 5h2.16a.9.9 0 0 1 .9.61l3.41 8.82a18.8 18.8 0 0 1 .62 2.02 19.44 19.44 0 0 1 .57-2.02l3.39-8.82c.05-.15.16-.3.31-.42a.9.9 0 0 1 .58-.19H35Zm17.18 0v14.46H49.8v-9.34c0-.37.02-.78.06-1.21l-4.37 8.21c-.21.4-.53.59-.95.59h-.38c-.43 0-.75-.2-.95-.59L38.8 8.88a22.96 22.96 0 0 1 .07 1.24v9.34H36.5V5h2.03l.3.01c.1 0 .17.02.24.05.07.03.13.07.19.13a1 1 0 0 1 .17.24l4.33 8.03a16.97 16.97 0 0 1 .6 1.36 14.34 14.34 0 0 1 .6-1.38l4.28-8.01c.05-.1.1-.18.17-.24.06-.06.12-.1.19-.13a.9.9 0 0 1 .24-.05l.3-.01h2.04Zm8.88 13.73a4.5 4.5 0 0 0 1.82-.35 3.96 3.96 0 0 0 2.22-2.47c.2-.57.3-1.19.3-1.85V5.31h1.02v8.75c0 .78-.12 1.51-.37 2.19a4.88 4.88 0 0 1-2.76 2.95c-.66.29-1.4.43-2.23.43-.82 0-1.57-.14-2.24-.43a5.01 5.01 0 0 1-2.75-2.95 6.37 6.37 0 0 1-.37-2.19V5.31h1.03v8.74c0 .66.1 1.28.3 1.85a3.98 3.98 0 0 0 2.21 2.47c.53.24 1.14.36 1.82.36Zm10.38.73h-1.03V5.31h1.03v14.15Z"})}),qo=()=>e("svg",{viewBox:"0 0 85 38",fill:"currentColor",children:[e("path",{d:"M11.12 10.48c.36.28.8.43 1.26.43h.05c.48 0 .96-.19 1.25-.44 1.5-1.28 5.88-5.29 5.88-5.29 1.17-1.09-2.1-2.17-7.13-2.18h-.06c-5.04 0-8.3 1.1-7.13 2.18 0 0 4.37 4 5.88 5.3Zm2.56 2.16c-.36.28-.8.44-1.26.45h-.04c-.46 0-.9-.17-1.26-.45-1.04-.88-4.74-4.22-6.12-5.5v1.94c0 .21.08.5.22.63l.07.06c1.05.96 4.55 4.16 5.83 5.25.36.28.8.43 1.26.44h.04c.49-.02.96-.2 1.26-.44 1.3-1.11 4.94-4.45 5.88-5.31.15-.14.23-.42.23-.63V7.15a455.13 455.13 0 0 1-6.11 5.5Zm-1.26 4.99c.46 0 .9-.16 1.26-.44 2.05-1.82 4.09-3.65 6.1-5.5v1.94c0 .2-.07.48-.22.62-.94.87-4.57 4.2-5.88 5.3-.3.26-.77.44-1.26.45h-.04c-.46 0-.9-.16-1.26-.44-1.2-1.02-4.38-3.92-5.62-5.06l-.28-.25c-.14-.14-.22-.42-.22-.62v-1.94c1.38 1.26 5.08 4.6 6.12 5.5.36.28.8.43 1.26.44h.04ZM40 5l-5.84 14.46h-2.43L25.89 5h2.16a.9.9 0 0 1 .9.61l3.41 8.82a18.8 18.8 0 0 1 .62 2.02 19.44 19.44 0 0 1 .57-2.02l3.39-8.82c.05-.15.16-.3.31-.42a.9.9 0 0 1 .58-.19H40Zm17.18 0v14.46H54.8v-9.34c0-.37.02-.78.06-1.21l-4.37 8.21c-.21.4-.53.59-.95.59h-.38c-.43 0-.75-.2-.95-.59L43.8 8.88a22.96 22.96 0 0 1 .07 1.24v9.34H41.5V5h2.03l.3.01c.1 0 .17.02.24.05.07.03.13.07.19.13a1 1 0 0 1 .17.24l4.33 8.03a16.97 16.97 0 0 1 .6 1.36 14.34 14.34 0 0 1 .6-1.38l4.28-8.01c.05-.1.1-.18.17-.24.06-.06.12-.1.19-.13a.9.9 0 0 1 .24-.05l.3-.01h2.04Zm8.88 13.73a4.5 4.5 0 0 0 1.82-.35 3.96 3.96 0 0 0 2.22-2.47c.2-.57.3-1.19.3-1.85V5.31h1.02v8.75c0 .78-.12 1.51-.37 2.19a4.88 4.88 0 0 1-2.76 2.95c-.66.29-1.4.43-2.23.43-.82 0-1.57-.14-2.24-.43a5.01 5.01 0 0 1-2.75-2.95 6.37 6.37 0 0 1-.37-2.19V5.31h1.03v8.74c0 .66.1 1.28.3 1.85a3.98 3.98 0 0 0 2.21 2.47c.53.24 1.14.36 1.82.36Zm10.38.73h-1.03V5.31h1.03v14.15ZM1.73 36v-5.17l-.67-.07a.6.6 0 0 1-.21-.1.23.23 0 0 1-.08-.18v-.44h.96v-.59c0-.34.05-.65.14-.92a1.79 1.79 0 0 1 1.08-1.11 2.45 2.45 0 0 1 1.62-.02l-.03.53c0 .1-.06.15-.16.16H4c-.18 0-.35.03-.5.08a.95.95 0 0 0-.39.23c-.1.11-.19.25-.25.43-.05.18-.08.4-.08.65v.56h1.75v.78H2.8V36H1.73Zm6.17-6.17c.45 0 .85.07 1.2.22a2.57 2.57 0 0 1 1.5 1.62c.13.38.2.81.2 1.29s-.07.91-.2 1.3a2.57 2.57 0 0 1-1.49 1.61c-.36.14-.76.21-1.2.21-.45 0-.86-.07-1.22-.21a2.57 2.57 0 0 1-1.5-1.62c-.12-.38-.19-.81-.19-1.3 0-.47.07-.9.2-1.28a2.57 2.57 0 0 1 1.5-1.62c.35-.15.76-.22 1.2-.22Zm0 5.42c.6 0 1.05-.2 1.35-.6.3-.4.44-.97.44-1.69s-.15-1.28-.44-1.69c-.3-.4-.75-.6-1.35-.6-.3 0-.57.05-.8.15-.22.1-.4.26-.56.45-.15.2-.26.44-.33.73-.08.28-.11.6-.11.96 0 .72.15 1.29.44 1.69.3.4.76.6 1.36.6Zm5.26-4.11c.2-.42.43-.74.71-.97.28-.24.62-.36 1.03-.36.13 0 .25.02.36.05.12.02.23.07.32.13l-.08.8c-.02.1-.08.15-.18.15l-.24-.04a1.7 1.7 0 0 0-.88.05c-.15.05-.29.14-.4.25-.12.1-.23.24-.32.4-.1.17-.18.35-.26.56V36h-1.07v-6.08h.61c.12 0 .2.02.24.07.05.04.08.12.1.23l.06.92Zm13.73-3.82L23.39 36h-1.46l-3.5-8.68h1.29a.54.54 0 0 1 .54.37l2.04 5.3a11.31 11.31 0 0 1 .37 1.21 11.65 11.65 0 0 1 .35-1.22l2.03-5.29c.03-.1.1-.18.19-.25.1-.08.21-.12.35-.12h1.3Zm2.2 2.52V36H27.6v-6.16h1.49Zm.2-1.79c0 .13-.02.25-.08.36a1 1 0 0 1-.51.5.96.96 0 0 1-.73 0 1.02 1.02 0 0 1-.5-.5.96.96 0 0 1 0-.73.93.93 0 0 1 .86-.58.9.9 0 0 1 .37.08c.12.05.22.11.3.2a.94.94 0 0 1 .3.67Zm5.72 3.1a.68.68 0 0 1-.13.13c-.04.03-.1.05-.18.05a.42.42 0 0 1-.22-.07 3.95 3.95 0 0 0-.62-.31c-.14-.05-.3-.07-.51-.07-.26 0-.5.04-.69.14-.2.1-.36.23-.49.4-.13.18-.22.4-.29.64-.06.25-.1.53-.1.85 0 .33.04.62.1.88.08.25.18.47.32.64.13.18.29.3.48.4.18.09.4.13.63.13a1.6 1.6 0 0 0 .94-.27l.26-.2a.4.4 0 0 1 .25-.09.3.3 0 0 1 .27.14l.43.54a2.76 2.76 0 0 1-1.77.96c-.22.03-.43.05-.65.05a2.57 2.57 0 0 1-1.96-.83c-.25-.28-.45-.6-.6-1-.14-.4-.21-.85-.21-1.35 0-.45.06-.87.2-1.25a2.61 2.61 0 0 1 1.51-1.67c.37-.16.8-.24 1.28-.24.46 0 .86.07 1.2.22.35.15.66.36.94.64l-.4.54Zm3.43 4.95c-.54 0-.95-.15-1.24-.45-.28-.3-.42-.73-.42-1.26v-3.44h-.63a.29.29 0 0 1-.2-.07c-.06-.06-.09-.13-.09-.24v-.59l.99-.16.31-1.68a.33.33 0 0 1 .12-.18.34.34 0 0 1 .21-.07h.77v1.94h1.64v1.05h-1.64v3.34c0 .2.05.34.14.45.1.1.22.16.39.16a.73.73 0 0 0 .39-.1l.12-.07a.2.2 0 0 1 .11-.03c.05 0 .08.01.11.03l.09.1.44.72c-.21.18-.46.32-.74.4-.28.1-.57.15-.87.15Zm5.09-6.35c.46 0 .87.07 1.24.22a2.7 2.7 0 0 1 1.58 1.63c.14.39.22.83.22 1.31 0 .49-.08.93-.22 1.32-.14.4-.35.73-.62 1-.26.28-.58.49-.96.64-.37.15-.78.22-1.24.22a3.4 3.4 0 0 1-1.25-.22 2.71 2.71 0 0 1-1.59-1.64 3.8 3.8 0 0 1-.21-1.32c0-.48.07-.92.21-1.31a2.75 2.75 0 0 1 1.58-1.63c.38-.15.8-.22 1.26-.22Zm0 5.2c.51 0 .89-.17 1.13-.52.25-.34.38-.84.38-1.5a2.6 2.6 0 0 0-.38-1.53c-.24-.34-.62-.52-1.13-.52-.52 0-.9.18-1.16.53-.25.35-.37.85-.37 1.51s.12 1.17.37 1.51c.25.35.64.52 1.16.52Zm5.56-4.04c.2-.37.42-.65.69-.86.26-.21.57-.32.94-.32.28 0 .5.06.68.19l-.1 1.1a.3.3 0 0 1-.09.16.24.24 0 0 1-.15.04 1.8 1.8 0 0 1-.27-.03 2.01 2.01 0 0 0-.34-.03c-.16 0-.3.03-.44.08a1.1 1.1 0 0 0-.34.2c-.1.1-.2.2-.27.33-.08.13-.15.27-.22.44V36H47.7v-6.16h.87c.15 0 .26.03.31.09.06.05.1.15.13.29l.09.7Zm4.62-1.07V36h-1.49v-6.16h1.49Zm.2-1.79c0 .13-.02.25-.07.36a1 1 0 0 1-.51.5.96.96 0 0 1-.74 0 1.02 1.02 0 0 1-.5-.5.96.96 0 0 1 0-.73.93.93 0 0 1 .86-.58.9.9 0 0 1 .38.08c.11.05.21.11.3.2a.94.94 0 0 1 .28.67Zm4.56 5.32a7.8 7.8 0 0 0-1.08.12c-.29.05-.52.12-.7.2a.92.92 0 0 0-.38.3.64.64 0 0 0-.11.36c0 .26.07.45.23.56.15.11.35.17.6.17.3 0 .57-.06.79-.17.22-.1.44-.28.65-.5v-1.04Zm-3.4-2.67c.71-.65 1.57-.97 2.56-.97.36 0 .68.06.97.18a1.99 1.99 0 0 1 1.16 1.24c.1.3.16.61.16.96V36h-.67a.7.7 0 0 1-.33-.06c-.07-.04-.13-.13-.18-.26l-.13-.44c-.16.14-.3.26-.46.37a2.8 2.8 0 0 1-.97.43 2.77 2.77 0 0 1-1.32-.05 1.62 1.62 0 0 1-.57-.31 1.41 1.41 0 0 1-.38-.53 1.85 1.85 0 0 1-.05-1.18c.05-.16.14-.3.25-.45.12-.14.28-.27.46-.4a3 3 0 0 1 .7-.32 9.19 9.19 0 0 1 2.2-.33v-.36c0-.41-.09-.71-.26-.91-.18-.2-.43-.3-.76-.3a1.84 1.84 0 0 0-1.02.28l-.33.18c-.1.06-.2.09-.32.09-.1 0-.2-.03-.27-.08a.72.72 0 0 1-.17-.2l-.26-.47Zm11.49 4.32V36h-4.88v-8.6h1.16v7.62h3.72Zm3.16-5.2c.44 0 .84.08 1.2.23a2.57 2.57 0 0 1 1.49 1.62c.13.38.2.81.2 1.29s-.07.91-.2 1.3a2.57 2.57 0 0 1-1.49 1.61c-.36.14-.76.21-1.2.21-.45 0-.85-.07-1.21-.21a2.57 2.57 0 0 1-1.5-1.62c-.13-.38-.2-.81-.2-1.3 0-.47.07-.9.2-1.28.14-.39.33-.72.59-1 .25-.26.55-.47.9-.62.37-.15.77-.22 1.22-.22Zm0 5.43c.6 0 1.05-.2 1.34-.6.3-.4.45-.97.45-1.69s-.15-1.28-.45-1.69c-.3-.4-.74-.6-1.34-.6-.3 0-.57.05-.8.15-.22.1-.4.26-.56.45-.15.2-.26.44-.34.73-.07.28-.1.6-.1.96 0 .72.14 1.29.44 1.69.3.4.75.6 1.36.6Zm6.33-2.22c.22 0 .4-.03.57-.09.16-.06.3-.14.41-.25.12-.11.2-.24.26-.39.05-.15.08-.31.08-.5 0-.37-.11-.66-.34-.88-.23-.22-.55-.33-.98-.33-.43 0-.76.1-.99.33-.22.22-.34.51-.34.89 0 .18.03.34.09.5a1.1 1.1 0 0 0 .67.63c.16.06.35.09.57.09Zm1.93 3.3a.51.51 0 0 0-.13-.36.84.84 0 0 0-.34-.22 8.57 8.57 0 0 0-1.73-.2 7.5 7.5 0 0 1-.62-.05c-.23.1-.41.23-.56.4a.8.8 0 0 0-.1.92c.07.12.18.22.32.3.14.1.32.16.54.21a3.5 3.5 0 0 0 1.55 0c.23-.05.42-.12.57-.22.16-.1.29-.21.37-.34a.8.8 0 0 0 .13-.44Zm1.08-6.17v.4c0 .13-.08.21-.25.25l-.69.09c.14.26.2.56.2.88a1.86 1.86 0 0 1-1.36 1.82 3.07 3.07 0 0 1-1.72.04c-.12.08-.22.16-.29.25a.44.44 0 0 0-.1.27c0 .15.06.26.17.33.12.08.28.13.47.16a5 5 0 0 0 .66.06 16.56 16.56 0 0 1 1.5.13c.26.05.48.12.67.22.19.1.34.24.46.41.12.18.18.4.18.69 0 .26-.07.5-.2.75s-.31.46-.56.65c-.24.2-.54.34-.9.46a4.57 4.57 0 0 1-2.36.04c-.33-.09-.6-.2-.82-.36a1.56 1.56 0 0 1-.5-.51c-.1-.2-.16-.4-.16-.6 0-.3.1-.56.28-.77.19-.2.45-.37.77-.5a1.15 1.15 0 0 1-.43-.32.88.88 0 0 1-.15-.54c0-.09.01-.18.04-.27.04-.1.08-.2.15-.28a1.55 1.55 0 0 1 .58-.5c-.3-.16-.53-.39-.7-.66-.17-.28-.25-.6-.25-.97 0-.3.05-.57.16-.8.12-.25.28-.46.48-.63.2-.17.45-.3.73-.4a3 3 0 0 1 2.3.21h1.64Zm4.65.76a.24.24 0 0 1-.23.14.42.42 0 0 1-.2-.07 3.59 3.59 0 0 0-.67-.3 1.8 1.8 0 0 0-1.03 0c-.14.05-.27.11-.37.2a.87.87 0 0 0-.23.27.75.75 0 0 0-.08.35c0 .15.04.28.13.39.1.1.21.19.36.27.15.07.32.14.5.2a13.63 13.63 0 0 1 1.16.4c.2.08.36.18.5.3a1.33 1.33 0 0 1 .5 1.07 2 2 0 0 1-.15.78c-.1.24-.25.44-.45.62-.2.17-.43.3-.72.4a3.1 3.1 0 0 1-2.14-.05 2.97 2.97 0 0 1-.87-.53l.25-.41c.04-.05.07-.1.12-.12a.3.3 0 0 1 .17-.04.4.4 0 0 1 .22.08l.3.19a1.91 1.91 0 0 0 1.03.27c.2 0 .38-.03.54-.08.16-.06.29-.13.4-.22a.96.96 0 0 0 .3-.7c0-.17-.05-.31-.14-.42-.09-.11-.2-.2-.36-.28a2.6 2.6 0 0 0-.5-.2l-.59-.19c-.2-.06-.39-.14-.58-.22a2.14 2.14 0 0 1-.5-.3 1.45 1.45 0 0 1-.36-.46c-.1-.19-.14-.41-.14-.67a1.6 1.6 0 0 1 .57-1.23c.18-.16.4-.3.68-.39.26-.1.57-.14.91-.14a2.84 2.84 0 0 1 1.9.7l-.23.4Z"}),e("defs",{children:e("path",{d:"M0 0h85v38H0z"})})]}),Bo=()=>e("svg",{viewBox:"0 0 85 38",fill:"currentColor",children:e("path",{d:"M11.118 10.476c.36.28.801.433 1.257.436h.052c.48-.007.961-.192 1.25-.444 1.509-1.279 5.88-5.287 5.88-5.287 1.168-1.087-2.093-2.174-7.13-2.181h-.06c-5.036.007-8.298 1.094-7.13 2.181 0 0 4.372 4.008 5.88 5.295zm2.559 2.166c-.359.283-.801.439-1.258.444h-.044a2.071 2.071 0 0 1-1.257-.444C10.082 11.755 6.384 8.42 5 7.148v1.93c0 .215.081.496.222.629l.07.064c1.045.955 4.546 4.154 5.825 5.245.358.283.8.438 1.257.444h.044c.489-.015.962-.2 1.258-.444 1.309-1.11 4.948-4.444 5.887-5.31.148-.132.222-.413.222-.628v-1.93a455.127 455.127 0 0 1-6.11 5.494zm-1.258 4.984a2.071 2.071 0 0 0 1.258-.436c2.053-1.815 4.09-3.65 6.11-5.502v1.938c0 .207-.075.488-.223.621-.94.873-4.578 4.2-5.887 5.31-.296.25-.77.436-1.258.443h-.044a2.071 2.071 0 0 1-1.257-.436c-1.204-1.027-4.376-3.928-5.616-5.062l-.28-.255c-.14-.133-.221-.414-.221-.621v-1.938c1.383 1.265 5.081 4.607 6.117 5.495.358.282.8.438 1.257.443h.044zM40 5l-5.84 14.46h-2.43L25.89 5h2.16c.233 0 .423.057.57.17.146.113.256.26.33.44l3.41 8.82c.113.287.22.603.32.95.106.34.206.697.3 1.07.08-.373.166-.73.26-1.07a8.84 8.84 0 0 1 .31-.95l3.39-8.82a.959.959 0 0 1 .31-.42.906.906 0 0 1 .58-.19H40zm17.176 0v14.46h-2.37v-9.34c0-.373.02-.777.06-1.21l-4.37 8.21c-.206.393-.523.59-.95.59h-.38c-.426 0-.743-.197-.95-.59l-4.42-8.24c.02.22.037.437.05.65.014.213.02.41.02.59v9.34h-2.37V5h2.03c.12 0 .224.003.31.01a.778.778 0 0 1 .23.05c.074.027.137.07.19.13.06.06.117.14.17.24l4.33 8.03c.114.213.217.433.31.66.1.227.197.46.29.7.094-.247.19-.483.29-.71.1-.233.207-.457.32-.67l4.27-8.01c.054-.1.11-.18.17-.24a.57.57 0 0 1 .19-.13.903.903 0 0 1 .24-.05c.087-.007.19-.01.31-.01h2.03zm8.887 13.73c.68 0 1.286-.117 1.82-.35.54-.24.996-.57 1.37-.99a4.28 4.28 0 0 0 .85-1.48c.2-.573.3-1.19.3-1.85V5.31h1.02v8.75c0 .78-.124 1.51-.37 2.19a5.248 5.248 0 0 1-1.07 1.77c-.46.5-1.024.893-1.69 1.18-.66.287-1.404.43-2.23.43-.827 0-1.574-.143-2.24-.43a5.012 5.012 0 0 1-1.69-1.18 5.33 5.33 0 0 1-1.06-1.77 6.373 6.373 0 0 1-.37-2.19V5.31h1.03v8.74c0 .66.096 1.277.29 1.85.2.567.483 1.06.85 1.48.373.42.826.75 1.36.99.54.24 1.15.36 1.83.36zm10.38.73h-1.03V5.31h1.03v14.15zM4.242 35v-5.166l-.672-.078a.595.595 0 0 1-.21-.09.23.23 0 0 1-.078-.186v-.438h.96v-.588c0-.348.048-.656.144-.924.1-.272.24-.5.42-.684a1.79 1.79 0 0 1 .66-.426c.256-.096.544-.144.864-.144.272 0 .522.04.75.12l-.024.534c-.008.096-.062.148-.162.156a4.947 4.947 0 0 1-.39.012c-.184 0-.352.024-.504.072a.949.949 0 0 0-.384.234c-.108.108-.192.25-.252.426a2.184 2.184 0 0 0-.084.654v.558h1.752v.774H5.316V35H4.242zM10.416 28.826a3.1 3.1 0 0 1 1.2.222c.356.148.66.358.912.63s.444.602.576.99c.136.384.204.814.204 1.29 0 .48-.068.912-.204 1.296a2.735 2.735 0 0 1-.576.984 2.572 2.572 0 0 1-.912.63 3.175 3.175 0 0 1-1.2.216c-.448 0-.852-.072-1.212-.216a2.572 2.572 0 0 1-.912-.63 2.805 2.805 0 0 1-.582-.984 3.972 3.972 0 0 1-.198-1.296c0-.476.066-.906.198-1.29.136-.388.33-.718.582-.99.252-.272.556-.482.912-.63.36-.148.764-.222 1.212-.222zm0 5.424c.6 0 1.048-.2 1.344-.6.296-.404.444-.966.444-1.686 0-.724-.148-1.288-.444-1.692-.296-.404-.744-.606-1.344-.606-.304 0-.57.052-.798.156a1.507 1.507 0 0 0-.564.45c-.148.196-.26.438-.336.726a3.941 3.941 0 0 0-.108.966c0 .72.148 1.282.444 1.686.3.4.754.6 1.362.6zM15.677 30.14c.192-.416.428-.74.708-.972.28-.236.622-.354 1.026-.354.128 0 .25.014.366.042.12.028.226.072.318.132l-.078.798c-.024.1-.084.15-.18.15-.056 0-.138-.012-.246-.036a1.694 1.694 0 0 0-.366-.036c-.192 0-.364.028-.516.084-.148.056-.282.14-.402.252a1.782 1.782 0 0 0-.318.408c-.092.16-.176.344-.252.552V35h-1.074v-6.078h.612c.116 0 .196.022.24.066.044.044.074.12.09.228l.072.924zM26.761 28.922 24.283 35h-.96l-2.478-6.078h.87a.33.33 0 0 1 .33.222l1.542 3.912c.048.148.09.292.126.432.036.14.07.28.102.42.032-.14.066-.28.102-.42.036-.14.08-.284.132-.432l1.56-3.912a.33.33 0 0 1 .12-.156.311.311 0 0 1 .198-.066h.834zM27.74 35v-6.078h.643c.152 0 .246.074.282.222l.078.624c.224-.276.476-.502.756-.678.28-.176.604-.264.972-.264.408 0 .738.114.99.342.256.228.44.536.552.924.088-.22.2-.41.336-.57a1.987 1.987 0 0 1 1.014-.624c.196-.048.394-.072.594-.072.32 0 .604.052.852.156.252.1.464.248.636.444.176.196.31.438.402.726.092.284.138.61.138.978V35H34.91v-3.87c0-.476-.104-.836-.312-1.08-.208-.248-.508-.372-.9-.372-.176 0-.344.032-.504.096-.156.06-.294.15-.414.27-.12.12-.216.272-.288.456-.068.18-.102.39-.102.63V35h-1.074v-3.87c0-.488-.098-.852-.294-1.092-.196-.24-.482-.36-.858-.36-.264 0-.508.072-.732.216a2.38 2.38 0 0 0-.618.576V35H27.74zM40.746 32.372c-.428.02-.788.058-1.08.114-.292.052-.526.12-.702.204a.923.923 0 0 0-.378.294.639.639 0 0 0-.114.366c0 .26.076.446.228.558.156.112.358.168.606.168.304 0 .566-.054.786-.162.224-.112.442-.28.654-.504v-1.038zm-3.396-2.67c.708-.648 1.56-.972 2.556-.972.36 0 .682.06.966.18.284.116.524.28.72.492.196.208.344.458.444.75.104.292.156.612.156.96V35h-.672a.708.708 0 0 1-.324-.06c-.076-.044-.136-.13-.18-.258l-.132-.444c-.156.14-.308.264-.456.372a2.804 2.804 0 0 1-.462.264c-.16.072-.332.126-.516.162-.18.04-.38.06-.6.06-.26 0-.5-.034-.72-.102a1.618 1.618 0 0 1-.57-.318 1.414 1.414 0 0 1-.372-.522 1.852 1.852 0 0 1-.132-.726 1.419 1.419 0 0 1 .33-.906c.12-.14.274-.272.462-.396s.418-.232.69-.324c.276-.092.596-.166.96-.222.364-.06.78-.096 1.248-.108v-.36c0-.412-.088-.716-.264-.912-.176-.2-.43-.3-.762-.3-.24 0-.44.028-.6.084-.156.056-.294.12-.414.192l-.33.186a.631.631 0 0 1-.324.084.439.439 0 0 1-.264-.078.716.716 0 0 1-.174-.192l-.264-.474zM44.974 29.6c.124-.124.254-.238.39-.342a2.395 2.395 0 0 1 .936-.444c.176-.044.368-.066.576-.066.336 0 .634.058.894.174.26.112.476.272.648.48.176.204.308.45.396.738.092.284.138.598.138.942V35H47.47v-3.918c0-.376-.086-.666-.258-.87-.172-.208-.434-.312-.786-.312-.256 0-.496.058-.72.174a2.58 2.58 0 0 0-.636.474V35h-1.482v-6.156h.906c.192 0 .318.09.378.27l.102.486zM53.085 28.748c.456 0 .87.074 1.242.222a2.692 2.692 0 0 1 1.578 1.626c.144.392.216.83.216 1.314 0 .488-.072.928-.216 1.32-.144.392-.35.726-.618 1.002a2.653 2.653 0 0 1-.96.636 3.333 3.333 0 0 1-1.242.222c-.46 0-.878-.074-1.254-.222a2.712 2.712 0 0 1-.966-.636 2.922 2.922 0 0 1-.618-1.002 3.807 3.807 0 0 1-.216-1.32c0-.484.072-.922.216-1.314.148-.392.354-.724.618-.996.268-.272.59-.482.966-.63a3.397 3.397 0 0 1 1.254-.222zm0 5.202c.512 0 .89-.172 1.134-.516.248-.344.372-.848.372-1.512s-.124-1.17-.372-1.518c-.244-.348-.622-.522-1.134-.522-.52 0-.906.176-1.158.528-.248.348-.372.852-.372 1.512s.124 1.164.372 1.512c.252.344.638.516 1.158.516zM57.252 35v-6.156h.906c.192 0 .318.09.378.27l.096.456c.108-.12.22-.23.336-.33a2.017 2.017 0 0 1 1.32-.492c.388 0 .706.106.954.318.252.208.44.486.564.834a1.93 1.93 0 0 1 .834-.882c.172-.092.354-.16.546-.204.196-.044.392-.066.588-.066.34 0 .642.052.906.156.264.104.486.256.666.456.18.2.316.444.408.732.096.288.144.618.144.99V35h-1.482v-3.918c0-.392-.086-.686-.258-.882-.172-.2-.424-.3-.756-.3-.152 0-.294.026-.426.078a1.026 1.026 0 0 0-.342.228 1.019 1.019 0 0 0-.228.366 1.435 1.435 0 0 0-.084.51V35h-1.488v-3.918c0-.412-.084-.712-.252-.9-.164-.188-.406-.282-.726-.282-.216 0-.418.054-.606.162a1.979 1.979 0 0 0-.516.432V35h-1.482zM70.558 32.372c-.428.02-.788.058-1.08.114-.292.052-.526.12-.702.204a.923.923 0 0 0-.378.294.639.639 0 0 0-.114.366c0 .26.076.446.228.558.156.112.358.168.606.168.304 0 .566-.054.786-.162.224-.112.442-.28.654-.504v-1.038zm-3.396-2.67c.708-.648 1.56-.972 2.556-.972.36 0 .682.06.966.18.284.116.524.28.72.492.196.208.344.458.444.75.104.292.156.612.156.96V35h-.672a.708.708 0 0 1-.324-.06c-.076-.044-.136-.13-.18-.258l-.132-.444c-.156.14-.308.264-.456.372a2.804 2.804 0 0 1-.462.264c-.16.072-.332.126-.516.162-.18.04-.38.06-.6.06-.26 0-.5-.034-.72-.102a1.618 1.618 0 0 1-.57-.318 1.414 1.414 0 0 1-.372-.522 1.852 1.852 0 0 1-.132-.726 1.419 1.419 0 0 1 .33-.906c.12-.14.274-.272.462-.396s.418-.232.69-.324c.276-.092.596-.166.96-.222.364-.06.78-.096 1.248-.108v-.36c0-.412-.088-.716-.264-.912-.176-.2-.43-.3-.762-.3-.24 0-.44.028-.6.084-.156.056-.294.12-.414.192l-.33.186a.631.631 0 0 1-.324.084.439.439 0 0 1-.264-.078.716.716 0 0 1-.174-.192l-.264-.474zM74.9 26.084V35h-1.482v-8.916H74.9zM81.969 28.844l-3.354 7.848a.538.538 0 0 1-.174.234c-.068.056-.174.084-.318.084h-1.104l1.152-2.472-2.49-5.694h1.302c.116 0 .206.028.27.084.068.056.118.12.15.192l1.308 3.192c.044.108.08.216.108.324.032.108.062.218.09.33a32.3 32.3 0 0 1 .108-.33c.036-.112.076-.222.12-.33l1.236-3.186a.437.437 0 0 1 .408-.276h1.188z"})}),jo=()=>e("svg",{viewBox:"0 0 15 17",fill:"currentColor",children:e("path",{d:"M6.11767 7.47586C6.47736 7.75563 6.91931 7.90898 7.37503 7.91213H7.42681C7.90756 7.90474 8.38832 7.71987 8.67677 7.46846C10.1856 6.18921 14.5568 2.18138 14.5568 2.18138C15.7254 1.09438 12.4637 0.00739 7.42681 0H7.36764C2.3308 0.00739 -0.930935 1.09438 0.237669 2.18138C0.237669 2.18138 4.60884 6.18921 6.11767 7.47586ZM8.67677 9.64243C8.31803 9.92483 7.87599 10.0808 7.41941 10.0861H7.37503C6.91845 10.0808 6.47641 9.92483 6.11767 9.64243C5.0822 8.75513 1.38409 5.42018 0.000989555 4.14832V6.07829C0.000989555 6.29273 0.0823481 6.57372 0.222877 6.70682L0.293316 6.7712L0.293344 6.77122C1.33784 7.72579 4.83903 10.9255 6.11767 12.0161C6.47641 12.2985 6.91845 12.4545 7.37503 12.4597H7.41941C7.90756 12.4449 8.38092 12.2601 8.67677 12.0161C9.9859 10.9069 13.6249 7.57198 14.5642 6.70682C14.7121 6.57372 14.7861 6.29273 14.7861 6.07829V4.14832C12.7662 5.99804 10.7297 7.82949 8.67677 9.64243ZM7.41941 14.6263C7.87513 14.6232 8.31708 14.4698 8.67677 14.19C10.7298 12.3746 12.7663 10.5407 14.7861 8.68853V10.6259C14.7861 10.8329 14.7121 11.1139 14.5642 11.247C13.6249 12.1196 9.9859 15.4471 8.67677 16.5563C8.38092 16.8077 7.90756 16.9926 7.41941 17H7.37503C6.91931 16.9968 6.47736 16.8435 6.11767 16.5637C4.91427 15.5373 1.74219 12.6364 0.502294 11.5025C0.393358 11.4029 0.299337 11.3169 0.222877 11.247C0.0823481 11.1139 0.000989555 10.8329 0.000989555 10.6259V8.68853C1.38409 9.95303 5.0822 13.2953 6.11767 14.1827C6.47641 14.4651 6.91845 14.6211 7.37503 14.6263H7.41941Z"})}),ot=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"})}),He=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})}),at=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M12 5V2L8 6l4 4V7c3.31 0 6 2.69 6 6 0 2.97-2.17 5.43-5 5.91v2.02c3.95-.49 7-3.85 7-7.93 0-4.42-3.58-8-8-8zm-6 8c0-1.65.67-3.15 1.76-4.24L6.34 7.34C4.9 8.79 4 10.79 4 13c0 4.08 3.05 7.44 7 7.93v-2.02c-2.83-.48-5-2.94-5-5.91z"})}),st=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"})}),Un=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M11 7h2v2h-2zm0 4h2v6h-2zm1-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8"})}),ja=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"})}),Qa=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"})}),Qo=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"})}),qn=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M12 6v3l4-4-4-4v3c-4.42 0-8 3.58-8 8 0 1.57.46 3.03 1.24 4.26L6.7 14.8c-.45-.83-.7-1.79-.7-2.8 0-3.31 2.69-6 6-6zm6.76 1.74L17.3 9.2c.44.84.7 1.79.7 2.8 0 3.31-2.69 6-6 6v-3l-4 4 4 4v-3c4.42 0 8-3.58 8-8 0-1.57-.46-3.03-1.24-4.26z"})}),ve=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M7.41 8.59 12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"})}),Qe=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"m7 10 5 5 5-5z"})}),en=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:[e("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),e("path",{d:"M12.5 7H11v6l5.25 3.15.75-1.23-4.5-2.67z"})]}),Ln=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M20 3h-1V1h-2v2H7V1H5v2H4c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 18H4V8h16v13z"})}),Yo=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"m22 5.72-4.6-3.86-1.29 1.53 4.6 3.86L22 5.72zM7.88 3.39 6.6 1.86 2 5.71l1.29 1.53 4.59-3.85zM12.5 8H11v6l4.75 2.85.75-1.23-4-2.37V8zM12 4c-4.97 0-9 4.03-9 9s4.02 9 9 9c4.97 0 9-4.03 9-9s-4.03-9-9-9zm0 16c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"})}),Go=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M20 5H4c-1.1 0-1.99.9-1.99 2L2 17c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm-9 3h2v2h-2V8zm0 3h2v2h-2v-2zM8 8h2v2H8V8zm0 3h2v2H8v-2zm-1 2H5v-2h2v2zm0-3H5V8h2v2zm9 7H8v-2h8v2zm0-4h-2v-2h2v2zm0-3h-2V8h2v2zm3 3h-2v-2h2v2zm0-3h-2V8h2v2z"})}),dt=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M8 5v14l11-7z"})}),Bn=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"m10 16.5 6-4.5-6-4.5v9zM12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"})}),Ya=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"m3.5 18.49 6-6.01 4 4L22 6.92l-1.41-1.41-7.09 7.97-4-4L2 16.99z"})}),ln=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M10 10.02h5V21h-5zM17 21h3c1.1 0 2-.9 2-2v-9h-5v11zm3-18H5c-1.1 0-2 .9-2 2v3h19V5c0-1.1-.9-2-2-2zM3 19c0 1.1.9 2 2 2h3V10H3v9z"})}),Lt=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M9.4 16.6 4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0 4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z"})}),jn=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"})}),Ga=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"})}),Wo=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M19 13H5v-2h14v2z"})}),Qn=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M8.9999 14.7854L18.8928 4.8925C19.0803 4.70497 19.3347 4.59961 19.5999 4.59961C19.8651 4.59961 20.1195 4.70497 20.307 4.8925L21.707 6.2925C22.0975 6.68303 22.0975 7.31619 21.707 7.70672L9.70701 19.7067C9.31648 20.0972 8.68332 20.0972 8.2928 19.7067L2.6928 14.1067C2.50526 13.9192 2.3999 13.6648 2.3999 13.3996C2.3999 13.1344 2.50526 12.88 2.6928 12.6925L4.0928 11.2925C4.48332 10.902 5.11648 10.902 5.50701 11.2925L8.9999 14.7854Z"})}),Ht=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"})}),Wa=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7zM2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3 2 4.27zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2zm4.31-.78 3.15 3.15.02-.16c0-1.66-1.34-3-3-3l-.17.01z"})}),Ko=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M19 9l1.25-2.75L23 5l-2.75-1.25L19 1l-1.25 2.75L15 5l2.75 1.25L19 9zm-7.5.5L9 4 6.5 9.5 1 12l5.5 2.5L9 20l2.5-5.5L17 12l-5.5-2.5zM19 15l-1.25 2.75L15 19l2.75 1.25L19 23l1.25-2.75L23 19l-2.75-1.25L19 15z"})}),Xe=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"})}),Ka=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M20 9H4v2h16V9zM4 15h16v-2H4v2z"})}),Mn=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M23 8c0 1.1-.9 2-2 2-.18 0-.35-.02-.51-.07l-3.56 3.55c.05.16.07.34.07.52 0 1.1-.9 2-2 2s-2-.9-2-2c0-.18.02-.36.07-.52l-2.55-2.55c-.16.05-.34.07-.52.07s-.36-.02-.52-.07l-4.55 4.56c.05.16.07.33.07.51 0 1.1-.9 2-2 2s-2-.9-2-2 .9-2 2-2c.18 0 .35.02.51.07l4.56-4.55C8.02 9.36 8 9.18 8 9c0-1.1.9-2 2-2s2 .9 2 2c0 .18-.02.36-.07.52l2.55 2.55c.16-.05.34-.07.52-.07s.36.02.52.07l3.55-3.56C19.02 8.35 19 8.18 19 8c0-1.1.9-2 2-2s2 .9 2 2z"})}),it=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:[e("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M21 5C19.89 4.65 18.67 4.5 17.5 4.5C15.55 4.5 13.45 4.9 12 6C10.55 4.9 8.45 4.5 6.5 4.5C5.33 4.5 4.11 4.65 3 5C2.25 5.25 1.6 5.55 1 6V20.6C1 20.85 1.25 21.1 1.5 21.1C1.6 21.1 1.65 21.1 1.75 21.05C3.15 20.3 4.85 20 6.5 20C8.2 20 10.65 20.65 12 21.5C13.35 20.65 15.8 20 17.5 20C19.15 20 20.85 20.3 22.25 21.05C22.35 21.1 22.4 21.1 22.5 21.1C22.75 21.1 23 20.85 23 20.6V6C22.4 5.55 21.75 5.25 21 5ZM21 18.5C19.9 18.15 18.7 18 17.5 18C15.8 18 13.35 18.65 12 19.5C10.65 18.65 8.2 18 6.5 18C5.3 18 4.1 18.15 3 18.5V7C4.1 6.65 5.3 6.5 6.5 6.5C8.2 6.5 10.65 7.15 12 8C13.35 7.15 15.8 6.5 17.5 6.5C18.7 6.5 19.9 6.65 21 7V18.5Z"}),e("path",{d:"M17.5 10.5C18.38 10.5 19.23 10.59 20 10.76V9.24C19.21 9.09 18.36 9 17.5 9C15.8 9 14.26 9.29 13 9.83V11.49C14.13 10.85 15.7 10.5 17.5 10.5ZM13 12.49V14.15C14.13 13.51 15.7 13.16 17.5 13.16C18.38 13.16 19.23 13.25 20 13.42V11.9C19.21 11.75 18.36 11.66 17.5 11.66C15.8 11.66 14.26 11.96 13 12.49ZM17.5 14.33C15.8 14.33 14.26 14.62 13 15.16V16.82C14.13 16.18 15.7 15.83 17.5 15.83C18.38 15.83 19.23 15.92 20 16.09V14.57C19.21 14.41 18.36 14.33 17.5 14.33Z"}),e("path",{d:"M6.5 10.5C5.62 10.5 4.77 10.59 4 10.76V9.24C4.79 9.09 5.64 9 6.5 9C8.2 9 9.74 9.29 11 9.83V11.49C9.87 10.85 8.3 10.5 6.5 10.5ZM11 12.49V14.15C9.87 13.51 8.3 13.16 6.5 13.16C5.62 13.16 4.77 13.25 4 13.42V11.9C4.79 11.75 5.64 11.66 6.5 11.66C8.2 11.66 9.74 11.96 11 12.49ZM6.5 14.33C8.2 14.33 9.74 14.62 11 15.16V16.82C9.87 16.18 8.3 15.83 6.5 15.83C5.62 15.83 4.77 15.92 4 16.09V14.57C4.79 14.41 5.64 14.33 6.5 14.33Z"})]}),Jo=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M12 2C6.49 2 2 6.49 2 12s4.49 10 10 10 10-4.49 10-10S17.51 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm3-8c0 1.66-1.34 3-3 3s-3-1.34-3-3 1.34-3 3-3 3 1.34 3 3z"})}),Ja=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2ZM12 6C9.79 6 8 7.79 8 10H10C10 8.9 10.9 8 12 8C13.1 8 14 8.9 14 10C14 10.8792 13.4202 11.3236 12.7704 11.8217C11.9421 12.4566 11 13.1787 11 15H13C13 13.9046 13.711 13.2833 14.4408 12.6455C15.21 11.9733 16 11.2829 16 10C16 7.79 14.21 6 12 6ZM13 16V18H11V16H13Z"})}),Tt=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M4 20h16c1.1 0 2-.9 2-2s-.9-2-2-2H4c-1.1 0-2 .9-2 2s.9 2 2 2zm0-3h2v2H4v-2zM2 6c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2s-.9-2-2-2H4c-1.1 0-2 .9-2 2zm4 1H4V5h2v2zm-2 7h16c1.1 0 2-.9 2-2s-.9-2-2-2H4c-1.1 0-2 .9-2 2s.9 2 2 2zm0-3h2v2H4v-2z"})}),Za=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"})}),Zo=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M3 17v2h6v-2H3zM3 5v2h10V5H3zm10 16v-2h8v-2h-8v-2h-2v6h2zM7 9v2H3v2h4v2h2V9H7zm14 4v-2H11v2h10zm-6-4h2V7h4V5h-4V3h-2v6z"})}),cn=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M7 20h4c0 1.1-.9 2-2 2s-2-.9-2-2zm-2-1h8v-2H5v2zm11.5-9.5c0 3.82-2.66 5.86-3.77 6.5H5.27c-1.11-.64-3.77-2.68-3.77-6.5C1.5 5.36 4.86 2 9 2s7.5 3.36 7.5 7.5zm4.87-2.13L20 8l1.37.63L22 10l.63-1.37L24 8l-1.37-.63L22 6l-.63 1.37zM19 6l.94-2.06L22 3l-2.06-.94L19 0l-.94 2.06L16 3l2.06.94L19 6z"})}),Xo=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M3 14h4v-4H3v4zm0 5h4v-4H3v4zM3 9h4V5H3v4zm5 5h13v-4H8v4zm0 5h13v-4H8v4zM8 5v4h13V5H8z"})}),es=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"m22 9.24-7.19-.62L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21 12 17.27 18.18 21l-1.63-7.03L22 9.24zM12 15.4l-3.76 2.27 1-4.28-3.32-2.88 4.38-.38L12 6.1l1.71 4.04 4.38.38-3.32 2.88 1 4.28L12 15.4z"})}),ts=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M12 17.27 18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"})}),Dn=()=>e("svg",{viewBox:"0 0 16 16",fill:Ze("color-error"),children:e("path",{d:"M13.5095 4L8.50952 1H7.50952L2.50952 4L2.01953 4.85999V10.86L2.50952 11.71L7.50952 14.71H8.50952L13.5095 11.71L13.9995 10.86V4.85999L13.5095 4ZM7.50952 13.5601L3.00952 10.86V5.69995L7.50952 8.15002V13.5601ZM3.26953 4.69995L8.00952 1.85999L12.7495 4.69995L8.00952 7.29004L3.26953 4.69995ZM13.0095 10.86L8.50952 13.5601V8.15002L13.0095 5.69995V10.86Z"})}),Yn=()=>e("svg",{viewBox:"0 0 16 16",fill:Ze("color-primary"),children:e("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2 5H4V4H1.5L1 4.5V12.5L1.5 13H4V12H2V5ZM14.5 4H12V5H14V12H12V13H14.5L15 12.5V4.5L14.5 4ZM11.76 6.56995L12 7V9.51001L11.7 9.95996L7.19995 11.96H6.73999L4.23999 10.46L4 10.03V7.53003L4.30005 7.06995L8.80005 5.06995H9.26001L11.76 6.56995ZM5 9.70996L6.5 10.61V9.28003L5 8.38V9.70996ZM5.57996 7.56006L7.03003 8.43005L10.42 6.93005L8.96997 6.06006L5.57996 7.56006ZM7.53003 10.73L11.03 9.17004V7.77002L7.53003 9.31995V10.73Z"})}),Xa=()=>e("svg",{viewBox:"0 0 16 16",fill:Ze("color-warning"),children:e("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14 2H8L7 3V6H8V3H14V8H10V9H14L15 8V3L14 2ZM9 6H13V7H9.41L9 6.59V6ZM7 7H2L1 8V13L2 14H8L9 13V8L8 7H7ZM8 13H2V8H8V9V13ZM3 9H7V10H3V9ZM3 11H7V12H3V11ZM9 4H13V5H9V4Z"})}),In=()=>e("svg",{viewBox:"0 0 16 16",fill:Ze("color-primary"),children:e("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7 3L8 2H14L15 3V8L14 9H10V8H14V3H8V6H7V3ZM9 9V8L8 7H7H2L1 8V13L2 14H8L9 13V9ZM8 8V9V13H2V8H7H8ZM9.41421 7L9 6.58579V6H13V7H9.41421ZM9 4H13V5H9V4ZM7 10H3V11H7V10Z"})}),Gn=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"})}),er=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M12 5.83 15.17 9l1.41-1.41L12 3 7.41 7.59 8.83 9zm0 12.34L8.83 15l-1.41 1.41L12 21l4.59-4.59L15.17 15z"})}),tr=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M7.41 18.59 8.83 20 12 16.83 15.17 20l1.41-1.41L12 14zm9.18-13.18L15.17 4 12 7.17 8.83 4 7.41 5.41 12 10z"})}),ns=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"})}),nr=()=>e("svg",{viewBox:"0 0 24 24",children:e("path",{fill:"currentColor",d:"M12,4a8,8,0,0,1,7.89,6.7A1.53,1.53,0,0,0,21.38,12h0a1.5,1.5,0,0,0,1.48-1.75,11,11,0,0,0-21.72,0A1.5,1.5,0,0,0,2.62,12h0a1.53,1.53,0,0,0,1.49-1.3A8,8,0,0,1,12,4Z",children:e("animateTransform",{attributeName:"transform",dur:"0.75s",repeatCount:"indefinite",type:"rotate",values:"0 12 12;360 12 12"})})}),as=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M21.99 4c0-1.1-.89-2-1.99-2H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h14l4 4zM18 14H6v-2h12zm0-3H6V9h12zm0-3H6V6h12z"})}),ar=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M4.25 5.61C6.27 8.2 10 13 10 13v6c0 .55.45 1 1 1h2c.55 0 1-.45 1-1v-6s3.72-4.8 5.74-7.39c.51-.66.04-1.61-.79-1.61H5.04c-.83 0-1.3.95-.79 1.61"})}),rr=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M19.79 5.61C20.3 4.95 19.83 4 19 4H6.83l7.97 7.97zM2.81 2.81 1.39 4.22 10 13v6c0 .55.45 1 1 1h2c.55 0 1-.45 1-1v-2.17l5.78 5.78 1.41-1.41z"})}),Wi=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M19 19H5V5h7V3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2v-7h-2zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3z"})}),Ki=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M19 4H5c-1.11 0-2 .9-2 2v12c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.89-2-2-2m0 14H5V8h14z"})}),Ji=Object.freeze(Object.defineProperty({__proto__:null,AlarmIcon:Yo,ArrowDownIcon:ve,ArrowDropDownIcon:Qe,CalendarIcon:Ln,ChartIcon:Ya,ClockIcon:en,CloseIcon:He,CodeIcon:Lt,CollapseIcon:tr,CommentIcon:as,CopyIcon:Xe,DeleteIcon:jn,DoneIcon:Qn,DownloadIcon:Gn,DragIcon:Ka,ErrorIcon:Qa,ExpandIcon:er,FilterIcon:ar,FilterOffIcon:rr,FunctionIcon:Yn,InfoIcon:st,InfoOutlinedIcon:Un,IssueIcon:Jo,KeyboardIcon:Go,LabelIcon:Xa,ListIcon:Xo,LogoAnomalyIcon:Bo,LogoIcon:Uo,LogoLogsIcon:qo,LogoShortIcon:jo,MetricIcon:Dn,MinusIcon:Wo,ModalIcon:Ki,MoreIcon:Za,OpenNewIcon:Wi,PlayCircleOutlineIcon:Bn,PlayIcon:dt,PlusIcon:Ga,Prettify:Ko,QuestionIcon:Ja,RefreshIcon:qn,RestartIcon:at,SearchIcon:ns,SettingsIcon:ot,SpinnerIcon:nr,StarBorderIcon:es,StarIcon:ts,StorageIcon:Tt,SuccessIcon:Qo,TableIcon:ln,TimelineIcon:Mn,TipIcon:cn,TuneIcon:Zo,ValueIcon:In,VisibilityIcon:Ht,VisibilityOffIcon:Wa,WarningIcon:ja,WikiIcon:it},Symbol.toStringTag,{value:"Module"})),Zi=({to:t,isNavLink:n,children:a,...r})=>n?e(To,{to:t,...r,children:a}):e("div",{...r,children:a}),Xi=({activeItem:t,item:n,color:a=Ze("color-primary"),activeNavRef:r,onChange:o,isNavLink:s})=>{const i=c=>()=>{o&&o(c)};return e(Zi,{className:D({"vm-tabs-item":!0,"vm-tabs-item_active":t===n.value,[n.className||""]:n.className}),isNavLink:s,to:n.value,style:{color:a},onClick:i(n.value),ref:t===n.value?r:void 0,children:[n.icon&&e("div",{className:D({"vm-tabs-item__icon":!0,"vm-tabs-item__icon_single":!n.label}),children:n.icon}),n.label]})};function ce(t,n,a,r){const o=Q(n);A(()=>{o.current=n},[n]),A(()=>{const s=(a==null?void 0:a.current)??window;if(!(s&&s.addEventListener))return;const i=c=>o.current(c);return s.addEventListener(t,i,r),()=>{s.removeEventListener(t,i,r)}},[t,a,r])}const Mt=()=>{const[t,n]=C({width:0,height:0}),a=()=>{n({width:window.innerWidth,height:window.innerHeight})};return ce("resize",a),A(a,[]),t},Yt=({activeItem:t,items:n,color:a=Ze("color-primary"),onChange:r,indicatorPlacement:o="bottom",isNavLink:s})=>{const i=Mt(),c=Q(null),[l,m]=C({left:0,width:0,bottom:0});return A(()=>{var d;if(((d=c.current)==null?void 0:d.base)instanceof HTMLElement){const{offsetLeft:u,offsetWidth:h,offsetHeight:p}=c.current.base;m({left:u,width:h,bottom:o==="top"?p-2:0})}},[i,t,c,n]),e("div",{className:"vm-tabs",children:[n.map(d=>e(Xi,{activeItem:t,item:d,onChange:r,color:a,activeNavRef:c,isNavLink:s},d.value)),e("div",{className:"vm-tabs__indicator",style:{...l,borderColor:a}})]})},Ft=[{value:we.chart,icon:e(Ya,{}),label:"Graph",prometheusCode:0},{value:we.code,icon:e(Lt,{}),label:"JSON",prometheusCode:3},{value:we.table,icon:e(ln,{}),label:"Table",prometheusCode:1}],rs=({tabFilter:t})=>{const{displayType:n}=Ue(),a=Gt(),r=s=>{a({type:"SET_DISPLAY_TYPE",payload:s??n})},o=Ft.filter(t??(()=>!0));return e(Yt,{activeItem:n,items:o,onChange:r})},os=()=>{const t=Oe("g0.tab",0),n=Ft.find(a=>a.prometheusCode===+t||a.value===t);return(n==null?void 0:n.value)||we.chart},Gr=xe("SERIES_LIMITS"),el={displayType:os(),nocache:!1,isTracingEnabled:!1,seriesLimits:Gr?JSON.parse(Gr):Do,tableCompact:xe("TABLE_COMPACT")||!1,reduceMemUsage:!1};function tl(t,n){switch(n.type){case"SET_DISPLAY_TYPE":return{...t,displayType:n.payload};case"SET_SERIES_LIMITS":return Te("SERIES_LIMITS",JSON.stringify(n.payload)),{...t,seriesLimits:n.payload};case"TOGGLE_QUERY_TRACING":return{...t,isTracingEnabled:!t.isTracingEnabled};case"TOGGLE_NO_CACHE":return{...t,nocache:!t.nocache};case"TOGGLE_TABLE_COMPACT":return Te("TABLE_COMPACT",!t.tableCompact),{...t,tableCompact:!t.tableCompact};case"TOGGLE_REDUCE_MEM_USAGE":return Te("TABLE_COMPACT",!t.reduceMemUsage),{...t,reduceMemUsage:!t.reduceMemUsage};default:throw new Error}}const or=vt({}),Ue=()=>De(or).state,Gt=()=>De(or).dispatch,nl=({children:t})=>{const[n,a]=xt(tl,el),r=L(()=>({state:n,dispatch:a}),[n,a]);return e(or.Provider,{value:r,children:t})},al={customStep:Oe("g0.step_input",""),yaxis:{limits:{enable:!1,range:{1:[0,0]}}},isHistogram:!1,isEmptyHistogram:!1,spanGaps:!1,openSettings:!1};function rl(t,n){switch(n.type){case"TOGGLE_ENABLE_YAXIS_LIMITS":return{...t,yaxis:{...t.yaxis,limits:{...t.yaxis.limits,enable:!t.yaxis.limits.enable}}};case"SET_CUSTOM_STEP":return{...t,customStep:n.payload};case"SET_YAXIS_LIMITS":return{...t,yaxis:{...t.yaxis,limits:{...t.yaxis.limits,range:n.payload}}};case"SET_IS_HISTOGRAM":return{...t,isHistogram:n.payload};case"SET_IS_EMPTY_HISTOGRAM":return{...t,isEmptyHistogram:n.payload};case"SET_SPAN_GAPS":return{...t,spanGaps:n.payload};case"SET_OPEN_SETTINGS":return{...t,openSettings:n.payload};default:throw new Error}}const sr=vt({}),Re=()=>De(sr).state,mt=()=>De(sr).dispatch,ol=({children:t})=>{const[n,a]=xt(rl,al),r=L(()=>({state:n,dispatch:a}),[n,a]);return e(sr.Provider,{value:r,children:t})},sl={dashboardsSettings:[],dashboardsLoading:!1,dashboardsError:""};function il(t,n){switch(n.type){case"SET_DASHBOARDS_SETTINGS":return{...t,dashboardsSettings:n.payload};case"SET_DASHBOARDS_LOADING":return{...t,dashboardsLoading:n.payload};case"SET_DASHBOARDS_ERROR":return{...t,dashboardsError:n.payload};default:throw new Error}}const ir=vt({}),ss=()=>De(ir).state,ll=()=>De(ir).dispatch,cl=({children:t})=>{const[n,a]=xt(il,sl),r=L(()=>({state:n,dispatch:a}),[n,a]);return e(ir.Provider,{value:r,children:t})},dl={markdownParsing:xe("LOGS_MARKDOWN")==="true",autocompleteCache:new Map};function ml(t,n){switch(n.type){case"SET_MARKDOWN_PARSING":return Te("LOGS_MARKDOWN",`${n.payload}`),{...t,markdownParsing:n.payload};case"SET_AUTOCOMPLETE_CACHE":{if(t.autocompleteCache.size>=St.cacheLimit){const a=t.autocompleteCache.keys().next().value;a&&t.autocompleteCache.delete(a)}return t.autocompleteCache.set(n.payload.key,n.payload.value),{...t,autocompleteCache:t.autocompleteCache}}default:throw new Error}}const lr=vt({}),cr=()=>De(lr).state,is=()=>De(lr).dispatch,ul=({children:t})=>{const[n,a]=xt(ml,dl),r=L(()=>({state:n,dispatch:a}),[n,a]);return e(lr.Provider,{value:r,children:t})},ls={windows:"Windows",mac:"Mac OS",linux:"Linux"},hl=()=>Object.values(ls).find(t=>navigator.userAgent.indexOf(t)>=0)||"unknown",Wn=()=>hl()===ls.mac,pl=()=>["Android","webOS","iPhone","iPad","iPod","BlackBerry","Windows Phone"].map(a=>navigator.userAgent.match(new RegExp(a,"i"))).some(a=>a);function W(){const t=Mt(),n=()=>{const o=pl(),s=window.innerWidth<500;return o||s},[a,r]=C(n());return A(()=>{r(n())},[t]),{isMobile:a}}const gl={success:e(Qo,{}),error:e(Qa,{}),warning:e(ja,{}),info:e(st,{})},ie=({variant:t,children:n})=>{const{isDarkTheme:a}=re(),{isMobile:r}=W();return e("div",{className:D({"vm-alert":!0,[`vm-alert_${t}`]:t,"vm-alert_dark":a,"vm-alert_mobile":r}),children:[e("div",{className:"vm-alert__icon",children:gl[t||"info"]}),e("div",{className:"vm-alert__content",children:n})]})},cs=vt({showInfoMessage:()=>{}}),vl=()=>De(cs),fl=({children:t})=>{const{isMobile:n}=W(),[a,r]=C({text:"",type:"info"}),[o,s]=C(!1),[i,c]=C(null);A(()=>{if(!i)return;r({...i,key:Date.now()}),s(!0);const m=setTimeout(l,i.timeout||4e3);return()=>clearTimeout(m)},[i]);const l=()=>{c(null),s(!1)};return e(cs.Provider,{value:{showInfoMessage:c},children:[o&&e("div",{className:D({"vm-snackbar":!0,"vm-snackbar_mobile":n}),children:e(ie,{variant:a.type,children:e("div",{className:"vm-snackbar-content",children:[e("span",{children:a.text}),e("div",{className:"vm-snackbar-content__close",onClick:l,children:e(He,{})})]})})}),t]})},_l=(...t)=>t.reduce((n,a)=>({children:r})=>e(n,{children:e(a,{children:r})}),({children:n})=>e(U,{children:n})),bl=[xi,qi,Gi,nl,ol,fl,cl,ul],dr=_l(...bl);var tn=(t=>(t[t.internalLink=0]="internalLink",t[t.externalLink=1]="externalLink",t))(tn||{});const yl=(t,n)=>({label:"Alerts",value:!!on(t)?`${t}/vmalert`:t.replace(/\/prometheus$/,"/vmalert"),type:1,hide:!n}),wl=t=>[{value:J.trace},{value:J.queryAnalyzer},{value:J.withTemplate},{value:J.relabel},{value:J.downsamplingDebug,hide:!t},{value:J.retentionDebug,hide:!t}],Cl=()=>[{value:J.metrics},{value:J.cardinality},{value:J.topQueries},{value:J.activeQueries}],Nl=({serverUrl:t,isEnterpriseLicense:n,showPredefinedDashboards:a,showAlertLink:r})=>[{value:J.home},{value:J.rawQuery},{label:"Explore",submenu:Cl()},{label:"Tools",submenu:wl(n)},{value:J.dashboards,hide:!a},yl(t,r)],kl=()=>[{label:ct[J.logs].title,value:J.home}],Sl=()=>[{label:ct[J.anomaly].title,value:J.home}],Ca=({activeMenu:t,label:n,value:a,type:r,color:o})=>r===tn.externalLink?e("a",{className:D({"vm-header-nav-item":!0,"vm-header-nav-item_active":t===a}),style:{color:o},href:a,target:"_blank",rel:"noreferrer",children:n}):e(To,{className:D({"vm-header-nav-item":!0,"vm-header-nav-item_active":t===a}),style:{color:o},to:a,children:n}),dn=(t,n,a)=>{const r=X(o=>{const s=t==null?void 0:t.current,i=o.target,c=(a==null?void 0:a.current)&&a.current.contains(i);!s||s.contains((o==null?void 0:o.target)||null)||c||n(o)},[t,n]);ce("mouseup",r),ce("touchstart",r)},P=({variant:t="contained",color:n="primary",size:a="medium",ariaLabel:r,children:o,endIcon:s,startIcon:i,fullWidth:c=!1,className:l,disabled:m,onClick:d,onMouseDown:u})=>{const h=D({"vm-button":!0,[`vm-button_${t}_${n}`]:!0,[`vm-button_${a}`]:a,"vm-button_icon":(i||s)&&!o,"vm-button_full-width":c,"vm-button_with-icon":i||s,"vm-button_disabled":m,[l||""]:l});return e("button",{className:h,disabled:m,"aria-label":r,onClick:d,onMouseDown:u,children:e(U,{children:[i&&e("span",{className:"vm-button__start-icon",children:i}),o&&e("span",{children:o}),s&&e("span",{className:"vm-button__end-icon",children:s})]})})},Ie=({children:t,buttonRef:n,placement:a="bottom-left",placementPosition:r,open:o=!1,onClose:s,offset:i={top:6,left:0},clickOutside:c=!0,fullWidth:l,title:m,disabledFullScreen:d,variant:u})=>{const{isMobile:h}=W(),p=On(),v=lt(),[b,f]=C({width:0,height:0}),[g,_]=C(!1),y=Q(null);A(()=>(_(o),!o&&s&&s(),o&&h&&!d&&(document.body.style.overflow="hidden"),()=>{document.body.style.overflow="auto"}),[o]),A(()=>{var x,M;f({width:((x=y==null?void 0:y.current)==null?void 0:x.clientWidth)||0,height:((M=y==null?void 0:y.current)==null?void 0:M.clientHeight)||0}),_(!1)},[y]);const w=L(()=>{const x=n.current;if(!x||!g)return{};const M=x.getBoundingClientRect(),E={top:0,left:0,width:"auto"},I=a==="bottom-right"||a==="top-right",$=a==null?void 0:a.includes("top"),O=(i==null?void 0:i.top)||0,V=(i==null?void 0:i.left)||0;if(E.left=E.left=M.left+V,E.top=M.height+M.top+O,I&&(E.left=M.right-b.width),$&&(E.top=M.top-b.height-O),a==="fixed"&&r)return E.top=Math.max(r.top+i.top,0),E.left=Math.max(r.left+i.left,0),E;const{innerWidth:z,innerHeight:j}=window,H=E.top+b.height>j,te=E.top<0,de=E.left+b.width>z,G=E.left<0;return H&&(E.top=M.top-b.height-O),te&&(E.top=M.height+M.top+O),de&&(E.left=M.right-b.width-V),G&&(E.left=M.left+V),l&&(E.width=`${M.width}px`),E.top<0&&(E.top=0),E.left<0&&(E.left=0),E},[n,a,g,t,l]),S=x=>{x.stopPropagation(),s()},N=()=>{_(!1),s()},k=()=>{c&&N()};A(()=>{if(!y.current||!g||h&&!d)return;const{right:x,width:M}=y.current.getBoundingClientRect();if(x>window.innerWidth){const E=window.innerWidth-M;y.current.style.left=`${E}px`}},[g,y,r]);const T=X(()=>{g&&h&&!d&&(p(v,{replace:!0}),s())},[g,h,d,v,s]);return ce("scroll",N),ce("popstate",T),dn(y,k,n),e(U,{children:(g||!b.width)&&Ut(e("div",{className:D({"vm-popper":!0,[`vm-popper_${u}`]:u,"vm-popper_mobile":h&&!d,"vm-popper_open":(h||Object.keys(w).length)&&g}),ref:y,style:h&&!d?{}:w,children:[(m||h&&!d)&&e("div",{className:"vm-popper-header",children:[e("p",{className:"vm-popper-header__title",children:m}),e(P,{variant:"text",color:u==="dark"?"white":"primary",size:"small",onClick:S,ariaLabel:"close",children:e(He,{})})]}),t]}),document.body)})},se=t=>{const[n,a]=C(!!t),r=X(()=>a(!0),[]),o=X(()=>a(!1),[]),s=X(()=>a(i=>!i),[]);return{value:n,setValue:a,setTrue:r,setFalse:o,toggle:s}},Tl=({activeMenu:t,label:n,color:a,background:r,submenu:o,direction:s})=>{const{pathname:i}=lt(),[c,l]=C(null),m=Q(null),{value:d,setFalse:u,setTrue:h}=se(!1),p=()=>{h(),c&&clearTimeout(c)},v=()=>{c&&clearTimeout(c);const f=setTimeout(u,300);l(f)},b=()=>{c&&clearTimeout(c)};return A(()=>{u()},[i]),s==="column"?e(U,{children:o.map(f=>e(Ca,{activeMenu:t,value:f.value||"",label:f.label||"",type:f.type||tn.internalLink},f.value))}):e("div",{className:D({"vm-header-nav-item":!0,"vm-header-nav-item_sub":!0,"vm-header-nav-item_open":d,"vm-header-nav-item_active":o.find(f=>f.value===t)}),style:{color:a},onMouseEnter:p,onMouseLeave:v,ref:m,children:[n,e(Qe,{}),e(Ie,{open:d,placement:"bottom-left",offset:{top:12,left:0},onClose:u,buttonRef:m,children:e("div",{className:"vm-header-nav-item-submenu",style:{background:r},onMouseLeave:v,onMouseEnter:b,children:o.map(f=>e(Ca,{activeMenu:t,value:f.value||"",label:f.label||"",color:a,type:f.type||tn.internalLink},f.value))})})]})},Al=t=>{try{return t.replace(/^\/+/,"").replace(/-/g," ").trim().replace(/^\w/,n=>n.toUpperCase())}catch{return t}},ds=t=>t.filter(n=>!n.hide).map(n=>{var r;const a={...n};return a.value&&!a.label&&(a.label=((r=ct[a.value])==null?void 0:r.title)||Al(a.value)),a.submenu&&a.submenu.length>0&&(a.submenu=ds(a.submenu)),a}),xl=()=>{var d;const t=Ce(),{dashboardsSettings:n}=ss(),{serverUrl:a,flags:r,appConfig:o}=re(),s=((d=o.license)==null?void 0:d.type)==="enterprise",i=!!r["vmalert.proxyURL"],c=!!(!t&&n.length),l=L(()=>({serverUrl:a,isEnterpriseLicense:s,showAlertLink:i,showPredefinedDashboards:c}),[a,s,i,c]),m=L(()=>{switch(jt){case rt.victorialogs:return kl();case rt.vmanomaly:return Sl();default:return Nl(l)}},[l]);return ds(m)},ms=({color:t,background:n,direction:a})=>{const{pathname:r}=lt(),[o,s]=C(r),i=xl();return A(()=>{s(r)},[r]),e("nav",{className:D({"vm-header-nav":!0,[`vm-header-nav_${a}`]:a}),children:i.map(c=>c.submenu?e(Tl,{activeMenu:o,label:c.label||"",submenu:c.submenu,color:t,background:n,direction:a},c.label):e(Ca,{activeMenu:o,value:c.value||"",label:c.label||"",color:t,type:c.type||tn.internalLink},c.value))})},Pe=({title:t,children:n,onClose:a,className:r,isOpen:o=!0})=>{const{isMobile:s}=W(),i=On(),c=lt(),l=X(h=>{o&&h.key==="Escape"&&a()},[o]),m=h=>{h.stopPropagation()},d=X(()=>{o&&(i(c,{replace:!0}),a())},[o,c,a]);return A(()=>{if(o)return document.body.style.overflow="hidden",()=>{document.body.style.overflow="auto"}},[o]),ce("popstate",d),ce("keyup",l),Ut(e("div",{className:D({"vm-modal":!0,"vm-modal_mobile":s,[`${r}`]:r}),onMouseDown:a,children:e("div",{className:"vm-modal-content",onMouseDown:m,children:[e("div",{className:"vm-modal-content-header",children:[t&&e("div",{className:"vm-modal-content-header__title",children:t}),e("div",{className:"vm-modal-header__close",children:e(P,{variant:"text",size:"small",onClick:a,ariaLabel:"close",children:e(He,{})})})]}),e("div",{className:"vm-modal-content-body",tabIndex:0,children:n})]})}),document.body)},Y=({children:t,title:n,open:a,placement:r="bottom-center",offset:o={top:6,left:0}})=>{const{isMobile:s}=W(),[i,c]=C(!1),[l,m]=C({width:0,height:0}),d=Q(null),u=Q(null),h=()=>c(!1);A(()=>{if(!(!u.current||!i))return m({width:u.current.clientWidth,height:u.current.clientHeight}),window.addEventListener("scroll",h),()=>{window.removeEventListener("scroll",h)}},[i,n]);const p=L(()=>{var V;const f=(V=d==null?void 0:d.current)==null?void 0:V.base;if(!f||!i)return{};const g=f.getBoundingClientRect(),_={top:0,left:0},y=r==="bottom-right"||r==="top-right",w=r==="bottom-left"||r==="top-left",S=r==null?void 0:r.includes("top"),N=(o==null?void 0:o.top)||0,k=(o==null?void 0:o.left)||0;_.left=g.left-(l.width-g.width)/2+k,_.top=g.height+g.top+N,y&&(_.left=g.right-l.width),w&&(_.left=g.left+k),S&&(_.top=g.top-l.height-N);const{innerWidth:T,innerHeight:x}=window,M=20,E=_.top+l.height+M>x,I=_.top-M<0,$=_.left+l.width+M>T,O=_.left-M<0;return E&&(_.top=g.top-l.height-N),I&&(_.top=g.height+g.top+N),$&&(_.left=g.right-l.width-k),O&&(_.left=g.left+k),_.top<0&&(_.top=20),_.left<0&&(_.left=20),_},[d,r,i,l]),v=()=>{typeof a!="boolean"&&c(!0)},b=()=>{c(!1)};return A(()=>{typeof a=="boolean"&&c(a)},[a]),A(()=>{var g;const f=(g=d==null?void 0:d.current)==null?void 0:g.base;if(f)return f.addEventListener("mouseenter",v),f.addEventListener("mouseleave",b),()=>{f.removeEventListener("mouseenter",v),f.removeEventListener("mouseleave",b)}},[d]),e(U,{children:[e(U,{ref:d,children:t}),!s&&i&&Ut(e("div",{className:"vm-tooltip",ref:u,style:p,children:n}),document.body)]})},Nn=e("code",{children:Wn()?"Cmd":"Ctrl"}),El=[{title:"Zoom in",description:e(U,{children:["To zoom in, hold down the ",Nn," + ",e("code",{children:"scroll up"}),", or press the ",e("code",{children:"+"}),". Also, you can zoom in on a range on the graph by holding down your mouse button and selecting the range."]})},{title:"Zoom out",description:e(U,{children:["To zoom out, hold down the ",Nn," + ",e("code",{children:"scroll down"}),", or press the ",e("code",{children:"-"}),"."]})},{title:"Move horizontal axis",description:e(U,{children:["To move the graph, hold down the ",Nn," + ",e("code",{children:"drag"})," the graph to the right or left."]})},{title:"Fixing a tooltip",description:e(U,{children:["To fix the tooltip, ",e("code",{children:"click"})," mouse when it's open. Then, you can drag the fixed tooltip by ",e("code",{children:"clicking"})," and ",e("code",{children:"dragging"})," on the ",e(Ka,{})," icon."]})},{title:"Set a custom range for the vertical axis",description:e(U,{children:["To set a custom range for the vertical axis, click on the ",e(ot,{})," icon located in the upper right corner of the graph, activate the toggle, and set the values."]})}],Ll=[{title:"Show/hide a legend item",description:e(U,{children:[e("code",{children:"click"})," on a legend item to isolate it on the graph.",Nn," + ",e("code",{children:"click"})," on a legend item to remove it from the graph. To revert to the previous state, click again."]})},{title:"Copy label key-value pairs",description:e(U,{children:[e("code",{children:"click"})," on a label key-value pair to save it to the clipboard."]})},{title:"Collapse/Expand the legend group",description:e(U,{children:[e("code",{children:"click"})," on the group name (e.g. ",e("b",{children:'Query 1: {__name__!=""}'}),") to collapse or expand the legend."]})}],Ml=El.concat(Ll),mr=()=>{const{value:t,setFalse:n,setTrue:a}=se(!1);return e(U,{children:[e(Y,{title:"Show tips on working with the graph",children:e(P,{variant:"text",color:"gray",startIcon:e(cn,{}),onClick:a,ariaLabel:"open the tips"})}),t&&e(Pe,{title:"Tips on working with the graph and the legend",onClose:n,children:e("div",{className:"fc-graph-tips",children:Ml.map(({title:r,description:o})=>e("div",{className:"fc-graph-tips-item",children:[e("h4",{className:"fc-graph-tips-item__action",children:r}),e("p",{className:"fc-graph-tips-item__description",children:o})]},r))})})]})},bt=e("code",{children:Wn()?"Cmd":"Ctrl"}),us=e(U,{children:[e("code",{children:Wn()?"Option":"Ctrl"})," + ",e("code",{children:"Space"})]}),Dl=[{title:"Query",list:[{keys:e("code",{children:"Enter"}),description:"Run"},{keys:e(U,{children:[e("code",{children:"Shift"})," + ",e("code",{children:"Enter"})]}),description:"Multi-line queries"},{keys:e(U,{children:[bt," + ",e("code",{children:"Arrow Up"})]}),description:"Previous command from the Query history"},{keys:e(U,{children:[bt," + ",e("code",{children:"Arrow Down"})]}),description:"Next command from the Query history"},{keys:e(U,{children:[bt," + ",e("code",{children:"click"})," by ",e(Ht,{})]}),description:"Toggle multiple queries"},{keys:us,description:"Show quick autocomplete tips"}]},{title:"Graph",readMore:e(mr,{}),list:[{keys:e(U,{children:[bt," + ",e("code",{children:"scroll Up"})," or ",e("code",{children:"+"})]}),description:"Zoom in"},{keys:e(U,{children:[bt," + ",e("code",{children:"scroll Down"})," or ",e("code",{children:"-"})]}),description:"Zoom out"},{keys:e(U,{children:[bt," + ",e("code",{children:"drag"})]}),description:"Move the graph left/right"},{keys:e(U,{children:e("code",{children:"click"})}),description:"Select the series in the legend"},{keys:e(U,{children:[bt," + ",e("code",{children:"click"})]}),description:"Toggle multiple series in the legend"}]}],ia="Shortcut keys",Na=Wn(),Il=Na?"Cmd + /":"F1",hs=({showTitle:t})=>{const n=Ce(),{value:a,setTrue:r,setFalse:o}=se(!1),s=X(i=>{const c=Na&&i.key==="/"&&i.metaKey,l=!Na&&i.key==="F1"&&!i.metaKey;(c||l)&&r()},[r]);return ce("keydown",s),e(U,{children:[e(Y,{open:t===!0?!1:void 0,title:`${ia} (${Il})`,placement:"bottom-center",children:e(P,{className:n?"":"vm-header-button",variant:"contained",color:"primary",startIcon:e(Go,{}),onClick:r,ariaLabel:ia,children:t&&ia})}),a&&e(Pe,{title:"Shortcut keys",onClose:o,children:e("div",{className:"vm-shortcuts",children:Dl.map(i=>e("div",{className:"vm-shortcuts-section",children:[i.readMore&&e("div",{className:"vm-shortcuts-section__read-more",children:i.readMore}),e("h3",{className:"vm-shortcuts-section__title",children:i.title}),e("div",{className:"vm-shortcuts-section-list",children:i.list.map((c,l)=>e("div",{className:"vm-shortcuts-section-list-item",children:[e("div",{className:"vm-shortcuts-section-list-item__key",children:c.keys}),e("p",{className:"vm-shortcuts-section-list-item__description",children:c.description})]},`${i.title}_${l}`))})]},i.title))})})]})},Pl=({open:t})=>e("button",{className:D({"vm-menu-burger":!0,"vm-menu-burger_opened":t}),"aria-label":"menu",children:e("span",{})}),$l=({background:t,color:n})=>{const{pathname:a}=lt(),{isMobile:r}=W(),o=Q(null),{value:s,toggle:i,setFalse:c}=se(!1);return A(c,[a]),dn(o,c),e("div",{className:"vm-header-sidebar",ref:o,children:[e("div",{className:D({"vm-header-sidebar-button":!0,"vm-header-sidebar-button_open":s}),onClick:i,children:e(Pl,{open:s})}),e("div",{className:D({"vm-header-sidebar-menu":!0,"vm-header-sidebar-menu_open":s}),children:[e("div",{children:e(ms,{color:n,background:t,direction:"column"})}),e("div",{className:"vm-header-sidebar-menu-settings",children:!r&&!1})]})]})},Ol=t=>`${t.replace(/^(.+)(\/select.+)/,"$1")}/admin/tenants`,Rl=()=>{const{useTenantID:t}=rn(),n=Ce(),{serverUrl:a}=re(),[r,o]=C(!1),[s,i]=C(),[c,l]=C([]),m=L(()=>Ol(a),[a]),d=L(()=>!!on(a),[a]),u=n?!t:!d;return A(()=>{if(u)return;(async()=>{o(!0);try{const p=await fetch(m),v=await p.json(),b=v.data||[];l(b.sort((f,g)=>f.localeCompare(g))),p.ok?i(void 0):i(`${v.errorType}\r
${v==null?void 0:v.error}`)}catch(p){p instanceof Error&&i(`${p.name}: ${p.message}`)}o(!1)})().catch(console.error)},[m]),{accountIds:c,isLoading:r,error:s}},Fl=({controlsComponent:t,isMobile:n,...a})=>{const r=Ce(),{pathname:o}=lt(),{accountIds:s}=Rl(),{value:i,toggle:c,setFalse:l}=se(!1),m=L(()=>(ct[o]||{}).header||{},[o]),d=e(t,{...a,isMobile:n,accountIds:s,headerSetup:m});return n?e(U,{children:[e("div",{children:e(P,{className:D({"vm-header-button":!r}),startIcon:e(Za,{}),onClick:c,ariaLabel:"controls"})}),e(Pe,{title:"Controls",onClose:l,isOpen:i,className:D({"vm-header-controls-modal":!0,"vm-header-controls-modal_open":i}),children:d})]}):d},Wr=()=>{switch(jt){case rt.victorialogs:return e(qo,{});case rt.vmanomaly:return e(Bo,{});default:return e(Uo,{})}},ur=({controlsComponent:t})=>{const{isMobile:n}=W(),a=Mt(),r=L(()=>window.innerWidth<1e3,[a]),{isDarkTheme:o}=re(),s=Ce(),i=L(()=>Ze(o?"color-background-block":"color-primary"),[o]),{background:c,color:l}=L(()=>{const{headerStyles:{background:u=s?"#FFF":i,color:h=s?i:"#FFF"}={}}=rn();return{background:u,color:h}},[i]),m=On(),d=()=>{m({pathname:J.home}),window.location.reload()};return e("header",{className:D({"vm-header":!0,"vm-header_app":s,"vm-header_dark":o,"vm-header_sidebar":r,"vm-header_mobile":n}),style:{background:c,color:l},children:[r?e($l,{background:c,color:l}):e(U,{children:[!s&&e("div",{className:"vm-header-logo",onClick:d,style:{color:l},children:e(Wr,{})}),e(ms,{color:l,background:c})]}),r&&e("div",{className:D({"vm-header-logo":!0,"vm-header-logo_mobile":!0}),onClick:d,style:{color:l},children:e(Wr,{})}),e(Fl,{controlsComponent:t,displaySidebar:r,isMobile:n})]})},ps={href:"https://github.com/VictoriaMetrics/VictoriaMetrics/issues/new/choose",Icon:Jo,title:"Create an issue"},zl=[{href:"https://docs.victoriametrics.com/metricsql/",Icon:Lt,title:"MetricsQL"},{href:"https://docs.victoriametrics.com/#vmui",Icon:it,title:"Documentation"},ps],Hl=[{href:"https://docs.victoriametrics.com/victorialogs/logsql/",Icon:Lt,title:"LogsQL"},{href:"https://docs.victoriametrics.com/victorialogs/",Icon:it,title:"Documentation"},ps],hr=La(({links:t=zl})=>{const n=`2019-${new Date().getFullYear()}`;return e("footer",{className:"vm-footer",children:[e("a",{className:"vm-link vm-footer__website",target:"_blank",href:"https://victoriametrics.com/",rel:"me noreferrer",children:[e(jo,{}),"victoriametrics.com"]}),t.map(({href:a,Icon:r,title:o})=>e("a",{className:"vm-link vm-footer__link",target:"_blank",href:a,rel:"help noreferrer",children:[e(r,{}),o]},`${a}-${o}`)),e("div",{className:"vm-footer__copyright",children:["© ",n," VictoriaMetrics"]})]})}),Vl=()=>{const t=Ce(),{serverUrl:n}=re(),a=ll(),[r,o]=C(!1),[s,i]=C(""),[c,l]=C([]),m=async()=>{};return A(()=>{t||(l([]),m())},[n]),A(()=>{a({type:"SET_DASHBOARDS_SETTINGS",payload:c})},[c]),A(()=>{a({type:"SET_DASHBOARDS_LOADING",payload:r})},[r]),A(()=>{a({type:"SET_DASHBOARDS_ERROR",payload:s})},[s]),{dashboardsSettings:c,isLoading:r,error:s}},Ul=({error:t,warning:n,info:a})=>{const r=Q(null),[o,s]=C(!1),[i,c]=C(!1),m=`${L(()=>t?"ERROR: ":n?"WARNING: ":"",[t,n])}${t||n||a}`,d=()=>{const h=r.current;if(h){const{offsetWidth:p,scrollWidth:v,offsetHeight:b,scrollHeight:f}=h,g=p+1<v||b+1<f;s(g)}else s(!1)},u=()=>{o&&(c(!0),s(!1))};return A(()=>{c(!1),d()},[r,m]),ce("resize",d),!t&&!n&&!a?null:e("span",{className:D({"vm-text-field__error":!0,"vm-text-field__warning":n&&!t,"vm-text-field__helper-text":!n&&!t,"vm-text-field__error_overflowed":o,"vm-text-field__error_full":i}),"data-show":!!m,ref:r,onClick:u,children:m})},le=({label:t,value:n,type:a="text",error:r="",warning:o="",helperText:s="",placeholder:i,endIcon:c,startIcon:l,disabled:m=!1,autofocus:d=!1,inputmode:u="text",caretPosition:h,onChange:p,onEnter:v,onKeyDown:b,onFocus:f,onBlur:g,onChangeCaret:_})=>{const{isDarkTheme:y}=re(),{isMobile:w}=W(),S=Q(null),N=Q(null),k=L(()=>a==="textarea"?N:S,[a]),T=D({"vm-text-field__input":!0,"vm-text-field__input_error":r,"vm-text-field__input_warning":!r&&o,"vm-text-field__input_icon-start":l,"vm-text-field__input_disabled":m,"vm-text-field__input_textarea":a==="textarea"}),x=j=>{if(!_)return;const{selectionStart:H,selectionEnd:te}=j;_&&_([H||0,te||0])},M=j=>{x(j.currentTarget)},E=j=>{b&&b(j);const{key:H,ctrlKey:te,metaKey:de}=j,G=H==="Enter";(a!=="textarea"?G:G&&(de||te))&&v&&(j.preventDefault(),v())},I=j=>{x(j.currentTarget)},$=j=>{m||(p&&p(j.currentTarget.value),x(j.currentTarget))},O=()=>{f&&f()},V=()=>{g&&g()},z=j=>{try{k.current&&k.current.setSelectionRange(j[0],j[1])}catch(H){return H}};return A(()=>{var j;!d||w||(j=k==null?void 0:k.current)!=null&&j.focus&&k.current.focus()},[k,d]),A(()=>{h&&z(h)},[h]),e("label",{className:D({"vm-text-field":!0,"vm-text-field_textarea":a==="textarea","vm-text-field_dark":y}),"data-replicated-value":n,children:[l&&e("div",{className:"vm-text-field__icon-start",children:l}),c&&e("div",{className:"vm-text-field__icon-end",children:c}),a==="textarea"?e("textarea",{className:T,disabled:m,ref:N,value:n,rows:1,inputMode:u,placeholder:i,autoCapitalize:"none",onInput:$,onKeyDown:E,onKeyUp:I,onFocus:O,onBlur:V,onMouseUp:M}):e("input",{className:T,disabled:m,ref:S,value:n,type:a,placeholder:i,inputMode:u,autoCapitalize:"none",onInput:$,onKeyDown:E,onKeyUp:I,onFocus:O,onBlur:V,onMouseUp:M}),t&&e("span",{className:"vm-text-field__label",children:t}),e(Ul,{error:r,warning:o,info:s})]})},gs=({accountIds:t})=>{const n=Ce(),{isMobile:a}=W(),{tenantId:r,serverUrl:o}=re(),s=Et(),i=Ve(),[c,l]=C(""),m=Q(null),{value:d,toggle:u,setFalse:h}=se(!1),p=L(()=>{if(!c)return t;try{const f=new RegExp(c,"i");return t.filter(_=>f.test(_)).sort((_,y)=>{var w,S;return(((w=_.match(f))==null?void 0:w.index)||0)-(((S=y.match(f))==null?void 0:S.index)||0)})}catch{return[]}},[c,t]),v=L(()=>t.length>1,[t]),b=f=>()=>{const g=f;if(s({type:"SET_TENANT_ID",payload:g}),o){const _=Eo(o,g);if(_===o)return;s({type:"SET_SERVER",payload:_}),i({type:"RUN_QUERY"})}h()};return A(()=>{const f=on(o);r&&r!==f?b(r)():b(f)()},[o]),v?e("div",{className:"vm-tenant-input",children:[e(Y,{title:"Define Tenant ID if you need request to another storage",children:e("div",{ref:m,children:a?e("div",{className:"vm-mobile-option",onClick:u,children:[e("span",{className:"vm-mobile-option__icon",children:e(Tt,{})}),e("div",{className:"vm-mobile-option-text",children:[e("span",{className:"vm-mobile-option-text__label",children:"Tenant ID"}),e("span",{className:"vm-mobile-option-text__value",children:r})]}),e("span",{className:"vm-mobile-option__arrow",children:e(ve,{})})]}):e(P,{className:n?"":"vm-header-button",variant:"contained",color:"primary",fullWidth:!0,startIcon:e(Tt,{}),endIcon:e("div",{className:D({"vm-execution-controls-buttons__arrow":!0,"vm-execution-controls-buttons__arrow_open":d}),children:e(ve,{})}),onClick:u,children:r})})}),e(Ie,{open:d,placement:"bottom-right",onClose:h,buttonRef:m,title:a?"Define Tenant ID":void 0,children:e("div",{className:D({"vm-list vm-tenant-input-list":!0,"vm-list vm-tenant-input-list_mobile":a}),children:[e("div",{className:"vm-tenant-input-list__search",children:e(le,{autofocus:!0,label:"Search",value:c,onChange:l,type:"search"})}),p.map(f=>e("div",{className:D({"vm-list-item":!0,"vm-list-item_mobile":a,"vm-list-item_active":f===r}),onClick:b(f),children:f},f))]})})]}):null};function nn(t){const n=Q();return A(()=>{n.current=t},[t]),n.current}const Se=({text:t,href:n,children:a,colored:r=!0,underlined:o=!1,withIcon:s=!1})=>e("a",{href:n,className:D({"vm-link":!0,"vm-link_colored":r,"vm-link_underlined":o,"vm-link_with-icon":s}),target:"_blank",rel:"noreferrer",children:t||a}),vs=()=>{const t=Ce(),{isMobile:n}=W(),{customStep:a,isHistogram:r}=Re(),{period:{step:o,end:s,start:i}}=he(),c=mt(),{displayType:l}=Ue(),m=nn(s-i),d=L(()=>sn(s-i,r,l),[s,i,r,l]),u=nn(d),[h,p]=C(a||d),[v,b]=C(""),f=a===d,{value:g,toggle:_,setFalse:y}=se(!1),w=Q(null),S=E=>{const I=E||h||d||"1s",O=(I.match(/[a-zA-Z]+/g)||[]).length?I:`${I}s`;c({type:"SET_CUSTOM_STEP",payload:O}),p(O),b("")},N=()=>{S(),y()},k=()=>{document.activeElement instanceof HTMLInputElement&&document.activeElement.select()},T=()=>{S(),N()},x=E=>{const I=E.match(/[-+]?([0-9]*\.[0-9]+|[0-9]+)/g)||[],$=E.match(/[a-zA-Z]+/g)||[],O=I.length&&I.every(j=>parseFloat(j)>0),V=$.every(j=>za.find(H=>H.short===j)),z=O&&V;p(E),b(z?"":be.validStep)},M=()=>{const E=d||"1s";x(E),S(E)};return A(()=>{a&&S(a)},[a]),A(()=>{!a&&d&&S(d)},[d]),A(()=>{s-i===m||!m||a!==u||d&&S(d)},[m,d]),A(()=>{(o===a||o===d)&&S(d)},[r,l]),e("div",{className:"vm-step-control",ref:w,children:[n?e("div",{className:"vm-mobile-option",onClick:_,children:[e("span",{className:"vm-mobile-option__icon",children:e(Mn,{})}),e("div",{className:"vm-mobile-option-text",children:[e("span",{className:"vm-mobile-option-text__label",children:"Step"}),e("span",{className:"vm-mobile-option-text__value",children:h})]}),e("span",{className:"vm-mobile-option__arrow",children:e(ve,{})})]}):e(P,{className:t?"":"vm-header-button",variant:"contained",color:"primary",startIcon:e(Mn,{}),onClick:_,children:["Step: ",f?`auto (${h})`:h]}),e(Ie,{open:g,placement:"bottom-right",onClose:N,buttonRef:w,title:n?"Query resolution step width":void 0,children:e("div",{className:D({"vm-step-control-popper":!0,"vm-step-control-popper_mobile":n}),children:[e(le,{autofocus:!0,label:"Step value",value:h,error:v,onChange:x,onEnter:T,onFocus:k,onBlur:S,endIcon:e(Y,{title:`Reset to auto step (${d})`,children:e(P,{size:"small",variant:"text",color:"primary",startIcon:e(at,{}),onClick:M,ariaLabel:"reset step"})})}),e("div",{className:"vm-step-control-popper-info",children:[e("p",{children:[e("code",{children:"step"})," - the ",e(Se,{href:"https://prometheus.io/docs/prometheus/latest/querying/basics/#time-durations",text:"interval"})," between datapoints, which must be returned from the range query. The ",e("code",{children:"query"})," is executed at ",e("code",{children:"start"}),", ",e("code",{children:"start+step"}),", ",e("code",{children:"start+2*step"}),", …, ",e("code",{children:"end"})," timestamps."]}),e("p",{children:["Read more about ",e(Se,{href:"https://docs.victoriametrics.com/keyconcepts/#range-query",text:"Range"})," and ",e(Se,{href:"https://docs.victoriametrics.com/keyconcepts/#instant-query",text:"Instant"})," queries."]})]})]})})]})},ql=({relativeTime:t,setDuration:n})=>{const{isMobile:a}=W(),r=o=>()=>{n(o)};return e("div",{className:D({"vm-time-duration":!0,"vm-time-duration_mobile":a}),children:Xt.map(({id:o,duration:s,until:i,title:c})=>e("div",{className:D({"vm-list-item":!0,"vm-list-item_mobile":a,"vm-list-item_active":o===t}),onClick:r({duration:s,until:i(),id:o}),children:c||s},o))})},Bl=({viewDate:t,showArrowNav:n,onChangeViewDate:a,toggleDisplayYears:r})=>{const o=()=>{a(t.subtract(1,"month"))},s=()=>{a(t.add(1,"month"))};return e("div",{className:"vm-calendar-header",children:[e("div",{className:"vm-calendar-header-left",onClick:r,children:[e("span",{className:"vm-calendar-header-left__date",children:t.format("MMMM YYYY")}),e("div",{className:"vm-calendar-header-left__select-year",children:e(Qe,{})})]}),n&&e("div",{className:"vm-calendar-header-right",children:[e("div",{className:"vm-calendar-header-right__prev",onClick:o,children:e(ve,{})}),e("div",{className:"vm-calendar-header-right__next",onClick:s,children:e(ve,{})})]})]})},jl=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],Ql=({viewDate:t,selectDate:n,onChangeSelectDate:a})=>{const r="YYYY-MM-DD",o=B.tz(),s=B(t.format(r)),i=L(()=>{const l=new Array(42).fill(null),m=s.startOf("month"),u=s.endOf("month").diff(m,"day")+1,h=new Array(u).fill(m).map((v,b)=>v.add(b,"day")),p=m.day();return l.splice(p,u,...h),l},[s]),c=l=>()=>{l&&a(l)};return e("div",{className:"vm-calendar-body",children:[jl.map(l=>e(Y,{title:l,children:e("div",{className:"vm-calendar-body-cell vm-calendar-body-cell_weekday",children:l[0]})},l)),i.map((l,m)=>e("div",{className:D({"vm-calendar-body-cell":!0,"vm-calendar-body-cell_day":!0,"vm-calendar-body-cell_day_empty":!l,"vm-calendar-body-cell_day_active":(l&&l.format(r))===n.format(r),"vm-calendar-body-cell_day_today":(l&&l.format(r))===o.format(r)}),onClick:c(l),children:l&&l.format("D")},l?l.format(r):m))]})},Yl=({viewDate:t,onChangeViewDate:n})=>{const a=B().format("YYYY"),r=L(()=>t.format("YYYY"),[t]),o=L(()=>{const l=B().subtract(18/2,"year");return new Array(18).fill(l).map((m,d)=>m.add(d,"year"))},[t]);A(()=>{const i=document.getElementById(`vm-calendar-year-${r}`);i&&i.scrollIntoView({block:"center"})},[]);const s=i=>()=>{n(i)};return e("div",{className:"vm-calendar-years",children:o.map(i=>e("div",{className:D({"vm-calendar-years__year":!0,"vm-calendar-years__year_selected":i.format("YYYY")===r,"vm-calendar-years__year_today":i.format("YYYY")===a}),id:`vm-calendar-year-${i.format("YYYY")}`,onClick:s(i),children:i.format("YYYY")},i.format("YYYY")))})},Gl=({viewDate:t,selectDate:n,onChangeViewDate:a})=>{const r=B().format("MM"),o=L(()=>n.format("MM"),[n]),s=L(()=>new Array(12).fill("").map((c,l)=>B(t).month(l)),[t]);A(()=>{const c=document.getElementById(`vm-calendar-year-${o}`);c&&c.scrollIntoView({block:"center"})},[]);const i=c=>()=>{a(c)};return e("div",{className:"vm-calendar-years",children:s.map(c=>e("div",{className:D({"vm-calendar-years__year":!0,"vm-calendar-years__year_selected":c.format("MM")===o,"vm-calendar-years__year_today":c.format("MM")===r}),id:`vm-calendar-year-${c.format("MM")}`,onClick:i(c),children:c.format("MMMM")},c.format("MM")))})},Wl=({date:t,format:n=Ge,onChange:a})=>{const[r,o]=C(0),[s,i]=C(B.tz(t)),[c,l]=C(B.tz(t)),m=B.tz(),d=m.format(Nt)===s.format(Nt),{isMobile:u}=W(),h=()=>{o(f=>f===2?0:2)},p=f=>{i(f),o(g=>g===2?1:0)},v=f=>{l(f)},b=()=>{i(m)};return A(()=>{c.format()!==B.tz(t).format()&&a(c.format(n))},[c]),A(()=>{const f=B.tz(t);i(f),l(f)},[t]),e("div",{className:D({"vm-calendar":!0,"vm-calendar_mobile":u}),children:[e(Bl,{viewDate:s,onChangeViewDate:p,toggleDisplayYears:h,showArrowNav:r===0}),r===0&&e(Ql,{viewDate:s,selectDate:c,onChangeSelectDate:v}),r===2&&e(Yl,{viewDate:s,onChangeViewDate:p}),r===1&&e(Gl,{selectDate:c,viewDate:s,onChangeViewDate:p}),!d&&r===0&&e("div",{className:"vm-calendar-footer",children:e(P,{variant:"text",size:"small",onClick:b,children:"show today"})})]})},fs=Rn(({date:t,targetRef:n,format:a=Ge,onChange:r,label:o},s)=>{const i=L(()=>B(t).isValid()?B.tz(t):B().tz(),[t]),{isMobile:c}=W(),{value:l,toggle:m,setFalse:d}=se(!1),u=p=>{r(p),d()},h=p=>{(p.key==="Escape"||p.key==="Enter")&&d()};return ce("click",m,n),ce("keyup",h),e(U,{children:e(Ie,{open:l,buttonRef:n,placement:"bottom-right",onClose:d,title:c?o:void 0,children:e("div",{ref:s,children:e(Wl,{date:i,format:a,onChange:u})})})})}),Kr=t=>B(t).isValid()?B.tz(t).format(Ge):t,Jr=({value:t="",label:n,pickerLabel:a,pickerRef:r,onChange:o,onEnter:s})=>{const i=Q(null),[c,l]=C(null),[m,d]=C(Kr(t)),[u,h]=C(!1),[p,v]=C(!1),b=B(m).isValid()?"":"Invalid date format",f=w=>{d(w.currentTarget.value)},g=()=>{o(m)},_=w=>{w.key==="Enter"&&(o(m),v(!0))},y=w=>{d(w),h(!0)};return A(()=>{const w=Kr(t);w!==m&&d(w),p&&(s(),v(!1))},[t]),A(()=>{u&&c&&(c.focus(),c.setSelectionRange(11,11),h(!1))},[u]),e("div",{className:D({"vm-date-time-input":!0,"vm-date-time-input_error":b}),children:[e("label",{children:n}),e(vi,{tabIndex:1,inputRef:l,mask:"9999-99-99 99:99:99",placeholder:"YYYY-MM-DD HH:mm:ss",value:m,autoCapitalize:"none",inputMode:"numeric",maskChar:null,onChange:f,onBlur:g,onKeyUp:_}),b&&e("span",{className:"vm-date-time-input__error-text",children:b}),e("div",{className:"vm-date-time-input__icon",ref:i,children:e(P,{variant:"text",color:"gray",size:"small",startIcon:e(Ln,{}),ariaLabel:"calendar"})}),e(fs,{label:a,ref:r,date:m,onChange:y,targetRef:i})]})},pr=()=>{const{isMobile:t}=W(),{isDarkTheme:n}=re(),a=Q(null),r=Mt(),o=L(()=>r.width>1120,[r]),[s,i]=C(),[c,l]=C(),{period:{end:m,start:d},relativeTime:u,timezone:h,duration:p}=he(),v=Ve(),b=Ce(),f=nn(h),{value:g,toggle:_,setFalse:y}=se(!1),w=L(()=>({region:h,utc:Zt(h)}),[h]);A(()=>{i(Rt(je(m)))},[h,m]),A(()=>{l(Rt(je(d)))},[h,d]);const S=({duration:O,until:V,id:z})=>{v({type:"SET_RELATIVE_TIME",payload:{duration:O,until:V,id:z}}),y()},N=L(()=>{const O=B.tz(je(d)).format(Ge),V=B.tz(je(m)).format(Ge);return{start:O,end:V}},[d,m,h]),k=L(()=>u&&u!=="none"?u.replace(/_/g," "):`${N.start} - ${N.end}`,[u,N]),T=Q(null),x=Q(null),M=Q(null),E=()=>{c&&s&&v({type:"SET_PERIOD",payload:{from:B.tz(c).toDate(),to:B.tz(s).toDate()}}),y()},I=()=>v({type:"RUN_QUERY_TO_NOW"}),$=()=>{i(Rt(je(m))),l(Rt(je(d))),y()};return A(()=>{const O=Ua({relativeTimeId:u,defaultDuration:p,defaultEndInput:je(m)});f&&h!==f&&S({id:O.relativeTimeId,duration:O.duration,until:O.endInput})},[h,f]),dn(a,O=>{var H,te;if(t)return;const V=O.target,z=(T==null?void 0:T.current)&&((H=T==null?void 0:T.current)==null?void 0:H.contains(V)),j=(x==null?void 0:x.current)&&((te=x==null?void 0:x.current)==null?void 0:te.contains(V));z||j||y()}),e(U,{children:[e("div",{ref:M,children:t?e("div",{className:"vm-mobile-option",onClick:_,children:[e("span",{className:"vm-mobile-option__icon",children:e(en,{})}),e("div",{className:"vm-mobile-option-text",children:[e("span",{className:"vm-mobile-option-text__label",children:"Time range"}),e("span",{className:"vm-mobile-option-text__value",children:k})]}),e("span",{className:"vm-mobile-option__arrow",children:e(ve,{})})]}):e(Y,{title:o?"Time range controls":k,children:e(P,{className:b?"":"vm-header-button",variant:"contained",color:"primary",startIcon:e(en,{}),onClick:_,ariaLabel:"time range controls",children:o&&e("span",{children:k})})})}),e(Ie,{open:g,buttonRef:M,placement:"bottom-right",onClose:y,clickOutside:!1,title:t?"Time range controls":"",children:e("div",{className:D({"vm-time-selector":!0,"vm-time-selector_mobile":t}),ref:a,children:[e("div",{className:"vm-time-selector-left",children:[e("div",{className:D({"vm-time-selector-left-inputs":!0,"vm-time-selector-left-inputs_dark":n}),children:[e(Jr,{value:c,label:"From:",pickerLabel:"Date From",pickerRef:T,onChange:l,onEnter:E}),e(Jr,{value:s,label:"To:",pickerLabel:"Date To",pickerRef:x,onChange:i,onEnter:E})]}),e("div",{className:"vm-time-selector-left-timezone",children:[e("div",{className:"vm-time-selector-left-timezone__title",children:w.region}),e("div",{className:"vm-time-selector-left-timezone__utc",children:w.utc})]}),e(P,{variant:"text",startIcon:e(Yo,{}),onClick:I,children:"switch to now"}),e("div",{className:"vm-time-selector-left__controls",children:[e(P,{color:"error",variant:"outlined",onClick:$,children:"Cancel"}),e(P,{color:"primary",onClick:E,children:"Apply"})]})]}),e(ql,{relativeTime:u||"",setDuration:S})]})})]})},ft=()=>{const t=On(),[n,a]=ae();return{setSearchParamsFromKeys:X(o=>{const s=!!Array.from(n.values()).length;let i=!1;Object.entries(o).forEach(([c,l])=>{n.get(c)!==`${l}`&&(n.set(c,`${l}`),i=!0)}),i&&(s?a(n):t(`?${n.toString()}`,{replace:!0}))},[n,t])}},_s=()=>{const{isMobile:t}=W(),n=Ce(),a=Q(null),[r]=ae(),{setSearchParamsFromKeys:o}=ft(),s=r.get("date")||B().tz().format(Nt),i=L(()=>B.tz(s).format(Nt),[s]),c=l=>{o({date:l})};return A(()=>{c(s)},[]),e("div",{children:[e("div",{ref:a,children:t?e("div",{className:"vm-mobile-option",children:[e("span",{className:"vm-mobile-option__icon",children:e(Ln,{})}),e("div",{className:"vm-mobile-option-text",children:[e("span",{className:"vm-mobile-option-text__label",children:"Date control"}),e("span",{className:"vm-mobile-option-text__value",children:i})]}),e("span",{className:"vm-mobile-option__arrow",children:e(ve,{})})]}):e(Y,{title:"Date control",children:e(P,{className:n?"":"vm-header-button",variant:"contained",color:"primary",startIcon:e(Ln,{}),children:i})})}),e(fs,{label:"Date control",date:s||"",format:Nt,onChange:c,targetRef:a})]})},la=[{seconds:0,title:"Off"},{seconds:1,title:"1s"},{seconds:2,title:"2s"},{seconds:5,title:"5s"},{seconds:10,title:"10s"},{seconds:30,title:"30s"},{seconds:60,title:"1m"},{seconds:300,title:"5m"},{seconds:900,title:"15m"},{seconds:1800,title:"30m"},{seconds:3600,title:"1h"},{seconds:7200,title:"2h"}],gr=()=>{const{isMobile:t}=W(),n=Ve(),a=Ce(),[r,o]=C(!1),[s,i]=C(la[0]),{value:c,toggle:l,setFalse:m}=se(!1),d=Q(null),u=v=>{(r&&!v.seconds||!r&&v.seconds)&&o(b=>!b),i(v),m()},h=()=>{n({type:"RUN_QUERY"})};A(()=>{const v=s.seconds;let b;return r?b=setInterval(()=>{n({type:"RUN_QUERY"})},v*1e3):i(la[0]),()=>{b&&clearInterval(b)}},[s,r]);const p=v=>()=>{u(v)};return e(U,{children:[e("div",{className:"vm-execution-controls",children:e("div",{className:D({"vm-execution-controls-buttons":!0,"vm-execution-controls-buttons_mobile":t,"vm-header-button":!a}),children:[!t&&e(Y,{title:"Refresh dashboard",children:e(P,{variant:"contained",color:"primary",onClick:h,startIcon:e(qn,{}),ariaLabel:"refresh dashboard"})}),t?e("div",{className:"vm-mobile-option",onClick:l,children:[e("span",{className:"vm-mobile-option__icon",children:e(at,{})}),e("div",{className:"vm-mobile-option-text",children:[e("span",{className:"vm-mobile-option-text__label",children:"Auto-refresh"}),e("span",{className:"vm-mobile-option-text__value",children:s.title})]}),e("span",{className:"vm-mobile-option__arrow",children:e(ve,{})})]}):e(Y,{title:"Auto-refresh control",children:e("div",{ref:d,children:e(P,{variant:"contained",color:"primary",fullWidth:!0,endIcon:e("div",{className:D({"vm-execution-controls-buttons__arrow":!0,"vm-execution-controls-buttons__arrow_open":c}),children:e(ve,{})}),onClick:l,children:s.title})})})]})}),e(Ie,{open:c,placement:"bottom-right",onClose:m,buttonRef:d,title:t?"Auto-refresh duration":void 0,children:e("div",{className:D({"vm-execution-controls-list":!0,"vm-execution-controls-list_mobile":t}),children:la.map(v=>e("div",{className:D({"vm-list-item":!0,"vm-list-item_mobile":t,"vm-list-item_active":v.seconds===s.seconds}),onClick:p(v),children:v.title},v.seconds))})})]})},Zr={enable:"Enable to save the modified server URL to local storage, preventing reset upon page refresh.",disable:"Disable to stop saving the server URL to local storage, reverting to the default URL on page refresh."},Kl=Rn(({onClose:t},n)=>{const{serverUrl:a}=re(),r=Et(),{value:o,toggle:s}=se(!!xe("SERVER_URL")),[i,c]=C(a),[l,m]=C(""),d=h=>{c(h||""),m("")},u=X(()=>{const h=on(i);h!==""&&r({type:"SET_TENANT_ID",payload:h}),r({type:"SET_SERVER",payload:i}),t()},[i]);return A(()=>{a||m(be.emptyServer),Oa(a)||m(be.validServer)},[a]),A(()=>{o?Te("SERVER_URL",i):Lo(["SERVER_URL"])},[o]),A(()=>{o&&Te("SERVER_URL",i)},[i]),A(()=>{a!==i&&c(a)},[a]),Ma(n,()=>({handleApply:u}),[u]),e("div",{children:[e("div",{className:"vm-server-configurator__title",children:"Server URL"}),e("div",{className:"vm-server-configurator-url",children:[e(le,{autofocus:!0,value:i,error:l,onChange:d,onEnter:u,inputmode:"url"}),e(Y,{title:o?Zr.disable:Zr.enable,children:e(P,{className:"vm-server-configurator-url__button",variant:"text",color:o?"primary":"gray",onClick:s,startIcon:e(Tt,{})})})]})]})}),Jl=[{label:"Graph",type:we.chart},{label:"JSON",type:we.code},{label:"Table",type:we.table}],Zl=Rn(({onClose:t},n)=>{const{isMobile:a}=W(),{seriesLimits:r}=Ue(),o=Gt(),[s,i]=C(r),[c,l]=C({table:"",chart:"",code:""}),m=()=>{i(Do)},d=h=>p=>{const v=p||"";l(b=>({...b,[h]:+v<0?be.positiveNumber:""})),i({...s,[h]:v||1/0})},u=X(()=>{o({type:"SET_SERIES_LIMITS",payload:s}),t()},[s]);return Ma(n,()=>({handleApply:u}),[u]),e("div",{className:"vm-limits-configurator",children:[e("div",{className:"vm-server-configurator__title",children:["Series limits by tabs",e(Y,{title:"Set to 0 to disable the limit",children:e(P,{variant:"text",color:"primary",size:"small",startIcon:e(st,{})})}),e("div",{className:"vm-limits-configurator-title__reset",children:e(P,{variant:"text",color:"primary",size:"small",startIcon:e(at,{}),onClick:m,children:"Reset limits"})})]}),e("div",{className:D({"vm-limits-configurator__inputs":!0,"vm-limits-configurator__inputs_mobile":a}),children:Jl.map(h=>e("div",{children:e(le,{label:h.label,value:s[h.type],error:c[h.type],onChange:d(h.type),onEnter:u,type:"number"})},h.type))})]})}),Kn=({defaultExpanded:t=!1,onChange:n,title:a,children:r})=>{const[o,s]=C(t),i=()=>{const c=window.getSelection();c&&c.toString()||s(l=>{const m=!l;return n&&n(m),m})};return A(()=>{s(t)},[t]),e(U,{children:[e("header",{className:`vm-accordion-header ${o&&"vm-accordion-header_open"}`,onClick:i,children:[a,e("div",{className:`vm-accordion-header__arrow ${o&&"vm-accordion-header__arrow_open"}`,children:e(ve,{})})]}),o&&e("section",{className:"vm-accordion-section",children:r},"content")]})},Xl="Browser timezone is not recognized, supported, or could not be determined.",ec=()=>e(Y,{title:Xl,children:e(ja,{})}),pn=zo(),tc=Rn((t,n)=>{const{isMobile:a}=W(),r=Qr(),{timezone:o,defaultTimezone:s}=he(),i=Ve(),[c,l]=C(o),[m,d]=C(""),u=Q(null),{value:h,toggle:p,setFalse:v}=se(!1),b=L(()=>[{title:`Default time (${s})`,region:s,utc:s?Zt(s):"UTC"},{title:pn.title,region:pn.region,utc:Zt(pn.region),isInvalid:!pn.isValid},{title:"UTC (Coordinated Universal Time)",region:"UTC",utc:"UTC"}].filter(N=>N.region),[s]),f=L(()=>{if(!m)return r;try{return Qr(m)}catch{return{}}},[m,r]),g=L(()=>Object.keys(f),[f]),_=L(()=>({region:c,utc:Zt(c)}),[c]),y=N=>{d(N)},w=N=>{l(N.region),d(""),v()},S=N=>()=>{w(N)};return A(()=>{l(o)},[o]),Ma(n,()=>({handleApply:()=>{i({type:"SET_TIMEZONE",payload:c})}}),[c]),e("div",{className:"vm-timezones",children:[e("div",{className:"vm-server-configurator__title",children:"Time zone"}),e("div",{className:"vm-timezones-item vm-timezones-item_selected",onClick:p,ref:u,children:[e("div",{className:"vm-timezones-item__title",children:_.region}),e("div",{className:"vm-timezones-item__utc",children:_.utc}),e("div",{className:D({"vm-timezones-item__icon":!0,"vm-timezones-item__icon_open":h}),children:e(Qe,{})})]}),e(Ie,{open:h,buttonRef:u,placement:"bottom-left",onClose:v,fullWidth:!0,title:a?"Time zone":void 0,children:e("div",{className:D({"vm-timezones-list":!0,"vm-timezones-list_mobile":a}),children:[e("div",{className:"vm-timezones-list-header",children:[e("div",{className:"vm-timezones-list-header__search",children:e(le,{autofocus:!0,label:"Search",value:m,onChange:y})}),b.map((N,k)=>N&&e("div",{className:"vm-timezones-item vm-timezones-list-group-options__item",onClick:S(N),children:[e("div",{className:"vm-timezones-item__title",children:[N.title,N.isInvalid&&e(ec,{})]}),e("div",{className:"vm-timezones-item__utc",children:N.utc})]},`${k}_${N.region}`))]}),g.map(N=>e("div",{className:"vm-timezones-list-group",children:e(Kn,{defaultExpanded:!0,title:e("div",{className:"vm-timezones-list-group__title",children:N}),children:e("div",{className:"vm-timezones-list-group-options",children:f[N]&&f[N].map(k=>e("div",{className:"vm-timezones-item vm-timezones-list-group-options__item",onClick:S(k),children:[e("div",{className:"vm-timezones-item__title",children:k.region}),e("div",{className:"vm-timezones-item__utc",children:k.utc})]},k.search))})})},N))]})})]})}),nc=({options:t,value:n,label:a,onChange:r})=>{const o=Q(null),[s,i]=C({width:"0px",left:"0px",borderRadius:"0px"}),c=l=>()=>{r(l)};return A(()=>{if(!o.current){i({width:"0px",left:"0px",borderRadius:"0px"});return}const l=t.findIndex(p=>p.value===n),{width:m}=o.current.getBoundingClientRect();let d=m,u=l*d,h="0";l===0&&(h="16px 0 0 16px"),l===t.length-1&&(h="10px",u-=1,h="0 16px 16px 0"),l!==0&&l!==t.length-1&&(d+=1,u-=1),i({width:`${d}px`,left:`${u}px`,borderRadius:h})},[o,n,t]),e("div",{className:"vm-toggles",children:[a&&e("label",{className:"vm-toggles__label",children:a}),e("div",{className:"vm-toggles-group",style:{gridTemplateColumns:`repeat(${t.length}, 1fr)`},children:[s.borderRadius&&e("div",{className:"vm-toggles-group__highlight",style:s}),t.map((l,m)=>e("div",{className:D({"vm-toggles-group-item":!0,"vm-toggles-group-item_first":m===0,"vm-toggles-group-item_active":l.value===n,"vm-toggles-group-item_icon":l.icon&&l.title}),onClick:c(l.value),ref:l.value===n?o:null,children:[l.icon,l.title]},l.value))]})]})},ac=Object.values(Be).map(t=>({title:t,value:t})),rc=()=>{const{isMobile:t}=W(),n=Et(),{theme:a}=re(),r=o=>{n({type:"SET_THEME",payload:o})};return e("div",{className:D({"vm-theme-control":!0,"vm-theme-control_mobile":t}),children:[e("div",{className:"vm-server-configurator__title",children:"Theme preferences"}),e("div",{className:"vm-theme-control__toggle",children:e(nc,{options:ac,value:a,onChange:r})},`${t}`)]})},ye=({value:t=!1,disabled:n=!1,label:a,color:r="secondary",fullWidth:o,onChange:s})=>{const i=()=>{n||s(!t)},c=D({"vm-switch":!0,"vm-switch_full-width":o,"vm-switch_disabled":n,"vm-switch_active":t,[`vm-switch_${r}_active`]:t,[`vm-switch_${r}`]:r});return e("div",{className:c,onClick:i,children:[e("div",{className:"vm-switch-track",children:e("div",{className:"vm-switch-track__thumb"})}),a&&e("span",{className:"vm-switch__label",children:a})]})},oc=()=>{const{isMobile:t}=W(),{markdownParsing:n}=cr(),a=is();return e("div",{children:[e("div",{className:"vm-server-configurator__title",children:"Markdown Parsing for Logs"}),e(ye,{label:n?"Disable markdown parsing":"Enable markdown parsing",value:n,onChange:o=>{a({type:"SET_MARKDOWN_PARSING",payload:o})},fullWidth:t}),e("div",{className:"vm-server-configurator__info",children:"Toggle this switch to enable or disable the Markdown formatting for log entries. Enabling this will parse log texts to Markdown."})]})},ca="Settings",vr=()=>{const{isMobile:t}=W(),n=Ce(),a=Q(null),r=Q(null),o=Q(null),{value:s,setTrue:i,setFalse:c}=se(!1),l=()=>{a.current&&a.current.handleApply(),r.current&&r.current.handleApply(),o.current&&o.current.handleApply(),c()},m=[{show:!n&&!1,component:e(Kl,{ref:a,onClose:c})},{show:!1,component:e(Zl,{ref:r,onClose:c})},{show:Ao,component:e(oc,{})},{show:!0,component:e(tc,{ref:o})},{show:!n,component:e(rc,{})}].filter(d=>d.show);return e(U,{children:[t?e("div",{className:"vm-mobile-option",onClick:i,children:[e("span",{className:"vm-mobile-option__icon",children:e(ot,{})}),e("div",{className:"vm-mobile-option-text",children:e("span",{className:"vm-mobile-option-text__label",children:ca})}),e("span",{className:"vm-mobile-option__arrow",children:e(ve,{})})]}):e(Y,{title:ca,children:e(P,{className:D({"vm-header-button":!n}),variant:"contained",color:"primary",startIcon:e(ot,{}),onClick:i,ariaLabel:"settings"})}),s&&e(Pe,{title:ca,onClose:c,children:e("div",{className:D({"vm-server-configurator":!0,"vm-server-configurator_mobile":t}),children:[m.map((d,u)=>e("div",{className:"vm-server-configurator__input",children:d.component},u)),e("div",{className:"vm-server-configurator-footer",children:[e(P,{color:"error",variant:"outlined",onClick:c,children:"Cancel"}),e(P,{color:"primary",variant:"contained",onClick:l,children:"Apply"})]})]})})]})},sc=({displaySidebar:t,isMobile:n,headerSetup:a,accountIds:r})=>e("div",{className:D({"vm-header-controls":!0,"vm-header-controls_mobile":n}),children:[(a==null?void 0:a.tenant)&&e(gs,{accountIds:r||[]}),(a==null?void 0:a.stepControl)&&e(vs,{}),(a==null?void 0:a.timeSelector)&&e(pr,{}),(a==null?void 0:a.cardinalityDatePicker)&&e(_s,{}),(a==null?void 0:a.executionControls)&&e(gr,{}),e(vr,{}),!t&&e(hs,{})]});xe("DISABLED_DEFAULT_TIMEZONE");const fr=()=>{const{serverUrl:t}=re();Ve();const[n,a]=C(!1),[r,o]=C(""),s=async()=>{};return A(()=>{s()},[t]),{isLoading:n,error:r}},ic=()=>{const{serverUrl:t}=re();Et();const[n,a]=C(!1),[r,o]=C("");return A(()=>{(async()=>{})()},[t]),{isLoading:n,error:r}},lc=()=>{Et();const[t,n]=C(!1),[a,r]=C("");return A(()=>{(async()=>{})()},[]),{isLoading:t,error:a}},cc=()=>{const t=Ce(),{isMobile:n}=W(),{pathname:a}=lt(),[r,o]=ae();Vl(),fr(),lc(),ic();const s=()=>{var m;const c="vmui",l=(m=ct[a])==null?void 0:m.title;document.title=l?`${l} - ${c}`:c},i=()=>{const{search:c,href:l}=window.location;if(c){const d=Ea.parse(c,{ignoreQueryPrefix:!0});Object.entries(d).forEach(([u,h])=>r.set(u,h)),o(r),window.location.search=""}const m=l.replace(/\/\?#\//,"/#/");m!==l&&window.location.replace(m)};return A(s,[a]),A(i,[]),e("section",{className:"vm-container",children:[e(ur,{controlsComponent:sc}),e("div",{className:D({"vm-container-body":!0,"vm-container-body_mobile":n,"vm-container-body_app":t}),children:e(Da,{})}),!t&&e(hr,{})]})},dc=`No match! 
This query hasn't selected any time series from database.
Either the requested metrics are missing in the database,
or there is a typo in series selector.`,mc=`The shown results are marked as PARTIAL.
The result is marked as partial if one or more vmstorage nodes failed to respond to the query.`,bs=({value:t,onChange:n,onEnter:a,onArrowUp:r,onArrowDown:o,autocomplete:s,autocompleteEl:i,error:c,stats:l,label:m,disabled:d=!1,includeFunctions:u=!0})=>{const{autocompleteQuick:h}=Ee(),{isMobile:p}=W(),[v,b]=C(!1),[f,g]=C([0,0]),[_,y]=C([0,0]),w=Q(null),[S,N]=C(!!i),k=Q(Fn(N,500)).current,T=[{show:(l==null?void 0:l.seriesFetched)==="0"&&!l.resultLength,text:dc},{show:l==null?void 0:l.isPartial,text:mc}].filter($=>$.show).map($=>$.text).join("");l&&(m=`${m} (${l.executionTimeMsec||0}ms)`);const x=($,O)=>{n($),y([O,O])},M=$=>{const{key:O,ctrlKey:V,metaKey:z,shiftKey:j}=$,te=($.target.value||"").split(`
`).length>1,de=V||z,G=O==="ArrowUp",oe=O==="ArrowDown",K=O==="Enter";G&&de&&($.preventDefault(),r()),oe&&de&&($.preventDefault(),o()),K&&v&&$.preventDefault(),K&&!j&&(!te||de)&&!v&&($.preventDefault(),a())},E=$=>{b(!!$.length)},I=$=>{g(O=>O[0]===$[0]&&O[1]===$[1]?O:$)};return A(()=>{b(!!i&&h)},[h]),A(()=>{N(!1),k(!0)},[f]),e("div",{className:"vm-query-editor",ref:w,children:[e(le,{value:t,label:m,type:"textarea",autofocus:!p,error:c,warning:T,onKeyDown:M,onChange:n,onChangeCaret:I,disabled:d,inputmode:"search",caretPosition:_}),S&&s&&i&&e(i,{value:t,anchorEl:w,caretPosition:f,hasHelperText:!!(T||c),includeFunctions:u,onSelect:x,onFoundOptions:E})]})},Xr=({isMobile:t,hideButtons:n})=>{const{autocomplete:a}=Ee(),r=Qt(),{nocache:o,isTracingEnabled:s,reduceMemUsage:i}=Ue(),c=Gt(),l=()=>{c({type:"TOGGLE_NO_CACHE"})},m=()=>{c({type:"TOGGLE_REDUCE_MEM_USAGE"})},d=()=>{c({type:"TOGGLE_QUERY_TRACING"})},u=()=>{r({type:"TOGGLE_AUTOCOMPLETE"})},h=()=>{r({type:"SET_AUTOCOMPLETE_QUICK",payload:!0})};return ce("keydown",v=>{const{code:b,ctrlKey:f,altKey:g}=v;b==="Space"&&(f||g)&&(v.preventDefault(),h())}),e("div",{className:D({"vm-additional-settings":!0,"vm-additional-settings_mobile":t}),children:[!(n!=null&&n.autocomplete)&&e(Y,{title:e(U,{children:["Quick tip: ",us]}),children:e(ye,{label:"Autocomplete",value:a,onChange:u,fullWidth:t})}),!(n!=null&&n.disableCache)&&e(ye,{label:"Disable cache",value:o,onChange:l,fullWidth:t}),!(n!=null&&n.reduceMemUsage)&&e(ye,{label:"Disable deduplication",value:i,onChange:m,fullWidth:t}),!(n!=null&&n.traceQuery)&&e(ye,{label:"Trace query",value:s,onChange:d,fullWidth:t})]})},uc=t=>{const{isMobile:n}=W(),a=Q(null),{value:r,toggle:o,setFalse:s}=se(!1);return n?e(U,{children:[e("div",{ref:a,children:e(P,{variant:"outlined",startIcon:e(Zo,{}),onClick:o,ariaLabel:"additional the query settings"})}),e(Ie,{open:r,buttonRef:a,placement:"bottom-left",onClose:s,title:"Query settings",children:e(Xr,{isMobile:n,...t})})]}):e(Xr,{...t})},Jn=(t,n)=>t.length===n.length&&t.every((a,r)=>a===n[r]);function ys(t,n){const a=t.reduce((r,o)=>{const s=n.map(i=>`${String(i)}: ${o[i]||"-"}`).join("|");return(r[s]=r[s]||[]).push(o),r},{});return Object.entries(a).map(([r,o])=>({keys:r.split("|"),values:o}))}const hc=()=>{const{serverUrl:t}=re();return async a=>{try{const r=encodeURIComponent(a),o=`${t}/prettify-query?query=${r}`,s=await fetch(o);if(s.status!=200)return{query:a,error:"Error requesting /prettify-query, status: "+s.status};const i=await s.json();return i.status!="success"?{query:a,error:String(i.msg)}:{query:String(i.query),error:""}}catch(r){return console.error(r),r instanceof Error&&r.name!=="AbortError"?{query:a,error:`${r.name}: ${r.message}`}:{query:a,error:String(r)}}}},Fe=()=>{const{showInfoMessage:t}=vl();return async(n,a)=>{if(!(navigator!=null&&navigator.clipboard))return t({text:e(pc,{}),type:"error",timeout:2e4}),!1;try{return await navigator.clipboard.writeText(n),a&&t({text:a,type:"success"}),!0}catch(r){return r instanceof Error&&t({text:`${r.name}: ${r.message}`,type:"error"}),console.warn("Copy failed",r),!1}}},pc=()=>e("div",{className:"vm-snackbar-details",children:[e("p",{className:"vm-snackbar-details__title",children:"Clipboard not supported"}),window.isSecureContext?e("p",{className:"vm-snackbar-details__msg",children:[e("p",{children:"Common reasons:"}),e("ul",{children:[e("li",{children:"Browser restrictions"}),e("li",{children:"Insecure connection (HTTP)"}),e("li",{children:"Permissions not granted"})]}),e("p",{children:["For detailed information, visit the ",e("a",{className:"vm-link vm-link_underlined vm-link_colored",href:"https://developer.mozilla.org/en-US/docs/Web/API/Clipboard_API#security_considerations",target:"_blank",rel:"noopener noreferrer",children:"Clipboard API documentation"})]})]}):e("p",{className:"vm-snackbar-details__msg",children:[e("p",{children:"This page is not running in a secure context (HTTPS)."}),e("p",{children:"Clipboard operations require a secure context."}),e("a",{className:"vm-link vm-link_underlined vm-link_colored",href:"https://developer.mozilla.org/en-US/docs/Web/Security/Secure_Contexts",target:"_blank",rel:"noopener noreferrer",children:"Learn more about secure contexts"})]})]}),gc=({query:t,favorites:n,onRun:a,onToggleFavorite:r})=>{const o=Fe(),s=L(()=>n.includes(t),[t,n]);return e("div",{className:"vm-query-history-item",children:[e("span",{className:"vm-query-history-item__value",children:t}),e("div",{className:"vm-query-history-item__buttons",children:[e(Y,{title:"Execute query",children:e(P,{size:"small",variant:"text",onClick:()=>{a(t)},startIcon:e(Bn,{})})}),e(Y,{title:"Copy query",children:e(P,{size:"small",variant:"text",onClick:async()=>{await o(t,"Query has been copied")},startIcon:e(Xe,{})})}),e(Y,{title:s?"Remove Favorite":"Add to Favorites",children:e(P,{size:"small",variant:"text",color:s?"warning":"primary",onClick:()=>{r(t,s)},startIcon:s?e(ts,{}):e(es,{})})})]})]})},wt={session:"session",storage:"saved",favorite:"favorite"},eo=[{label:"Session history",value:wt.session},{label:"Saved history",value:wt.storage},{label:"Favorite queries",value:wt.favorite}],vc=({handleSelectQuery:t})=>{const{queryHistory:n}=Ee(),{isMobile:a}=W(),{value:r,setTrue:o,setFalse:s}=se(!1),[i,c]=C(eo[0].value),[l,m]=C($t("QUERY_HISTORY")),[d,u]=C($t("QUERY_FAVORITES")),h=L(()=>n.map(w=>w.values.filter(S=>S).reverse()),[n]),p=L(()=>{switch(i){case wt.favorite:return d;case wt.storage:return l;default:return h}},[i,d,l,h]),v=p==null?void 0:p.every(w=>!w.length),b=L(()=>{switch(i){case wt.favorite:return`Favorites queries are empty.
To see your favorites, mark a query as a favorite.`;default:return`Query history is empty.
To see the history, please make a query.`}},[i]),f=w=>S=>{t(S,w),s()},g=(w,S)=>{u(N=>{const k=N[0]||[];return S?[k.filter(T=>T!==w)]:!S&&!k.includes(w)?[[...k,w]]:N})},_=()=>{m($t("QUERY_HISTORY")),u($t("QUERY_FAVORITES"))},y=()=>{Te("QUERY_HISTORY","")};return A(()=>{const w=d[0]||[],S=$t("QUERY_FAVORITES")[0]||[];Jn(w,S)||Te("QUERY_FAVORITES",JSON.stringify(d))},[d]),ce("storage",_),e(U,{children:[e(Y,{title:"Show history",children:e(P,{color:"primary",variant:"text",onClick:o,startIcon:e(en,{}),ariaLabel:"Show history"})}),r&&e(Pe,{title:"Query history",onClose:s,children:e("div",{className:D({"vm-query-history":!0,"vm-query-history_mobile":a}),children:[e("div",{className:D({"vm-query-history__tabs":!0,"vm-section-header__tabs":!0,"vm-query-history__tabs_mobile":a}),children:e(Yt,{activeItem:i,items:eo,onChange:c})}),e("div",{className:"vm-query-history-list",children:[v&&e("div",{className:"vm-query-history-list__no-data",children:b}),p.map((w,S)=>e("div",{children:[p.length>1&&e("div",{className:D({"vm-query-history-list__group-title":!0,"vm-query-history-list__group-title_first":S===0}),children:["Query ",S+1]}),w.map((N,k)=>e(gc,{query:N,favorites:d.flat(),onRun:f(S),onToggleFavorite:g},k))]},S)),i===wt.storage&&!v&&e("div",{className:"vm-query-history-footer",children:e(P,{color:"error",variant:"outlined",size:"small",startIcon:e(jn,{}),onClick:y,children:"clear history"})})]})]})})]})},qe=({containerStyles:t,message:n})=>{const{isDarkTheme:a}=re();return e("div",{className:D({"vm-spinner":!0,"vm-spinner_dark":a}),style:t,children:[e("div",{className:"half-circle-spinner",children:[e("div",{className:"circle circle-1"}),e("div",{className:"circle circle-2"})]}),n&&e("div",{className:"vm-spinner__message",children:n})]})},fc=()=>{const{serverUrl:t}=re(),{isMobile:n}=W(),{value:a,setTrue:r,setFalse:o}=se(!1),{query:s}=Ee(),{period:i}=he(),[c,l]=C(!1),[m,d]=C(""),[u,h]=C(""),[p,v]=C(""),b=async()=>{l(!0);try{const g=encodeURIComponent(s[0]||""),_=encodeURIComponent(i.step||sn(i.end-i.start,!1)),y=`${t}/api/vmanomaly/config.yaml?query=${g}&step=${_}`,w=await fetch(y),S=w.headers.get("Content-Type");if(w.ok)if(S=="application/yaml"){const N=await w.blob(),k=await N.text();d(k),h(URL.createObjectURL(N))}else v("Response Content-Type is not YAML, does `Server URL` point to VMAnomaly server?");else{const N=await w.text();v(` ${w.status} ${w.statusText}: ${N}`)}}catch(g){console.error(g),v(String(g))}l(!1)};return e(U,{children:[e(P,{color:"secondary",variant:"outlined",onClick:()=>(r(),v(""),URL.revokeObjectURL(u),d(""),h(""),b()),children:"Open Config"}),a&&e(Pe,{title:"Download config",onClose:o,children:e("div",{className:D({"vm-anomaly-config":!0,"vm-anomaly-config_mobile":n}),children:[c&&e(qe,{containerStyles:{position:"relative"},message:"Loading config..."}),!c&&p&&e("div",{className:"vm-anomaly-config-error",children:[e("div",{className:"vm-anomaly-config-error__icon",children:e(Qa,{})}),e("h3",{className:"vm-anomaly-config-error__title",children:"Cannot download config"}),e("p",{className:"vm-anomaly-config-error__text",children:p})]}),!c&&m&&e(le,{value:m,label:"config.yaml",type:"textarea",disabled:!0}),e("div",{className:"vm-anomaly-config-footer",children:u&&e("a",{href:u,download:"config.yaml",children:e(P,{variant:"contained",startIcon:e(Gn,{}),children:"download"})})})]})})]})},_r=({value:t,options:n,anchor:a,disabled:r,minLength:o=2,fullWidth:s,selected:i,noOptionsText:c,label:l,disabledFullScreen:m,offset:d,maxDisplayResults:u,loading:h,onSelect:p,onOpenAutocomplete:v,onFoundOptions:b,onChangeWrapperRef:f})=>{var de;const{isMobile:g}=W(),_=Q(null),[y,w]=C({index:-1}),[S,N]=C(""),[k,T]=C(0),{value:x,setValue:M,setFalse:E}=se(!1),I=L(()=>{if(!x)return[];try{const G=new RegExp(String(t.trim()),"i"),K=n.filter(R=>G.test(R.value)).sort((R,F)=>{var q,Z;return R.value.toLowerCase()===t.trim().toLowerCase()?-1:F.value.toLowerCase()===t.trim().toLowerCase()?1:(((q=R.value.match(G))==null?void 0:q.index)||0)-(((Z=F.value.match(G))==null?void 0:Z.index)||0)});return T(K.length),N(K.length>Number(u==null?void 0:u.limit)&&(u==null?void 0:u.message)||""),u!=null&&u.limit?K.slice(0,u.limit):K}catch{return[]}},[x,n,t]),$=L(()=>{var G;return I.length===1&&((G=I[0])==null?void 0:G.value)===t},[I]),O=L(()=>c&&!I.length,[c,I]),V=G=>()=>{r||(p(G.value,G),i||E())},z=G=>()=>{w({index:G,type:0})},j=()=>{w({index:-1})},H=()=>{if(!_.current||y.type===0)return;const G=_.current.childNodes[y.index];G!=null&&G.scrollIntoView&&G.scrollIntoView({block:"center"})},te=X(G=>{const{key:oe,ctrlKey:K,metaKey:R,shiftKey:F}=G,q=K||R||F,Z=I.length&&!$;if(oe==="ArrowUp"&&!q&&Z&&(G.preventDefault(),w(({index:ee})=>({index:ee<=0?0:ee-1,type:1}))),oe==="ArrowDown"&&!q&&Z){G.preventDefault();const ee=I.length-1;w(({index:ue})=>({index:ue>=ee?ee:ue+1,type:1}))}if(oe==="Enter"){const ee=I[y.index];ee&&p(ee.value,ee),i||E()}oe==="Escape"&&E()},[y,I,$,E,p,i]);return A(()=>{M(t.length>=o)},[t,n]),ce("keydown",te),A(H,[y,I]),A(()=>{w({index:-1})},[I]),A(()=>{v&&v(x)},[x]),A(()=>{b&&b($?[]:I)},[I,$]),A(()=>{f&&f(_)},[_]),e(Ie,{open:x,buttonRef:a,placement:"bottom-left",onClose:E,fullWidth:s,title:g?l:void 0,disabledFullScreen:m,offset:d,children:[e("div",{className:D({"vm-autocomplete":!0,"vm-autocomplete_mobile":g&&!m}),ref:_,children:[h&&e("div",{className:"vm-autocomplete__loader",children:[e(qn,{}),e("span",{children:"Loading..."})]}),O&&e("div",{className:"vm-autocomplete__no-options",children:c}),!$&&I.map((G,oe)=>e("div",{className:D({"vm-list-item":!0,"vm-list-item_mobile":g,"vm-list-item_active":oe===y.index,"vm-list-item_multiselect":i,"vm-list-item_multiselect_selected":i==null?void 0:i.includes(G.value),"vm-list-item_with-icon":G.icon}),id:`$autocomplete$${G.value}`,onClick:V(G),onMouseEnter:z(oe),onMouseLeave:j,children:[(i==null?void 0:i.includes(G.value))&&e(Qn,{}),e(U,{children:G.icon}),e("span",{children:G.value})]},`${oe}${G.value}`))]}),S&&e("div",{className:"vm-autocomplete-message",children:["Shown ",u==null?void 0:u.limit," results out of ",k,". ",S]}),((de=I[y.index])==null?void 0:de.description)&&e("div",{className:"vm-autocomplete-info",children:[e("div",{className:"vm-autocomplete-info__type",children:I[y.index].type}),e("div",{className:"vm-autocomplete-info__description",dangerouslySetInnerHTML:{__html:I[y.index].description||""}})]})]})},Pn=t=>t.replace(/[/\-\\^$*+?.()|[\]{}]/g,"\\$&"),gn=t=>JSON.stringify(t).slice(1,-1),ws=t=>{const n=t.match(/["`']/g);return n?n.length%2!==0:!1},_c={metric:e(Dn,{}),label:e(Xa,{}),labelValue:e(In,{})},bc=({valueByContext:t,metric:n,label:a,context:r})=>{const{serverUrl:o}=re(),{period:{start:s,end:i}}=he(),{autocompleteCache:c}=Ee(),l=Qt(),[m,d]=C(!1),[u,h]=C(t),p=Fn(h,500);A(()=>(p(t),p.cancel),[t,p]);const[v,b]=C([]),[f,g]=C([]),[_,y]=C([]),w=Q(new AbortController),S=X(T=>{const x=B(s*1e3).startOf("day").valueOf()/1e3,M=B(i*1e3).endOf("day").valueOf()/1e3;return new URLSearchParams({...T||{},limit:`${St.queryLimit}`,start:`${x}`,end:`${M}`})},[s,i]),N=(T,x)=>T.map(M=>({value:M,type:`${x}`,icon:_c[x]})),k=async({value:T,urlSuffix:x,setter:M,type:E,params:I})=>{if(!T&&E==="metric")return;w.current.abort(),w.current=new AbortController;const{signal:$}=w.current,O={type:E,value:T,start:(I==null?void 0:I.get("start"))||"",end:(I==null?void 0:I.get("end"))||"",match:(I==null?void 0:I.get("match[]"))||""};d(!0);try{const V=c.get(O);if(V){M(N(V,E)),d(!1);return}const z=await fetch(`${o}/api/v1/${x}?${I}`,{signal:$});if(z.ok){const{data:j}=await z.json();M(N(j,E)),l({type:"SET_AUTOCOMPLETE_CACHE",payload:{key:O,value:j}})}d(!1)}catch(V){V instanceof Error&&V.name!=="AbortError"&&(l({type:"SET_AUTOCOMPLETE_CACHE",payload:{key:O,value:[]}}),d(!1),console.error(V))}};return A(()=>{const T=r!==Le.metricsql&&r!==Le.empty;if(!o||!n||T)return;b([]);const x=gn(Pn(n));return k({value:u,urlSuffix:"label/__name__/values",setter:b,type:"metric",params:S({"match[]":`{__name__=~".*${x}.*"}`})}),()=>{var M;return(M=w.current)==null?void 0:M.abort()}},[o,u,r,n]),A(()=>{if(!o||r!==Le.label)return;g([]);const T=gn(n);return k({value:u,urlSuffix:"labels",setter:g,type:"label",params:S(n?{"match[]":`{__name__="${T}"}`}:void 0)}),()=>{var x;return(x=w.current)==null?void 0:x.abort()}},[o,u,r,n]),A(()=>{if(!o||!a||r!==Le.labelValue)return;y([]);const T=gn(n),x=gn(Pn(u)),M=n?`__name__="${T}"`:"",E=`${a}=~".*${x}.*"`,I=[M,E].filter(Boolean).join(",");return k({value:u,urlSuffix:`label/${a}/values`,setter:y,type:"labelValue",params:S({"match[]":`{${I}}`})}),()=>{var $;return($=w.current)==null?void 0:$.abort()}},[o,u,r,n,a]),{metrics:v,labels:f,labelValues:_,loading:m}},yc=""+new URL("MetricsQL-DGylhASK.md",import.meta.url).href,Cs="h3",wc="h4",Cc="p",Nc="https://docs.victoriametrics.com/metricsql/",kc="vm-link vm-link_colored",Sc=t=>{const n=`$1 target="_blank" class="${kc}" $2${Nc}#`;return t.replace(/(<a) (href=")#/gm,n)},Tc=t=>{const n=[];let a=t.nextElementSibling;for(;a&&a.tagName.toLowerCase()===Cc;)a&&n.push(a),a=a.nextElementSibling;return n},Ac=(t,n)=>{const a=n.textContent??"",o=Tc(n).map(s=>s.outerHTML??"").join(`
`);return{type:t,value:a,description:Sc(o),icon:e(Yn,{})}},xc=t=>{let n="";return Array.from(t).map(a=>{const r=a.tagName.toLowerCase()===Cs;return n=r?a.textContent??"":n,r?null:Ac(n,a)}).filter(Boolean)},Ec=t=>{const{metricsQLFunctions:n}=Ee(),a=Qt(),r=o=>{const s=document.createElement("div");s.innerHTML=qt(o);const i=s.querySelectorAll(`${Cs}, ${wc}`);return xc(i)};return A(()=>{if(!t||n.length)return;(async()=>{try{const i=await(await fetch(yc)).text(),c=r(i);a({type:"SET_METRICSQL_FUNCTIONS",payload:c})}catch(s){console.error("Error fetching or processing the MetricsQL.md file:",s)}})()},[]),t?n:[]};function Lc(t){const n=/\s(or|and|unless|default|ifnot|if|group_left|group_right)\s|}|\+|\|-|\*|\/|\^/i,a=t.split(n),r=a[a.length-1].trim(),o=/.*\(([^)]*)$/,s=r.match(o);if(s&&s[1]){const i=s[1];if(i.lastIndexOf("{")>i.lastIndexOf("}")){const l=i.match(/([\w_.:]+)\{[^}]*$/);return l?l[0]:r}const c=i.lastIndexOf(",");return c!==-1?i.substring(c+1).trim():i}return r}function Mc(t){const n=t.match(/([\w_.:]+(?![},]))$/);return n?n[0]:""}function Dc(t){const n=/([{(),+\-*/^]|\b(?:or|and|unless|default|ifnot|if|group_left|group_right|by|without|on|ignoring)\b)/i,a=t.split(/\s+/),r=a.length,o=a[r-1],s=a[r-2],i=!o&&ws(t),c=(!o||a.length>1)&&!n.test(s);return i||c}function Ic(t,n="",a=""){const r=t.trim(),o=["}",")"].some(m=>r.endsWith(m)),s=!ws(r)&&["`","'",'"'].some(m=>r.endsWith(m));if(!r||o||s||Dc(r))return Le.empty;const i=/(?:by|without|on|ignoring)\s*\(\s*[^)]*$|\{[^}]*$/i,c=`(${Pn(n)})?{?.+${Pn(a)}(=|!=|=~|!~)"?([^"]*)$`,l=new RegExp(c,"g");switch(!0){case l.test(r):return Le.labelValue;case i.test(r):return Le.label;default:return Le.metricsql}}const Pc=({value:t,anchorEl:n,caretPosition:a,hasHelperText:r,includeFunctions:o,onSelect:s,onFoundOptions:i})=>{const[c,l]=C({top:0,left:0}),m=Ec(o),d=L(()=>{if(a[0]!==a[1])return{beforeCursor:t,afterCursor:""};const N=t.substring(0,a[0]),k=t.substring(a[1]);return{beforeCursor:N,afterCursor:k}},[t,a]),u=L(()=>Lc(d.beforeCursor),[d]),h=L(()=>{const N=/\w+\((?<metricName>[^)]+)\)\s+(by|without|on|ignoring)\s*\(\w*/gi,k=[...u.matchAll(N)];if(k.length>0&&k[0].groups&&k[0].groups.metricName)return k[0].groups.metricName;const T=/^\s*\b(?<metricName>[^{}(),\s]+)(?={|$)/g,x=[...u.matchAll(T)];return x.length>0&&x[0].groups&&x[0].groups.metricName?x[0].groups.metricName:""},[u]),p=L(()=>{const N=/[a-z_:-][\w\-.:/]*\b(?=\s*(=|!=|=~|!~))/g,k=u.match(N);return k?k[k.length-1]:""},[u]),v=L(()=>Ic(d.beforeCursor,h,p),[d,h,p]),b=L(()=>Mc(d.beforeCursor),[d.beforeCursor]),{metrics:f,labels:g,labelValues:_,loading:y}=bc({valueByContext:b,metric:h,label:p,context:v}),w=L(()=>{switch(v){case Le.metricsql:return[...f,...m];case Le.label:return g;case Le.labelValue:return _;default:return[]}},[v,f,g,_]),S=X(N=>{const k=d.beforeCursor;let T=d.afterCursor;const x=k.lastIndexOf(b,a[0]),M=x+b.length,E=k.substring(0,x),I=k.substring(M);if(v===Le.labelValue){const O='"';T=T.replace(/^[^\s"|},]*/,"");const V=/(?:=|!=|=~|!~)$/.test(E),z=T.trim()[0]!=='"';N=`${V?O:""}${N}${z?O:""}`}v===Le.label&&(T=T.replace(/^[^\s=!,{}()"|+\-/*^]*/,"")),v===Le.metricsql&&(T=T.replace(/^[^\s[\]{}()"|+\-/*^]*/,""));const $=`${E}${N}${I}${T}`;s($,E.length+N.length)},[d]);return A(()=>{if(!n.current){l({top:0,left:0});return}const N=n.current.querySelector("textarea")||n.current,k=window.getComputedStyle(N),T=`${k.getPropertyValue("font-size")}`,x=`${k.getPropertyValue("font-family")}`,M=parseInt(`${k.getPropertyValue("line-height")}`),E=document.createElement("div");E.style.font=`${T} ${x}`,E.style.padding=k.getPropertyValue("padding"),E.style.lineHeight=`${M}px`,E.style.width=`${N.offsetWidth}px`,E.style.maxWidth=`${N.offsetWidth}px`,E.style.whiteSpace=k.getPropertyValue("white-space"),E.style.overflowWrap=k.getPropertyValue("overflow-wrap");const I=document.createElement("span");E.appendChild(document.createTextNode(d.beforeCursor)),E.appendChild(I),E.appendChild(document.createTextNode(d.afterCursor)),document.body.appendChild(E);const $=E.getBoundingClientRect(),O=I.getBoundingClientRect(),V=O.left-$.left,z=O.bottom-$.bottom-(r?M:0);l({top:z,left:V}),E.remove(),I.remove()},[n,a,r]),e(U,{children:e(_r,{loading:y,disabledFullScreen:!0,value:b,options:w,anchor:n,minLength:0,offset:c,onSelect:S,onFoundOptions:i,maxDisplayResults:{limit:St.displayResults,message:"Please, specify the query more precisely."}})})},br=({queryErrors:t,setQueryErrors:n,setHideError:a,stats:r,label:o,isLoading:s,includeFunctions:i=!0,onHideQuery:c,onRunQuery:l,abortFetch:m,hideButtons:d})=>{const{isMobile:u}=W(),{query:h,queryHistory:p,autocomplete:v,autocompleteQuick:b}=Ee(),f=Qt(),g=Ve(),[_,y]=C(h||[]),[w,S]=C([]),[N,k]=C(!1),T=nn(_),x=hc(),M=()=>{f({type:"SET_QUERY_HISTORY",payload:_.map((K,R)=>{const F=p[R]||{values:[]},q=K===F.values[F.values.length-1],Z=!q&&K?[...F.values,K]:F.values;return Z.length>Mo&&Z.shift(),{index:F.values.length-Number(q),values:Z}})})},E=()=>{if(s){m&&m();return}M(),f({type:"SET_QUERY",payload:_}),g({type:"RUN_QUERY"}),l()},I=()=>{y(K=>[...K,""])},$=K=>{y(R=>R.filter((F,q)=>q!==K))},O=(K,R)=>{const{ctrlKey:F,metaKey:q}=K;if(F||q){const ee=_.map((ue,_e)=>_e).filter(ue=>ue!==R);S(ue=>Jn(ee,ue)?[]:ee)}else S(ee=>ee.includes(R)?ee.filter(ue=>ue!==R):[...ee,R])},V=(K,R)=>{y(F=>F.map((q,Z)=>Z===R?K:q))},z=(K,R)=>{V(K,R),k(!0)},j=(K,R)=>{const{index:F,values:q}=p[R],Z=F+K;Z<0||Z>=q.length||(V(q[Z]||"",R),f({type:"SET_QUERY_HISTORY_BY_INDEX",payload:{value:{values:q,index:Z},queryNumber:R}}))},H=(K,R)=>()=>{j(K,R)},te=K=>R=>{V(R,K),f({type:"SET_AUTOCOMPLETE_QUICK",payload:!1})},de=K=>()=>{$(K),S(R=>R.includes(K)?R.filter(F=>F!==K):R.map(F=>F>K?F-1:F))},G=K=>R=>{O(R,K)},oe=async K=>{const R=await x(_[K]);a(!1),V(R.query,K),n(F=>(F[K]=R.error,[...F]))};return A(()=>{T&&_.length<T.length&&E()},[_]),A(()=>{c&&c(w)},[w]),A(()=>{N&&(E(),k(!1))},[_,N]),A(()=>{y(h||[])},[h]),e("div",{className:D({"vm-query-configurator":!0,"vm-block":!0,"vm-block_mobile":u}),children:[e("div",{className:"vm-query-configurator-list",children:_.map((K,R)=>e("div",{className:D({"vm-query-configurator-list-row":!0,"vm-query-configurator-list-row_disabled":w.includes(R),"vm-query-configurator-list-row_mobile":u}),children:[e(bs,{value:_[R],autocomplete:!(d!=null&&d.autocomplete)&&(v||b),autocompleteEl:Pc,error:t[R],stats:r[R],onArrowUp:H(-1,R),onArrowDown:H(1,R),onEnter:E,onChange:te(R),label:`${o||"Query"} ${_.length>1?R+1:""}`,disabled:w.includes(R),includeFunctions:i}),c&&e(Y,{title:w.includes(R)?"Enable query":"Disable query",children:e("div",{className:"vm-query-configurator-list-row__button",children:e(P,{variant:"text",color:"gray",startIcon:w.includes(R)?e(Wa,{}):e(Ht,{}),onClick:G(R),ariaLabel:"visibility query"})})}),!(d!=null&&d.prettify)&&e(Y,{title:"Prettify query",children:e("div",{className:"vm-query-configurator-list-row__button",children:e(P,{variant:"text",color:"gray",startIcon:e(Ko,{}),onClick:async()=>await oe(R),className:"prettify",ariaLabel:"prettify the query"})})}),_.length>1&&e(Y,{title:"Remove Query",children:e("div",{className:"vm-query-configurator-list-row__button",children:e(P,{variant:"text",color:"error",startIcon:e(jn,{}),onClick:de(R),ariaLabel:"remove query"})})})]},R))}),e("div",{className:"vm-query-configurator-settings",children:[e(uc,{hideButtons:d}),e("div",{className:"vm-query-configurator-settings__buttons",children:[e(vc,{handleSelectQuery:z}),(d==null?void 0:d.anomalyConfig)&&e(fc,{}),!(d!=null&&d.addQuery)&&_.length<Sn&&e(P,{variant:"outlined",onClick:I,startIcon:e(Ga,{}),children:"Add Query"}),e(P,{variant:"contained",onClick:E,startIcon:s?e(nr,{}):e(dt,{}),children:`${s?"Cancel":"Execute"} ${u?"":"Query"}`})]})]})]})},$c=(t,n,a,r,o)=>`${t}/api/v1/query_range?query=${encodeURIComponent(n)}&start=${a.start}&end=${a.end}&step=${a.step}${r?"&nocache=1":""}${o?"&trace=1":""}`,Oc=(t,n,a,r,o)=>`${t}/api/v1/query?query=${encodeURIComponent(n)}&time=${a.end}&step=${a.step}${r?"&nocache=1":""}${o?"&trace=1":""}`,Rc=(t,n,a,r)=>{const o=new URLSearchParams({"match[]":n,start:a.start.toString(),end:a.end.toString()});return r&&o.set("reduce_mem_usage","1"),`${t}/api/v1/export?${o}`};let Fc=0;class At{constructor(n,a){Ye(this,"tracing");Ye(this,"query");Ye(this,"tracingChildren");Ye(this,"originalTracing");Ye(this,"id");this.tracing=n,this.originalTracing=JSON.parse(JSON.stringify(n)),this.query=a,this.id=Fc++;const r=n.children||[];this.tracingChildren=r.map(o=>new At(o,a))}get queryValue(){return this.query}get idValue(){return this.id}get children(){return this.tracingChildren}get message(){return this.tracing.message}get duration(){return this.tracing.duration_msec}get JSON(){return JSON.stringify(this.tracing,null,2)}get originalJSON(){return JSON.stringify(this.originalTracing,null,2)}setTracing(n){this.tracing=n;const a=n.children||[];this.tracingChildren=a.map(r=>new At(r,this.query))}setQuery(n){this.query=n}resetTracing(){this.tracing=this.originalTracing}}const ka=(t,n,a=!0)=>{const{__name__:r,...o}=t.metric,s=a?`[Query ${t.group}] `:"";if(n)return Ns(t.metric,n);const i=`${s}${r||""}`;if(Object.keys(o).length===0)return i||"value";const c=Object.entries(o).map(([l,m])=>`${l}=${JSON.stringify(m)}`).join(", ");return`${i}{${c}}`},Ns=(t,n)=>n.replace(/\{\{(\w+)}}/g,(a,r)=>t[r]||""),an=t=>{switch(t){case"NaN":return NaN;case"Inf":case"+Inf":return 1/0;case"-Inf":return-1/0;default:return parseFloat(t)}},yr=t=>{if(t.length<2)return!1;const n=["le","vmrange"],a=Object.keys(t[0].metric).filter(o=>!n.includes(o));return t.every(o=>{const s=Object.keys(o.metric).filter(i=>!n.includes(i));return a.length===s.length&&s.every(i=>o.metric[i]===t[0].metric[i])})&&t.every(o=>n.some(s=>s in o.metric))},Zn=({predefinedQuery:t,visible:n,display:a,customStep:r,hideQuery:o,showAllSeries:s})=>{const{query:i}=Ee(),{period:c}=he(),{displayType:l,nocache:m,isTracingEnabled:d,seriesLimits:u}=Ue(),{serverUrl:h}=re(),{isHistogram:p}=Re(),[v,b]=C(!1),[f,g]=C(),[_,y]=C(),[w,S]=C(),[N,k]=C(),[T,x]=C([]),[M,E]=C([]),[I,$]=C(),[O,V]=C([]),[z,j]=C(!1),H=L(()=>{const{end:F,start:q}=c;return sn(F-q,p,l)},[c,p,l]),de=X(Fn(async({fetchUrl:F,fetchQueue:q,displayType:Z,query:ee,stateSeriesLimits:ue,showAllSeries:_e,hideQuery:We})=>{const Ne=new AbortController;V([...q,Ne]);try{const ze=Z===we.chart,$e=_e?1/0:+ue[Z]||1/0;let Ke=$e;const fe=[],Dt=[];let et=1,_t=0,Kt=!1;for await(const ut of F){if(We==null?void 0:We.includes(et-1)){x(ht=>[...ht,""]),E(ht=>[...ht,{}]),et++;continue}const oa=new URL(ut),Ur=await fetch(`${oa.origin}${oa.pathname}`,{signal:Ne.signal,method:"POST",body:oa.searchParams}),pe=await Ur.json();if(Ur.ok){if(E(Je=>[...Je,{...pe==null?void 0:pe.stats,isPartial:pe==null?void 0:pe.isPartial,resultLength:pe.data.result.length}]),x(Je=>[...Je,""]),pe.trace){const Je=new At(pe.trace,ee[et-1]);Dt.push(Je)}const ht=!!Oe("display_mode",null);Kt=!yi&&ze&&!ht&&yr(pe.data.result),Ke=Kt?1/0:$e;const sa=Ke-fe.length;pe.data.result.slice(0,sa).forEach(Je=>{Je.group=et,fe.push(Je)}),_t+=pe.data.result.length}else{fe.push({metric:{},values:[],group:et});const ht=pe.errorType||be.unknownType,sa=(pe==null?void 0:pe.error)||(pe==null?void 0:pe.message)||"see console for more details",Je=[ht,sa].join(`,\r
`);x(di=>[...di,`${Je}`]),console.error(`Fetch query error: ${ht}`,pe)}et++}const It=`Showing ${fe.length} series out of ${_t} series due to performance reasons. Please narrow down the query, so it returns less series`;$(_t>Ke?It:""),ze?g(fe):y(fe),S(Dt),j(ut=>_t?Kt:ut)}catch(ze){const $e=ze;if($e.name==="AbortError"){b(!1);return}let fe=`Error executing query: ${$e.message}. Please check your serverURL settings and confirm server availability.`;$e.message==="Unexpected end of JSON input"&&(fe+=`
Additionally, this error can occur if the server response is too large to process. Apply more specific filters to reduce the data volume.`),k(fe)}b(!1)},300),[]),G=L(()=>{k(""),x([]),E([]);const F=t??i,q=(a||l)===we.chart;if(c)if(!h)k(be.emptyServer);else if(F.every(Z=>!Z.trim()))x(F.map(()=>be.validQuery));else if(Oa(h)){const Z={...c};return Z.step=r,F.map(ee=>q?$c(h,ee,Z,m,d):Oc(h,ee,Z,m,d))}else k(be.validServer)},[h,c,l,r,o]),oe=X(()=>{O.map(F=>F.abort()),V([]),g([]),y([])},[O]),[K,R]=C([]);return A(()=>{const F=G===K&&!!t;if(!n||!(G!=null&&G.length)||F)return;b(!0),de({fetchUrl:G,fetchQueue:O,displayType:a||l,query:t??i,stateSeriesLimits:u,showAllSeries:s,hideQuery:o}),R(G)},[G,n,u,s]),A(()=>{const F=O.slice(0,-1);F.length&&(F.map(q=>q.abort()),V(O.filter(q=>!q.signal.aborted)))},[O]),A(()=>{H===r&&g([])},[z]),{fetchUrl:G,isLoading:v,graphData:f,liveData:_,error:N,queryErrors:T,setQueryErrors:x,queryStats:M,warning:I,traces:w,isHistogram:z,abortFetch:oe}},Xn=()=>e("div",{className:"vm-line-loader",children:[e("div",{className:"vm-line-loader__background"}),e("div",{className:"vm-line-loader__line"})]}),wr=()=>{const{tenantId:t}=re(),{displayType:n}=Ue(),{query:a}=Ee(),{duration:r,relativeTime:o,period:{date:s,step:i}}=he(),{customStep:c}=Re(),[l,m]=ae(),d=Et(),u=Ve(),h=mt(),p=Qt(),v=Gt(),[b,f]=C(!1),g=X(()=>{if(b){f(!1);return}const _=new URLSearchParams(l);a.forEach((w,S)=>{var x;const N=`g${S}`;l.get(`${N}.expr`)!==w&&w&&_.set(`${N}.expr`,w),l.get(`${N}.range_input`)!==r&&_.set(`${N}.range_input`,r),l.get(`${N}.end_input`)!==s&&_.set(`${N}.end_input`,s),l.get(`${N}.relative_time`)!==o&&_.set(`${N}.relative_time`,o||"none");const k=l.get(`${N}.step_input`)||i;k&&k!==c&&_.set(`${N}.step_input`,c);const T=`${((x=Ft.find(M=>M.value===n))==null?void 0:x.prometheusCode)||0}`;l.get(`${N}.tab`)!==T&&_.set(`${N}.tab`,`${T}`),l.get(`${N}.tenantID`)!==t&&t&&_.set(`${N}.tenantID`,t)});const y=a.length-1;Array.from(_.keys()).forEach(w=>{const S=w.match(/^g(\d+)\./);S&&parseInt(S[1],10)>y&&_.delete(w)}),!(Ni(_,l)||!_.size)&&m(_)},[t,n,a,r,o,s,i,c]);A(()=>{const _=setTimeout(g,200);return()=>clearTimeout(_)},[g]),A(()=>{if(!b)return;const _=Vo(),y=_.duration!==r,w=_.relativeTime!==o,S=_.relativeTime==="none"&&_.period.date!==s;(y||w||S)&&u({type:"SET_TIME_STATE",payload:_});const k=os();k!==n&&v({type:"SET_DISPLAY_TYPE",payload:k});const T=l.get("g0.tenantID")||"";T!==t&&d({type:"SET_TENANT_ID",payload:T});const x=Io();Jn(x,a)||(p({type:"SET_QUERY",payload:x}),u({type:"RUN_QUERY"}));const M=setTimeout(()=>{const E=l.get("g0.step_input")||i;E&&E!==c&&h({type:"SET_CUSTOM_STEP",payload:E})},50);return()=>clearTimeout(M)},[l,b]),ce("popstate",()=>{f(!0)})},zc=e(Se,{text:"last_over_time",href:"https://docs.victoriametrics.com/metricsql/#last_over_time",underlined:!0}),Hc=e(Se,{text:"instant query",href:"https://docs.victoriametrics.com/keyconcepts/#instant-query",underlined:!0}),Vc=()=>{const{customStep:t}=Re();return e("div",{children:[e("p",{children:["This tab shows ",Hc," results for the last ",t||"5m"," (defined by the ",e("code",{children:"step"}),") ending at the selected time range."]}),e("p",{children:["Please wrap the query into ",zc," if you need results over arbitrary lookbehind interval."]})]})},ks=({value:t,hideValue:n})=>e("div",{className:"vm-line-progress",children:[e("div",{className:"vm-line-progress-track",children:e("div",{className:"vm-line-progress-track__thumb",style:{width:`${t}%`}})}),!n&&e("span",{children:[t.toFixed(2),"%"]})]}),Ss=({isRoot:t,trace:n,totalMsec:a,isExpandedAll:r})=>{const{isDarkTheme:o}=re(),{isMobile:s}=W(),[i,c]=C({}),l=Q(null),[m,d]=C(!1),[u,h]=C(!1),p=Ha(n.duration/1e3)||`${n.duration}ms`;A(()=>{if(!l.current)return;const y=l.current,w=l.current.children[0],{height:S}=w.getBoundingClientRect();d(S>y.clientHeight)},[n]);const v=y=>{y.stopPropagation(),h(w=>!w)},b=n.children&&!!n.children.length,f=n.duration/a*100,g=y=>()=>{b&&c(w=>({...w,[y]:!w[y]}))},_=y=>{var S;const w=[y.idValue];return(S=y==null?void 0:y.children)==null||S.forEach(N=>{w.push(..._(N))}),w};return A(()=>{if(!r){c([]);return}const y=_(n),w={};y.forEach(S=>{w[S]=!0}),c(w)},[r]),e("div",{className:D({"vm-nested-nav":!0,"vm-nested-nav_root":t,"vm-nested-nav_dark":o,"vm-nested-nav_mobile":s}),children:[e("div",{className:D({"vm-nested-nav-header":!0,"vm-nested-nav-header_open":i[n.idValue]}),onClick:g(n.idValue),children:[b&&e("div",{className:D({"vm-nested-nav-header__icon":!0,"vm-nested-nav-header__icon_open":i[n.idValue]}),children:e(ve,{})}),e("div",{className:"vm-nested-nav-header__progress",children:e(ks,{value:f})}),e("div",{className:D({"vm-nested-nav-header__message":!0,"vm-nested-nav-header__message_show-full":u}),ref:l,children:[e("span",{className:"vm-nested-nav-header__message_duration",children:p}),": ",e("span",{children:n.message})]}),e("div",{className:"vm-nested-nav-header-bottom",children:(m||u)&&e(P,{variant:"text",size:"small",onClick:v,children:u?"Hide":"Show full query"})})]}),i[n.idValue]&&e("div",{className:"vm-nested-nav__childrens",children:b&&n.children.map(y=>e(Ss,{trace:y,totalMsec:a,isExpandedAll:r},y.duration))})]})},Ts=({editable:t=!1,defaultTile:n="JSON",displayTitle:a=!0,defaultJson:r="",resetValue:o="",onClose:s,onUpload:i})=>{const c=Fe(),{isMobile:l}=W(),[m,d]=C(r),[u,h]=C(n),[p,v]=C(""),[b,f]=C(""),g=L(()=>{try{const k=JSON.parse(m),T=k.trace||k;return T.duration_msec?(new At(T,""),""):be.traceNotFound}catch(k){return k instanceof Error?k.message:"Unknown error"}},[m]),_=k=>{h(k)},y=k=>{f(""),d(k)},w=async()=>{await c(m,"Formatted JSON has been copied")},S=()=>{d(o)},N=()=>{f(g),u.trim()||v(be.emptyTitle),!(g||p)&&(i(m,u),s())};return e("div",{className:D({"vm-json-form":!0,"vm-json-form_one-field":!a,"vm-json-form_one-field_mobile":!a&&l,"vm-json-form_mobile":l}),children:[a&&e(le,{value:u,label:"Title",error:p,onEnter:N,onChange:_}),e(le,{value:m,label:"JSON",type:"textarea",error:b,autofocus:!0,onChange:y,onEnter:N,disabled:!t}),e("div",{className:"vm-json-form-footer",children:[e("div",{className:"vm-json-form-footer__controls",children:[e(P,{variant:"outlined",startIcon:e(Xe,{}),onClick:w,children:"Copy JSON"}),o&&e(P,{variant:"text",startIcon:e(at,{}),onClick:S,children:"Reset JSON"})]}),e("div",{className:"vm-json-form-footer__controls vm-json-form-footer__controls_right",children:[e(P,{variant:"outlined",color:"error",onClick:s,children:"Cancel"}),e(P,{variant:"contained",onClick:N,children:"apply"})]})]})]})},Cr=({traces:t,jsonEditor:n=!1,onDeleteClick:a})=>{const{isMobile:r}=W(),[o,s]=C(null),[i,c]=C([]),l=()=>{s(null)},m=(v,b)=>{if(!(!n||!o))try{o.setTracing(JSON.parse(v)),o.setQuery(b),s(null)}catch(f){console.error(f)}};if(!t.length)return e(ie,{variant:"info",children:"Please re-run the query to see results of the tracing"});const d=v=>()=>{a(v)},u=v=>()=>{s(v)},h=v=>()=>{const b=new Blob([v.originalJSON],{type:"application/json"}),f=URL.createObjectURL(b),g=document.createElement("a");g.href=f,g.download=`vmui_trace_${v.queryValue}.json`,document.body.appendChild(g),g.click(),document.body.removeChild(g),URL.revokeObjectURL(f)},p=v=>()=>{c(b=>b.includes(v.idValue)?b.filter(f=>f!==v.idValue):[...b,v.idValue])};return e(U,{children:[e("div",{className:"vm-tracings-view",children:t.map(v=>e("div",{className:"vm-tracings-view-trace vm-block vm-block_empty-padding",children:[e("div",{className:"vm-tracings-view-trace-header",children:[e("h3",{className:"vm-tracings-view-trace-header-title",children:["Trace for ",e("b",{className:"vm-tracings-view-trace-header-title__query",children:v.queryValue})]}),e(Y,{title:i.includes(v.idValue)?"Collapse All":"Expand All",children:e(P,{variant:"text",startIcon:i.includes(v.idValue)?e(tr,{}):e(er,{}),onClick:p(v),ariaLabel:i.includes(v.idValue)?"Collapse All":"Expand All"})}),e(Y,{title:"Save Trace to JSON",children:e(P,{variant:"text",startIcon:e(Gn,{}),onClick:h(v),ariaLabel:"Save trace to JSON"})}),e(Y,{title:"Open JSON",children:e(P,{variant:"text",startIcon:e(Lt,{}),onClick:u(v),ariaLabel:"open JSON"})}),e(Y,{title:"Remove trace",children:e(P,{variant:"text",color:"error",startIcon:e(jn,{}),onClick:d(v),ariaLabel:"remove trace"})})]}),e("nav",{className:D({"vm-tracings-view-trace__nav":!0,"vm-tracings-view-trace__nav_mobile":r}),children:e(Ss,{isRoot:!0,trace:v,totalMsec:v.duration,isExpandedAll:i.includes(v.idValue)})})]},v.idValue))}),o&&e(Pe,{title:o.queryValue,onClose:l,children:e(Ts,{editable:n,displayTitle:n,defaultTile:o.queryValue,defaultJson:o.JSON,resetValue:o.originalJSON,onClose:l,onUpload:m})})]})},Uc=({traces:t,displayType:n})=>{const{isTracingEnabled:a}=Ue(),[r,o]=C([]),s=i=>{const c=r.filter(l=>l.idValue!==i.idValue);o([...c])};return A(()=>{t&&o([...r,...t])},[t]),A(()=>{o([])},[n]),e(U,{children:a&&e("div",{className:"vm-custom-panel__trace",children:e(Cr,{traces:r,onDeleteClick:s})})})},ea=({warning:t,query:n,onChange:a})=>{const{isMobile:r}=W(),{value:o,setTrue:s,setFalse:i}=se(!1);return A(i,[n]),A(()=>{a(o)},[o]),e(ie,{variant:"warning",children:e("div",{className:D({"vm-custom-panel__warning":!0,"vm-custom-panel__warning_mobile":r}),children:[e("p",{children:t}),e(P,{color:"warning",variant:"outlined",onClick:s,children:"Show all"})]})})},Nr=t=>{let n=t.length,a=-1/0;for(;n--;){const r=t[n];Number.isFinite(r)&&r>a&&(a=r)}return Number.isFinite(a)?a:null},kr=t=>{let n=t.length,a=1/0;for(;n--;){const r=t[n];Number.isFinite(r)&&r<a&&(a=r)}return Number.isFinite(a)?a:null},qc=t=>{let n=t[0],a=1;for(let r=1;r<t.length;r++){const o=t[r];Number.isFinite(o)&&(n=n*(a-1)/a+o/a,a++)}return n},Bc=t=>{let n=t.length;const a=[];for(;n--;){const r=t[n];Number.isFinite(r)&&a.push(r)}return a.sort(),a[a.length>>1]},jc=t=>{let n=t.length;for(;n--;){const a=t[n];if(Number.isFinite(a))return a}},Qc=t=>t>=1e9?(t/1e9).toFixed(1).replace(/\.0$/,"")+"B":t>=1e6?(t/1e6).toFixed(1).replace(/\.0$/,"")+"M":t>=1e3?(t/1e3).toFixed(1).replace(/\.0$/,"")+"K":t.toString(),Yc=(t,n,a="")=>{const r=n[0],o=n[n.length-1];return a?n.map(s=>`${gt(s,r,o)} ${a}`):n.map(s=>gt(s,r,o))},gt=(t,n,a)=>{if(t==null)return"";a=a||0,n=n||0;const r=Math.abs(a-n);if(isNaN(r)||r==0)return Math.abs(t)>=1e3?t.toLocaleString("en-US"):t.toString();let o=3+Math.floor(1+Math.log10(Math.max(Math.abs(n),Math.abs(a)))-Math.log10(r));return(isNaN(o)||o>20)&&(o=20),t.toLocaleString("en-US",{minimumSignificantDigits:1,maximumSignificantDigits:o})},Gc=(t,n)=>{const a=document.createElement("span");a.innerText=t,a.style.cssText=`position: absolute; z-index: -1; pointer-events: none; opacity: 0; font: ${n}`,document.body.appendChild(a);const r=a.offsetWidth;return a.remove(),r},Wc=(t,n)=>{if(n!=null&&n.hasAlias&&(n!=null&&n.label))return n.label;const a=(t==null?void 0:t.metric)||{},o=Object.keys(a).filter(i=>i!="__name__").map(i=>`${i}=${JSON.stringify(a[i])}`);let s=a.__name__||"";return o.length>0&&(s+="{"+o.join(",")+"}"),s},Kc=[[3600*24*365,"{YYYY}",null,null,null,null,null,null,1],[3600*24*28,"{MMM}",`
{YYYY}`,null,null,null,null,null,1],[3600*24,"{MM}-{DD}",`
{YYYY}`,null,null,null,null,null,1],[3600,"{HH}:{mm}",`
{YYYY}-{MM}-{DD}`,null,`
{MM}-{DD}`,null,null,null,1],[60,"{HH}:{mm}",`
{YYYY}-{MM}-{DD}`,null,`
{MM}-{DD}`,null,null,null,1],[1,"{HH}:{mm}:{ss}",`
{YYYY}-{MM}-{DD}`,null,`
{MM}-{DD} {HH}:{mm}`,null,null,null,1],[.001,":{ss}.{fff}",`
{YYYY}-{MM}-{DD} {HH}:{mm}`,null,`
{MM}-{DD} {HH}:{mm}`,null,`
{HH}:{mm}`,null,1]],Sr=(t,n)=>Array.from(new Set(t.map(a=>a.scale))).map(a=>{const r="10px Arial",o=Ze("color-text"),s={scale:a,show:!0,size:As,stroke:o,font:r,values:(i,c)=>Yc(i,c,n)};return a?!(Number(a)%2)&&a!=="y"?{...s,side:1}:s:{space:80,values:Kc,stroke:o,font:r}}),Jc=(t,n,a)=>{const r=Va(n)||1,o=Array.from(new Set(t)).sort((m,d)=>m-d);let s=a.start;const i=Cn(a.end+r);let c=0;const l=[];for(;s<=i;){for(;c<o.length&&o[c]<=s;)s=o[c],c++,l.push(s);s=Cn(s+r),(c>=o.length||o[c]>s)&&l.push(s)}for(;l.length<2;)l.push(s),s=Cn(s+r);return l},Tr=(t,n)=>{if(t==null||n==null)return[-1,1];const r=.02*(Math.abs(n-t)||Math.abs(t)||1);return[t-r,n+r]},Zc=(t,n)=>{const a={},r=Object.values(t).flat(),o="1",s=kr(r)||0,i=Nr(r)||1;return a[o]=n?Tr(s,i):[s,i],a},As=(t,n,a,r)=>{var c;const o=t.axes[a];if(r>1)return o._size||60;let s=6+(((c=o==null?void 0:o.ticks)==null?void 0:c.size)||0)+(o.gap||0);const i=(n??[]).reduce((l,m)=>(m==null?void 0:m.length)>l.length?m:l,"");return i!=""&&(s+=Gc(i,"10px Arial")),Math.ceil(s)},to=["#e54040","#32a9dc","#2ee329","#7126a1","#e38f0f","#3d811a","#ffea00","#2d2d2d","#da42a6","#a44e0c"],xs=t=>{if(t.length!=7)return"0, 0, 0";const n=parseInt(t.slice(1,3),16),a=parseInt(t.slice(3,5),16),r=parseInt(t.slice(5,7),16);return`${n}, ${a}, ${r}`},zt={[ne.yhatUpper]:"#7126a1",[ne.yhatLower]:"#7126a1",[ne.yhat]:"#da42a6",[ne.anomaly]:"#da4242",[ne.anomalyScore]:"#7126a1",[ne.actual]:"#203ea9",[ne.training]:`rgba(${xs("#203ea9")}, 0.2)`},no=t=>{let r=1,o=0,s=1;if(t.length>0)for(let c=0;c<t.length;c++)t[c].charCodeAt(0)>o&&(o=t[c].charCodeAt(0)),s=parseInt(String(16777215/o)),r=(r+t[c].charCodeAt(0)*s*49979693)%16777215;let i=(r*t.length%16777215).toString(16);return i=i.padEnd(6,i),`#${i}`},Xc=t=>{let n=t.replace("#","").trim();if(n.length===3&&(n=n[0]+n[0]+n[1]+n[1]+n[2]+n[2]),n.length!==6)throw new Error("Invalid HEX color.");const a=parseInt(n.slice(0,2),16),r=parseInt(n.slice(2,4),16),o=parseInt(n.slice(4,6),16);return(a*299+r*587+o*114)/1e3>=128?"#000000":"#FFFFFF"},ed=(t,n,a)=>{const r=[];for(let o=0;o<a;o++){const s=o/(a-1),i=t[0]+(n[0]-t[0])*s,c=t[1]+(n[1]-t[1])*s,l=t[2]+(n[2]-t[2])*s;r.push([i,c,l].map(m=>Math.round(m)).join(", "))}return r.map(o=>`rgb(${o})`)},Ar=ed([246,226,219],[127,39,4],16),td=(t,n)=>{const a=t.data[n][2],r=Ar,o=0;let s=1/0,i=-1/0;for(let d=0;d<a.length;d++)a[d]>o&&(s=Math.min(s,a[d]),i=Math.max(i,a[d]));const c=i-s,l=r.length,m=Array(a.length);for(let d=0;d<a.length;d++)m[d]=a[d]===0?-1:Math.min(l-1,Math.floor(l*(a[d]-s)/c));return m},nd=()=>(t,n)=>{const a=Math.round(devicePixelRatio);Bt.orient(t,n,(r,o,s,i,c,l,m,d,u,h,p,v,b,f)=>{const[g,_,y]=t.data[n],w=g.length,S=td(t,n),N=Ar??[...Array.from(new Set(S))],k=N.map(()=>new Path2D),T=w-_.lastIndexOf(_[0]),x=w/T,M=_[1]-_[0],E=g[T]-g[0],I=l(E,i,h,d)-l(0,i,h,d)-a,$=m(M,c,p,u)-m(0,c,p,u)+a,O=_.slice(0,T).map(z=>Math.round(m(z,c,p,u)-$/2)),V=Array.from({length:x},(z,j)=>Math.round(l(g[j*T],i,h,d)-I));for(let z=0;z<w;z++)if(y[z]>0&&g[z]>=(i.min||-1/0)&&g[z]<=(i.max||1/0)&&_[z]>=(c.min||-1/0)&&_[z]<=(c.max||1/0)){const j=V[~~(z/T)],H=O[z%T],te=k[S[z]];f(te,j,H,I,$)}t.ctx.save(),t.ctx.rect(t.bbox.left,t.bbox.top,t.bbox.width,t.bbox.height),t.ctx.clip(),k.forEach((z,j)=>{t.ctx.fillStyle=N[j],t.ctx.fill(z)}),t.ctx.restore()})},ad=t=>{var s,i;if(!t.every(c=>c.metric.le))return t;const n=t.sort((c,l)=>parseFloat(c.metric.le)-parseFloat(l.metric.le)),a=((s=t[0])==null?void 0:s.group)||1;let r={metric:{le:""},values:[]};const o=[];for(const c of n){const l=[r.metric.le,c.metric.le].filter(d=>d).join("..."),m=[];for(const[d,u]of c.values){const h=((i=r.values.find(v=>v[0]===d))==null?void 0:i[1])||0,p=+u-+h;m.push([d,`${p}`])}o.push({metric:{vmrange:l},values:m,group:a}),r=c}return o},ao=t=>{const n=(t.metric.vmrange||t.metric.le||"").split("...");return an(n[n.length-1])},rd=(t,n)=>ao(t)-ao(n),od=(t,n)=>{if(!n)return t;const a=t.sort(rd),r=ad(a),o={};return r.forEach(i=>i.values.forEach(([c,l])=>{const m=Number(l),d=isNaN(m)?0:m,u=o[c]||0;o[c]=u+d})),r.map(i=>{const c=i.values.map(([l,m])=>{const d=o[l];return[l,`${Math.round(+m/d*100)}`]});return{...i,values:c}}).filter(i=>!i.values.every(c=>c[1]==="0"))},sd=t=>{Object.keys(t.hooks).forEach(n=>{t.hooks[n]=[]})},Sa=t=>{const n=["__name__","for"];return Object.entries(t).filter(([a])=>!n.includes(a)).map(([a,r])=>`${a}: ${r}`).join(",")},Es=t=>{const n=(t==null?void 0:t.__name__)||"",a=new RegExp(`(${Object.values(ne).join("|")})$`),r=n.match(a),o=r&&r[0];return{value:/(?:^|[^a-zA-Z0-9_])y(?:$|[^a-zA-Z0-9_])/.test(n)?ne.actual:o,group:Sa(t)}},id=(t,n,a,r)=>{const o={},s=r?0:Math.min(t.length,to.length);for(let i=0;i<s;i++){const c=ka(t[i],a[t[i].group-1]);o[c]=to[i]}return(i,c)=>{const l=r?Es(t[c].metric):null,m=a[i.group-1],d=r?(l==null?void 0:l.group)||"":ka(i,m);return{label:d,hasAlias:!!m,dash:dd(l),width:md(l),stroke:pd({metricInfo:l,label:d,isAnomalyUI:r,colorState:o}),points:ud(l),spanGaps:!1,forecast:l==null?void 0:l.value,forecastGroup:l==null?void 0:l.group,freeFormFields:i.metric,show:!Ls(d,n),scale:"1",...ld(i)}}},ld=t=>{const n=t.values.map(i=>an(i[1])),{min:a,max:r,median:o,last:s}={min:kr(n),max:Nr(n),median:Bc(n),last:jc(n)};return{median:o,statsFormatted:{min:gt(a,a,r),max:gt(r,a,r),median:gt(o,a,r),last:gt(s,a,r)}}},ro=(t,n)=>({group:n,label:t.label||"",color:t.stroke,checked:t.show||!1,freeFormFields:t.freeFormFields,statsFormatted:t.statsFormatted,median:t.median,hasAlias:t.hasAlias||!1}),cd=({hideSeries:t,legend:n,metaKey:a,series:r,isAnomalyView:o})=>{const{label:s}=n,i=Ls(s,t),c=r.map(l=>l.label||"");return o?c.filter(l=>l!==s):a?i?t.filter(l=>l!==s):[...t,s]:t.length?i?[...c.filter(l=>l!==s)]:[]:[...c.filter(l=>l!==s)]},Ls=(t,n)=>n.includes(`${t}`),xr=t=>{for(let n=t.series.length-1;n>=0;n--)n&&t.delSeries(n)},Ms=(t,n,a=!1)=>{n.forEach((r,o)=>{r.label&&(r.spanGaps=a),o&&t.addSeries(r)})},dd=t=>{const n=(t==null?void 0:t.value)===ne.yhatLower,a=(t==null?void 0:t.value)===ne.yhatUpper,r=(t==null?void 0:t.value)===ne.yhat;return n||a?[10,5]:r?[10,2]:[]},md=t=>{const n=(t==null?void 0:t.value)===ne.yhatLower,a=(t==null?void 0:t.value)===ne.yhatUpper,r=(t==null?void 0:t.value)===ne.yhat,o=(t==null?void 0:t.value)===ne.anomaly;return a||n?.7:r?1:o?0:1.4},ud=t=>(t==null?void 0:t.value)===ne.anomaly?{size:8,width:4,space:0}:{size:4,width:0,show:!0,filter:hd},hd=(t,n)=>{const a=t.data[n],r=[];for(let o=0;o<a.length;o++){const s=a[o-1],i=a[o+1];s===null&&i===null&&r.push(o)}return r},pd=({metricInfo:t,label:n,isAnomalyUI:a,colorState:r})=>{const o=r[n]||no(n),s=(t==null?void 0:t.value)===ne.anomaly;return a&&s?zt[ne.anomaly]:a&&!s&&!(t!=null&&t.value)?zt[ne.actual]:t!=null&&t.value?t!=null&&t.value?zt[t==null?void 0:t.value]:o:r[n]||no(n)},Ds=({width:t=400,height:n=500})=>({width:t,height:n,series:[],tzDate:a=>B(Rt(je(a))).local().toDate(),legend:{show:!1},cursor:{drag:{x:!0,y:!1},focus:{prox:30},points:{size:5.6,width:1.4},bind:{click:()=>null,dblclick:()=>null}}}),Er=t=>{xr(t),sd(t),t.setData([])},Is=({min:t,max:n})=>[t,n],Ps=(t,n=0,a=1,r,o)=>o.limits.enable?o.limits.range[r]:Tr(n,a),gd=(t,n)=>{const a={x:{range:()=>Is(n)}},r=Object.keys(t.limits.range);return(r.length?r:["1"]).forEach(o=>{a[o]={range:(s,i=0,c=1)=>Ps(s,i,c,o,t)}}),a},Lr=t=>n=>{const a=n.posToVal(n.select.left,"x"),r=n.posToVal(n.select.left+n.select.width,"x");t({min:a,max:r})},$s=(t,n)=>{if(t.delBand(),n.length<2)return;const a=n.map((i,c)=>({...i,index:c})),r=a.filter(i=>i.forecast===ne.yhatUpper),o=a.filter(i=>i.forecast===ne.yhatLower),s=r.map(i=>{const c=o.find(l=>l.forecastGroup===i.forecastGroup);return c?{series:[i.index,c.index],fill:vd(ne.yhatUpper)}:null}).filter(i=>i!==null);s.length&&s.forEach(i=>{t.addBand(i)})};function vd(t){return`rgba(${xs(zt[t])}, 0.05)`}const fd=t=>t instanceof MouseEvent,oo=t=>fd(t)?t.clientX:t.touches[0].clientX,_d=({dragSpeed:t=.85,setPanning:n,setPlotScale:a})=>{const r=Q({leftStart:0,xUnitsPerPx:0,scXMin:0,scXMax:0}),o=c=>{c.preventDefault();const l=oo(c),{leftStart:m,xUnitsPerPx:d,scXMin:u,scXMax:h}=r.current,p=d*((l-m)*t);a({min:u-p,max:h-p})},s=()=>{n(!1),document.removeEventListener("mousemove",o),document.removeEventListener("mouseup",s),document.removeEventListener("touchmove",o),document.removeEventListener("touchend",s)},i=()=>{document.addEventListener("mousemove",o),document.addEventListener("mouseup",s),document.addEventListener("touchmove",o),document.addEventListener("touchend",s)};return({e:c,u:l})=>{c.preventDefault(),n(!0),r.current={leftStart:oo(c),xUnitsPerPx:l.posToVal(1,"x")-l.posToVal(0,"x"),scXMin:l.scales.x.min||0,scXMax:l.scales.x.max||0},i()}},bd=t=>{const{ctrlKey:n,metaKey:a,button:r}=t;return r===0&&(n||a)},da=.9,Mr=t=>{const[n,a]=C(!1),r=_d({dragSpeed:da,setPanning:a,setPlotScale:t});return{onReadyChart:s=>{const i=l=>{const m=l instanceof MouseEvent&&bd(l),d=window.TouchEvent&&l instanceof TouchEvent&&l.touches.length>1;(m||d)&&r({u:s,e:l})},c=l=>{if(!l.ctrlKey&&!l.metaKey)return;l.preventDefault();const{width:m}=s.over.getBoundingClientRect(),d=s.cursor.left&&s.cursor.left>0?s.cursor.left:0,u=s.posToVal(d,"x"),h=(s.scales.x.max||0)-(s.scales.x.min||0),p=l.deltaY<0?h*da:h/da,v=u-d/m*p,b=v+p;s.batch(()=>t({min:v,max:b}))};s.over.addEventListener("mousedown",i),s.over.addEventListener("touchstart",i),s.over.addEventListener("wheel",c)},isPanning:n}},so=t=>{const n=t[0].clientX-t[1].clientX,a=t[0].clientY-t[1].clientY;return Math.sqrt(n*n+a*a)},Dr=({uPlotInst:t,xRange:n,setPlotScale:a})=>{const[r,o]=C(0),s=X(l=>{const{target:m,ctrlKey:d,metaKey:u,key:h}=l,p=m instanceof HTMLInputElement||m instanceof HTMLTextAreaElement;if(!t||p)return;const v=h==="+"||h==="=";if((h==="-"||v)&&!(d||u)){l.preventDefault();const g=(n.max-n.min)/10*(v?1:-1);a({min:n.min+g,max:n.max-g})}},[t,n]),i=l=>{l.touches.length===2&&(l.preventDefault(),o(so(l.touches)))},c=X(l=>{if(!t||l.touches.length!==2)return;l.preventDefault();const m=so(l.touches),d=r-m,u=t.scales.x.max||n.max,h=t.scales.x.min||n.min,p=u-h,v=d>0?-1:1,b=p/50*v;t.batch(()=>a({min:h+b,max:u-b}))},[t,r,n]);return ce("keydown",s),ce("touchmove",c),ce("touchstart",i),null},Ir=({period:t,setPeriod:n})=>{const[a,r]=C({min:t.start,max:t.end}),o=({min:s,max:i})=>{const c=(i-s)*1e3;c<Br.min||c>Br.max||n({from:B(s*1e3).toDate(),to:B(i*1e3).toDate()})};return A(()=>{r({min:t.start,max:t.end})},[t]),{xRange:a,setPlotScale:o}},yd=({u:t,metrics:n,series:a,unit:r,isAnomalyView:o})=>{const[s,i]=C(!1),[c,l]=C({seriesIdx:-1,dataIdx:-1}),[m,d]=C([]),u=()=>{d([]),l({seriesIdx:-1,dataIdx:-1})},h=g=>{const _=g.cursor.idx??-1;l(y=>({...y,dataIdx:_}))},p=(g,_)=>{const y=_??-1;l(w=>({...w,seriesIdx:y}))},v=X(()=>{const{seriesIdx:g,dataIdx:_}=c,y=n[g-1],w=a[g],S=new Set(n.map(I=>I.group)),N=(y==null?void 0:y.group)||0,k=pt(t,["data",g,_],0),T=pt(t,["scales","1","min"],0),x=pt(t,["scales","1","max"],1),M=pt(t,["data",0,_],0),E={top:t?t.valToPos(k||0,(w==null?void 0:w.scale)||"1"):0,left:t?t.valToPos(M,"x"):0};return{unit:r,point:E,u:t,id:`${g}_${_}`,title:S.size>1&&!o?`Query ${N}`:"",dates:[M?B(M*1e3).tz().format(xn):"-"],value:gt(k,T,x),info:Wc(y,w),statsFormatted:w==null?void 0:w.statsFormatted,marker:`${w==null?void 0:w.stroke}`}},[t,c,n,a,r,o]),b=X(()=>{if(!s)return;const g=v();m.find(_=>_.id===g.id)||d(_=>[..._,g])},[v,m,s]),f=g=>{d(_=>_.filter(y=>y.id!==g))};return A(()=>{i(c.dataIdx!==-1&&c.seriesIdx!==-1)},[c]),ce("click",b),{showTooltip:s,stickyTooltips:m,handleUnStick:f,getTooltipProps:v,seriesFocus:p,setCursor:h,resetTooltips:u}},io=({u:t,id:n,title:a,dates:r,value:o,point:s,unit:i="",info:c,statsFormatted:l,isSticky:m,marker:d,onClose:u})=>{const h=Q(null),[p,v]=C({top:-999,left:-999}),[b,f]=C(!1),[g,_]=C(!1),y=()=>{u&&u(n)},w=T=>{_(!0),f(!0);const{clientX:x,clientY:M}=T;v({top:M,left:x})},S=X(T=>{if(!b)return;const{clientX:x,clientY:M}=T;v({top:M,left:x})},[b]),N=()=>{f(!1)};return A(()=>{if(!h.current||!t)return;const{top:T,left:x}=s,M={left:parseFloat(t.over.style.left),top:parseFloat(t.over.style.top)},{width:E,height:I}=t.over.getBoundingClientRect(),{width:$,height:O}=h.current.getBoundingClientRect(),V=10,z=x+$>=E?$+2*V:0,j=T+O>=I?O+2*V:0,H={top:T+M.top+V-j,left:x+M.left+V-z};H.left<0&&(H.left=20),H.top<0&&(H.top=20),v(H)},[t,o,s,h]),ce("mousemove",S),ce("mouseup",N),t?Ut(e("div",{className:D({"vm-chart-tooltip":!0,"vm-chart-tooltip_sticky":m,"vm-chart-tooltip_moved":g}),ref:h,style:p,children:[e("div",{className:"vm-chart-tooltip-header",children:[a&&e("div",{className:"vm-chart-tooltip-header__title",children:a}),e("div",{className:"vm-chart-tooltip-header__date",children:r.map((T,x)=>e("span",{children:T},x))}),m&&e(U,{children:[e(P,{className:"vm-chart-tooltip-header__drag",variant:"text",size:"small",startIcon:e(Ka,{}),onMouseDown:w,ariaLabel:"drag the tooltip"}),e(P,{className:"vm-chart-tooltip-header__close",variant:"text",size:"small",startIcon:e(He,{}),onClick:y,ariaLabel:"close the tooltip"})]})]}),e("div",{className:"vm-chart-tooltip-data",children:[d&&e("span",{className:"vm-chart-tooltip-data__marker",style:{background:d}}),e("p",{className:"vm-chart-tooltip-data__value",children:[e("b",{children:o}),i]})]}),l&&e("table",{className:"vm-chart-tooltip-stats",children:$a.map((T,x)=>e("div",{className:"vm-chart-tooltip-stats-row",children:[e("span",{className:"vm-chart-tooltip-stats-row__key",children:[T,":"]}),e("span",{className:"vm-chart-tooltip-stats-row__value",children:l[T]})]},x))}),c&&e("p",{className:"vm-chart-tooltip__info",children:c})]}),t.root):null},Os=({showTooltip:t,tooltipProps:n,stickyTooltips:a,handleUnStick:r})=>e(U,{children:[t&&n&&e(io,{...n}),a.map(o=>fi(io,{...o,isSticky:!0,key:o.id,onClose:r}))]}),wd=({data:t,series:n,metrics:a=[],period:r,yaxis:o,unit:s,setPeriod:i,layoutSize:c,height:l,isAnomalyView:m,spanGaps:d=!1})=>{const{isDarkTheme:u}=re(),h=Q(null),[p,v]=C(),{xRange:b,setPlotScale:f}=Ir({period:r,setPeriod:i}),{onReadyChart:g,isPanning:_}=Mr(f);Dr({uPlotInst:p,xRange:b,setPlotScale:f});const{showTooltip:y,stickyTooltips:w,handleUnStick:S,getTooltipProps:N,seriesFocus:k,setCursor:T,resetTooltips:x}=yd({u:p,metrics:a,series:n,unit:s,isAnomalyView:m}),M={...Ds({width:c.width,height:l}),series:n,axes:Sr([{},{scale:"1"}],s),scales:gd(o,b),hooks:{ready:[g],setSeries:[k],setCursor:[T],setSelect:[Lr(f)],destroy:[Er]},bands:[]};return A(()=>{if(x(),!h.current)return;p&&p.destroy();const E=new Bt(M,t,h.current);return v(E),E.destroy},[h,u]),A(()=>{p&&(p.setData(t),p.redraw())},[t]),A(()=>{p&&(xr(p),Ms(p,n,d),$s(p,n),p.redraw())},[n,d]),A(()=>{p&&(Object.keys(o.limits.range).forEach(E=>{p.scales[E]&&(p.scales[E].range=(I,$=0,O=1)=>Ps(I,$,O,E,o))}),p.redraw())},[o]),A(()=>{p&&(p.scales.x.range=()=>Is(b),p.redraw())},[b]),A(()=>{p&&(p.setSize({width:c.width||400,height:l||500}),p.redraw())},[l,c]),e("div",{className:D({"vm-line-chart":!0,"vm-line-chart_panning":_}),style:{minWidth:`${c.width||400}px`,minHeight:`${l||500}px`},children:[e("div",{className:"vm-line-chart__u-plot",ref:h}),e(Os,{showTooltip:y,tooltipProps:N(),stickyTooltips:w,handleUnStick:S})]})};var Wt=(t=>(t.view="legend_view",t.hideDuplicates="legend_hide_duplicates",t.hideStats="legend_hide_stats",t.format="legend_format",t.group="legend_group",t))(Wt||{}),Ta=(t=>(t.table="table",t.lines="lines",t))(Ta||{});const vn=Wt.view,Rs=()=>{const[t,n]=ae(),a=t.get(vn),[r,o]=C(a||"lines"),s=i=>{i==="table"?t.set(vn,i):t.delete(vn),o(i),n(t)};return A(()=>{const i=t.get(vn);i!==r&&o(i)},[t]),{view:r,isLinesView:r==="lines",isTableView:r==="table",onChange:s}},Cd=t=>Object.keys(t.freeFormFields).filter(a=>a!=="__name__").map(a=>{const r=`${a}=${JSON.stringify(t.freeFormFields[a])}`;return{id:`${t.label}.${r}`,freeField:r,key:a}}),fn=Wt.hideStats,Pr=()=>{const[t,n]=ae(),a=t.get(fn)==="true",[r,o]=C(a),s=i=>{i?t.set(fn,"true"):t.delete(fn),o(i),n(t)};return A(()=>{const i=t.get(fn)==="true";i!==r&&o(i)},[t]),{hideStats:r,onChange:s}},_n=Wt.format,Fs=()=>{const[t,n]=ae(),a=t.get(_n)||"",[r,o]=C(a),s=c=>{o(c)},i=()=>{r?t.set(_n,r):t.delete(_n),n(t)};return A(()=>{const c=t.get(_n);c!==r&&o(c||"")},[t]),{format:r,onChange:s,onApply:i}},Nd=({legend:t,onChange:n,duplicateFields:a,isAnomalyView:r})=>{const o=Fe(),{hideStats:s}=Pr(),{format:i}=Fs(),c=Ns(t.freeFormFields,i),l=L(()=>{const p=Cd(t);return a!=null&&a.length?p.filter(v=>!a.includes(v.key)):p},[t,a]),m=t.statsFormatted,d=Object.values(m).some(p=>p),u=p=>v=>{n&&n(p,v.ctrlKey||v.metaKey)},h=p=>async v=>{v.stopPropagation(),await o(p,`${p} has been copied`)};return e("div",{className:D({"vm-legend-item":!0,"vm-legend-row":!0,"vm-legend-item_hide":!t.checked}),onClick:u(t),children:[!r&&e("div",{className:"vm-legend-item__marker",style:{backgroundColor:t.color}}),e("div",{className:"vm-legend-item-info",children:e("span",{className:"vm-legend-item-info__label",children:[t.hasAlias&&t.label,!t.hasAlias&&i&&c,!t.hasAlias&&!i&&e(U,{children:[t.freeFormFields.__name__,!!l.length&&e(U,{children:" {"}),l.map((p,v)=>e("span",{className:"vm-legend-item-info__free-fields",onClick:h(p.freeField),title:"copy to clipboard",children:[p.freeField,v+1<l.length&&","]},p.key)),!!l.length&&e(U,{children:"}"})]})]})}),!s&&d&&e("div",{className:"vm-legend-item-stats",children:$a.map((p,v)=>e("div",{className:"vm-legend-item-stats-row",children:[e("span",{className:"vm-legend-item-stats-row__key",children:[p,":"]}),e("span",{className:"vm-legend-item-stats-row__value",children:m[p]})]},v))})]})},kd=({labels:t,isAnomalyView:n,duplicateFields:a,onChange:r})=>e("div",{className:"vm-legend-item-container",children:t.map(o=>e(Nd,{legend:o,isAnomalyView:n,duplicateFields:a,onChange:r},o.label))}),Sd=$a.map(t=>({key:`statsFormatted.${t}`,title:t})),Td=({labels:t,duplicateFields:n,onChange:a})=>{const{hideStats:r}=Pr(),o=r?[]:Sd,i=L(()=>{const l=[...new Set(t.flatMap(m=>Object.keys(m.freeFormFields)))].map(m=>({key:`freeFormFields.${m}`,title:m}));return n!=null&&n.length?l.filter(m=>!n.includes(m.title)):l},[t,n]).concat(o),c=l=>m=>{a&&a(l,m.ctrlKey||m.metaKey)};return e("div",{className:"vm-legend-table__wrapper",children:e("table",{className:"vm-legend-table",children:[e("thead",{className:"vm-legend-table-thead",children:e("tr",{className:"vm-legend-table-row vm-legend-table_thead",children:[e("th",{className:"vm-legend-table-col vm-legend-table-col_marker vm-legend-table-col_thead"}),i.map(l=>e("th",{className:"vm-legend-table-col vm-legend-table-col_thead",children:l.title},l.key))]})}),e("tbody",{className:"vm-legend-table-tbody",children:t.map(l=>e("tr",{className:D({"vm-legend-table-row":!0,"vm-legend-table-row_tbody":!0,"vm-legend-table-row_exclude":!l.checked}),onClick:c(l),children:[e("td",{className:"vm-legend-table-col vm-legend-table-col_marker",children:e("div",{className:"vm-legend-item__marker",style:{backgroundColor:l.color}})}),i.map(m=>e("td",{className:"vm-legend-table-col",children:e("span",{className:"vm-legend-table-col__content",children:pt(l,m.key)})},`${m.key}_${l.label}`))]},l.label))})]})})},bn=Wt.hideDuplicates,zs=t=>{const[n,a]=ae(),r=n.get(bn)==="true",[o,s]=C(r),i=l=>{l?n.set(bn,"true"):n.delete(bn),s(l),a(n)};A(()=>{const l=n.get(bn)==="true";l!==o&&s(l)},[n]);const c=L(()=>!o||!(t!=null&&t.length)||(t==null?void 0:t.length)<2?[]:[...new Set(t.flatMap(m=>Object.keys(m.freeFormFields||{})))].filter(m=>{var u;const d=(u=t.find(h=>h.freeFormFields[m]))==null?void 0:u.freeFormFields[m];return t.every(h=>h.freeFormFields[m]===d)}),[t,o]);return{hideDuplicates:o,onChange:i,duplicateFields:c}},Ad=50,Hs=100,Vs=5,Vt="Ungrouped",Me="_stream",kn="_msg",Ot=`${Ge}.SSS`,ke={GROUP_BY:"groupBy",DISPLAY_FIELDS:"displayFields",NO_WRAP_LINES:"noWrapLines",COMPACT_GROUP_HEADER:"compactGroupHeader",DATE_FORMAT:"dateFormat",ROWS_PER_PAGE:"rows_per_page"},yn=Wt.group,$r=()=>{const[t,n]=ae(),a=t.get(yn)||"",[r,o]=C(a),s=i=>{i&&i!==Vt?t.set(yn,i):t.delete(yn),o(i),n(t)};return A(()=>{const i=t.get(yn);i!==r&&o(i||"")},[t]),{groupByLabel:r,onChange:s}},xd=({labels:t,group:n,isAnomalyView:a,onChange:r})=>{const{isTableView:o}=Rs(),{groupByLabel:s}=$r(),i=Fe(),{duplicateFields:c}=zs(t),l=L(()=>t.sort((u,h)=>(h.median||0)-(u.median||0)),[t]),m=u=>async h=>{h.stopPropagation(),await i(u,`${u} has been copied`)},d=o?Td:kd;return e("div",{className:"vm-legend-group",children:e(Kn,{defaultExpanded:!0,title:e("div",{className:"vm-legend-group-header",children:[e("div",{className:"vm-legend-group-header-title",children:["Group by",s?"":" query",": ",e("b",{children:n})]}),!!c.length&&e("div",{className:"vm-legend-group-header-labels",children:["common labels: {",c.map(u=>e("div",{onClick:m(`${u}="${t[0].freeFormFields[u]}"`),className:"vm-legend-group-header-labels__item",children:`${u}="${t[0].freeFormFields[u]}"`},u)),"}"]})]}),children:e(d,{labels:l,isAnomalyView:a,duplicateFields:c,onChange:r})})},n)},Ed=({labels:t,query:n,groupByLabel:a})=>L(()=>Ld(t,n,a),[t,n,a]),Ld=(t,n,a)=>{const r=new Map;for(const o of t){const s=a?`${a}="${o.freeFormFields[a]??""}"`:`${n[o.group-1]}`;r.has(s)||r.set(s,{group:String(s),items:[]}),r.get(s).items.push(o)}return Array.from(r.values())},Md=({values:t,onRemoveItem:n})=>{const{isMobile:a}=W(),r=o=>s=>{n(o),s.stopPropagation()};return a?e("span",{className:"vm-select-input-content__counter",children:["selected ",t.length]}):e(U,{children:t.map(o=>e("div",{className:"vm-select-input-content__selected",children:[e("span",{children:o}),e("div",{onClick:r(o),children:e(He,{})})]},o))})},Ct=({value:t,list:n,label:a,placeholder:r,noOptionsText:o,clearable:s=!1,searchable:i=!1,autofocus:c,disabled:l,onChange:m})=>{const{isDarkTheme:d}=re(),{isMobile:u}=W(),[h,p]=C(""),v=Q(null),[b,f]=C(null),[g,_]=C(!1),y=Q(null),w=Array.isArray(t),S=Array.isArray(t)?t:void 0,N=u&&w&&!!(S!=null&&S.length),k=L(()=>g?h:Array.isArray(t)?"":t,[t,h,g,w]),T=L(()=>g?h||"(.+)":"",[h,g]),x=()=>{y.current&&y.current.blur()},M=()=>{_(!1),x()},E=()=>{l||_(!0)},I=()=>{n.includes(h)&&m(h)},$=H=>{H.target instanceof HTMLInputElement||l||_(te=>!te)},O=H=>{p(""),m(H),w||M(),w&&y.current&&y.current.focus()},V=H=>{p(H.target.value)},z=H=>te=>{O(H),te.stopPropagation()},j=H=>{y.current!==H.target&&_(!1)};return A(()=>{p(""),g&&y.current&&y.current.focus(),g||x()},[g,y]),A(()=>{!c||!y.current||u||y.current.focus()},[c,y]),ce("keyup",j),dn(v,M,b),e("div",{className:D({"vm-select":!0,"vm-select_dark":d,"vm-select_disabled":l}),children:[e("div",{className:"vm-select-input",onClick:$,ref:v,children:[e("div",{className:"vm-select-input-content",children:[!!(S!=null&&S.length)&&e(Md,{values:S,onRemoveItem:O}),!N&&e("input",{value:k,type:"text",placeholder:r,onInput:V,onFocus:E,onBlur:I,ref:y,readOnly:u||!i})]}),a&&e("span",{className:"vm-text-field__label",children:a}),s&&t&&e("div",{className:"vm-select-input__icon",onClick:z(""),children:e(He,{})}),e("div",{className:D({"vm-select-input__icon":!0,"vm-select-input__icon_open":g}),children:e(Qe,{})})]}),e(_r,{label:a,value:T,options:n.map(H=>({value:H})),anchor:v,selected:S,minLength:1,fullWidth:!0,noOptionsText:o,onSelect:O,onOpenAutocomplete:_,onChangeWrapperRef:f})]})},Us=({data:t,isCompact:n})=>{const{isTableView:a,onChange:r}=Rs(),{hideDuplicates:o,onChange:s}=zs(),{hideStats:i,onChange:c}=Pr(),{format:l,onChange:m,onApply:d}=Fs(),{groupByLabel:u,onChange:h}=$r(),p=mt(),v=L(()=>{if(!t||!t.length)return[];const y=t.flatMap(w=>Object.keys(w.metric));return Array.from(new Set(y))},[t]),b=y=>{const w=y?Ta.table:Ta.lines;r(w)},f=()=>{p({type:"SET_OPEN_SETTINGS",payload:!0})},g=[{label:"Table View",value:a,onChange:b,info:"If enabled, the legend will be displayed in a table format."},{label:"Hide Common Labels",value:o,onChange:s,info:"If enabled, hides labels that are the same for all series."},{label:"Hide Statistics",value:i,onChange:c,info:"If enabled, hides the display of min, median, and max values."}],_=n?Y:U;return e("div",{className:D({"vm-legend-configs":!0,"vm-legend-configs_compact":n}),children:[g.map(({label:y,value:w,onChange:S,info:N})=>e(_,{title:N,children:e("div",{className:"vm-legend-configs-item vm-legend-configs-item_switch",children:[e("span",{className:"vm-legend-configs-item__label",children:y}),e(ye,{label:`${n?y:w?"Enabled":"Disabled"}`,value:w,onChange:S}),e("span",{className:"vm-legend-configs-item__info",children:N})]})},y)),n&&e(P,{size:"small",variant:"text",startIcon:e(ot,{}),onClick:f,children:"Settings"}),!n&&e(U,{children:[e("div",{className:"vm-legend-configs-item",children:[e(le,{label:"Custom Legend Format",placeholder:"{{label_name}}",value:l,onChange:m,onBlur:d,onEnter:d}),e("span",{className:"vm-legend-configs-item__info vm-legend-configs-item__info_input",children:"Customize legend labels with text and {{label_name}} placeholders."})]}),e("div",{className:"vm-legend-configs-item",children:[e(Ct,{label:"Group Legend By",value:u,list:[Vt,...v],placeholder:Vt,onChange:h,searchable:!0}),e("span",{className:"vm-legend-configs-item__info",children:"Choose a label to group the legend. By default, legends are grouped by query."})]})]})]})},Dd=({labels:t,query:n,isAnomalyView:a,isPredefinedPanel:r,onChange:o})=>{const{groupByLabel:s}=$r(),i=Ed({labels:t,query:n,groupByLabel:s});return e("div",{className:"vm-legend",children:[!r&&e(Us,{isCompact:!0}),e("div",{children:i.map(({group:c,items:l})=>e(xd,{labels:l,group:c,isAnomalyView:a,onChange:o},c))})]})},Id=({min:t,max:n,legendValue:a})=>{const[r,o]=C(0),[s,i]=C(""),[c,l]=C(""),[m,d]=C(""),u=L(()=>parseFloat(String((a==null?void 0:a.value)||0).replace("%","")),[a]);return A(()=>{o(u?(u-t)/(n-t)*100:0),i(u?`${u}%`:""),l(`${t}%`),d(`${n}%`)},[u,t,n]),e("div",{className:"vm-legend-heatmap__wrapper",children:e("div",{className:"vm-legend-heatmap",children:[e("div",{className:"vm-legend-heatmap-gradient",style:{background:`linear-gradient(to right, ${Ar.join(", ")})`},children:!!u&&e("div",{className:"vm-legend-heatmap-gradient__value",style:{left:`${r}%`},children:e("span",{children:s})})}),e("div",{className:"vm-legend-heatmap__value",children:c}),e("div",{className:"vm-legend-heatmap__value",children:m})]})})},Pd=({u:t,metrics:n,unit:a})=>{const[r,o]=C({left:0,top:0}),[s,i]=C([]),c=()=>{i([]),o({left:0,top:0})},l=h=>{const p=h.cursor.left||0,v=h.cursor.top||0;o({left:p,top:v})},m=X(()=>{var M;const{left:h,top:p}=r,v=pt(t,["data",1,0],[])||[],b=t?t.posToVal(h,"x"):0,f=t?t.posToVal(p,"y"):0,g=v.findIndex((E,I)=>b>=E&&b<v[I+1])||-1,_=v[g+1],y=n[Math.round(f)]||{values:[]},[w=0,S=""]=y.values.find(E=>E[0]===_)||[],N=v[g],k=B(N*1e3).tz().format(xn),T=B(w*1e3).tz().format(xn),x=((M=y==null?void 0:y.metric)==null?void 0:M.vmrange)||"";return{unit:a,point:r,u:t,id:`${x}_${k}`,dates:[k,T],value:`${S}%`,info:x,show:+S>0}},[t,r,n,a]),d=X(()=>{const h=m();h.show&&(s.find(p=>p.id===h.id)||i(p=>[...p,h]))},[m,s]),u=h=>{i(p=>p.filter(v=>v.id!==h))};return ce("click",d),{stickyTooltips:s,handleUnStick:u,getTooltipProps:m,setCursor:l,resetTooltips:c}},$d=({data:t,metrics:n=[],period:a,unit:r,setPeriod:o,layoutSize:s,height:i,onChangeLegend:c})=>{const{isDarkTheme:l}=re(),m=Q(null),[d,u]=C(),{xRange:h,setPlotScale:p}=Ir({period:a,setPeriod:o}),{onReadyChart:v,isPanning:b}=Mr(p);Dr({uPlotInst:d,xRange:h,setPlotScale:p});const{stickyTooltips:f,handleUnStick:g,getTooltipProps:_,setCursor:y,resetTooltips:w}=Pd({u:d,metrics:n,unit:r}),S=L(()=>_(),[_]),N=()=>{const T=Sr([{}],r);return[...T,{scale:"y",stroke:T[0].stroke,font:T[0].font,size:As,splits:n.map((x,M)=>M),values:n.map(x=>x.metric.vmrange)}]},k={...Ds({width:s.width,height:i}),mode:2,series:[{},{paths:nd(),facets:[{scale:"x",auto:!0,sorted:1},{scale:"y",auto:!0}]}],axes:N(),scales:{x:{time:!0},y:{log:2,time:!1,range:(T,x,M)=>[x-1,M+1]}},hooks:{ready:[v],setCursor:[y],setSelect:[Lr(p)],destroy:[Er]}};return A(()=>{w();const T=t[0]===null&&Array.isArray(t[1]);if(!m.current||!T)return;const x=new Bt(k,t,m.current);return u(x),x.destroy},[m,t,l]),A(()=>{d&&(d.setSize({width:s.width||400,height:i||500}),d.redraw())},[i,s]),A(()=>{c(S)},[S]),e("div",{className:D({"vm-line-chart":!0,"vm-line-chart_panning":b}),style:{minWidth:`${s.width||400}px`,minHeight:`${i||500}px`},children:[e("div",{className:"vm-line-chart__u-plot",ref:m}),e(Os,{showTooltip:!!S.show,tooltipProps:S,stickyTooltips:f,handleUnStick:g})]})},qs=()=>{const[t,n]=C(null),[a,r]=C({width:0,height:0}),o=X(()=>{r({width:(t==null?void 0:t.offsetWidth)||0,height:(t==null?void 0:t.offsetHeight)||0})},[t==null?void 0:t.offsetHeight,t==null?void 0:t.offsetWidth]);return ce("resize",o),A(o,[t==null?void 0:t.offsetHeight,t==null?void 0:t.offsetWidth]),[n,a]},Od={[ne.yhat]:"yhat",[ne.yhatLower]:"yhat_upper - yhat_lower",[ne.yhatUpper]:"yhat_upper - yhat_lower",[ne.anomaly]:"anomalies",[ne.training]:"training data",[ne.actual]:"y"},Rd=({series:t})=>{const n=L(()=>{const a=t.reduce((o,s)=>{const i=Object.prototype.hasOwnProperty.call(s,"forecast"),c=s.forecast!==ne.yhatUpper,l=!o.find(m=>m.forecast===s.forecast);return i&&l&&c&&o.push(s),o},[]),r={...a[0],forecast:ne.training,color:zt[ne.training]};return a.splice(1,0,r),a.map(o=>({...o,color:typeof o.stroke=="string"?o.stroke:zt[o.forecast||ne.actual]}))},[t]);return e(U,{children:e("div",{className:"vm-legend-anomaly",children:n.filter(a=>a.forecast!==ne.training).map((a,r)=>{var o;return e("div",{className:"vm-legend-anomaly-item",children:[e("svg",{children:a.forecast===ne.anomaly?e("circle",{cx:"15",cy:"7",r:"4",fill:a.color,stroke:a.color,strokeWidth:"1.4"}):e("line",{x1:"0",y1:"7",x2:"30",y2:"7",stroke:a.color,strokeWidth:a.width||1,strokeDasharray:(o=a.dash)==null?void 0:o.join(",")})}),e("div",{className:"vm-legend-anomaly-item__title",children:Od[a.forecast||ne.actual]})]},`${r}_${a.forecast}`)})})})},ta=({data:t=[],period:n,customStep:a,query:r,yaxis:o,unit:s,showLegend:i=!0,setYaxisLimits:c,setPeriod:l,alias:m=[],fullWidth:d=!0,height:u,isHistogram:h,isAnomalyView:p,isPredefinedPanel:v,spanGaps:b})=>{var K;const f=mt(),{isMobile:g}=W(),{timezone:_}=he(),y=L(()=>a||n.step||"1s",[n.step,a]),w=L(()=>od(t,h),[h,t]),[S,N]=C([[]]),[k,T]=C([]),[x,M]=C([]),[E,I]=C([]),[$,O]=C(null),V=L(()=>id(w,E,m,p),[w,E,m,p]),z=R=>{const F=Zc(R,!h);c(F)},j=(R,F)=>{I(cd({hideSeries:E,legend:R,metaKey:F,series:k,isAnomalyView:p}))},H=R=>{const F=R.slice(1,R.length),q=[],Z=[];F.forEach((ue,_e)=>{ue.forEach((We,Ne)=>{const ze=Ne*F.length+_e;Z[ze]=We})}),R[0].forEach(ue=>{const _e=new Array(F.length).fill(ue);q.push(..._e)});const ee=new Array(q.length).fill(0).map((ue,_e)=>_e%F.length);return[null,[q,ee,Z]]},te=R=>p?ys(R,["group","label"]).map(q=>{const Z=q.values[0];return{...Z,freeFormFields:{...Z.freeFormFields,__name__:""}}}):R;A(()=>{const R=[],F={},q=[],Z=[{}];w==null||w.forEach((Ne,ze)=>{const $e=V(Ne,ze);Z.push($e),q.push(ro($e,Ne.group));const Ke=F[Ne.group]||[];for(const fe of Ne.values)R.push(fe[0]),Ke.push(an(fe[1]));F[Ne.group]=Ke});const ee=Jc(R,y,n),ue=w.map(Ne=>{const ze=[],$e=Ne.values,Ke=$e.length;let fe=0;for(const It of ee){for(;fe<Ke&&$e[fe][0]<It;)fe++;let ut=null;fe<Ke&&$e[fe][0]==It&&(ut=an($e[fe][1]),Number.isFinite(ut)||(ut=null)),ze.push(ut)}const Dt=ze.filter(It=>It!==null),et=Math.abs(qc(Dt)),_t=Tr(kr(Dt),Nr(Dt)),Kt=Math.abs(_t[1]-_t[0]);return et>Kt*1e10&&!p?ze.map(()=>et):ze});ue.unshift(ee),z(F);const _e=h?H(ue):ue;N(_e),T(Z);const We=te(q);M(We),p&&I(We.map(Ne=>Ne.label||"").slice(1))},[w,_,h,y]),A(()=>{const R=[],F=[{}];w==null||w.forEach((q,Z)=>{const ee=V(q,Z);F.push(ee),R.push(ro(ee,q.group))}),T(F),M(te(R))},[E]);const[de,G]=qs(),oe=((K=S[0])==null?void 0:K.length)>0;return A(()=>{const F=(()=>{var q;if(!h||!w[1])return!1;try{return(((q=S==null?void 0:S[1])==null?void 0:q[2])||[]).every(ee=>ee===null)}catch{return!1}})();f({type:"SET_IS_EMPTY_HISTOGRAM",payload:F})},[S,h]),e("div",{className:D({"vm-graph-view":!0,"vm-graph-view_full-width":d,"vm-graph-view_full-width_mobile":d&&g}),ref:de,children:[!h&&oe&&e(wd,{data:S,series:k,metrics:w,period:n,yaxis:o,unit:s,setPeriod:l,layoutSize:G,height:u,isAnomalyView:p,spanGaps:b}),h&&e($d,{data:S,metrics:w,period:n,unit:s,setPeriod:l,layoutSize:G,height:u,onChangeLegend:O}),p&&i&&e(Rd,{series:k}),!h&&i&&e(Dd,{labels:x,query:r,isAnomalyView:p,onChange:j,isPredefinedPanel:v}),h&&i&&e(Id,{min:o.limits.range[1][0]||0,max:o.limits.range[1][1]||0,legendValue:$})]})},Fd=({yaxis:t,setYaxisLimits:n,toggleEnableLimits:a})=>{const{isMobile:r}=W(),o=L(()=>Object.keys(t.limits.range),[t.limits.range]),i=X(Fn((l,m,d)=>{const u=t.limits.range;u[m][d]=+l,!(u[m][0]===u[m][1]||u[m][0]>u[m][1])&&n(u)},500),[t.limits.range]),c=(l,m)=>d=>{i(d,l,m)};return e("div",{className:D({"vm-axes-limits":!0,"vm-axes-limits_mobile":r}),children:[e("div",{className:"vm-graph-settings-row",children:[e("span",{className:"vm-graph-settings-row__label",children:"Fixed Y-axis limits"}),e(ye,{value:t.limits.enable,onChange:a,label:t.limits.enable?"Enabled":"Disabled",fullWidth:r})]}),e("span",{className:"vm-legend-configs-item__info",children:"Enables manual setting of min and max values for the y-axis."}),t.limits.enable&&e("div",{className:"vm-axes-limits-list",children:o.map(l=>e("div",{className:"vm-axes-limits-list__inputs",children:[e(le,{label:`Min ${l}`,type:"number",disabled:!t.limits.enable,value:t.limits.range[l][0],onChange:c(l,0)}),e(le,{label:`Max ${l}`,type:"number",disabled:!t.limits.enable,value:t.limits.range[l][1],onChange:c(l,1)})]},l))})]})},zd=({spanGaps:t,onChange:n})=>{const{isMobile:a}=W();return e("div",{className:"vm-graph-settings-row",children:[e("span",{className:"vm-graph-settings-row__label",children:"Connect null values"}),e(ye,{value:t,onChange:n,label:t?"Enabled":"Disabled",fullWidth:a}),e("span",{className:"vm-legend-configs-item__info",children:"Connects data points by skipping null values instead of creating gaps."})]})},Bs=()=>{const[t,n]=ae(),a=Ve();return{handleChange:(o,s)=>{o?t.delete("display_mode"):t.set("display_mode","lines"),n(t),a({type:"RUN_QUERY"}),s&&s()}}},Hd=({onChange:t})=>{const{isMobile:n}=W(),{handleChange:a}=Bs(),[r]=ae(),o=!r.get("display_mode");return e("div",{className:"vm-graph-settings-row",children:[e("span",{className:"vm-graph-settings-row__label",children:"Histogram mode"}),e(ye,{value:o,onChange:i=>{a(i,t)},label:o?"Enabled":"Disabled",fullWidth:n})]})},lo="Graph & Legend Settings",Or=({data:t,yaxis:n,setYaxisLimits:a,toggleEnableLimits:r,spanGaps:o})=>{const{openSettings:s}=Re(),i=mt(),c=Q(null),l=Q(null),m=yr(t),{value:d,setTrue:u,setFalse:h}=se(!1);return A(()=>{s&&(u(),i({type:"SET_OPEN_SETTINGS",payload:!1}))},[s]),e("div",{className:"vm-graph-settings",children:[e(Y,{title:lo,children:e("div",{ref:l,children:e(P,{variant:"text",startIcon:e(ot,{}),onClick:u,ariaLabel:"settings"})})}),d&&e(Pe,{onClose:h,title:lo,className:"vm-graph-settings-modal",children:e("div",{className:"vm-graph-settings-body",ref:c,children:[e("div",{className:"vm-graph-settings-body-section",children:[e("h3",{className:"vm-graph-settings-body-section__title",children:"Graph Options"}),e("div",{className:"vm-graph-settings-body-section-content",children:[e(Fd,{yaxis:n,setYaxisLimits:a,toggleEnableLimits:r}),e(zd,{spanGaps:o.value,onChange:o.onChange}),m&&e(Hd,{onChange:h})]})]}),e("div",{className:"vm-graph-settings-body-section",children:[e("h3",{className:"vm-graph-settings-body-section__title",children:"Legend Options"}),e("div",{className:"vm-graph-settings-body-section-content",children:e(Us,{data:t})})]})]})})]})},js=({isHistogram:t,graphData:n,controlsRef:a,isAnomalyView:r})=>{const{isMobile:o}=W(),{customStep:s,yaxis:i,spanGaps:c}=Re(),{period:l}=he(),{query:m}=Ee(),d=Ve(),u=mt(),h=g=>{u({type:"SET_YAXIS_LIMITS",payload:g})},p=()=>{u({type:"TOGGLE_ENABLE_YAXIS_LIMITS"})},v=g=>{u({type:"SET_SPAN_GAPS",payload:g})},b=({from:g,to:_})=>{d({type:"SET_PERIOD",payload:{from:g,to:_}})},f=e("div",{className:"vm-custom-panel-body-header__graph-controls",children:[e(mr,{}),e(Or,{data:n,yaxis:i,isHistogram:t,setYaxisLimits:h,toggleEnableLimits:p,spanGaps:{value:c,onChange:v}})]});return e(U,{children:[a.current&&Ut(f,a.current),e(ta,{data:n,period:l,customStep:s,query:m,yaxis:i,setYaxisLimits:h,setPeriod:b,height:o?window.innerHeight*.5:500,isHistogram:t,isAnomalyView:r,spanGaps:c})]})},na=({data:t})=>{const n=Fe(),a=L(()=>JSON.stringify(t,null,2),[t]);return e("div",{className:"vm-json-view",children:[e("div",{className:"vm-json-view__copy",children:e(P,{variant:"outlined",onClick:async()=>{await n(a,"Formatted JSON has been copied")},children:"Copy JSON"})}),e("pre",{className:"vm-json-view__code",children:e("code",{children:a})})]})},Rr=t=>{const n={};return t.forEach(a=>Object.entries(a.metric).forEach(r=>n[r[0]]?n[r[0]].options.add(r[1]):n[r[0]]={options:new Set([r[1]])})),Object.entries(n).map(a=>({key:a[0],variations:a[1].options.size})).sort((a,r)=>a.variations-r.variations)},co=(t,n)=>L(()=>n?Rr(t).filter(r=>n.includes(r.key)):[],[t,n]),Qs=({data:t,displayColumns:n})=>{const a=Fe(),{isMobile:r}=W(),{tableCompact:o}=Ue(),s=Q(null),[i,c]=C(""),[l,m]=C("asc"),d=o?co([{group:0,metric:{Data:"Data"}}],["Data"]):co(t,n),u=y=>{const{__name__:w,...S}=y;return!w&&!Object.keys(S).length?"":w?`${w} ${JSON.stringify(S)}`:`${JSON.stringify(S)}`},p=new Set(t==null?void 0:t.map(y=>y.group)).size>1,v=L(()=>{const y=t==null?void 0:t.map(N=>({metadata:d.map(k=>o?ka(N,"",p):N.metric[k.key]||"-"),value:N.value?N.value[1]:"-",values:N.values?N.values.map(([k,T])=>`${T} @${k}`):[],copyValue:u(N.metric)})),w=i==="Value",S=d.findIndex(N=>N.key===i);return!w&&S===-1?y:y.sort((N,k)=>{const T=w?Number(N.value):N.metadata[S],x=w?Number(k.value):k.metadata[S];return(l==="asc"?T<x:T>x)?-1:1})},[d,t,i,l,o]),b=L(()=>v.some(y=>y.copyValue),[v]),f=y=>{m(w=>w==="asc"&&i===y?"desc":"asc"),c(y)},g=y=>()=>{f(y)},_=y=>async()=>{await a(y,"Row has been copied")};return v.length?e("div",{className:D({"vm-table-view":!0,"vm-table-view_mobile":r}),children:e("table",{className:"vm-table",ref:s,children:[e("thead",{className:"vm-table-header",children:e("tr",{className:"vm-table__row vm-table__row_header",children:[d.map((y,w)=>e("td",{className:"vm-table-cell vm-table-cell_header vm-table-cell_sort",onClick:g(y.key),children:e("div",{className:"vm-table-cell__content",children:[y.key,e("div",{className:D({"vm-table__sort-icon":!0,"vm-table__sort-icon_active":i===y.key,"vm-table__sort-icon_desc":l==="desc"&&i===y.key}),children:e(Qe,{})})]})},w)),e("td",{className:"vm-table-cell vm-table-cell_header vm-table-cell_right vm-table-cell_sort",onClick:g("Value"),children:e("div",{className:"vm-table-cell__content",children:[e("div",{className:D({"vm-table__sort-icon":!0,"vm-table__sort-icon_active":i==="Value","vm-table__sort-icon_desc":l==="desc"}),children:e(Qe,{})}),"Value"]})}),b&&e("td",{className:"vm-table-cell vm-table-cell_header"})]})}),e("tbody",{className:"vm-table-body",children:v.map((y,w)=>e("tr",{className:"vm-table__row",children:[y.metadata.map((S,N)=>e("td",{className:D({"vm-table-cell vm-table-cell_no-wrap":!0,"vm-table-cell_gray":v[w-1]&&v[w-1].metadata[N]===S}),children:S},N)),e("td",{className:"vm-table-cell vm-table-cell_right vm-table-cell_no-wrap",children:y.values.length?y.values.map(S=>e("p",{children:S},S)):y.value}),b&&e("td",{className:"vm-table-cell vm-table-cell_right",children:y.copyValue&&e("div",{className:"vm-table-cell__content",children:e(Y,{title:"Copy row",children:e(P,{variant:"text",color:"gray",size:"small",startIcon:e(Xe,{}),onClick:_(y.copyValue),ariaLabel:"copy row"})})})})]},w))})]})}):e(ie,{variant:"warning",children:"No data to show"})},Aa=({checked:t=!1,disabled:n=!1,label:a,color:r="secondary",onChange:o})=>{const s=()=>{n||o(!t)},i=D({"vm-checkbox":!0,"vm-checkbox_disabled":n,"vm-checkbox_active":t,[`vm-checkbox_${r}_active`]:t,[`vm-checkbox_${r}`]:r});return e("div",{className:i,onClick:s,children:[e("div",{className:"vm-checkbox-track",children:e("div",{className:"vm-checkbox-track__thumb",children:e(Qn,{})})}),a&&e("span",{className:"vm-checkbox__label",children:a})]})},ma="Table settings",Fr=({columns:t,selectedColumns:n=[],tableCompact:a,onChangeColumns:r,toggleTableCompact:o})=>{const[s,i]=ae(),c=Q(null),{value:l,toggle:m,setFalse:d}=se(!1),[u,h]=C(""),[p,v]=C(-1),b=L(()=>n.filter(T=>!t.includes(T)),[t,n]),f=L(()=>{const T=b.concat(t);return u?T.filter(x=>x.includes(u)):T},[t,b,u]),g=L(()=>f.every(T=>n.includes(T)),[n,f]),_=T=>{r(T);const x=new URLSearchParams(s.toString());T.length===t.length?x.delete("columns"):x.set("columns",T.map(encodeURIComponent).join(",")),i(x)},y=T=>{const x=n.includes(T)?n.filter(M=>M!==T):[...n,T];_(x)},w=()=>{_(g?n.filter(T=>!f.includes(T)):f)},S=T=>()=>{y(T)},N=()=>{v(-1)},k=T=>{const x=T.key==="ArrowUp",M=T.key==="ArrowDown",E=T.key==="Enter";(M||x||E)&&T.preventDefault(),M?v(I=>I+1>f.length-1?I:I+1):x?v(I=>I-1<0?I:I-1):E&&y(f[p])};return A(()=>{Jn(t,n)||s.has("columns")||r(t)},[t]),A(()=>{if(!s.has("columns"))return;const M=(s.get("columns")||"").split(",").map(decodeURIComponent).filter(Boolean);r(M)},[]),e("div",{className:"vm-table-settings",children:[e(Y,{title:ma,children:e("div",{ref:c,children:e(P,{variant:"text",startIcon:e(ot,{}),onClick:m,ariaLabel:ma})})}),l&&e(Pe,{title:ma,className:"vm-table-settings-modal",onClose:d,children:[e("div",{className:"vm-table-settings-modal-section",children:[e("div",{className:"vm-table-settings-modal-section__title",children:"Customize columns"}),e("div",{className:"vm-table-settings-modal-columns",children:[e("div",{className:"vm-table-settings-modal-columns__search",children:e(le,{placeholder:"Search columns",startIcon:e(ns,{}),value:u,onChange:h,onBlur:N,onKeyDown:k,type:"search"})}),e("div",{className:"vm-table-settings-modal-columns-list",children:[!!f.length&&e("div",{className:"vm-table-settings-modal-columns-list__item vm-table-settings-modal-columns-list__item_all",children:e(Aa,{checked:g,onChange:w,label:g?"Uncheck all":"Check all",disabled:a})}),!f.length&&e("div",{className:"vm-table-settings-modal-columns-no-found",children:e("p",{className:"vm-table-settings-modal-columns-no-found__info",children:"No columns found."})}),f.map((T,x)=>e("div",{className:D({"vm-table-settings-modal-columns-list__item":!0,"vm-table-settings-modal-columns-list__item_focus":x===p,"vm-table-settings-modal-columns-list__item_custom":b.includes(T)}),children:e(Aa,{checked:n.includes(T),onChange:S(T),label:T,disabled:a})},T))]})]})]}),e("div",{className:"vm-table-settings-modal-section",children:[e("div",{className:"vm-table-settings-modal-section__title",children:"Table view"}),e("div",{className:"vm-table-settings-modal-columns-list__item",children:e(ye,{label:"Compact view",value:a,onChange:o})})]})]})]})},Vd=({liveData:t,controlsRef:n})=>{const{tableCompact:a}=Ue(),r=Gt(),[o,s]=C(),i=L(()=>Rr(t||[]).map(m=>m.key),[t]),l=e(Fr,{columns:i,selectedColumns:o,onChangeColumns:s,tableCompact:a,toggleTableCompact:()=>{r({type:"TOGGLE_TABLE_COMPACT"})}});return e(U,{children:[n.current&&Ut(l,n.current),e(Qs,{data:t,displayColumns:o})]})},Ys=({graphData:t,liveData:n,isHistogram:a,displayType:r,controlsRef:o})=>r===we.code&&n?e(na,{data:n}):r===we.table&&n?e(Vd,{liveData:n,controlsRef:o}):r===we.chart&&t?e(js,{graphData:t,isHistogram:a,controlsRef:o}):null,Ud=e(U,{children:[e("p",{children:"Filename - specify the name for your report file."}),e("p",{children:["Default format: ",e("code",{children:["vmui_report_$",$o,".json"]}),"."]}),e("p",{children:"This name will be used when saving your report on your device."})]}),qd=e(U,{children:[e("p",{children:["Title - specify the title that will be displayed on the ",e(zn,{to:J.queryAnalyzer,target:"_blank",rel:"noreferrer",className:"vm-link vm-link_underlined",children:ct[J.queryAnalyzer].title})," page."]}),e("p",{children:"This helps identify your report in the interface."})]}),Bd=e(U,{children:[e("p",{children:"Comment (optional) - add a comment to your report."}),e("p",{children:"This can be any additional information that will be useful when reviewing the report later."})]}),jd=e(U,{children:[e("p",{children:"Query trace - enable this option to include a query trace in your report."}),e("p",{children:"This will assist in analyzing and diagnosing the query processing."})]}),Qd=e(U,{children:[e("p",{children:"Generate Report - click this button to generate and save your report. "}),e("p",{children:["After creation, the report can be downloaded and examined on the ",e(zn,{to:J.queryAnalyzer,target:"_blank",rel:"noreferrer",className:"vm-link vm-link_underlined",children:ct[J.queryAnalyzer].title})," page."]})]}),Yd=[Ud,qd,Bd,jd,Qd],Gs=t=>{try{return JSON.parse(t)}catch{return null}},Gd=[{title:"Write",value:!1},{title:"Preview",value:!0}],Wd=({value:t,onChange:n})=>{const{value:a,setTrue:r,setFalse:o}=se(!1);return e("div",{className:"vm-markdown-editor",children:[e("div",{className:"vm-markdown-editor-header",children:[e("div",{className:"vm-markdown-editor-header-tabs",children:Gd.map(({title:s,value:i})=>e("div",{className:D({"vm-markdown-editor-header-tabs__tab":!0,"vm-markdown-editor-header-tabs__tab_active":a===i}),onClick:i?r:o,children:s},s))}),e("span",{className:"vm-markdown-editor-header__info",children:"Markdown is supported"})]}),a?e("div",{className:"vm-markdown-editor-preview vm-markdown",dangerouslySetInnerHTML:{__html:qt(t)}}):e(le,{type:"textarea",value:t,onChange:n})]})};var Ws=(t=>(t[t.QUERY_DATA=0]="QUERY_DATA",t[t.RAW_DATA=1]="RAW_DATA",t))(Ws||{});const Kd=t=>{switch(t){case 1:return"Raw report";default:return"Report"}},Jd=t=>{const n=B().utc().format($o);return`vmui_${t.toLowerCase().replace(/ /g,"_")}_${n}`},Ks=({fetchUrl:t,reportType:n=0})=>{const{query:a}=Ee(),r=Kd(n),o=Jd(r),[s,i]=C(r),[c,l]=C(o),[m,d]=C(""),[u,h]=C(n===0),[p,v]=C(),[b,f]=C(!1),g=Q(null),_=Q(null),y=Q(null),w=Q(null),S=Q(null),N=[_,g,y,w,S],[k,T]=C(0),{value:x,toggle:M,setFalse:E}=se(!1),{value:I,toggle:$,setFalse:O}=se(!1),V=X(()=>{if(t)try{return t.map((R,F)=>{const q=new URL(R);return u?q.searchParams.set("trace","1"):q.searchParams.delete("trace"),{id:F,url:q}})}catch(R){v(String(R))}},[t,u]),z=X(R=>{const F=JSON.stringify(R,null,2),q=new Blob([F],{type:"application/json"}),Z=URL.createObjectURL(q),ee=document.createElement("a");ee.href=Z,ee.download=`${c||o}.json`,document.body.appendChild(ee),ee.click(),document.body.removeChild(ee),URL.revokeObjectURL(Z),E()},[c]),j=({id:R,url:F,comment:q,title:Z})=>({id:R,title:Z||r,comment:q,endpoint:ki(F.pathname)||"",params:Object.fromEntries(F.searchParams)}),H=async(R,F)=>{const q=[],Z=await R.text();return R.ok?Z.split(`
`).filter(ue=>ue).forEach(ue=>{const _e=Gs(ue);_e&&q.push({metric:_e.metric,values:_e.values.map((We,Ne)=>[_e.timestamps[Ne]/1e3,We])})}):v(String(Z)),{data:{result:q,resultType:"matrix"},vmui:j(F)}},te=async(R,F)=>{const q=await R.json();if(R.ok)return q.vmui=j(F),q;{const Z=q.errorType?`${q.errorType}\r
`:"";v(`${Z}${(q==null?void 0:q.error)||(q==null?void 0:q.message)||"unknown error"}`)}},de=async(R,F)=>{switch(n){case 1:return await H(R,F);default:return await te(R,F)}},G=X(async()=>{const R=V();if(!R){v(F=>F||be.validQuery);return}v(""),f(!0);try{const F=[];for await(const q of R){if(!q)continue;const{url:Z,id:ee}=q,ue=await fetch(Z),_e=await de(ue,{id:ee,url:Z,comment:m,title:s});F.push(_e)}F.length&&z(F)}catch(F){F instanceof Error&&F.name!=="AbortError"&&v(`${F.name}: ${F.message}`)}finally{f(!1)}},[V,m,z,a,s]),oe=R=>()=>{const F=q=>{var ee;const Z=q+R;return(ee=N[Z])!=null&&ee.current?Z:F(Z)};T(F)};return A(()=>{v(""),l(o),d("")},[x]),A(()=>{T(0)},[I]),e(U,{children:[e(Y,{title:"Export query",children:e(P,{variant:"text",startIcon:e(Gn,{}),onClick:M,ariaLabel:"export query"})}),x&&e(Pe,{title:"Export query",onClose:E,isOpen:x,children:e("div",{className:"vm-download-report",children:[e("div",{className:"vm-download-report-settings",children:[e("div",{ref:_,children:[e("div",{className:"vm-download-report-settings__title",children:"Filename"}),e(le,{value:c,onChange:l})]}),e("div",{ref:g,children:[e("div",{className:"vm-download-report-settings__title",children:"Report title"}),e(le,{value:s,onChange:i})]}),e("div",{ref:y,children:[e("div",{className:"vm-download-report-settings__title",children:"Comment"}),e(Wd,{value:m,onChange:d})]}),n===0&&e(U,{children:[e("div",{ref:w,children:e(Aa,{checked:u,onChange:h,label:"Include query trace"})}),e(ie,{variant:"info",children:["If confused with the query results, try viewing the raw samples for selected series in ",e(()=>e(zn,{className:"vm-link vm-link_underlined vm-link_colored",to:J.rawQuery,children:"Raw Query"}),{})," tab."]})]})]}),p&&e(ie,{variant:"error",children:p}),e("div",{className:"vm-download-report__buttons",children:[e(P,{variant:"text",onClick:$,children:"Help"}),e("div",{ref:S,children:e(P,{onClick:G,disabled:b,children:b?"Loading data...":"Generate Report"})})]}),e(Ie,{open:I,buttonRef:N[k],placement:"top-left",variant:"dark",onClose:O,children:e("div",{className:"vm-download-report-helper",children:[e("div",{className:"vm-download-report-helper__description",children:Yd[k]}),e("div",{className:"vm-download-report-helper__buttons",children:[k!==0&&e(P,{onClick:oe(-1),size:"small",color:"white",children:"Prev"}),e(P,{onClick:k===N.length-1?O:oe(1),size:"small",color:"white",variant:"text",children:k===N.length-1?"Close":"Next"})]})]})})]})})]})},Js=()=>{const{isEmptyHistogram:t}=Re(),{handleChange:n}=Bs();return t?e(ie,{variant:"warning",children:e("div",{className:"vm-warning-heatmap-to-line",children:[e("p",{className:"vm-warning-heatmap-to-line__text",children:'The expression cannot be displayed as a heatmap. To make the graph work, disable the heatmap in the "Graph settings" or modify the expression.'}),e(P,{size:"small",color:"primary",variant:"text",onClick:()=>n(!1),children:"Switch to line chart"})]})}):null},Zs=()=>{wr();const{isMobile:t}=W(),{displayType:n}=Ue(),{query:a}=Ee(),{customStep:r}=Re(),o=mt(),[s,i]=C([]),[c,l]=C(!a[0]),[m,d]=C(!1),u=Q(null),{fetchUrl:h,isLoading:p,liveData:v,graphData:b,error:f,queryErrors:g,setQueryErrors:_,queryStats:y,warning:w,traces:S,isHistogram:N,abortFetch:k}=Zn({visible:!0,customStep:r,hideQuery:s,showAllSeries:m}),T=!(v!=null&&v.length)&&n!==we.chart,x=!c&&f,M=I=>{i(I)},E=()=>{l(!1)};return A(()=>{o({type:"SET_IS_HISTOGRAM",payload:N})},[b]),e("div",{className:D({"vm-custom-panel":!0,"vm-custom-panel_mobile":t}),children:[e(br,{queryErrors:c?[]:g,setQueryErrors:_,setHideError:l,stats:y,isLoading:p,onHideQuery:M,onRunQuery:E,abortFetch:k,hideButtons:{reduceMemUsage:!0}}),e(Uc,{traces:S,displayType:n}),x&&e(ie,{variant:"error",children:f}),T&&e(ie,{variant:"info",children:e(Vc,{})}),e(Js,{}),w&&e(ea,{warning:w,query:a,onChange:d}),e("div",{className:D({"vm-custom-panel-body":!0,"vm-custom-panel-body_mobile":t,"vm-block":!0,"vm-block_mobile":t}),children:[p&&e(Xn,{}),e("div",{className:"vm-custom-panel-body-header",ref:u,children:[e("div",{className:"vm-custom-panel-body-header__tabs",children:e(rs,{})}),(b||v)&&e(Ks,{fetchUrl:h})]}),e(Ys,{graphData:b,liveData:v,isHistogram:N,displayType:n,controlsRef:u})]})]})},Zd=({title:t,description:n,unit:a,expr:r,showLegend:o,filename:s,alias:i})=>{const{isMobile:c}=W(),{period:l}=he(),{customStep:m}=Re(),d=Ve(),u=Q(null),[h,p]=C(!1),[v,b]=C(!1),[f,g]=C({limits:{enable:!1,range:{1:[0,0]}}}),_=L(()=>Array.isArray(r)&&r.every(E=>E),[r]),{isLoading:y,graphData:w,error:S,warning:N}=Zn({predefinedQuery:_?r:[],display:we.chart,visible:h,customStep:m}),k=E=>{const I={...f};I.limits.range=E,g(I)},T=()=>{const E={...f};E.limits.enable=!E.limits.enable,g(E)},x=({from:E,to:I})=>{d({type:"SET_PERIOD",payload:{from:E,to:I}})};return A(()=>{const E=new IntersectionObserver(I=>{I.forEach($=>p($.isIntersecting))},{threshold:.1});return u.current&&E.observe(u.current),()=>{u.current&&E.unobserve(u.current)}},[u]),_?e("div",{className:"vm-predefined-panel",ref:u,children:[e("div",{className:"vm-predefined-panel-header",children:[e(Y,{title:e(()=>e("div",{className:"vm-predefined-panel-header__description vm-default-styles",children:[n&&e(U,{children:[e("div",{children:[e("span",{children:"Description:"}),e("div",{dangerouslySetInnerHTML:{__html:qt(n)}})]}),e("hr",{})]}),e("div",{children:[e("span",{children:"Queries:"}),e("div",{children:r.map((E,I)=>e("div",{children:E},`${I}_${E}`))})]})]}),{}),children:e("div",{className:"vm-predefined-panel-header__info",children:e(st,{})})}),e("h3",{className:"vm-predefined-panel-header__title",children:t||""}),e(Or,{data:w||[],yaxis:f,setYaxisLimits:k,toggleEnableLimits:T,spanGaps:{value:v,onChange:b}})]}),e("div",{className:"vm-predefined-panel-body",children:[y&&e(qe,{}),S&&e(ie,{variant:"error",children:S}),N&&e(ie,{variant:"warning",children:N}),w&&e(ta,{isPredefinedPanel:!0,data:w,period:l,customStep:m,query:r,yaxis:f,unit:a,alias:i,showLegend:o,setYaxisLimits:k,setPeriod:x,fullWidth:!1,height:c?window.innerHeight*.5:500,spanGaps:v})]})]}):e(ie,{variant:"error",children:[e("code",{children:'"expr"'})," not found. Check the configuration file ",e("b",{children:s}),"."]})},Xd=({index:t,title:n,panels:a,filename:r})=>{const o=Mt(),s=L(()=>o.width/12,[o]),[i,c]=C(!t),[l,m]=C([]);A(()=>{m(a&&a.map(_=>_.width||12))},[a]);const[d,u]=C({start:0,target:0,enable:!1}),h=X(_=>{if(!d.enable)return;const{start:y}=d,w=Math.ceil((y-_.clientX)/s);if(Math.abs(w)>=12)return;const S=l.map((N,k)=>N-(k===d.target?w:0));m(S)},[d,s]),p=(_,y)=>{u({start:_.clientX,target:y,enable:!0})},v=X(()=>{u({...d,enable:!1})},[d]),b=_=>c(_),f=_=>y=>{p(y,_)};return ce("mousemove",h),ce("mouseup",v),e("div",{className:"vm-predefined-dashboard",children:e(Kn,{defaultExpanded:i,onChange:b,title:e(()=>e("div",{className:D({"vm-predefined-dashboard-header":!0,"vm-predefined-dashboard-header_open":i}),children:[(n||r)&&e("span",{className:"vm-predefined-dashboard-header__title",children:n||`${t+1}. ${r}`}),a&&e("span",{className:"vm-predefined-dashboard-header__count",children:["(",a.length," panels)"]})]}),{}),children:e("div",{className:"vm-predefined-dashboard-panels",children:Array.isArray(a)&&a.length?a.map((_,y)=>e("div",{className:"vm-predefined-dashboard-panels-panel vm-block vm-block_empty-padding",style:{gridColumn:`span ${l[y]}`},children:[e(Zd,{title:_.title,description:_.description,unit:_.unit,expr:_.expr,alias:_.alias,filename:r,showLegend:_.showLegend}),e("button",{className:"vm-predefined-dashboard-panels-panel__resizer",onMouseDown:f(y),"aria-label":"resize the panel"})]},y)):e("div",{className:"vm-predefined-dashboard-panels-panel__alert",children:e(ie,{variant:"error",children:[e("code",{children:'"panels"'})," not found. Check the configuration file ",e("b",{children:r}),"."]})})})})})};function em(t,n){return Object.fromEntries(Object.entries(t).filter(n))}function Xs(t){return em(t,n=>!!n[1]||typeof n[1]=="number")}function tm(t){return Object.keys(t).length===0}const nm=()=>{const{duration:t,relativeTime:n,period:{date:a}}=he(),{customStep:r}=Re(),{setSearchParamsFromKeys:o}=ft(),s=()=>{const i=Xs({"g0.range_input":t,"g0.end_input":a,"g0.step_input":r,"g0.relative_time":n});o(i)};A(s,[t,n,a,r]),A(s,[])},am=()=>{nm();const{isMobile:t}=W(),{dashboardsSettings:n,dashboardsLoading:a,dashboardsError:r}=ss(),[o,s]=C(0),i=L(()=>n.map((p,v)=>({label:p.title||"",value:v})),[n]),c=L(()=>n[o]||{},[n,o]),l=L(()=>c==null?void 0:c.rows,[c]),m=L(()=>c.title||c.filename||"",[c]),d=L(()=>Array.isArray(l)&&!!l.length,[l]),u=p=>{s(p)},h=p=>()=>{u(p)};return e("div",{className:"vm-predefined-panels",children:[a&&e(qe,{}),!n.length&&r&&e(ie,{variant:"error",children:r}),!n.length&&e(ie,{variant:"info",children:"Dashboards not found"}),i.length>1&&e("div",{className:D({"vm-predefined-panels-tabs":!0,"vm-predefined-panels-tabs_mobile":t}),children:i.map(p=>e("div",{className:D({"vm-predefined-panels-tabs__tab":!0,"vm-predefined-panels-tabs__tab_active":p.value==o}),onClick:h(p.value),children:p.label},p.value))}),e("div",{className:"vm-predefined-panels__dashboards",children:[d&&l.map((p,v)=>e(Xd,{index:v,filename:m,title:p.title,panels:p.panels},`${o}_${v}`)),!!n.length&&!d&&e(ie,{variant:"error",children:[e("code",{children:'"rows"'})," not found. Check the configuration file ",e("b",{children:m}),"."]})]})]})},ua=(t,n)=>{const a=n.match?"&match[]="+encodeURIComponent(n.match):"",r=n.focusLabel?"&focusLabel="+encodeURIComponent(n.focusLabel):"";return`${t}/api/v1/status/tsdb?topN=${n.topN}&date=${n.date}${a}${r}`},mn={id:"action",label:""},un={id:"diff",label:"1d",info:"Shows the absolute difference compared to the previous day.",sortable:!0},hn={id:"diffPercent",label:"1d %",info:"Shows the percentage difference compared to the previous day.",sortable:!0},rm=[{id:"name",label:"Metric name",sortable:!0},{id:"value",label:"Number of series",sortable:!0},un,hn,{id:"percentage",label:"Share in total",info:"Shows the share of a metric to the total number of series"},mn],om=[{id:"name",label:"Label name",sortable:!0},{id:"value",label:"Number of series",sortable:!0},un,hn,{id:"percentage",label:"Share in total",info:"Shows the share of the label to the total number of series"},mn],sm=[{id:"name",label:"Label value",sortable:!0},{id:"value",label:"Number of series",sortable:!0},un,hn,{id:"percentage",label:"Share in total"},mn],im=[{id:"name",label:"Label=value pair",sortable:!0},{id:"value",label:"Number of series",sortable:!0},un,hn,{id:"percentage",label:"Share in total",info:"Shows the share of the label value pair to the total number of series"},mn],lm=[{id:"name",label:"Label name",sortable:!0},{id:"value",label:"Number of unique values",sortable:!0},un,hn,mn];class cm{constructor(){Ye(this,"tsdbStatus");Ye(this,"tabsNames");Ye(this,"isPrometheus");this.tsdbStatus=this.defaultTSDBStatus,this.tabsNames=["table","graph"],this.isPrometheus=!1,this.getDefaultState=this.getDefaultState.bind(this)}set tsdbStatusData(n){this.isPrometheus=!!(n!=null&&n.headStats),this.tsdbStatus=n}get tsdbStatusData(){return this.tsdbStatus}get defaultTSDBStatus(){return{totalSeries:0,totalSeriesPrev:0,totalSeriesByAll:0,totalLabelValuePairs:0,seriesCountByMetricName:[],seriesCountByLabelName:[],seriesCountByFocusLabelValue:[],seriesCountByLabelValuePair:[],labelValueCountByLabelName:[]}}get isPrometheusData(){return this.isPrometheus}keys(n,a){const r=n&&/__name__=".+"/.test(n),o=n&&/{.+=".+"}/g.test(n),s=n&&/__name__=".+", .+!=""/g.test(n);let i=[];return a||s?i=i.concat("seriesCountByFocusLabelValue"):r?i=i.concat("labelValueCountByLabelName"):o?i=i.concat("seriesCountByMetricName","seriesCountByLabelName"):i=i.concat("seriesCountByMetricName","seriesCountByLabelName","seriesCountByLabelValuePair","labelValueCountByLabelName"),i}getDefaultState(n,a){return this.keys(n,a).reduce((r,o)=>({...r,tabs:{...r.tabs,[o]:this.tabsNames},containerRefs:{...r.containerRefs,[o]:Q(null)}}),{tabs:{},containerRefs:{}})}sectionsTitles(n){return{seriesCountByMetricName:"Metric names with the highest number of series",seriesCountByLabelName:"Labels with the highest number of series",seriesCountByFocusLabelValue:`Values for "${n}" label with the highest number of series`,seriesCountByLabelValuePair:"Label=value pairs with the highest number of series",labelValueCountByLabelName:"Labels with the highest number of unique values"}}get sectionsTips(){return{seriesCountByMetricName:`
        <p>
          This table returns a list of metrics with the highest cardinality.
          The cardinality of a metric is the number of time series associated with that metric,
          where each time series is defined as a unique combination of key-value label pairs.
        </p>
        <p>
          When looking to reduce the number of active series in your data source,
          you can start by inspecting individual metrics with high cardinality
          (i.e. that have lots of active time series associated with them),
          since that single metric contributes a large fraction of the series that make up your total series count.
        </p>`,seriesCountByLabelName:`
        <p>
          This table returns a list of the labels with the highest number of series.
        </p>
        <p>
          Use this table to identify labels that are storing dimensions with high cardinality
          (many different label values).
        </p>
        <p>
          It is recommended to choose labels such that they have a finite set of values,
          since every unique combination of key-value label pairs creates a new time series
          and therefore can dramatically increase the number of time series in your system.
        </p>`,seriesCountByFocusLabelValue:`
       <p>
          This table returns a list of unique label values per selected label.
       </p>
       <p>
          Use this table to identify label values that are storing per each selected series.
       </p>`,labelValueCountByLabelName:`
       <p>
          This table returns a list of labels with the highest number of the unique values.
       </p>
      `,seriesCountByLabelValuePair:`
        <p>
          This table returns a list of the label values pairs with the highest number of series.
        </p>
        <p>
          Use this table to identify unique label values pairs. This helps to identify same labels 
          is applied to count timeseries in your system, since every unique combination of key-value label pairs 
          creates a new time series and therefore can dramatically increase the number of time series in your system
        </p>`}}get tablesHeaders(){return{seriesCountByMetricName:rm,seriesCountByLabelName:om,seriesCountByFocusLabelValue:sm,seriesCountByLabelValuePair:im,labelValueCountByLabelName:lm}}totalSeries(n,a=!1){return n==="labelValueCountByLabelName"?-1:a?this.tsdbStatus.totalSeriesPrev:this.tsdbStatus.totalSeries}}const dm=()=>{const t=new cm,[n]=ae(),a=n.get("match"),r=n.get("focusLabel"),o=+(n.get("topN")||10),s=n.get("date")||B().tz().format(Nt),i=nn(s),c=Q(),{serverUrl:l}=re(),[m,d]=C(!1),[u,h]=C(),[p,v]=C(t.defaultTSDBStatus),[b,f]=C(!1),g=async w=>{const S=await fetch(w),N=await S.json();if(S.ok)return N;console.error(`Error fetching ${w}:`,N);const k=N.errorType||be.unknownType,T=(N==null?void 0:N.error)||(N==null?void 0:N.message)||"see console for more details",x=[k,T].join(`\r
`);throw new Error(x)},_=(w,S)=>{Object.keys(w).forEach(N=>{const k=N,T=w[k],x=S[k];Array.isArray(T)&&Array.isArray(x)&&T.forEach(M=>{var O;const E=(O=x.find(V=>V.name===M.name))==null?void 0:O.value,I=E?M.value-E:0,$=E?I/E*100:0;M.diff=I,M.diffPercent=$,M.valuePrev=E||0})})},y=async w=>{var T,x,M,E,I,$,O,V,z,j;if(!l)return;h(""),d(!0),v(t.defaultTSDBStatus);const S={...w,date:w.date,topN:0,match:"",focusLabel:""},N={...w,date:B(w.date).subtract(1,"day").format(Nt)},k=[ua(l,w),ua(l,N)];i!==s&&(w.match||w.focusLabel)&&k.push(ua(l,S));try{const[H,te,de]=await Promise.all(k.map(g)),G={...te.data},{data:oe}=de||c.current||H;c.current={data:oe};const K={...H.data,totalSeries:((T=H.data)==null?void 0:T.totalSeries)||((M=(x=H.data)==null?void 0:x.headStats)==null?void 0:M.numSeries)||0,totalLabelValuePairs:((E=H.data)==null?void 0:E.totalLabelValuePairs)||(($=(I=H.data)==null?void 0:I.headStats)==null?void 0:$.numLabelValuePairs)||0,seriesCountByLabelName:((O=H.data)==null?void 0:O.seriesCountByLabelName)||[],seriesCountByFocusLabelValue:((V=H.data)==null?void 0:V.seriesCountByFocusLabelValue)||[],totalSeriesByAll:(oe==null?void 0:oe.totalSeries)||((z=oe==null?void 0:oe.headStats)==null?void 0:z.numSeries)||p.totalSeriesByAll||0,totalSeriesPrev:(G==null?void 0:G.totalSeries)||((j=G==null?void 0:G.headStats)==null?void 0:j.numSeries)||0},R=a==null?void 0:a.replace(/[{}"]/g,"");K.seriesCountByLabelValuePair=K.seriesCountByLabelValuePair.filter(F=>F.name!==R),_(K,G),v(K),d(!1)}catch(H){d(!1),H instanceof Error&&h(`${H.name}: ${H.message}`)}};return A(()=>{y({topN:o,match:a,date:s,focusLabel:r})},[l,a,r,o,s]),A(()=>{u&&(v(t.defaultTSDBStatus),d(!1))},[u]),A(()=>{const w=on(l);f(!!w)},[l]),t.tsdbStatusData=p,{isLoading:m,appConfigurator:t,error:u,isCluster:b}},mm={seriesCountByMetricName:({query:t})=>ha("__name__",t),seriesCountByLabelName:({query:t})=>`{${t}!=""}`,seriesCountByFocusLabelValue:({query:t,focusLabel:n})=>ha(n,t),seriesCountByLabelValuePair:({query:t})=>{const n=t.split("="),a=n[0],r=n.slice(1).join("=");return ha(a,r)},labelValueCountByLabelName:({query:t,match:n})=>n===""?`{${t}!=""}`:`${n.replace("}","")}, ${t}!=""}`},ha=(t,n)=>t?"{"+t+"="+JSON.stringify(n)+"}":"",um=({totalSeries:t=0,totalSeriesPrev:n=0,totalSeriesAll:a=0,seriesCountByMetricName:r=[],isPrometheus:o})=>{var v;const{isMobile:s}=W(),[i]=ae(),c=i.get("match"),l=i.get("focusLabel"),m=/__name__/.test(c||""),d=((v=r[0])==null?void 0:v.value)/a*100,u=t-n,h=Math.abs(u)/n*100,p=[{title:"Total series",value:t.toLocaleString("en-US"),dynamic:!t||!n||o?"":`${h.toFixed(2)}%`,display:!l,info:`The total number of unique time series for a selected day.
             A time series is uniquely identified by its name plus a set of its labels. 
             For example, temperature{city="NY",country="US"} and temperature{city="SF",country="US"} 
             are two distinct series, since they differ by the "city" label.`},{title:"Percentage from total",value:isNaN(d)?"-":`${d.toFixed(2)}%`,display:m,info:"The share of these series in the total number of time series."}].filter(b=>b.display);return p.length?e("div",{className:D({"vm-cardinality-totals":!0,"vm-cardinality-totals_mobile":s}),children:p.map(({title:b,value:f,info:g,dynamic:_})=>e("div",{className:"vm-cardinality-totals-card",children:[e("h4",{className:"vm-cardinality-totals-card__title",children:[g&&e(Y,{title:e("p",{className:"vm-cardinality-totals-card__tooltip",children:g}),children:e("div",{className:"vm-cardinality-totals-card__info-icon",children:e(Un,{})})}),b]}),e("span",{className:"vm-cardinality-totals-card__value",children:f}),!!_&&e(Y,{title:`in relation to the previous day: ${n.toLocaleString("en-US")}`,children:e("span",{className:D({"vm-dynamic-number":!0,"vm-dynamic-number_positive vm-dynamic-number_down":u<0,"vm-dynamic-number_negative vm-dynamic-number_up":u>0}),children:_})})]},b))}):null},Ae=(t,n)=>{const[a]=ae(),r=a.get(n)?a.get(n):t,[o,s]=C(r);return A(()=>{r!==o&&s(r)},[r]),[o,s]},hm=({isPrometheus:t,isCluster:n,...a})=>{const{isMobile:r}=W(),[o]=ae(),{setSearchParamsFromKeys:s}=ft(),i=o.get("tips")||"",[c,l]=Ae("","match"),[m,d]=Ae("","focusLabel"),[u,h]=Ae(10,"topN"),p=L(()=>u<0?"Number must be bigger than zero":"",[u]),v=_=>{const y=+_;h(isNaN(y)?0:y)},b=()=>{s({match:c,topN:u,focusLabel:m})},f=()=>{s({match:"",focusLabel:""})},g=()=>{const _=o.get("tips")||"";s({tips:_?"":"true"})};return A(()=>{const _=o.get("match"),y=+(o.get("topN")||10),w=o.get("focusLabel");_!==c&&l(_||""),y!==u&&h(y),w!==m&&d(w||"")},[o]),e("div",{className:D({"vm-cardinality-configurator":!0,"vm-cardinality-configurator_mobile":r,"vm-block":!0,"vm-block_mobile":r}),children:[e("div",{className:"vm-cardinality-configurator-controls",children:[e("div",{className:"vm-cardinality-configurator-controls__query",children:e(le,{label:"Time series selector",type:"string",value:c,onChange:l,onEnter:b})}),e("div",{className:"vm-cardinality-configurator-controls__item",children:e(le,{label:"Focus label",type:"text",value:m||"",onChange:d,onEnter:b,endIcon:e(Y,{title:e("div",{children:e("p",{children:"To identify values with the highest number of series for the selected label."})}),children:e(Ja,{})})})}),e("div",{className:"vm-cardinality-configurator-controls__item vm-cardinality-configurator-controls__item_limit",children:e(le,{label:"Limit entries",type:"number",value:t?10:u,error:p,disabled:t,helperText:t?"not available for Prometheus":"",onChange:v,onEnter:b})})]}),e("div",{className:"vm-cardinality-configurator-bottom",children:[e(um,{isPrometheus:t,isCluster:n,...a}),n&&e("div",{className:"vm-cardinality-configurator-bottom-helpful",children:e(Se,{href:"https://docs.victoriametrics.com/Single-server-VictoriaMetrics.html#cardinality-explorer-statistic-inaccuracy",withIcon:!0,children:[e(it,{}),"Statistic inaccuracy explanation"]})}),e("div",{className:"vm-cardinality-configurator-bottom-helpful",children:e(Se,{href:"https://docs.victoriametrics.com/#cardinality-explorer",withIcon:!0,children:[e(it,{}),"Documentation"]})}),e("div",{className:"vm-cardinality-configurator-bottom__execute",children:[e(Y,{title:i?"Hide tips":"Show tips",children:e(P,{variant:"text",color:i?"warning":"gray",startIcon:e(cn,{}),onClick:g,ariaLabel:"visibility tips"})}),e(P,{variant:"text",startIcon:e(at,{}),onClick:f,children:"Reset"}),e(P,{startIcon:e(dt,{}),onClick:b,children:"Execute Query"})]})]})]})};function pm(t){const{order:n,orderBy:a,onRequestSort:r,headerCells:o}=t,s=i=>c=>{r(c,i)};return e("thead",{className:"vm-table-header vm-cardinality-panel-table__header",children:e("tr",{className:"vm-table__row vm-table__row_header",children:o.map(i=>e("th",{className:D({"vm-table-cell vm-table-cell_header":!0,"vm-table-cell_sort":i.sortable,"vm-table-cell_right":i.id==="action"}),onClick:i.sortable?s(i.id):void 0,children:e("div",{className:"vm-table-cell__content",children:[i.info&&e(Y,{title:i.info,children:e("div",{className:"vm-metrics-content-header__tip-icon",children:e(Un,{})})}),i.label,i.sortable&&e("div",{className:D({"vm-table__sort-icon":!0,"vm-table__sort-icon_active":a===i.id,"vm-table__sort-icon_desc":n==="desc"&&a===i.id}),children:e(Qe,{})})]})},i.id))})})}const mo=["date","timestamp","time"];function uo(t,n,a){const r=t[a],o=n[a],s=mo.includes(String(a))?En(`${r}`):r,i=mo.includes(String(a))?En(`${o}`):o;return i<s?-1:i>s?1:0}function zr(t,n){return t==="desc"?(a,r)=>uo(a,r,n):(a,r)=>-uo(a,r,n)}function Hr(t,n){const a=t.map((r,o)=>[r,o]);return a.sort((r,o)=>{const s=n(r[0],o[0]);return s!==0?s:r[1]-o[1]}),a.map(r=>r[0])}const gm=({rows:t,headerCells:n,defaultSortColumn:a,tableCells:r})=>{const[o,s]=C("desc"),[i,c]=C(a),l=(d,u)=>{s(i===u&&o==="asc"?"desc":"asc"),c(u)},m=Hr(t,zr(o,i));return e("table",{className:"vm-table vm-cardinality-panel-table",children:[e(pm,{order:o,orderBy:i,onRequestSort:l,rowCount:t.length,headerCells:n}),e("tbody",{className:"vm-table-header",children:m.map(d=>e("tr",{className:"vm-table__row",children:r(d)},d.name))})]})},vm=({row:t,totalSeries:n,totalSeriesPrev:a,onActionClick:r})=>{const o=n>0?t.value/n*100:-1,s=a>0?t.valuePrev/a*100:-1,i=[o,s].some(v=>v===-1),c=t.value.toLocaleString("en-US"),l=t.valuePrev.toLocaleString("en-US"),m=Math.abs(t.diff).toLocaleString("en-US"),d=o-s,u=i?"":`${Math.abs(d).toFixed(2)}%`,h=`${Math.abs(t.diffPercent).toFixed(2)}%`,p=()=>{r(t.name)};return e(U,{children:[e("td",{className:"vm-table-cell",children:e("span",{className:"vm-link vm-link_colored",onClick:p,children:t.name})}),e("td",{className:"vm-table-cell vm-table-cell_compact",children:c}),e("td",{className:"vm-table-cell vm-table-cell_compact",children:e(Y,{title:`in relation to the previous day: ${l}`,children:e("span",{className:D({"vm-dynamic-number":!0,"vm-dynamic-number_positive vm-dynamic-number_down":t.diff<0,"vm-dynamic-number_negative vm-dynamic-number_up":t.diff>0}),children:m})})}),e("td",{className:"vm-table-cell vm-table-cell_compact",children:e(Y,{title:`in relation to the previous day: ${l}`,children:e("div",{className:D({"vm-dynamic-number":!0,"vm-dynamic-number_positive vm-dynamic-number_down":t.diff<0,"vm-dynamic-number_negative vm-dynamic-number_up":t.diff>0}),children:h})})}),o>0&&e("td",{className:"vm-table-cell",children:e("div",{className:"vm-cardinality-panel-table__progress",children:[e(ks,{value:o,hideValue:!0}),e("span",{className:"vm-dynamic-number vm-dynamic-number_static",children:[o.toFixed(2),"%"]}),e(Y,{title:"in relation to the previous day",children:e("span",{className:D({"vm-dynamic-number":!0,"vm-dynamic-number_no-change":d===0,"vm-dynamic-number_positive vm-dynamic-number_down":d<0,"vm-dynamic-number_negative vm-dynamic-number_up":d>0}),children:u})})]})}),e("td",{className:"vm-table-cell vm-table-cell_right",children:e("div",{className:"vm-table-cell__content",children:e(Y,{title:e("span",{children:["Filter by ",e("code",{children:["`",t.name,"`"]})]}),children:e(P,{variant:"text",size:"small",onClick:p,startIcon:e(Bn,{})})})})})]})},fm=({data:t})=>{const[n,a]=C([]),[r,o]=C([0,0]),s=i=>{const c=i.map(u=>u.value),l=Math.ceil(c[0]||1),m=10,d=l/(m-1);return new Array(m+1).fill(l+d).map((u,h)=>Math.round(u-d*h))};return A(()=>{const i=t.sort((l,m)=>m.value-l.value),c=s(i);o(c),a(i.map(l=>({...l,percentage:l.value/c[0]*100})))},[t]),e("div",{className:"vm-simple-bar-chart",children:[e("div",{className:"vm-simple-bar-chart-y-axis",children:r.map(i=>e("div",{className:"vm-simple-bar-chart-y-axis__tick",children:i},i))}),e("div",{className:"vm-simple-bar-chart-data",children:n.map(({name:i,value:c,percentage:l})=>e(Y,{title:`${i}: ${c}`,placement:"top-center",children:e("div",{className:"vm-simple-bar-chart-data-item",style:{maxHeight:`${l||0}%`}})},`${i}_${c}`))})]})},_m=({rows:t,tabs:n=[],chartContainer:a,totalSeries:r,totalSeriesPrev:o,onActionClick:s,sectionTitle:i,tip:c,tableHeaderCells:l,isPrometheus:m})=>{const{isMobile:d}=W(),[u,h]=C("table"),p=m&&!t.length,v=f=>e(vm,{row:f,totalSeries:r,totalSeriesPrev:o,onActionClick:s}),b=L(()=>n.map((f,g)=>({value:f,label:f,icon:g===0?e(ln,{}):e(Ya,{})})),[n]);return e("div",{className:D({"vm-metrics-content":!0,"vm-metrics-content_mobile":d,"vm-block":!0,"vm-block_mobile":d}),children:[e("div",{className:"vm-metrics-content-header vm-section-header",children:[e("h5",{className:D({"vm-metrics-content-header__title":!0,"vm-section-header__title":!0,"vm-section-header__title_mobile":d}),children:[!d&&c&&e(Y,{title:e("p",{dangerouslySetInnerHTML:{__html:c},className:"vm-metrics-content-header__tip"}),children:e("div",{className:"vm-metrics-content-header__tip-icon",children:e(Un,{})})}),i]}),e("div",{className:"vm-section-header__tabs",children:e(Yt,{activeItem:u,items:b,onChange:h})})]}),p&&e("div",{className:"vm-metrics-content-prom-data",children:[e("div",{className:"vm-metrics-content-prom-data__icon",children:e(st,{})}),e("h3",{className:"vm-metrics-content-prom-data__title",children:"Prometheus Data Limitation"}),e("p",{className:"vm-metrics-content-prom-data__text",children:["Due to missing data from your Prometheus source, some tables may appear empty.",e("br",{}),"This does not indicate an issue with your system or our tool."]})]}),!p&&u==="table"&&e("div",{ref:a,className:D({"vm-metrics-content__table":!0,"vm-metrics-content__table_mobile":d}),children:e(gm,{rows:t,headerCells:l,defaultSortColumn:"value",tableCells:v})}),!p&&u==="graph"&&e("div",{className:"vm-metrics-content__chart",children:e(fm,{data:t.map(({name:f,value:g})=>({name:f,value:g}))})})]})},aa=({title:t,children:n})=>e("div",{className:"vm-cardinality-tip",children:[e("div",{className:"vm-cardinality-tip-header",children:[e("div",{className:"vm-cardinality-tip-header__tip-icon",children:e(cn,{})}),e("h4",{className:"vm-cardinality-tip-header__title",children:t||"Tips"})]}),e("p",{className:"vm-cardinality-tip__description",children:n})]}),bm=()=>e(aa,{title:"Metrics with a high number of series",children:e("ul",{children:[e("li",{children:["Identify and eliminate labels with frequently changed values to reduce their ",e(Se,{href:"https://docs.victoriametrics.com/FAQ.html#what-is-high-cardinality",children:"cardinality"})," and ",e(Se,{href:"https://docs.victoriametrics.com/FAQ.html#what-is-high-churn-rate",children:"high churn rate"})]}),e("li",{children:["Find unused time series and ",e(Se,{href:"https://docs.victoriametrics.com/relabeling.html",children:"drop entire metrics"})]}),e("li",{children:["Aggregate time series before they got ingested into the database via ",e(Se,{href:"https://docs.victoriametrics.com/stream-aggregation.html",children:"streaming aggregation"})]})]})}),ym=()=>e(aa,{title:"Labels with a high number of unique values",children:e("ul",{children:[e("li",{children:"Decrease the number of unique label values to reduce cardinality"}),e("li",{children:["Drop the label entirely via ",e(Se,{href:"https://docs.victoriametrics.com/relabeling.html",children:"relabeling"})]}),e("li",{children:"For volatile label values (such as URL path, user session, etc.) consider printing them to the log file instead of adding to time series"})]})}),wm=()=>e(aa,{title:"Dashboard of a single metric",children:[e("p",{children:"This dashboard helps to understand the cardinality of a single metric."}),e("p",{children:"Each time series is a unique combination of key-value label pairs. Therefore a label key with many values can create a lot of time series for a particular metric. If you’re trying to decrease the cardinality of a metric, start by looking at the labels with the highest number of values."}),e("p",{children:"Use the series selector at the top of the page to apply additional filters."})]}),Cm=()=>e(aa,{title:"Dashboard of a label",children:[e("p",{children:"This dashboard helps you understand the count of time series per label."}),e("p",{children:"Use the selector at the top of the page to pick a label name you’d like to inspect. For the selected label name, you’ll see the label values that have the highest number of series associated with them. So if you’ve chosen `instance` as your label name, you may see that `657` time series have value “host-1” attached to them and `580` time series have value `host-2` attached to them."}),e("p",{children:"This can be helpful in allowing you to determine where the bulk of your time series are coming from. If the label “instance=host-1” was applied to 657 series and the label “instance=host-2” was only applied to 580 series, you’d know, for example, that host-01 was responsible for sending the majority of the time series."})]}),Nm=`Please wait while cardinality stats is calculated. 
                        This may take some time if the db contains big number of time series.`,km=()=>{const{isMobile:t}=W(),[n]=ae(),{setSearchParamsFromKeys:a}=ft(),r=n.get("tips")||"",o=n.get("match")||"",s=n.get("focusLabel")||"",{isLoading:i,appConfigurator:c,error:l,isCluster:m}=dm(),{tsdbStatusData:d,getDefaultState:u,tablesHeaders:h,sectionsTips:p}=c,v=u(o,s),b=f=>g=>{const y={match:mm[f]({query:g,focusLabel:s,match:o})};(f==="labelValueCountByLabelName"||f=="seriesCountByLabelName")&&(y.focusLabel=g),f=="seriesCountByFocusLabelValue"&&(y.focusLabel=""),a(y)};return e("div",{className:D({"vm-cardinality-panel":!0,"vm-cardinality-panel_mobile":t}),children:[i&&e(qe,{message:Nm}),e(hm,{isPrometheus:c.isPrometheusData,totalSeries:d.totalSeries,totalSeriesPrev:d.totalSeriesPrev,totalSeriesAll:d.totalSeriesByAll,totalLabelValuePairs:d.totalLabelValuePairs,seriesCountByMetricName:d.seriesCountByMetricName,isCluster:m}),r&&e("div",{className:"vm-cardinality-panel-tips",children:[!o&&!s&&e(bm,{}),o&&!s&&e(wm,{}),!o&&!s&&e(ym,{}),s&&e(Cm,{})]}),l&&e(ie,{variant:"error",children:l}),c.keys(o,s).map(f=>e(_m,{sectionTitle:c.sectionsTitles(s)[f],tip:p[f],rows:d[f],onActionClick:b(f),tabs:v.tabs[f],chartContainer:v.containerRefs[f],totalSeriesPrev:c.totalSeries(f,!0),totalSeries:c.totalSeries(f),tableHeaderCells:h[f],isPrometheus:c.isPrometheusData},f))]})},Sm=(t,n,a)=>`${t}/api/v1/status/top_queries?topN=${n||""}&maxLifetime=${a||""}`,Tm=(t,n)=>{var i;const{query:a,timeRangeSeconds:r}=t,o=[`g0.expr=${encodeURIComponent(a)}`],s=(i=Xt.find(c=>c.duration===n))==null?void 0:i.id;return s&&o.push(`g0.relative_time=${s}`),r&&o.push(`g0.range_input=${n}`),`${J.home}?${o.join("&")}`},Am=t=>(["topByAvgDuration","topByCount","topBySumDuration"].forEach(a=>{const r=t[a];Array.isArray(r)&&r.forEach(o=>{const s=Vn(o.timeRangeSeconds*1e3);o.url=Tm(o,s),o.timeRange=s})}),t),xm=({topN:t,maxLifetime:n})=>{const{serverUrl:a}=re(),{setSearchParamsFromKeys:r}=ft(),[o,s]=C(null),[i,c]=C(!1),[l,m]=C(),d=L(()=>Sm(a,t,n),[a,t,n]);return{data:o,error:l,loading:i,fetch:async()=>{c(!0),r({topN:t,maxLifetime:n});try{const h=await fetch(d),p=await h.json();s(h.ok?Am(p):null),m(String(p.error||""))}catch(h){h instanceof Error&&h.name!=="AbortError"&&m(`${h.name}: ${h.message}`)}c(!1)}}},Em=({rows:t,columns:n,defaultOrderBy:a})=>{const r=Fe(),[o,s]=C(a||"count"),[i,c]=C("desc"),l=L(()=>Hr(t,zr(i,o)),[t,o,i]),m=h=>{c(p=>p==="asc"&&o===h?"desc":"asc"),s(h)},d=h=>()=>{m(h)},u=({query:h})=>async()=>{await r(h,"Query has been copied")};return e("table",{className:"vm-table",children:[e("thead",{className:"vm-table-header",children:e("tr",{className:"vm-table__row vm-table__row_header",children:[n.map(h=>e("th",{className:"vm-table-cell vm-table-cell_header vm-table-cell_sort",onClick:d(h.sortBy||h.key),children:e("div",{className:"vm-table-cell__content",children:[h.title||h.key,e("div",{className:D({"vm-table__sort-icon":!0,"vm-table__sort-icon_active":o===h.key,"vm-table__sort-icon_desc":i==="desc"&&o===h.key}),children:e(Qe,{})})]})},h.key)),e("th",{className:"vm-table-cell vm-table-cell_header"})," "]})}),e("tbody",{className:"vm-table-body",children:l.map((h,p)=>e("tr",{className:"vm-table__row",children:[n.map(v=>e("td",{className:"vm-table-cell",children:h[v.key]||"-"},v.key)),e("td",{className:"vm-table-cell vm-table-cell_no-padding",children:e("div",{className:"vm-top-queries-panels__table-actions",children:[h.url&&e(Y,{title:"Execute query",children:e(zn,{to:h.url,target:"_blank",rel:"noreferrer","aria-disabled":!0,children:e(P,{variant:"text",size:"small",startIcon:e(Bn,{}),ariaLabel:"execute query"})})}),e(Y,{title:"Copy query",children:e(P,{variant:"text",size:"small",startIcon:e(Xe,{}),onClick:u(h),ariaLabel:"copy query"})})]})})]},p))})]})},Lm=["table","JSON"].map((t,n)=>({value:String(n),label:t,icon:n===0?e(ln,{}):e(Lt,{})})),pa=({rows:t,title:n,columns:a,defaultOrderBy:r})=>{const{isMobile:o}=W(),[s,i]=C(0),c=l=>{i(+l)};return e("div",{className:D({"vm-top-queries-panel":!0,"vm-block":!0,"vm-block_mobile":o}),children:[e("div",{className:D({"vm-top-queries-panel-header":!0,"vm-section-header":!0,"vm-top-queries-panel-header_mobile":o}),children:[e("h5",{className:D({"vm-section-header__title":!0,"vm-section-header__title_mobile":o}),children:n}),e("div",{className:"vm-section-header__tabs",children:e(Yt,{activeItem:String(s),items:Lm,onChange:c})})]}),e("div",{className:D({"vm-top-queries-panel__table":!0,"vm-top-queries-panel__table_mobile":o}),children:[s===0&&e(Em,{rows:t,columns:a,defaultOrderBy:r}),s===1&&e(na,{data:t})]})]})},Mm="30ms, 15s, 3d4h, 1y2w",Dm=()=>{const{isMobile:t}=W(),[n,a]=Ae(10,"topN"),[r,o]=Ae("10m","maxLifetime"),{data:s,error:i,loading:c,fetch:l}=xm({topN:n,maxLifetime:r}),m=L(()=>{const _=r.trim().split(" ").reduce((w,S)=>{const N=Oo(S);return N?{...w,...N}:{...w}},{});return!!B.duration(_).asMilliseconds()},[r]),d=L(()=>!!n&&n<1,[n]),u=L(()=>d?"Number must be bigger than zero":"",[d]),h=L(()=>m?"":"Invalid duration value",[m]),p=g=>{if(!s)return g;const _=s[g];return typeof _=="number"?gt(_,_,_):_||g},v=g=>{a(+g)},b=g=>{o(g)},f=g=>{g.key==="Enter"&&l()};return A(()=>{s&&(n||a(+s.topN),r||o(s.maxLifetime))},[s]),A(()=>(l(),window.addEventListener("popstate",l),()=>{window.removeEventListener("popstate",l)}),[]),e("div",{className:D({"vm-top-queries":!0,"vm-top-queries_mobile":t}),children:[c&&e(qe,{containerStyles:{height:"500px"}}),e("div",{className:D({"vm-top-queries-controls":!0,"vm-block":!0,"vm-block_mobile":t}),children:[e("div",{className:"vm-top-queries-controls-fields",children:[e("div",{className:"vm-top-queries-controls-fields__item",children:e(le,{label:"Max lifetime",value:r,error:h,helperText:`For example ${Mm}`,onChange:b,onKeyDown:f})}),e("div",{className:"vm-top-queries-controls-fields__item",children:e(le,{label:"Number of returned queries",type:"number",value:n||"",error:u,onChange:v,onKeyDown:f})})]}),e("div",{className:D({"vm-top-queries-controls-bottom":!0,"vm-top-queries-controls-bottom_mobile":t}),children:[e("div",{className:"vm-top-queries-controls-bottom__info",children:["VictoriaMetrics tracks the last ",e(Y,{title:"search.queryStats.lastQueriesCount",children:e("b",{children:p("search.queryStats.lastQueriesCount")})})," queries with durations at least ",e(Y,{title:"search.queryStats.minQueryDuration",children:e("b",{children:p("search.queryStats.minQueryDuration")})})]}),e("div",{className:"vm-top-queries-controls-bottom__button",children:e(P,{startIcon:e(dt,{}),onClick:l,children:"Execute"})})]})]}),i&&e(ie,{variant:"error",children:i}),s&&e(U,{children:e("div",{className:"vm-top-queries-panels",children:[e(pa,{rows:s.topBySumDuration,title:"Queries with most summary time to execute",columns:[{key:"query"},{key:"sumDurationSeconds",title:"sum duration, sec"},{key:"timeRange",sortBy:"timeRangeSeconds",title:"query time interval"},{key:"count"}],defaultOrderBy:"sumDurationSeconds"}),e(pa,{rows:s.topByAvgDuration,title:"Most heavy queries",columns:[{key:"query"},{key:"avgDurationSeconds",title:"avg duration, sec"},{key:"timeRange",sortBy:"timeRangeSeconds",title:"query time interval"},{key:"count"}],defaultOrderBy:"avgDurationSeconds"}),e(pa,{rows:s.topByCount,title:"Most frequently executed queries",columns:[{key:"query"},{key:"timeRange",sortBy:"timeRangeSeconds",title:"query time interval"},{key:"count"}]})]})})]})},ga={"color-primary":"#589DF6","color-secondary":"#316eca","color-error":"#e5534b","color-warning":"#c69026","color-info":"#539bf5","color-success":"#57ab5a","color-background-body":"#22272e","color-background-block":"#2d333b","color-background-tooltip":"rgba(22, 22, 22, 0.8)","color-text":"#cdd9e5","color-text-secondary":"#768390","color-text-disabled":"#636e7b","box-shadow":"rgba(0, 0, 0, 0.16) 1px 2px 6px","box-shadow-popper":"rgba(0, 0, 0, 0.2) 0px 2px 8px 0px","border-divider":"1px solid rgba(99, 110, 123, 0.5)","color-hover-black":"rgba(0, 0, 0, 0.2)","color-log-hits-bar-0":"rgba(255, 255, 255, 0.18)","color-log-hits-bar-1":"#FFB74D","color-log-hits-bar-2":"#81C784","color-log-hits-bar-3":"#64B5F6","color-log-hits-bar-4":"#E57373","color-log-hits-bar-5":"#8a62f0"},va={"color-primary":"#3F51B5","color-secondary":"#E91E63","color-error":"#FD080E","color-warning":"#FF8308","color-info":"#03A9F4","color-success":"#4CAF50","color-background-body":"#FEFEFF","color-background-block":"#FFFFFF","color-background-tooltip":"rgba(80,80,80,0.9)","color-text":"#110f0f","color-text-secondary":"#706F6F","color-text-disabled":"#A09F9F","box-shadow":"rgba(0, 0, 0, 0.08) 1px 2px 6px","box-shadow-popper":"rgba(0, 0, 0, 0.1) 0px 2px 8px 0px","border-divider":"1px solid rgba(0, 0, 0, 0.15)","color-hover-black":"rgba(0, 0, 0, 0.06)","color-log-hits-bar-0":"rgba(0, 0, 0, 0.18)","color-log-hits-bar-1":"#FFB74D","color-log-hits-bar-2":"#81C784","color-log-hits-bar-3":"#64B5F6","color-log-hits-bar-4":"#E57373","color-log-hits-bar-5":"#8a62f0"},Im=()=>{const[t,n]=C(An()),a=r=>{n(r.matches)};return A(()=>{const r=window.matchMedia("(prefers-color-scheme: dark)");return r.addEventListener("change",a),()=>r.removeEventListener("change",a)},[]),t},fa=["primary","secondary","error","warning","info","success"],Vr=({onLoaded:t})=>{const n=Ce(),{palette:a={}}=rn(),{theme:r}=re(),o=Im(),s=Et(),i=Mt(),[c,l]=C({[Be.dark]:ga,[Be.light]:va,[Be.system]:An()?ga:va}),m=()=>{const{innerWidth:v,innerHeight:b}=window,{clientWidth:f,clientHeight:g}=document.documentElement;Pt("scrollbar-width",`${v-f}px`),Pt("scrollbar-height",`${b-g}px`),Pt("vh",`${b*.01}px`)},d=()=>{fa.forEach((v,b)=>{const f=Ze(`color-${v}`),g=Xc(f);Pt(`${v}-text`,g),b===fa.length-1&&(s({type:"SET_DARK_THEME"}),t(!0))})},u=()=>{fa.forEach(v=>{const b=a[v];b&&Pt(`color-${v}`,b)}),d()},h=()=>{const v=xe("THEME")||Be.system,b=c[v];Object.entries(b).forEach(([f,g])=>{Pt(f,g)}),d(),n&&u()},p=()=>{const v=An()?ga:va;if(c[Be.system]===v){h();return}l(b=>({...b,[Be.system]:v}))};return A(()=>{m(),h()},[c]),A(m,[i]),A(p,[r,o]),A(()=>{n&&s({type:"SET_THEME",payload:Be.light})},[]),null},ei=()=>{const[t,n]=C([]),[a,r]=C(!1),o=Q(document.body),s=m=>{const d=Array.from(m||[]);n(d)},i=m=>{m.preventDefault(),m.stopPropagation(),m.type==="dragenter"||m.type==="dragover"?r(!0):m.type==="dragleave"&&r(!1)},c=m=>{var d;m.preventDefault(),m.stopPropagation(),r(!1),(d=m==null?void 0:m.dataTransfer)!=null&&d.files&&m.dataTransfer.files[0]&&s(m.dataTransfer.files)},l=m=>{var h;const d=(h=m.clipboardData)==null?void 0:h.items;if(!d)return;const u=Array.from(d).filter(p=>p.type==="application/json").map(p=>p.getAsFile()).filter(p=>p!==null);n(u)};return ce("dragenter",i,o),ce("dragleave",i,o),ce("dragover",i,o),ce("drop",c,o),ce("paste",l,o),{files:t,dragging:a}},$n=({onOpenModal:t,onChange:n})=>e("div",{className:"vm-upload-json-buttons",children:[e(P,{variant:"outlined",onClick:t,children:"Paste JSON"}),e("div",{className:"vm-upload-json-buttons__upload",children:[e(P,{children:"Upload Files"}),e("input",{id:"json",name:"json",type:"file",accept:"application/json",multiple:!0,title:" ",onChange:n})]})]}),Pm=()=>{const[t,n]=C([]),[a,r]=C([]),o=L(()=>!!t.length,[t]),{value:s,setTrue:i,setFalse:c}=se(!1),l=(g,_="")=>{r(y=>[{filename:_,text:`: ${g.message}`},...y])},m=(g,_)=>{try{const y=JSON.parse(g),w=y.trace||y;if(!w.duration_msec){l(new Error(be.traceNotFound),_);return}const S=new At(w,_);n(N=>[S,...N])}catch(y){y instanceof Error&&l(y,_)}},d=g=>{g.map(_=>{const y=new FileReader,w=(_==null?void 0:_.name)||"";y.onload=S=>{var k;const N=String((k=S.target)==null?void 0:k.result);m(N,w)},y.readAsText(_)})},u=g=>{if(!g.target)return;const _=g.target;r([]);const y=Array.from(_.files||[]);d(y),_.value=""},h=g=>{const _=t.filter(y=>y.idValue!==g.idValue);n([..._])},p=g=>{r(_=>_.filter((y,w)=>w!==g))},v=g=>()=>{p(g)},{files:b,dragging:f}=ei();return A(()=>{d(b)},[b]),e("div",{className:"vm-trace-page",children:[e("div",{className:"vm-trace-page-header",children:[e("div",{className:"vm-trace-page-header-errors",children:a.map((g,_)=>e("div",{className:"vm-trace-page-header-errors-item",children:[e(ie,{variant:"error",children:[e("b",{className:"vm-trace-page-header-errors-item__filename",children:g.filename}),e("span",{children:g.text})]}),e(P,{className:"vm-trace-page-header-errors-item__close",startIcon:e(He,{}),variant:"text",color:"error",onClick:v(_)})]},`${g}_${_}`))}),e("div",{children:o&&e($n,{onOpenModal:i,onChange:u})})]}),o&&e("div",{children:e(Cr,{jsonEditor:!0,traces:t,onDeleteClick:h})}),!o&&e("div",{className:"vm-trace-page-preview",children:[e("p",{className:"vm-trace-page-preview__text",children:["Please, upload file with JSON response content.",`
`,"The file must contain tracing information in JSON format.",`
`,"In order to use tracing please refer to the doc: ",e("a",{className:"vm-link vm-link_colored",href:"https://docs.victoriametrics.com/#query-tracing",target:"_blank",rel:"help noreferrer",children:"https://docs.victoriametrics.com/#query-tracing"}),`
`,"Tracing graph will be displayed after file upload.",`
`,"Attach files by dragging & dropping, selecting or pasting them."]}),e($n,{onOpenModal:i,onChange:u})]}),s&&e(Pe,{title:"Paste JSON",onClose:c,children:e(Ts,{editable:!0,displayTitle:!0,defaultTile:`JSON ${t.length+1}`,onClose:c,onUpload:m})}),f&&e("div",{className:"vm-trace-page__dropzone"})]})},$m=({job:t,instance:n,metrics:a,size:r})=>{const{duration:o,relativeTime:s,period:{date:i}}=he(),{customStep:c}=Re(),{setSearchParamsFromKeys:l}=ft(),m=()=>{const d=Xs({"g0.range_input":o,"g0.end_input":i,"g0.step_input":c,"g0.relative_time":s,size:r,job:t,instance:n,metrics:a});l(d)};A(m,[o,s,i,c,t,n,a,r]),A(m,[])},Om=(t,n)=>`${t}/api/v1/label/job/values?start=${n.start}&end=${n.end}`,Rm=(t,n,a)=>{const r=`{job=${JSON.stringify(a)}}`;return`${t}/api/v1/label/instance/values?match[]=${encodeURIComponent(r)}&start=${n.start}&end=${n.end}`},Fm=(t,n,a,r)=>{const s=`{${Object.entries({job:a,instance:r}).filter(i=>i[1]).map(([i,c])=>`${i}=${JSON.stringify(c)}`).join(",")}}`;return`${t}/api/v1/label/__name__/values?match[]=${encodeURIComponent(s)}&start=${n.start}&end=${n.end}`},zm=()=>{const{serverUrl:t}=re(),{period:n}=he(),[a,r]=C([]),[o,s]=C(!1),[i,c]=C(),l=L(()=>Om(t,n),[t,n]);return A(()=>{(async()=>{s(!0);try{const d=await fetch(l),u=await d.json(),h=u.data||[];r(h.sort((p,v)=>p.localeCompare(v))),d.ok?c(void 0):c(`${u.errorType}\r
${u==null?void 0:u.error}`)}catch(d){d instanceof Error&&c(`${d.name}: ${d.message}`)}s(!1)})().catch(console.error)},[l]),{jobs:a,isLoading:o,error:i}},Hm=t=>{const{serverUrl:n}=re(),{period:a}=he(),[r,o]=C([]),[s,i]=C(!1),[c,l]=C(),m=L(()=>Rm(n,a,t),[n,a,t]);return A(()=>{if(!t)return;(async()=>{i(!0);try{const u=await fetch(m),h=await u.json(),p=h.data||[];o(p.sort((v,b)=>v.localeCompare(b))),u.ok?l(void 0):l(`${h.errorType}\r
${h==null?void 0:h.error}`)}catch(u){u instanceof Error&&l(`${u.name}: ${u.message}`)}i(!1)})().catch(console.error)},[m]),{instances:r,isLoading:s,error:c}},Vm=(t,n)=>{const{serverUrl:a}=re(),{period:r}=he(),[o,s]=C([]),[i,c]=C(!1),[l,m]=C(),d=L(()=>Fm(a,r,t,n),[a,r,t,n]);return A(()=>{if(!t)return;(async()=>{c(!0);try{const h=await fetch(d),p=await h.json(),v=p.data||[];s(v.sort((b,f)=>b.localeCompare(f))),h.ok?m(void 0):m(`${p.errorType}\r
${p==null?void 0:p.error}`)}catch(h){h instanceof Error&&m(`${h.name}: ${h.message}`)}c(!1)})().catch(console.error)},[d]),{names:o,isLoading:i,error:l}},Um=({name:t,job:n,instance:a,rateEnabled:r,isBucket:o,height:s})=>{const{isMobile:i}=W(),{customStep:c,yaxis:l}=Re(),{period:m}=he(),d=mt(),u=Ve(),h=sn(m.end-m.start),p=Va(c),v=Vn(p*10*1e3),[b,f]=C(!1),[g,_]=C(!1),y=b&&c===h?v:c,w=L(()=>{const $=Object.entries({job:n,instance:a}).filter(z=>z[1]).map(([z,j])=>`${z}=${JSON.stringify(j)}`);$.push(`__name__=${JSON.stringify(t)}`),t=="node_cpu_seconds_total"&&$.push('mode!="idle"');const O=`{${$.join(",")}}`;return o?`sum(rate(${O})) by (vmrange, le)`:`
with (q = ${r?`rollup_rate(${O})`:`rollup(${O})`}) (
  alias(min(label_match(q, "rollup", "min")), "min"),
  alias(max(label_match(q, "rollup", "max")), "max"),
  alias(avg(label_match(q, "rollup", "avg")), "avg"),
)`},[t,n,a,r,o]),{isLoading:S,graphData:N,error:k,queryErrors:T,warning:x,isHistogram:M}=Zn({predefinedQuery:[w],visible:!0,customStep:y,showAllSeries:g}),E=$=>{d({type:"SET_YAXIS_LIMITS",payload:$})},I=({from:$,to:O})=>{u({type:"SET_PERIOD",payload:{from:$,to:O}})};return A(()=>{f(M)},[M]),e("div",{className:D({"vm-explore-metrics-graph":!0,"vm-explore-metrics-graph_mobile":i}),children:[S&&e(qe,{}),k&&e(ie,{variant:"error",children:k}),T[0]&&e(ie,{variant:"error",children:T[0]}),x&&e(ea,{warning:x,query:[w],onChange:_}),N&&m&&e(ta,{data:N,period:m,customStep:y,query:[w],yaxis:l,setYaxisLimits:E,setPeriod:I,showLegend:!1,height:s,isHistogram:M})]})},qm=({name:t,index:n,length:a,isBucket:r,rateEnabled:o,onChangeRate:s,onRemoveItem:i,onChangeOrder:c})=>{const{isMobile:l}=W(),{value:m,setTrue:d,setFalse:u}=se(!1),h=()=>{i(t)},p=()=>{c(t,n,n+1)},v=()=>{c(t,n,n-1)};return l?e("div",{className:"vm-explore-metrics-item-header vm-explore-metrics-item-header_mobile",children:[e("div",{className:"vm-explore-metrics-item-header__name",children:t}),e(P,{variant:"text",size:"small",startIcon:e(Za,{}),onClick:d,ariaLabel:"open panel settings"}),m&&e(Pe,{title:t,onClose:u,children:e("div",{className:"vm-explore-metrics-item-header-modal",children:[e("div",{className:"vm-explore-metrics-item-header-modal-order",children:[e(P,{startIcon:e(Wo,{}),variant:"outlined",onClick:v,disabled:n===0,ariaLabel:"move graph up"}),e("p",{children:["position:",e("span",{className:"vm-explore-metrics-item-header-modal-order__index",children:["#",n+1]})]}),e(P,{endIcon:e(Ga,{}),variant:"outlined",onClick:p,disabled:n===a-1,ariaLabel:"move graph down"})]}),!r&&e("div",{className:"vm-explore-metrics-item-header-modal__rate",children:[e(ye,{label:e("span",{children:["enable ",e("code",{children:"rate()"})]}),value:o,onChange:s,fullWidth:!0}),e("p",{children:"calculates the average per-second speed of metrics change"})]}),e(P,{startIcon:e(He,{}),color:"error",variant:"outlined",onClick:h,fullWidth:!0,children:"Remove graph"})]})})]}):e("div",{className:"vm-explore-metrics-item-header",children:[e("div",{className:"vm-explore-metrics-item-header-order",children:[e(Y,{title:"move graph up",children:e(P,{className:"vm-explore-metrics-item-header-order__up",startIcon:e(ve,{}),variant:"text",color:"gray",size:"small",onClick:v,ariaLabel:"move graph up"})}),e("div",{className:"vm-explore-metrics-item-header__index",children:["#",n+1]}),e(Y,{title:"move graph down",children:e(P,{className:"vm-explore-metrics-item-header-order__down",startIcon:e(ve,{}),variant:"text",color:"gray",size:"small",onClick:p,ariaLabel:"move graph down"})})]}),e("div",{className:"vm-explore-metrics-item-header__name",children:t}),!r&&e("div",{className:"vm-explore-metrics-item-header__rate",children:e(Y,{title:"calculates the average per-second speed of metric's change",children:e(ye,{label:e("span",{children:["enable ",e("code",{children:"rate()"})]}),value:o,onChange:s})})}),e("div",{className:"vm-explore-metrics-item-header__close",children:e(Y,{title:"close graph",children:e(P,{startIcon:e(He,{}),variant:"text",color:"gray",size:"small",onClick:h,ariaLabel:"close graph"})})})]})},Bm=({name:t,job:n,instance:a,index:r,length:o,size:s,onRemoveItem:i,onChangeOrder:c})=>{const l=L(()=>/_sum?|_total?|_count?/.test(t),[t]),m=L(()=>/_bucket?/.test(t),[t]),[d,u]=C(l),h=Mt(),p=L(s.height,[s,h]);return A(()=>{u(l)},[n]),e("div",{className:"vm-explore-metrics-item vm-block vm-block_empty-padding",children:[e(qm,{name:t,index:r,length:o,isBucket:m,rateEnabled:d,size:s.id,onChangeRate:u,onRemoveItem:i,onChangeOrder:c}),e(Um,{name:t,job:n,instance:a,rateEnabled:d,isBucket:m,height:p},`${t}_${n}_${a}_${d}`)]})},jm=Tn.map(t=>t.id),Qm=({jobs:t,instances:n,names:a,job:r,instance:o,size:s,selectedMetrics:i,onChangeJob:c,onChangeInstance:l,onToggleMetric:m,onChangeSize:d})=>{const u=L(()=>r?"":"No instances. Please select job",[r]),h=L(()=>r?"":"No metric names. Please select job",[r]),{isMobile:p}=W(),{value:v,toggle:b,setFalse:f}=se(xe("EXPLORE_METRICS_TIPS")!=="false");return A(()=>{Te("EXPLORE_METRICS_TIPS",`${v}`)},[v]),e(U,{children:[e("div",{className:D({"vm-explore-metrics-header":!0,"vm-explore-metrics-header_mobile":p,"vm-block":!0,"vm-block_mobile":p}),children:[e("div",{className:"vm-explore-metrics-header__job",children:e(Ct,{value:r,list:t,label:"Job",placeholder:"Please select job",onChange:c,autofocus:!r&&!!t.length&&!p,searchable:!0})}),e("div",{className:"vm-explore-metrics-header__instance",children:e(Ct,{value:o,list:n,label:"Instance",placeholder:"Please select instance",onChange:l,noOptionsText:u,clearable:!0,searchable:!0})}),e("div",{className:"vm-explore-metrics-header__size",children:[e(Ct,{label:"Size graphs",value:s,list:jm,onChange:d}),e(Y,{title:`${v?"Hide":"Show"} tip`,children:e(P,{variant:"text",color:v?"warning":"gray",startIcon:e(cn,{}),onClick:b,ariaLabel:"visibility tips"})})]}),e("div",{className:"vm-explore-metrics-header-metrics",children:e(Ct,{label:"Metrics",value:i,list:a,placeholder:"Search metric name",onChange:m,noOptionsText:h,clearable:!0,searchable:!0})})]}),v&&e(ie,{variant:"warning",children:e("div",{className:"vm-explore-metrics-header-description",children:[e("p",{children:["Please note: this page is solely designed for exploring Prometheus metrics. Prometheus metrics always contain ",e("code",{children:"job"})," and ",e("code",{children:"instance"})," labels (see ",e("a",{className:"vm-link vm-link_colored",href:"https://prometheus.io/docs/concepts/jobs_instances/",children:"these docs"}),"), and this page relies on them as filters. ",e("br",{}),"Please use this page for Prometheus metrics only, in accordance with their naming conventions."]}),e(P,{variant:"text",size:"small",startIcon:e(He,{}),onClick:f,ariaLabel:"close tips"})]})})]})},Ym=Oe("job",""),Gm=Oe("instance",""),ho=Oe("metrics",""),po=Oe("size",""),Wm=Tn.find(t=>po?t.id===po:t.isDefault)||Tn[0],Km=()=>{const[t,n]=C(Ym),[a,r]=C(Gm),[o,s]=C(ho?ho.split("&"):[]),[i,c]=C(Wm);$m({job:t,instance:a,metrics:o.join("&"),size:i.id});const{jobs:l,isLoading:m,error:d}=zm(),{instances:u,isLoading:h,error:p}=Hm(t),{names:v,isLoading:b,error:f}=Vm(t,a),g=L(()=>m||h||b,[m,h,b]),_=L(()=>d||p||f,[d,p,f]),y=N=>{s(N?k=>k.includes(N)?k.filter(T=>T!==N):[...k,N]:[])},w=N=>{const k=Tn.find(T=>T.id===N);k&&c(k)},S=(N,k,T)=>{const x=T>o.length-1;T<0||x||s(E=>{const I=[...E],[$]=I.splice(k,1);return I.splice(T,0,$),I})};return A(()=>{a&&u.length&&!u.includes(a)&&r("")},[u,a]),e("div",{className:"vm-explore-metrics",children:[e(Qm,{jobs:l,instances:u,names:v,job:t,size:i.id,instance:a,selectedMetrics:o,onChangeJob:n,onChangeSize:w,onChangeInstance:r,onToggleMetric:y}),g&&e(qe,{}),_&&e(ie,{variant:"error",children:_}),!t&&e(ie,{variant:"info",children:"Please select job to see list of metric names."}),t&&!o.length&&e(ie,{variant:"info",children:"Please select metric names to see the graphs."}),e("div",{className:"vm-explore-metrics-body",children:o.map((N,k)=>e(Bm,{name:N,job:t,instance:a,index:k,length:o.length,size:i,onRemoveItem:y,onChangeOrder:S},N))})]})},Jm=()=>{const t=Fe(),n=a=>async()=>{await t(`<${a}/>`,`<${a}/> has been copied`)};return e("div",{className:"vm-preview-icons",children:Object.entries(Ji).map(([a,r])=>e("div",{className:"vm-preview-icons-item",onClick:n(a),children:[e("div",{className:"vm-preview-icons-item__svg",children:r()}),e("div",{className:"vm-preview-icons-item__name",children:`<${a}/>`})]},a))})},tt=({code:t})=>{const n=Fe(),[a,r]=C("Copy"),o=async()=>{await n(t),r("Copied")};return A(()=>{let s=null;return a==="Copied"&&(s=setTimeout(()=>r("Copy"),1e3)),()=>{s&&clearTimeout(s)}},[a]),e("code",{className:"vm-code-example",children:[t,e("div",{className:"vm-code-example__copy",children:e(Y,{title:a,children:e(P,{size:"small",variant:"text",onClick:o,startIcon:e(Xe,{}),ariaLabel:"close"})})})]})},Zm=()=>e("a",{className:"vm-link vm-link_colored",href:"https://docs.victoriametrics.com/metricsql/",target:"_blank",rel:"help noreferrer",children:"MetricsQL"}),go=()=>e("a",{className:"vm-link vm-link_colored",href:"https://grafana.com/grafana/dashboards/1860-node-exporter-full/",target:"_blank",rel:"help noreferrer",children:"Node Exporter Full"}),Xm=()=>e("section",{className:"vm-with-template-tutorial",children:[e("h2",{className:"vm-with-template-tutorial__title",children:["Tutorial for WITH expressions in ",e(Zm,{})]}),e("div",{className:"vm-with-template-tutorial-section",children:[e("p",{className:"vm-with-template-tutorial-section__text",children:["Let's look at the following real query from ",e(go,{})," dashboard:"]}),e(tt,{code:`(
  (
    node_memory_MemTotal_bytes{instance=~"$node:$port", job=~"$job"}
      -
    node_memory_MemFree_bytes{instance=~"$node:$port", job=~"$job"}
  )
    /
  node_memory_MemTotal_bytes{instance=~"$node:$port", job=~"$job"}
) * 100`}),e("p",{className:"vm-with-template-tutorial-section__text",children:"It is clear the query calculates the percentage of used memory for the given $node, $port and $job. Isn't it? :)"})]}),e("div",{className:"vm-with-template-tutorial-section",children:[e("p",{className:"vm-with-template-tutorial-section__text",children:"What's wrong with this query? Copy-pasted label filters for distinct timeseries which makes it easy to mistype these filters during modification. Let's simplify the query with WITH expressions:"}),e(tt,{code:`WITH (
    commonFilters = {instance=~"$node:$port",job=~"$job"}
)
(
  node_memory_MemTotal_bytes{commonFilters}
    -
  node_memory_MemFree_bytes{commonFilters}
)
  /
node_memory_MemTotal_bytes{commonFilters} * 100`})]}),e("div",{className:"vm-with-template-tutorial-section",children:[e("p",{className:"vm-with-template-tutorial-section__text",children:["Now label filters are located in a single place instead of three distinct places. The query mentions node_memory_MemTotal_bytes metric twice and ","{commonFilters}"," three times. WITH expressions may improve this:"]}),e(tt,{code:`WITH (
    my_resource_utilization(free, limit, filters) = (limit{filters} - free{filters}) / limit{filters} * 100
)
my_resource_utilization(
  node_memory_MemFree_bytes,
  node_memory_MemTotal_bytes,
  {instance=~"$node:$port",job=~"$job"},
)`}),e("p",{className:"vm-with-template-tutorial-section__text",children:"Now the template function my_resource_utilization() may be used for monitoring arbitrary resources - memory, CPU, network, storage, you name it."})]}),e("div",{className:"vm-with-template-tutorial-section",children:[e("p",{className:"vm-with-template-tutorial-section__text",children:["Let's take another nice query from ",e(go,{})," dashboard:"]}),e(tt,{code:`(
  (
    (
      count(
        count(node_cpu_seconds_total{instance=~"$node:$port",job=~"$job"}) by (cpu)
      )
    )
      -
    avg(
      sum by (mode) (rate(node_cpu_seconds_total{mode='idle',instance=~"$node:$port",job=~"$job"}[5m]))
    )
  )
    *
  100
)
  /
count(
  count(node_cpu_seconds_total{instance=~"$node:$port",job=~"$job"}) by (cpu)
)`}),e("p",{className:"vm-with-template-tutorial-section__text",children:"Do you understand what does this mess do? Is it manageable? :) WITH expressions are happy to help in a few iterations."})]}),e("div",{className:"vm-with-template-tutorial-section",children:[e("p",{className:"vm-with-template-tutorial-section__text",children:"1. Extract common filters used in multiple places into a commonFilters variable:"}),e(tt,{code:`WITH (
    commonFilters = {instance=~"$node:$port",job=~"$job"}
)
(
  (
    (
      count(
        count(node_cpu_seconds_total{commonFilters}) by (cpu)
      )
    )
      -
    avg(
      sum by (mode) (rate(node_cpu_seconds_total{mode='idle',commonFilters}[5m]))
    )
  )
    *
  100
)
  /
count(
  count(node_cpu_seconds_total{commonFilters}) by (cpu)
)`})]}),e("div",{className:"vm-with-template-tutorial-section",children:[e("p",{className:"vm-with-template-tutorial-section__text",children:'2. Extract "count(count(...) by (cpu))" into cpuCount variable:'}),e(tt,{code:`WITH (
    commonFilters = {instance=~"$node:$port",job=~"$job"},
    cpuCount = count(count(node_cpu_seconds_total{commonFilters}) by (cpu))
)
(
  (
    cpuCount
      -
    avg(
      sum by (mode) (rate(node_cpu_seconds_total{mode='idle',commonFilters}[5m]))
    )
  )
    *
  100
) / cpuCount`})]}),e("div",{className:"vm-with-template-tutorial-section",children:[e("p",{className:"vm-with-template-tutorial-section__text",children:"3. Extract rate(...) part into cpuIdle variable, since it is clear now that this part calculates the number of idle CPUs:"}),e(tt,{code:`WITH (
    commonFilters = {instance=~"$node:$port",job=~"$job"},
    cpuCount = count(count(node_cpu_seconds_total{commonFilters}) by (cpu)),
    cpuIdle = sum(rate(node_cpu_seconds_total{mode='idle',commonFilters}[5m]))
)
((cpuCount - cpuIdle) * 100) / cpuCount`})]}),e("div",{className:"vm-with-template-tutorial-section",children:[e("p",{className:"vm-with-template-tutorial-section__text",children:["4. Put node_cpu_seconds_total","{commonFilters}"," into its own variable with the name cpuSeconds:"]}),e(tt,{code:`WITH (
    cpuSeconds = node_cpu_seconds_total{instance=~"$node:$port",job=~"$job"},
    cpuCount = count(count(cpuSeconds) by (cpu)),
    cpuIdle = sum(rate(cpuSeconds{mode='idle'}[5m]))
)
((cpuCount - cpuIdle) * 100) / cpuCount`}),e("p",{className:"vm-with-template-tutorial-section__text",children:"Now the query became more clear comparing to the initial query."})]}),e("div",{className:"vm-with-template-tutorial-section",children:[e("p",{className:"vm-with-template-tutorial-section__text",children:"WITH expressions may be nested and may be put anywhere. Try expanding the following query:"}),e(tt,{code:`WITH (
    f(a, b) = WITH (
        f1(x) = b-x,
        f2(x) = x+x
    ) f1(a)*f2(b)
) f(foo, with(x=bar) x)`})]})]}),eu=(t,n)=>`${t}/expand-with-exprs?query=${encodeURIComponent(n)}&format=json`,tu=()=>{const{serverUrl:t}=re(),[n,a]=ae(),[r,o]=C(""),[s,i]=C(!1),[c,l]=C();return{data:r,error:c,loading:s,expand:async d=>{n.set("expr",d),a(n);const u=eu(t,d);i(!0);try{const p=await(await fetch(u)).json();o((p==null?void 0:p.expr)||""),l(String(p.error||""))}catch(h){h instanceof Error&&h.name!=="AbortError"&&l(`${h.name}: ${h.message}`)}i(!1)}}},nu=()=>{const[t]=ae(),{data:n,loading:a,error:r,expand:o}=tu(),[s,i]=C(t.get("expr")||""),c=m=>{i(m)},l=()=>{o(s)};return A(()=>{s&&o(s)},[]),e("section",{className:"vm-with-template",children:[a&&e(qe,{}),e("div",{className:"vm-with-template-body vm-block",children:[e("div",{className:"vm-with-template-body__expr",children:e(le,{type:"textarea",label:"MetricsQL query with optional WITH expressions",value:s,error:r,autofocus:!0,onEnter:l,onChange:c})}),e("div",{className:"vm-with-template-body__result",children:e(le,{type:"textarea",label:"MetricsQL query after expanding WITH expressions and applying other optimizations",value:n,disabled:!0})}),e("div",{className:"vm-with-template-body-top",children:e(P,{variant:"contained",onClick:l,startIcon:e(dt,{}),children:"Expand"})})]}),e("div",{className:"vm-block",children:e(Xm,{})})]})},au=(t,n,a)=>{const r=["format=json",`relabel_configs=${encodeURIComponent(n)}`,`metric=${encodeURIComponent(a)}`];return`${t}/metric-relabel-debug?${r.join("&")}`},ru=()=>{const{serverUrl:t}=re(),[n,a]=C(null),[r,o]=C(!1),[s,i]=C();return{data:n,error:s,loading:r,fetchData:async(l,m)=>{const d=au(t,l,m);o(!0);try{const h=await(await fetch(d)).json();a(h.error?null:h),i(String(h.error||""))}catch(u){u instanceof Error&&u.name!=="AbortError"&&i(`${u.name}: ${u.message}`)}o(!1)}}},ou={config:`- if: '{bar_label=~"b.*"}'
  source_labels: [foo_label, bar_label]
  separator: "_"
  target_label: foobar
- action: labeldrop
  regex: "foo_.*"
- target_label: job
  replacement: "my-application-2"`,labels:'{__name__="my_metric", bar_label="bar", foo_label="foo", job="my-application", instance="192.168.0.1"}'},su=()=>{const[t,n]=ae(),{data:a,loading:r,error:o,fetchData:s}=ru(),[i,c]=Ae("","config"),[l,m]=Ae("","labels"),d=v=>{c(v||"")},u=v=>{m(v||"")},h=X(()=>{s(i,l),t.set("config",i),t.set("labels",l),n(t)},[i,l]),p=()=>{const{config:v,labels:b}=ou;c(v),m(b),s(v,b),t.set("config",v),t.set("labels",b),n(t)};return A(()=>{const v=t.get("config")||"",b=t.get("labels")||"";(b||v)&&(s(v,b),c(v),m(b))},[]),e("section",{className:"vm-relabeling",children:[r&&e(qe,{}),e("div",{className:"vm-relabeling-header vm-block",children:[e("div",{className:"vm-relabeling-header-configs",children:e(le,{type:"textarea",label:"Relabel configs",value:i,autofocus:!0,onChange:d,onEnter:h})}),e("div",{className:"vm-relabeling-header__labels",children:e(le,{type:"textarea",label:"Labels",value:l,onChange:u,onEnter:h})}),e("div",{className:"vm-relabeling-header-bottom",children:[e("a",{className:"vm-link vm-link_with-icon",target:"_blank",href:"https://docs.victoriametrics.com/relabeling.html",rel:"help noreferrer",children:[e(st,{}),"Relabeling cookbook"]}),e("a",{className:"vm-link vm-link_with-icon",target:"_blank",href:"https://docs.victoriametrics.com/vmagent.html#relabeling",rel:"help noreferrer",children:[e(it,{}),"Documentation"]}),e(P,{variant:"text",onClick:p,children:"Try example"}),e(P,{variant:"contained",onClick:h,startIcon:e(dt,{}),children:"Submit"})]})]}),o&&e(ie,{variant:"error",children:o}),a&&e("div",{className:"vm-relabeling-steps vm-block",children:[a.originalLabels&&e("div",{className:"vm-relabeling-steps-item",children:e("div",{className:"vm-relabeling-steps-item__row",children:[e("span",{children:"Original labels:"}),e("code",{dangerouslySetInnerHTML:{__html:a.originalLabels}})]})}),a.steps.map((v,b)=>e("div",{className:"vm-relabeling-steps-item",children:[e("div",{className:"vm-relabeling-steps-item__row",children:[e("span",{children:"Step:"}),b+1]}),e("div",{className:"vm-relabeling-steps-item__row",children:[e("span",{children:"Relabeling Rule:"}),e("code",{children:e("pre",{children:v.rule})})]}),e("div",{className:"vm-relabeling-steps-item__row",children:[e("span",{children:"Input Labels:"}),e("code",{children:e("pre",{dangerouslySetInnerHTML:{__html:v.inLabels}})})]}),e("div",{className:"vm-relabeling-steps-item__row",children:[e("span",{children:"Output labels:"}),e("code",{children:e("pre",{dangerouslySetInnerHTML:{__html:v.outLabels}})})]})]},b)),a.resultingLabels&&e("div",{className:"vm-relabeling-steps-item",children:e("div",{className:"vm-relabeling-steps-item__row",children:[e("span",{children:"Resulting labels:"}),e("code",{dangerouslySetInnerHTML:{__html:a.resultingLabels}})]})})]})]})},iu=t=>`${t}/api/v1/status/active_queries`,lu=()=>{const{serverUrl:t}=re(),[n,a]=C([]),[r,o]=C(B().format(xn)),[s,i]=C(!1),[c,l]=C(),m=L(()=>iu(t),[t]),d=async()=>{i(!0);try{const u=await fetch(m),h=await u.json();a(h.data),o(B().format("HH:mm:ss:SSS")),u.ok?l(void 0):l(`${h.errorType}\r
${h==null?void 0:h.error}`)}catch(u){u instanceof Error&&l(`${u.name}: ${u.message}`)}i(!1)};return A(()=>{d().catch(console.error)},[m]),{data:n,lastUpdated:r,isLoading:s,error:c,fetchData:d}},ti=({rows:t,columns:n,defaultOrderBy:a,defaultOrderDir:r,copyToClipboard:o,paginationOffset:s})=>{const i=Fe(),[c,l]=C(a),[m,d]=C(r||"desc"),[u,h]=C(null),p=L(()=>{const{startIndex:f,endIndex:g}=s;return Hr(t,zr(m,c)).slice(f,g)},[t,c,m,s]),v=f=>()=>{d(g=>g==="asc"&&c===f?"desc":"asc"),l(f)},b=(f,g)=>async()=>{if(u!==g)try{await i(String(f)),h(g)}catch(_){console.error(_)}};return A(()=>{if(u===null)return;const f=setTimeout(()=>h(null),2e3);return()=>clearTimeout(f)},[u]),e("table",{className:"vm-table",children:[e("thead",{className:"vm-table-header",children:e("tr",{className:"vm-table__row vm-table__row_header",children:[n.map(f=>e("th",{className:"vm-table-cell vm-table-cell_header vm-table-cell_sort",onClick:v(f.key),children:e("div",{className:"vm-table-cell__content",children:[e("div",{children:String(f.title||f.key)}),e("div",{className:D({"vm-table__sort-icon":!0,"vm-table__sort-icon_active":c===f.key,"vm-table__sort-icon_desc":m==="desc"&&c===f.key}),children:e(Qe,{})})]})},String(f.key))),o&&e("th",{className:"vm-table-cell vm-table-cell_header"})]})}),e("tbody",{className:"vm-table-body",children:p.map((f,g)=>e("tr",{className:"vm-table__row",children:[n.map(_=>e("td",{className:D({"vm-table-cell":!0,[`${_.className}`]:_.className}),children:f[_.key]||"-"},String(_.key))),o&&e("td",{className:"vm-table-cell vm-table-cell_right",children:f[o]&&e("div",{className:"vm-table-cell__content",children:e(Y,{title:u===g?"Copied":"Copy row",children:e(P,{variant:"text",color:u===g?"success":"gray",size:"small",startIcon:u===g?e(Qn,{}):e(Xe,{}),onClick:b(f[o],g),ariaLabel:"copy row"})})})})]},g))})]})},cu=()=>{const{isMobile:t}=W(),{timezone:n}=he(),{data:a,lastUpdated:r,isLoading:o,error:s,fetchData:i}=lu(),c=L(()=>a.map(d=>{const u=B(d.start).tz().format(Ge),h=B(d.end).tz().format(Ge);return{duration:d.duration,remote_addr:d.remote_addr,query:d.query,args:`${u} to ${h}, step=${wa(d.step)}`,data:JSON.stringify(d,null,2)}}),[a,n]),l=L(()=>{if(!(c!=null&&c.length))return[];const d=Object.keys(c[0]),u={remote_addr:"client address"},h=["data"];return d.filter(p=>!h.includes(p)).map(p=>({key:p,title:u[p]||p}))},[c]),m=async()=>{i().catch(console.error)};return e("div",{className:"vm-active-queries",children:[o&&e(qe,{}),e("div",{className:"vm-active-queries-header",children:[!c.length&&!s&&e(ie,{variant:"info",children:"There are currently no active queries running"}),s&&e(ie,{variant:"error",children:s}),e("div",{className:"vm-active-queries-header-controls",children:[e(P,{variant:"contained",onClick:m,startIcon:e(qn,{}),children:"Update"}),e("div",{className:"vm-active-queries-header__update-msg",children:["Last updated: ",r]})]})]}),!!c.length&&e("div",{className:D({"vm-block":!0,"vm-block_mobile":t}),children:e(ti,{rows:c,columns:l,defaultOrderBy:"duration",copyToClipboard:"data",paginationOffset:{startIndex:0,endIndex:1/0}})})]})},du=({onClose:t,onUpload:n})=>{const{isMobile:a}=W(),[r,o]=C(""),[s,i]=C(""),c=L(()=>{try{return JSON.parse(r),""}catch(d){return d instanceof Error?d.message:"Unknown error"}},[r]),l=d=>{i(""),o(d)},m=()=>{i(c),!c&&(n(r),t())};return e("div",{className:D({"vm-json-form vm-json-form_one-field":!0,"vm-json-form_mobile vm-json-form_one-field_mobile":a}),children:[e(le,{value:r,label:"JSON",type:"textarea",error:s,autofocus:!0,onChange:l,onEnter:m}),e("div",{className:"vm-json-form-footer",children:e("div",{className:"vm-json-form-footer__controls vm-json-form-footer__controls_right",children:[e(P,{variant:"outlined",color:"error",onClick:t,children:"Cancel"}),e(P,{variant:"contained",onClick:m,children:"apply"})]})})]})},mu=({data:t,period:n})=>{const{isMobile:a}=W(),[r,o]=ae(),{tableCompact:s}=Ue(),i=Gt(),[c,l]=C([]),[m,d]=C(),[u,h]=C(),[p,v]=C(!1),[b,f]=C([]),[g,_]=C(),y=L(()=>Rr(u||[]).map(z=>z.key),[u]),w=L(()=>{const z=t.some(H=>H.data.resultType==="matrix");return t.some(H=>H.data.resultType==="vector")&&z?Ft:z?Ft.filter(H=>H.value==="chart"):Ft.filter(H=>H.value!=="chart")},[t]),[S,N]=C(w[0].value),{yaxis:k,spanGaps:T}=Re(),x=mt(),M=z=>{x({type:"SET_YAXIS_LIMITS",payload:z})},E=()=>{x({type:"TOGGLE_ENABLE_YAXIS_LIMITS"})},I=z=>{x({type:"SET_SPAN_GAPS",payload:z})},$=z=>{N(z)},O=z=>{l(j=>j.filter(H=>H.idValue!==z.idValue))},V=()=>{i({type:"TOGGLE_TABLE_COMPACT"})};return A(()=>{const z=S==="chart"?"matrix":"vector",j=t.filter(H=>H.data.resultType===z&&H.trace).map(H=>{var te,de;return H.trace?new At(H.trace,((de=(te=H==null?void 0:H.vmui)==null?void 0:te.params)==null?void 0:de.query)||"Query"):null});l(j.filter(Boolean))},[t,S]),A(()=>{const z=[],j=[],H=[];t.forEach((te,de)=>{var oe,K;const G=te.data.result.map(R=>{var F,q;return{...R,group:Number(((q=(F=te.vmui)==null?void 0:F.params)==null?void 0:q.id)??de)+1}});te.data.resultType==="matrix"?(j.push(...G),z.push(((K=(oe=te.vmui)==null?void 0:oe.params)==null?void 0:K.query)||"Query")):H.push(...G)}),f(z),d(j),h(H),r.delete("display_mode"),o(r)},[t]),A(()=>{const z=!r.get("display_mode");v(!!m&&z&&yr(m))},[m,r]),e("div",{className:D({"vm-query-analyzer-view":!0,"vm-query-analyzer-view_mobile":a}),children:[!!c.length&&e(Cr,{traces:c,onDeleteClick:O}),e(Js,{}),e("div",{className:D({"vm-block":!0,"vm-block_mobile":a}),children:[e("div",{className:"vm-custom-panel-body-header",children:[e("div",{className:"vm-custom-panel-body-header__tabs",children:e(Yt,{activeItem:S,items:w,onChange:$})}),e("div",{className:"vm-custom-panel-body-header__graph-controls",children:[S==="chart"&&e(mr,{}),S==="chart"&&e(Or,{data:m||[],yaxis:k,isHistogram:p,setYaxisLimits:M,toggleEnableLimits:E,spanGaps:{value:T,onChange:I}}),S==="table"&&e(Fr,{columns:y,selectedColumns:g,onChangeColumns:_,tableCompact:s,toggleTableCompact:V})]})]}),m&&n&&S==="chart"&&e(ta,{data:m,period:n,customStep:n.step||"1s",query:b,yaxis:k,setYaxisLimits:M,setPeriod:()=>null,height:a?window.innerHeight*.5:500,isHistogram:p,spanGaps:T}),u&&S==="code"&&e(na,{data:u}),u&&S==="table"&&e(Qs,{data:u,displayColumns:g})]})]})},uu=({data:t,period:n})=>{var d,u,h,p,v;const a=L(()=>t.filter(b=>b.vmui||b.stats),[t]),r=((u=(d=a.find(b=>{var f;return(f=b==null?void 0:b.vmui)==null?void 0:f.title}))==null?void 0:d.vmui)==null?void 0:u.title)||"Report",o=(p=(h=a.find(b=>{var f;return(f=b==null?void 0:b.vmui)==null?void 0:f.comment}))==null?void 0:h.vmui)==null?void 0:p.comment,s=L(()=>["vmui.endpoint",...new Set(a.flatMap(b=>{var f;return[...Object.keys(((f=b.vmui)==null?void 0:f.params)||[]).map(g=>`vmui.params.${g}`),...Object.keys(b.stats||[]).map(g=>`stats.${g}`),"isPartial"]}))].map(b=>({column:b.split(".").pop(),values:a.map(f=>pt(f,b,"-"))})).filter(({values:b})=>b.length&&b.every(f=>f!=="-")),[a]),i=L(()=>{if(!n)return"";const b=B(n.start*1e3).tz().format(Ge),f=B(n.end*1e3).tz().format(Ge);return`${b} - ${f}`},[n]),{value:c,setTrue:l,setFalse:m}=se(!1);return e(U,{children:[e("div",{className:"vm-query-analyzer-info-header",children:[e("h1",{className:"vm-query-analyzer-info-header__title",children:r}),i&&e("div",{className:"vm-query-analyzer-info-header__timerange",children:[e(en,{})," ",i]}),(n==null?void 0:n.step)&&e("div",{className:"vm-query-analyzer-info-header__timerange",children:[e(Mn,{})," step ",n.step]}),(o||!!s.length)&&e("div",{className:"vm-query-analyzer-info-header__info",children:e(P,{startIcon:e(st,{}),variant:"outlined",color:"warning",onClick:l,children:["Show stats",o&&" & comments"]})})]}),c&&e(Pe,{title:r,onClose:m,children:e("div",{className:"vm-query-analyzer-info__modal",children:[!!s.length&&e("div",{className:"vm-query-analyzer-info-stats",children:[e("div",{className:"vm-query-analyzer-info-comment-header",children:[e(st,{}),"Stats"]}),e("table",{children:[e("thead",{children:e("tr",{children:s.map(({column:b})=>e("th",{children:b},b))})}),e("tbody",{children:(v=s[0])==null?void 0:v.values.map((b,f)=>e("tr",{children:s.map(({values:g},_)=>e("td",{children:g[f]},_))},f))})]})]}),o&&e("div",{className:"vm-query-analyzer-info-comment",children:[e("div",{className:"vm-query-analyzer-info-comment-header",children:[e(as,{}),"Comments"]}),e("div",{className:"vm-query-analyzer-info-comment-body vm-markdown",dangerouslySetInnerHTML:{__html:qt(o)||o}})]})]})})]})},hu=t=>{const n=t.slice(1).map((s,i)=>s-t[i]),a={};n.forEach(s=>{const i=s.toString();a[i]=(a[i]||0)+1});let r=0,o=0;for(const s in a)a[s]>o&&(o=a[s],r=Number(s));return r},pu=()=>{const[t,n]=C([]),[a,r]=C(""),o=L(()=>!!t.length,[t]),{value:s,setTrue:i,setFalse:c}=se(!1),l=L(()=>{var _,y;if(!t)return;const f=(y=(_=t[0])==null?void 0:_.vmui)==null?void 0:y.params,g={start:+((f==null?void 0:f.start)||0),end:+((f==null?void 0:f.end)||0),step:f==null?void 0:f.step,date:""};if(!f){const S=t.filter(k=>k.data.resultType==="matrix").map(k=>k.data.result).flat().map(k=>{var T;return k.values?(T=k.values)==null?void 0:T.map(x=>x[0]):[0]}).flat(),N=Array.from(new Set(S.filter(Boolean))).sort((k,T)=>k-T);g.start=N[0],g.end=N[N.length-1],g.step=Ha(hu(N))}return g.date=Ro(je(g.end)),g},[t]),m=f=>f.every(g=>{if(typeof g=="object"&&g!==null){const _=g.data;if(typeof _=="object"&&_!==null){const y=_.result,w=_.resultType;return Array.isArray(y)&&typeof w=="string"}}return!1}),d=f=>{try{const g=JSON.parse(f),_=Array.isArray(g)?g:[g];m(_)?n(_):(r("Invalid structure - JSON does not match the expected format"),n([]))}catch(g){g instanceof Error&&(r(`${g.name}: ${g.message}`),n([]))}},u=f=>{f.map(g=>{const _=new FileReader;_.onload=y=>{var S;const w=String((S=y.target)==null?void 0:S.result);d(w)},_.readAsText(g)})},h=f=>{if(!f.target)return;const g=f.target;r("");const _=Array.from(g.files||[]);u(_),g.value=""},p=()=>{r("")},{files:v,dragging:b}=ei();return A(()=>{u(v)},[v]),e("div",{className:"vm-query-analyzer",children:[o&&e("div",{className:"vm-query-analyzer-header",children:[e(uu,{data:t,period:l}),e($n,{onOpenModal:i,onChange:h})]}),o&&e(mu,{data:t,period:l}),!o&&e("div",{className:"vm-trace-page-preview",children:[e("p",{className:"vm-trace-page-preview__text",children:["Please, upload file with JSON response content.",`
`,"The file must contain query information in JSON format.",`
`,"Graph will be displayed after file upload.",`
`,"Attach files by dragging & dropping, selecting or pasting them."]}),e($n,{onOpenModal:i,onChange:h})]}),a&&e("div",{className:"vm-query-analyzer-error",children:[e(ie,{variant:"error",children:a}),e(P,{className:"vm-query-analyzer-error__close",startIcon:e(He,{}),variant:"text",color:"error",onClick:p})]}),s&&e(Pe,{title:"Paste JSON",onClose:c,children:e(du,{onClose:c,onUpload:d})}),b&&e("div",{className:"vm-trace-page__dropzone"})]})},gu=(t,n,a)=>{const r=[`flags=${encodeURIComponent(n)}`,`metrics=${encodeURIComponent(a)}`];return`${t}/downsampling-filters-debug?${r.join("&")}`},vu=()=>{const{serverUrl:t}=re(),[n,a]=ae(),[r,o]=C(new Map),[s,i]=C(!1),[c,l]=C(),[m,d]=C(),[u,h]=C(),p=X(async(v,b)=>{var g,_;if(l(b?"":"metrics are required"),d(v?"":"flags are required"),!b||!v)return;n.set("flags",v),n.set("metrics",b),a(n);const f=gu(t,v,b);i(!0);try{const w=await(await fetch(f)).json();o(new Map(Object.entries(w.result||{}))),l(((g=w.error)==null?void 0:g.metrics)||""),d(((_=w.error)==null?void 0:_.flags)||""),h("")}catch(y){y instanceof Error&&y.name!=="AbortError"&&h(`${y.name}: ${y.message}`)}i(!1)},[t]);return{data:r,error:u,metricsError:c,flagsError:m,loading:s,applyFilters:p}},vo={flags:`-downsampling.period={env="dev"}:7d:5m,{env="dev"}:30d:30m
-downsampling.period=30d:1m
-downsampling.period=60d:5m
`,metrics:`up
up{env="dev"}
up{env="prod"}`},fu=()=>{const[t]=ae(),{data:n,loading:a,error:r,metricsError:o,flagsError:s,applyFilters:i}=vu(),[c,l]=C(t.get("metrics")||""),[m,d]=C(t.get("flags")||""),u=X(f=>{l(f)},[l]),h=X(f=>{d(f)},[d]),p=X(()=>{i(m,c)},[i,m,c]),v=X(()=>{const{flags:f,metrics:g}=vo;d(f),l(g),i(f,g),t.set("flags",f),t.set("metrics",g)},[vo,d,l,t]);A(()=>{m&&c&&p()},[]);const b=[];for(const[f,g]of n)b.push(e("tr",{className:"vm-table__row",children:[e("td",{className:"vm-table-cell",children:f}),e("td",{className:D({"vm-table-cell":!0,"vm-table-cell_empty":!g}),children:g?g.join(" "):"No matching rules found!"})]}));return e("section",{className:"vm-downsampling-filters",children:[a&&e(qe,{}),e("div",{className:"vm-downsampling-filters-body vm-block",children:[e("div",{className:"vm-downsampling-filters-body__expr",children:[e("div",{className:"vm-retention-filters-body__title",children:e("p",{children:["Provide a list of flags for downsampling configuration. Note that only ",e("code",{children:"-downsampling.period"})," and ",e("code",{children:"-dedup.minScrapeInterval"})," flags are supported"]})}),e(le,{type:"textarea",label:"Flags",value:m,error:r||s,autofocus:!0,onEnter:p,onChange:h,placeholder:"-downsampling.period=30d:1m -downsampling.period=7d:5m -dedup.minScrapeInterval=30s"})]}),e("div",{className:"vm-downsampling-filters-body__expr",children:[e("div",{className:"vm-retention-filters-body__title",children:e("p",{children:"Provide a list of metrics to check downsampling configuration."})}),e(le,{type:"textarea",label:"Metrics",value:c,error:r||o,onEnter:p,onChange:u,placeholder:`up{env="dev"}
up{env="prod"}
`})]}),e("div",{className:"vm-downsampling-filters-body__result",children:e("table",{className:"vm-table",children:[e("thead",{className:"vm-table-header",children:e("tr",{children:[e("th",{className:"vm-table-cell vm-table-cell_header",children:"Metric"}),e("th",{className:"vm-table-cell vm-table-cell_header",children:"Applied downsampling rules"})]})}),e("tbody",{className:"vm-table-body",children:b})]})}),e("div",{className:"vm-downsampling-filters-body-top",children:[e("a",{className:"vm-link vm-link_with-icon",target:"_blank",href:"https://docs.victoriametrics.com/#downsampling",rel:"help noreferrer",children:[e(it,{}),"Documentation"]}),e(P,{variant:"text",onClick:v,children:"Try example"}),e(P,{variant:"contained",onClick:p,startIcon:e(dt,{}),children:"Apply"})]})]})]})},_u=(t,n,a)=>{const r=[`flags=${encodeURIComponent(n)}`,`metrics=${encodeURIComponent(a)}`];return`${t}/retention-filters-debug?${r.join("&")}`},bu=()=>{const{serverUrl:t}=re(),[n,a]=ae(),[r,o]=C(new Map),[s,i]=C(!1),[c,l]=C(),[m,d]=C(),[u,h]=C(),p=X(async(v,b)=>{var g,_;if(l(b?"":"metrics are required"),d(v?"":"flags are required"),!b||!v)return;n.set("flags",v),n.set("metrics",b),a(n);const f=_u(t,v,b);i(!0);try{const w=await(await fetch(f)).json();o(new Map(Object.entries(w.result||{}))),l(((g=w.error)==null?void 0:g.metrics)||""),d(((_=w.error)==null?void 0:_.flags)||""),h("")}catch(y){y instanceof Error&&y.name!=="AbortError"&&h(`${y.name}: ${y.message}`)}i(!1)},[t]);return{data:r,error:u,metricsError:c,flagsError:m,loading:s,applyFilters:p}},fo={flags:`-retentionPeriod=1y
-retentionFilters={env!="prod"}:2w
`,metrics:`up
up{env="dev"}
up{env="prod"}`},yu=()=>{const[t]=ae(),{data:n,loading:a,error:r,metricsError:o,flagsError:s,applyFilters:i}=bu(),[c,l]=C(t.get("metrics")||""),[m,d]=C(t.get("flags")||""),u=X(f=>{l(f)},[l]),h=X(f=>{d(f)},[d]),p=X(()=>{i(m,c)},[i,m,c]),v=X(()=>{const{flags:f,metrics:g}=fo;d(f),l(g),i(f,g),t.set("flags",f),t.set("metrics",g)},[fo,d,l,t]);A(()=>{m&&c&&p()},[]);const b=[];for(const[f,g]of n)b.push(e("tr",{className:"vm-table__row",children:[e("td",{className:"vm-table-cell",children:f}),e("td",{className:"vm-table-cell",children:g})]}));return e("section",{className:"vm-retention-filters",children:[a&&e(qe,{}),e("div",{className:"vm-retention-filters-body vm-block",children:[e("div",{className:"vm-retention-filters-body__expr",children:[e("div",{className:"vm-retention-filters-body__title",children:e("p",{children:["Provide a list of flags for retention configuration. Note that only ",e("code",{children:"-retentionPeriod"})," and ",e("code",{children:"-retentionFilters"})," flags are supported."]})}),e(le,{type:"textarea",label:"Flags",value:m,error:r||s,autofocus:!0,onEnter:p,onChange:h,placeholder:'-retentionPeriod=4w -retentionFilters=up{env="dev"}:2w'})]}),e("div",{className:"vm-retention-filters-body__expr",children:[e("div",{className:"vm-retention-filters-body__title",children:e("p",{children:"Provide a list of metrics to check retention configuration."})}),e(le,{type:"textarea",label:"Metrics",value:c,error:r||o,onEnter:p,onChange:u,placeholder:`up{env="dev"}
up{env="prod"}
`})]}),e("div",{className:"vm-retention-filters-body__result",children:e("table",{className:"vm-table",children:[e("thead",{className:"vm-table-header",children:e("tr",{children:[e("th",{className:"vm-table-cell vm-table-cell_header",children:"Metric"}),e("th",{className:"vm-table-cell vm-table-cell_header",children:"Applied retention"})]})}),e("tbody",{className:"vm-table-body",children:b})]})}),e("div",{className:"vm-retention-filters-body-top",children:[e("a",{className:"vm-link vm-link_with-icon",target:"_blank",href:"https://docs.victoriametrics.com/#retention-filters",rel:"help noreferrer",children:[e(it,{}),"Documentation"]}),e(P,{variant:"text",onClick:v,children:"Try example"}),e(P,{variant:"contained",onClick:p,startIcon:e(dt,{}),children:"Apply"})]})]})]})},wu=({hideQuery:t,showAllSeries:n})=>{const{query:a}=Ee(),{period:r}=he(),{displayType:o,reduceMemUsage:s,seriesLimits:i}=Ue(),{serverUrl:c}=re(),[l,m]=C(!1),[d,u]=C(),[h,p]=C(),[v,b]=C([]),[f,g]=C(),_=Q(new AbortController),y=L(()=>{if(p(""),b([]),!!r)if(!c)p(be.emptyServer);else if(a.every(N=>!N.trim()))b(a.map(()=>be.validQuery));else if(Oa(c)){const N={...r};return a.map(k=>Rc(c,k,N,s))}else p(be.validServer)},[c,r,t,s]),w=X(async({fetchUrl:N,stateSeriesLimits:k,showAllSeries:T})=>{_.current.abort(),_.current=new AbortController;const{signal:x}=_.current;m(!0);try{const M=[],E=T?1/0:+k[o]||1/0;let I=1,$=0;for await(const V of N){if(t==null?void 0:t.includes(I-1)){b(te=>[...te,""]),I++;continue}const j=await fetch(V,{signal:x}),H=await j.text();if(!j.ok||!j.body)M.push({metric:{},values:[],group:I}),p(H),b(te=>[...te,`${H}`]);else{b(oe=>[...oe,""]);const te=E-M.length,de=H.split(`
`).filter(oe=>oe);de.slice(0,te).sort().forEach(oe=>{const K=Gs(oe);K&&M.push({group:I,metric:K.metric,values:K.values.map((R,F)=>[K.timestamps[F]/1e3,R])})}),$+=de.length}I++}const O=`Showing ${M.length} series out of ${$} series due to performance reasons. Please narrow down the query, so it returns less series`;g($>E?O:""),u(M),m(!1)}catch(M){m(!1),M instanceof Error&&M.name!=="AbortError"&&(p(String(M)),console.error(M))}},[o,t]),S=X(()=>{_.current.abort(),u([])},[_]);return A(()=>{if(!(y!=null&&y.length))return;const N=setTimeout(w,400,{fetchUrl:y,stateSeriesLimits:i,showAllSeries:n});return()=>{var k;(k=_.current)==null||k.abort(),clearTimeout(N)}},[y,i,n]),{fetchUrl:y,isLoading:l,data:d,error:h,queryErrors:v,setQueryErrors:b,warning:f,abortFetch:S}},Cu=()=>e(Se,{href:"https://docs.victoriametrics.com/keyconcepts/#raw-samples",underlined:!0,children:"raw samples"}),Nu=()=>e(Se,{underlined:!0,href:"https://docs.victoriametrics.com/keyconcepts/#query-data",children:"Query API"}),ku=()=>e(Se,{underlined:!0,href:"https://docs.victoriametrics.com/keyconcepts/#filtering",children:"time series selector"}),Su=()=>{wr();const{isMobile:t}=W(),{displayType:n}=Ue(),{query:a}=Ee(),[r,o]=C([]),[s,i]=C(!a[0]),[c,l]=C(!1),[m,d]=C(!0),{data:u,error:h,isLoading:p,warning:v,queryErrors:b,setQueryErrors:f,abortFetch:g,fetchUrl:_}=wu({hideQuery:r,showAllSeries:c}),y=Q(null),w=!s&&h,S=T=>{o(T)},N=()=>{i(!1)},k=()=>{d(!1)};return e("div",{className:D({"vm-custom-panel":!0,"vm-custom-panel_mobile":t}),children:[e(br,{label:"Time series selector",queryErrors:s?[]:b,setQueryErrors:f,setHideError:i,stats:[],isLoading:p,onHideQuery:S,onRunQuery:N,abortFetch:g,hideButtons:{traceQuery:!0,disableCache:!0},includeFunctions:!1}),m&&e(ie,{variant:"info",children:e("div",{className:"vm-explore-metrics-header-description",children:[e("ul",{children:[e("li",{children:["This page provides a dedicated view for querying and displaying ",e(Cu,{})," from VictoriaMetrics."]}),e("li",{children:["It expects only ",e(ku,{})," as a query argument."]}),e("li",{children:["Deduplication can only be disabled if it was previously enabled on the server (",e("code",{children:"-dedup.minScrapeInterval"}),")."]}),e("li",{children:["Users often assume that the ",e(Nu,{})," returns data exactly as stored, but data samples and timestamps may be modified by the API."]})]}),e(P,{variant:"text",size:"small",startIcon:e(He,{}),onClick:k,ariaLabel:"close tips"})]})}),w&&e(ie,{variant:"error",children:h}),v&&e(ea,{warning:v,query:a,onChange:l}),e("div",{className:D({"vm-custom-panel-body":!0,"vm-custom-panel-body_mobile":t,"vm-block":!0,"vm-block_mobile":t}),children:[p&&e(Xn,{}),e("div",{className:"vm-custom-panel-body-header",ref:y,children:[e("div",{className:"vm-custom-panel-body-header__tabs",children:e(rs,{tabFilter:T=>T.value!==we.table})}),u&&e(Ks,{fetchUrl:_,reportType:Ws.RAW_DATA})]}),e(Ys,{graphData:u,liveData:u,isHistogram:!1,displayType:n,controlsRef:y})]})]})},Tu=()=>{const[t,n]=C(!1);return e(U,{children:e(Ia,{children:e(dr,{children:e(U,{children:[e(Vr,{onLoaded:n}),t&&e(Pa,{children:e(ge,{path:"/",element:e(cc,{}),children:[e(ge,{path:J.home,element:e(Zs,{})}),e(ge,{path:J.rawQuery,element:e(Su,{})}),e(ge,{path:J.metrics,element:e(Km,{})}),e(ge,{path:J.cardinality,element:e(km,{})}),e(ge,{path:J.topQueries,element:e(Dm,{})}),e(ge,{path:J.trace,element:e(Pm,{})}),e(ge,{path:J.queryAnalyzer,element:e(pu,{})}),e(ge,{path:J.dashboards,element:e(am,{})}),e(ge,{path:J.withTemplate,element:e(nu,{})}),e(ge,{path:J.relabel,element:e(su,{})}),e(ge,{path:J.activeQueries,element:e(cu,{})}),e(ge,{path:J.icons,element:e(Jm,{})}),e(ge,{path:J.downsamplingDebug,element:e(fu,{})}),e(ge,{path:J.retentionDebug,element:e(yu,{})})]})})]})})})})},ni=({currentPage:t,totalItems:n,itemsPerPage:a,onPageChange:r,maxVisiblePages:o=10})=>{const s=Math.ceil(n/a),i=d=>{d<1||d>s||r(d)},c=L(()=>{const d=[];if(s<=o)for(let u=1;u<=s;u++)d.push(u);else{const u=Math.max(1,t-Math.floor(o/2)),h=Math.min(s,u+o-1);u>1&&(d.push(1),u>2&&d.push("..."));for(let p=u;p<=h;p++)d.push(p);h<s&&(h<s-1&&d.push("..."),d.push(s))}return d},[s,t,o]),l=d=>()=>{i(t+d)},m=d=>()=>{typeof d=="number"&&i(d)};return c.length<=1?null:e("div",{className:"vm-pagination",children:[e("button",{className:"vm-pagination__page vm-pagination__arrow vm-pagination__arrow_prev",onClick:l(-1),disabled:t===1,children:e(ve,{})}),c.map((d,u)=>e("button",{onClick:m(d),className:D({"vm-pagination__page":!0,"vm-pagination__page_active":t===d,"vm-pagination__page_disabled":d==="..."}),disabled:d==="...",children:d},u)),e("button",{className:"vm-pagination__page vm-pagination__arrow vm-pagination__arrow_next",onClick:l(1),disabled:t===s,children:e(ve,{})})]})},Au=t=>{switch(t){case"_time":return"vm-table-cell_logs-time";default:return"vm-table-cell_logs"}},xu=[{key:"_vmui_data",title:"Data",className:"vm-table-cell_logs vm-table-cell_pre"}],Eu=({logs:t,displayColumns:n,tableCompact:a,columns:r,rowsPerPage:o})=>{const s=Q(null),[i,c]=C(1),l=L(()=>t.map(p=>{const v=JSON.stringify(p,null,2);return{...p,_vmui_data:v}}),[t]),m=L(()=>r.map(p=>({key:p,title:p,className:Au(p)})),[r]),d=L(()=>a?xu:n!=null&&n.length?m.filter(p=>n.includes(p.key)):[],[m,n,a]),u=L(()=>{const p=(i-1)*o,v=p+o;return{startIndex:p,endIndex:v}},[i,o]),h=p=>{if(c(p),s.current){const v=s.current.getBoundingClientRect().top+window.scrollY-50;window.scrollTo({top:v})}};return A(()=>{c(1)},[t,o]),e(U,{children:[e("div",{ref:s,children:e(ti,{rows:l,columns:d,defaultOrderBy:"_time",defaultOrderDir:"desc",copyToClipboard:"_vmui_data",paginationOffset:u})}),e(ni,{currentPage:i,totalItems:l.length,itemsPerPage:o,onPageChange:h})]})},Lu=({field:t,value:n})=>{const a=Fe(),[r,o]=ae(),[s,i]=C(!1),c=r.get(ke.GROUP_BY)||Me,l=r.get(ke.DISPLAY_FIELDS)||"",m=l?l.split(","):[],d=m.includes(t),u=c===t,h=X(async()=>{if(!s)try{await a(`${t}: "${n}"`),i(!0)}catch(b){console.error(b)}},[s,a]),p=()=>{const b=m,f=b.includes(t)?b.filter(g=>g!==t):[...b,t];r.set(ke.DISPLAY_FIELDS,f.join(",")),o(r)},v=()=>{u?r.delete(ke.GROUP_BY):r.set(ke.GROUP_BY,t),o(r)};return A(()=>{if(s===null)return;const b=setTimeout(()=>i(!1),2e3);return()=>clearTimeout(b)},[s]),e("tr",{className:"vm-group-logs-row-fields-item",children:[e("td",{className:"vm-group-logs-row-fields-item-controls",children:e("div",{className:"vm-group-logs-row-fields-item-controls__wrapper",children:[e(Y,{title:s?"Copied":"Copy to clipboard",children:e(P,{className:"vm-group-logs-row-fields-item-controls__button",variant:"text",color:"gray",size:"small",startIcon:e(Xe,{}),onClick:h,ariaLabel:"copy to clipboard"})}),e(Y,{title:d?"Hide this field":"Show this field instead of the message",children:e(P,{className:"vm-group-logs-row-fields-item-controls__button",variant:"text",color:d?"secondary":"gray",size:"small",startIcon:d?e(Ht,{}):e(Ht,{}),onClick:p,ariaLabel:"copy to clipboard"})}),e(Y,{title:u?"Ungroup this field":"Group by this field",children:e(P,{className:"vm-group-logs-row-fields-item-controls__button",variant:"text",color:u?"secondary":"gray",size:"small",startIcon:e(Tt,{}),onClick:v,ariaLabel:"copy to clipboard"})})]})}),e("td",{className:"vm-group-logs-row-fields-item__key",children:t}),e("td",{className:"vm-group-logs-row-fields-item__value",children:n})]})},Mu=La(Lu),Du=({log:t,displayFields:n=["_msg"]})=>{const{value:a,toggle:r}=se(!1),[o]=ae(),{markdownParsing:s}=cr(),{timezone:i}=he(),c=o.get(ke.NO_WRAP_LINES)==="true",l=o.get(ke.DATE_FORMAT)||Ot,m=L(()=>t._time?B(t._time).tz().format(l):"",[t._time,i,l]),d=L(()=>!s||!t._msg?"":qt(t._msg.replace(/```/g,"\n```\n")),[t._msg,s]),u=L(()=>Object.entries(t),[t]),h=u.length>0,p=L(()=>{if(n.length)return n.filter(_=>t[_]).map((_,y)=>e("span",{className:"vm-group-logs-row-content__sub-msg",children:t[_]},_+y));if(t._msg)return t._msg;if(!h)return;const g=u.reduce((_,[y,w])=>(_[y]=w,_),{});return JSON.stringify(g)},[t,u,h,n]),[v,b]=C(!!xe("LOGS_DISABLED_HOVERS"));return ce("storage",()=>{const g=!!xe("LOGS_DISABLED_HOVERS");g!==v&&b(g)}),e("div",{className:"vm-group-logs-row",children:[e("div",{className:D({"vm-group-logs-row-content":!0,"vm-group-logs-row-content_interactive":!v}),onClick:r,children:[h&&e("div",{className:D({"vm-group-logs-row-content__arrow":!0,"vm-group-logs-row-content__arrow_open":a}),children:e(ve,{})}),e("div",{className:D({"vm-group-logs-row-content__time":!0,"vm-group-logs-row-content__time_missing":!m}),children:m||"timestamp missing"}),e("div",{className:D({"vm-group-logs-row-content__msg":!0,"vm-group-logs-row-content__msg_empty-msg":!t._msg,"vm-group-logs-row-content__msg_missing":!p,"vm-group-logs-row-content__msg_single-line":c}),dangerouslySetInnerHTML:s&&d?{__html:d}:void 0,children:p||"-"})]}),h&&a&&e("div",{className:D({"vm-group-logs-row-fields":!0,"vm-group-logs-row-fields_interactive":!v}),children:e("table",{children:e("tbody",{children:u.map(([g,_])=>e(Mu,{field:g,value:_},g))})})})]})},Iu=La(Du);var nt=(t=>(t.BAR="Bars",t.LINE="Lines",t.LINE_STEPPED="Stepped lines",t.POINTS="Points",t))(nt||{});const Pu=(t,n,a,r)=>{var i,c,l;const o=t.under.clientWidth/Hs-1,s=(l=(c=(i=Bt)==null?void 0:i.paths)==null?void 0:c.bars)==null?void 0:l.call(c,{size:[.96,o]});return s?s(t,n,a,r):null},$u=(t,n,a,r)=>{var s,i,c;const o=(c=(i=(s=Bt)==null?void 0:s.paths)==null?void 0:i.stepped)==null?void 0:c.call(i,{align:1});return o?o(t,n,a,r):null},Ou=t=>{switch(t){case nt.BAR:return Pu;case nt.LINE_STEPPED:return $u;default:return}},Ru=["color-log-hits-bar-1","color-log-hits-bar-2","color-log-hits-bar-3","color-log-hits-bar-4","color-log-hits-bar-5"],Fu={[nt.BAR]:1,[nt.LINE_STEPPED]:2,[nt.LINE]:1.2,[nt.POINTS]:0},xa="other",ai=t=>t!=null&&t._isOther?xa:Object.values((t==null?void 0:t.fields)||{}).map(a=>a||'""').join(", "),zu=({data:t,logHits:n,xRange:a,bands:r,containerSize:o,onReadyChart:s,setPlotScale:i,graphOptions:c})=>{const{isDarkTheme:l}=re(),[m,d]=C(-1),u=v=>{const b=v.cursor.idx??-1;d(b)},h=L(()=>{let v=0;return t.map((b,f)=>{if(f===0)return{};const g=n==null?void 0:n[f-1],_=ai(g),y=Ze(g!=null&&g._isOther?"color-log-hits-bar-0":Ru[v]);return g!=null&&g._isOther||v++,{label:_,width:Fu[c.graphStyle],spanGaps:!0,stroke:y,fill:c.fill?y+(g!=null&&g._isOther?"":"80"):"",paths:Ou(c.graphStyle)}})},[l,t,c]);return{options:L(()=>({series:h,bands:r,width:o.width||window.innerWidth/2,height:o.height||200,cursor:{points:{width:(v,b,f)=>f/4,size:(v,b)=>{var f,g,_;return(((_=(g=(f=v.series)==null?void 0:f[b])==null?void 0:g.points)==null?void 0:_.size)||1)*1.5},stroke:(v,b)=>{var f;return`${((f=h==null?void 0:h[b])==null?void 0:f.stroke)||"#ffffff"}`},fill:()=>"#ffffff"}},scales:{x:{time:!0,range:()=>[a.min,a.max]}},hooks:{drawSeries:[],ready:[s],setCursor:[u],setSelect:[Lr(i)],destroy:[Er]},legend:{show:!1},axes:Sr([{},{scale:"y"}]),tzDate:v=>B(Rt(je(v))).local().toDate()}),[l,h,r]),series:h,focusDataIdx:m}},ri=t=>(/^{.+}$/.test(t)?t.slice(1,-1).split(","):[t]).filter(Boolean),oi=t=>{const n=B(t.start*1e3),a=B(t.end*1e3),r=a.diff(n,"milliseconds"),o=Math.ceil(r/Hs)||1;return{start:n,end:a,step:o}},si=(t,n=Me)=>/(.+)?=(".+")/.test(t)?t.replace(/=/,": "):`${n}: "${t}"`,Hu=t=>t.reduce((n,a)=>n+(a.total||0),0),ii=t=>(n,a)=>{if(n.label===xa)return 1;if(a.label===xa)return-1;const r=n[t];return a[t]-r},{GROUP_BY:_o,NO_WRAP_LINES:bo,COMPACT_GROUP_HEADER:yo,DISPLAY_FIELDS:_a,DATE_FORMAT:ba}=ke,wn="Group view settings",Vu=({logs:t})=>{const[n,a]=ae(),r=n.get(_o)||Me,o=n.get(bo)==="true",s=n.get(yo)==="true",i=n.get(_a)||"",c=i?i.split(","):[kn],[l,m]=C(n.get(ba)||Ot),[d,u]=C(""),[h,p]=C(!!xe("LOGS_DISABLED_HOVERS")),v=r!==Me,b=c.length!==1||c[0]!==kn,f=l!==Ot,g=[v,b,o,s,f].some(Boolean),_=L(()=>Array.from(new Set(t.map(V=>Object.keys(V)).flat())),[t]),{value:y,toggle:w,setFalse:S}=se(!1),N=V=>{n.set(_o,V),a(n)},k=V=>{const z=c,j=z.includes(V)?z.filter(H=>H!==V):[...z,V];n.set(_a,j.join(",")),a(n)},T=()=>{n.delete(_a),a(n)},x=()=>{n.set(bo,String(!o)),a(n)},M=()=>{n.set(yo,String(!s)),a(n)},E=V=>{B(new Date,V,!0).isValid()||u("Invalid date format"),m(V)},I=()=>{l===Ot?n.delete(ba):n.set(ba,l),a(n),S()},$=V=>{p(V),Te("LOGS_DISABLED_HOVERS",V)};return e(U,{children:[e("div",{className:"vm-group-logs-configurator-button",children:[e(Y,{title:g?e("div",{className:"vm-group-logs-configurator__tooltip",children:[e("p",{children:wn}),e("hr",{}),e("ul",{children:[v&&e("li",{children:["Group by ",e("code",{children:`"${r}"`})]}),b&&e("li",{children:["Display fields: ",c.length||1]}),o&&e("li",{children:"Single-line text is enabled"}),s&&e("li",{children:"Compact group header is enabled"}),f&&e("li",{children:["Date format: ",e("code",{children:l})]})]})]}):wn,children:e(P,{variant:"text",startIcon:e(ot,{}),onClick:w,ariaLabel:wn})}),g&&e("span",{className:"vm-group-logs-configurator-button__marker"})]}),y&&e(Pe,{title:wn,onClose:I,children:e("div",{className:"vm-group-logs-configurator",children:[e("div",{className:"vm-group-logs-configurator-item",children:[e(Ct,{value:r,list:[Vt,..._],label:"Group by field",placeholder:"Group by field",onChange:N,searchable:!0}),e(Y,{title:"Reset grouping",children:e(P,{variant:"text",color:"primary",startIcon:e(at,{}),onClick:()=>N(Me)})}),e("span",{className:"vm-group-logs-configurator-item__info",children:["Select a field to group logs by (default: ",e("code",{children:Me}),")."]})]}),e("div",{className:"vm-group-logs-configurator-item",children:[e(Ct,{value:c,list:_,label:"Display fields",placeholder:"Display fields",onChange:k,searchable:!0}),e(Y,{title:"Clear fields",children:e(P,{variant:"text",color:"primary",startIcon:e(at,{}),onClick:T})}),e("span",{className:"vm-group-logs-configurator-item__info",children:["Select fields to display instead of the message (default: ",e("code",{children:kn}),")."]})]}),e("div",{className:"vm-group-logs-configurator-item",children:[e(le,{autofocus:!0,label:"Date format",value:l,onChange:E,error:d}),e(Y,{title:"Reset format",children:e(P,{variant:"text",color:"primary",startIcon:e(at,{}),onClick:()=>m(Ot)})}),e("span",{className:"vm-group-logs-configurator-item__info vm-group-logs-configurator-item__info_input",children:["Set the date format (e.g., ",e("code",{children:"YYYY-MM-DD HH:mm:ss"}),"). Learn more in ",e(Se,{href:"https://day.js.org/docs/en/display/format",children:"this documentation"}),". ",e("br",{}),"Your current date format: ",e("code",{children:B().format(l||Ot)})]})]}),e("div",{className:"vm-group-logs-configurator-item",children:[e(ye,{value:o,onChange:x,label:"Single-line message"}),e("span",{className:"vm-group-logs-configurator-item__info",children:"Displays message in a single line and truncates it with an ellipsis if it exceeds the available space."})]}),e("div",{className:"vm-group-logs-configurator-item",children:[e(ye,{value:s,onChange:M,label:"Compact group header"}),e("span",{className:"vm-group-logs-configurator-item__info",children:'Shows group headers in one line with a "+N more" badge for extra fields.'})]}),e("div",{className:"vm-group-logs-configurator-item",children:[e(ye,{value:h,onChange:$,label:"Disable hover effects"}),e("span",{className:"vm-group-logs-configurator-item__info",children:"Disable row highlighting on hover to improve performance with large datasets."})]})]})})]})},wo=({pair:t,isHide:n})=>{const{isDarkTheme:a}=re(),r=Fe(),[o]=ae(),[s,i]=C(null),c=o.get(ke.GROUP_BY)||Me,l=m=>async d=>{d.stopPropagation();const u=si(m,c);await r(u)&&i(m)};return A(()=>{if(s===null)return;const m=setTimeout(()=>i(null),2e3);return()=>clearTimeout(m)},[s]),e(Y,{title:s===t?"Copied":"Copy to clipboard",placement:"top-center",children:e("div",{className:D({"vm-group-logs-section-keys__pair":!0,"vm-group-logs-section-keys__pair_hide":n,"vm-group-logs-section-keys__pair_dark":a}),onClick:l(t),children:t})})},Uu=({group:t,index:n})=>{const{isDarkTheme:a}=re(),[r]=ae(),o=Q(null),s=Q(null),{value:i,toggle:c,setFalse:l}=se(!1),[m,d]=C(0),u=r.get(ke.GROUP_BY)||Me,h=r.get(ke.COMPACT_GROUP_HEADER)==="true",p=t.pairs,v=p.length-m-1,b=g=>{g.stopPropagation(),c()},f=X(()=>{if(!h||!o.current){d(0);return}const g=o.current,_=g.getBoundingClientRect(),w=Array.from(g.querySelectorAll(".vm-group-logs-section-keys__pair:not(.vm-group-logs-section-keys__pair_more)"));let S=0;for(const N of w){const{right:k}=N.getBoundingClientRect();k+220>_.width&&S++}d(S)},[h,o]);return A(f,[t.pairs,h,o]),ce("resize",f),e("div",{className:D({"vm-group-logs-section-keys":!0,"vm-group-logs-section-keys_compact":h}),ref:o,children:[e("span",{className:"vm-group-logs-section-keys__title",children:u===Vt?Vt:e(U,{children:[n+1,". Group by ",e("code",{children:u}),":"]})}),p.map((g,_)=>e(wo,{pair:g,isHide:m?_>v:!1},`${t.keysString}_${g}`)),m>0&&e(U,{children:[e("div",{className:D({"vm-group-logs-section-keys__pair":!0,"vm-group-logs-section-keys__pair_more":!0,"vm-group-logs-section-keys__pair_dark":a}),ref:s,onClick:b,children:["+",m," more"]}),e(Ie,{open:i,buttonRef:s,placement:"bottom-left",onClose:l,children:e("div",{className:"vm-group-logs-section-keys vm-group-logs-section-keys_popper",children:p.slice(v+1).map(g=>e(wo,{pair:g},`${t.keysString}_${g}`))})})]}),e("span",{className:"vm-group-logs-section-keys__count",children:[t.total," entries"]})]})},Co=[10,25,50,100,250,500,1e3],li=({limit:t,allowUnlimited:n,onChange:a})=>{const{isMobile:r}=W(),o=Q(null),s=L(()=>n?[...Co,0]:Co,[n]),{value:i,toggle:c,setFalse:l}=se(!1),m=d=>()=>{a(d),l()};return e(U,{children:[e("div",{className:"vm-select-limits-button",onClick:c,ref:o,children:[e("div",{children:["Rows per page: ",e("b",{children:t||"All"})]}),e(Qe,{})]}),e(Ie,{open:i,onClose:l,placement:"bottom-right",buttonRef:o,children:e("div",{className:"vm-select-limits",children:s.map(d=>e("div",{className:D({"vm-list-item":!0,"vm-list-item_mobile":r,"vm-list-item_active":d===t}),onClick:m(d),children:d||"All"},d))})})]})},qu=(t,n,a)=>L(()=>{if(!a)return t;const r=(n-1)*a,o=r+a;let s=0;const i=[];for(const c of t){const l=c.values.length,m=s,d=s+l;if(d<=r){s=d;continue}if(m>=o)break;const u=Math.max(0,r-m),h=Math.min(l,o-m),p={...c,values:c.values.slice(u,h)};if(i.push(p),s=d,s>=o)break}return i},[t,n,a]),Bu=({logs:t,settingsRef:n})=>{const[a,r]=ae(),[o,s]=C(1),[i,c]=C([]),l=a.get(ke.GROUP_BY)||Me,m=a.get(ke.DISPLAY_FIELDS)||kn,d=L(()=>m.split(","),[m]),u=Number(a.get(ke.ROWS_PER_PAGE)),h=isNaN(u)?0:u,p=L(()=>i.every(Boolean),[i]),v=L(()=>ys(t,[l]).map(w=>{var T;const S=((T=w.values[0])==null?void 0:T[l])||"",N=ri(S),k=w.values.sort((x,M)=>{const E=En(x._time),I=En(M._time);return E>I?1:E<I?-1:0});return{keys:w.keys,keysString:w.keys.join(""),values:k,pairs:N,total:k.length}}).sort((w,S)=>S.values.length-w.values.length),[t,l]),b=qu(v,o,h),f=X(()=>{c(new Array(v.length).fill(!p))},[p,v.length]),g=X(w=>S=>{c(N=>{const k=[...N];return k[w]=S,k})},[]),_=w=>{w?a.set(ke.ROWS_PER_PAGE,String(w)):a.delete(ke.ROWS_PER_PAGE),r(a)},y=w=>{s(w),window.scrollTo({top:0})};return A(()=>{c(new Array(v.length).fill(!0))},[v]),A(()=>{s(1)},[h]),e(U,{children:[e("div",{className:"vm-group-logs",children:[b.map((w,S)=>e("div",{className:"vm-group-logs-section",children:e(Kn,{defaultExpanded:i[S],onChange:g(S),title:e(Uu,{group:w,index:S}),children:e("div",{className:"vm-group-logs-section-rows",children:w.values.map((N,k)=>e(Iu,{log:N,displayFields:d},`${S}_${k}_${N._time}`))})})},w.keysString)),e(ni,{currentPage:o,totalItems:t.length,itemsPerPage:h||1/0,onPageChange:y})]}),n.current&&Hn.createPortal(e("div",{className:"vm-group-logs-header",children:[e("div",{className:"vm-explore-logs-body-header__log-info",children:["Total groups: ",e("b",{children:v.length})]}),e(li,{allowUnlimited:!0,limit:h,onChange:_}),e(Y,{title:p?"Collapse All":"Expand All",children:e(P,{variant:"text",startIcon:p?e(tr,{}):e(er,{}),onClick:f,ariaLabel:p?"Collapse All":"Expand All"})}),e(Vu,{logs:t})]}),n.current)]})},ju=Hn.memo(Eu),Qu=Hn.memo(Bu),Yu=Hn.memo(na),Gu=[{label:"Group",value:"group",icon:e(Xo,{})},{label:"Table",value:"table",icon:e(ln,{})},{label:"JSON",value:"json",icon:e(Lt,{})}],Wu=({data:t,isLoading:n})=>{const{isMobile:a}=W(),{setSearchParamsFromKeys:r}=ft(),o=Q(null),[s,i]=Ae("group","view"),[c,l]=C([]),[m,d]=Ae(1e3,"rows_per_page"),{value:u,toggle:h}=se(!1),p=L(()=>{if(!(t!=null&&t.length)||s!=="table")return[];const f=new Set;for(const g of t)for(const _ in g)f.add(_);return Array.from(f)},[t,s]),v=f=>{i(f),r({view:f})},b=f=>{d(f),r({rows_per_page:f})};return e("div",{className:D({"vm-explore-logs-body":!0,"vm-block":!0,"vm-block_mobile":a}),children:[n&&e(Xn,{}),e("div",{className:D({"vm-explore-logs-body-header":!0,"vm-section-header":!0,"vm-explore-logs-body-header_mobile":a}),children:[e("div",{className:"vm-section-header__tabs",children:[e(Yt,{activeItem:String(s),items:Gu,onChange:v}),e("div",{className:"vm-explore-logs-body-header__log-info",children:["Total logs returned: ",e("b",{children:t.length})]})]}),s==="table"&&e("div",{className:"vm-explore-logs-body-header__settings",children:[e(li,{limit:m,onChange:b}),e(Fr,{columns:p,selectedColumns:c,onChangeColumns:l,tableCompact:u,toggleTableCompact:h})]}),s==="group"&&e("div",{className:"vm-explore-logs-body-header__settings",ref:o})]}),e("div",{className:D({"vm-explore-logs-body__table":!0,"vm-explore-logs-body__table_mobile":a}),children:[!t.length&&e("div",{className:"vm-explore-logs-body__empty",children:"No logs found"}),!!t.length&&e(U,{children:[s==="table"&&e(ju,{logs:t,displayColumns:c,tableCompact:u,columns:p,rowsPerPage:Number(m)}),s==="group"&&e(Qu,{logs:t,settingsRef:o}),s==="json"&&e(Yu,{data:t})]})]})]})},Ku=t=>`${t}/select/logsql/query`,Ju=t=>`${t}/select/logsql/hits`,Zu=(t,n,a)=>{const[r]=ae(),[o,s]=C([]),[i,c]=C({}),[l,m]=C(),d=Q(new AbortController),u=L(()=>Ku(t),[t]),h=L(()=>({AccountID:r.get("accountID")||"0",ProjectID:r.get("projectID")||"0"}),[r]),p=(b,f,g,_)=>({signal:_,method:"POST",headers:{...h,Accept:"application/stream+json"},body:new URLSearchParams({query:b.trim(),limit:`${g}`,start:B(f.start*1e3).tz().toISOString(),end:B(f.end*1e3).tz().toISOString()})}),v=X(async b=>{d.current.abort(),d.current=new AbortController;const{signal:f}=d.current,g=Date.now();c(_=>({..._,[g]:!0})),m(void 0);try{const _=p(n,b,a,f),y=await fetch(u,_),w=await y.text();if(!y.ok||!y.body)return m(w),s([]),!1;const S=w.split(`
`,a).map(Xu).filter(N=>N);return s(S),!0}catch(_){return _ instanceof Error&&_.name!=="AbortError"&&(m(String(_)),console.error(_),s([])),!1}finally{c(_=>{const{[g]:y,...w}=_;return w})}},[u,n,a,h]);return A(()=>()=>{d.current.abort()},[]),{logs:o,isLoading:Object.values(i).some(b=>b),error:l,fetchLogs:v,abortController:d.current}},Xu=t=>{try{return t&&JSON.parse(t)}catch(n){return console.error(`Failed to parse "${t}" to JSON
`,n),null}};var kt=(t=>(t.Filter="Filter",t.Pipe="Pipe",t.Operator="Operator",t))(kt||{}),me=(t=>(t.FilterName="FilterName",t.FilterUnknown="FilterUnknown",t.FilterValue="FilterValue",t.PipeName="Pipes",t.PipeValue="PipeValue",t.Unknown="Unknown",t))(me||{});const eh="https://docs.victoriametrics.com/victorialogs/logsql",th="vm-link vm-link_colored",nh=t=>{const n=`$1 target="_blank" class="${th}" $2`,a=`$1 $2${eh}#`;return t.replace(/(<a) (href=")#/gm,a).replace(/(<a) (href="[^"]+")/gm,n)},ci=[{value:"copy",description:'<a href="#copy-pipe"><code>copy</code></a> copies <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log fields</a>.'},{value:"delete",description:'<a href="#delete-pipe"><code>delete</code></a> deletes <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log fields</a>.'},{value:"drop_empty_fields",description:'<a href="#drop_empty_fields-pipe"><code>drop_empty_fields</code></a> drops <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log fields</a> with empty values.'},{value:"extract",description:'<a href="#extract-pipe"><code>extract</code></a> extracts the specified text into the given log fields.'},{value:"extract_regexp",description:'<a href="#extract_regexp-pipe"><code>extract_regexp</code></a> extracts the specified text into the given log fields via <a href="https://github.com/google/re2/wiki/Syntax" rel="external" target="_blank">RE2 regular expressions</a>.'},{value:"field_names",description:'<a href="#field_names-pipe"><code>field_names</code></a> returns all the names of <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log fields</a>.'},{value:"field_values",description:'<a href="#field_values-pipe"><code>field_values</code></a> returns all the values for the given <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log field</a>.'},{value:"fields",description:'<a href="#fields-pipe"><code>fields</code></a> selects the given set of <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log fields</a>.'},{value:"filter",description:'<a href="#filter-pipe"><code>filter</code></a> applies additional <a href="#filters">filters</a> to results.'},{value:"format",description:'<a href="#format-pipe"><code>format</code></a> formats output field from input <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log fields</a>.'},{value:"limit",description:'<a href="#limit-pipe"><code>limit</code></a> limits the number selected logs.'},{value:"math",description:'<a href="#math-pipe"><code>math</code></a> performs mathematical calculations over <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log fields</a>.'},{value:"offset",description:'<a href="#offset-pipe"><code>offset</code></a> skips the given number of selected logs.'},{value:"pack_json",description:'<a href="#pack_json-pipe"><code>pack_json</code></a> packs <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log fields</a> into JSON object.'},{value:"pack_logfmt",description:'<a href="#pack_logfmt-pipe"><code>pack_logfmt</code></a> packs <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log fields</a> into <a href="https://brandur.org/logfmt" rel="external" target="_blank">logfmt</a> message.'},{value:"rename",description:'<a href="#rename-pipe"><code>rename</code></a> renames <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log fields</a>.'},{value:"replace",description:'<a href="#replace-pipe"><code>replace</code></a> replaces substrings in the specified <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log fields</a>.'},{value:"replace_regexp",description:'<a href="#replace_regexp-pipe"><code>replace_regexp</code></a> updates <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log fields</a> with regular expressions.'},{value:"sort",description:'<a href="#sort-pipe"><code>sort</code></a> sorts logs by the given <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">fields</a>.'},{value:"stats",description:'<a href="#stats-pipe"><code>stats</code></a> calculates various stats over the selected logs.'},{value:"stream_context",description:`<a href="#stream_context-pipe"><code>stream_context</code></a> allows selecting surrounding logs in front and after the matching logs
per each <a href="/victorialogs/keyconcepts/#stream-fields">log stream</a>.`},{value:"top",description:'<a href="#top-pipe"><code>top</code></a> returns top <code>N</code> field sets with the maximum number of matching logs.'},{value:"uniq",description:'<a href="#uniq-pipe"><code>uniq</code></a> returns unique log entries.'},{value:"unpack_json",description:'<a href="#unpack_json-pipe"><code>unpack_json</code></a> unpacks JSON messages from <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log fields</a>.'},{value:"unpack_logfmt",description:'<a href="#unpack_logfmt-pipe"><code>unpack_logfmt</code></a> unpacks <a href="https://brandur.org/logfmt" rel="external" target="_blank">logfmt</a> messages from <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log fields</a>.'},{value:"unpack_syslog",description:'<a href="#unpack_syslog-pipe"><code>unpack_syslog</code></a> unpacks <a href="https://en.wikipedia.org/wiki/Syslog" rel="external" target="_blank">syslog</a> messages from <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log fields</a>.'},{value:"unroll",description:'<a href="#unroll-pipe"><code>unroll</code></a> unrolls JSON arrays from <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log fields</a>.'}].map(t=>({...t,type:me.PipeName,icon:e(Yn,{}),description:nh(t.description)})),ah=["AND","OR","NOT"],rh=ci.map(t=>t.value),oh=t=>{var p,v;const n=t,a=[];let r="",o=!1;const s=["'",'"',"`"];let i=!1,c="";const l=["(","[","{"],m=[")","]","}"],d=[...l,...m];let u=0,h=0;for(let b=0;b<n.length;b++){const f=n[b];if(s.includes(f)){const g=i&&f===c;i=!g,c=g?"":f}if(!i&&d.includes(f)){const g=l.includes(f)?1:-1;u+=g}if(!i&&!u&&f==="|"){o=!0;const g=((p=r.match(/^ */))==null?void 0:p[0].length)||0,_=((v=r.match(/ *$/))==null?void 0:v[0].length)||0;ya(r,!0,[h+g,b-_-1],a),r="",h=b+1;continue}if(!o&&!i&&!u&&f===" "){const g=n.slice(b).replace(/^\s*/,""),_=n.slice(0,b).replace(/\s*$/,"");if(!g.startsWith(":")&&!_.endsWith(":")){ya(r,!1,[h,b-1],a),r="",h=b+1;continue}}r+=f}return ya(r,o,[h,n.length],a),a},ya=(t,n,a,r)=>{const o=t.trim();if(!o)return;const s=ah.includes(o.toUpperCase());r.push({id:r.length,value:o,position:a,type:n?kt.Pipe:s?kt.Operator:kt.Filter})},sh=(t,n)=>{const a=t.value.substring(0,n),r=t.value.substring(n),o={valueBeforeCursor:a,valueAfterCursor:r,valueContext:t.value,contextType:me.Unknown};if(t.type===kt.Filter)if(!a.includes(":")&&!r.includes(":"))o.contextType=me.FilterUnknown;else if(a.includes(":")){const[i,c]=a.split(":");o.contextType=me.FilterValue,o.filterName=i,o.valueContext=c}else o.contextType=me.FilterName;else if(t.type===kt.Pipe){const s=rh.some(i=>t.value.startsWith(i));o.contextType=s?me.PipeValue:me.PipeName}return o.valueContext=o.valueContext.replace(/^["']|["']$/g,""),o},ih={[me.FilterName]:e(Dn,{}),[me.FilterUnknown]:e(Dn,{}),[me.FilterValue]:e(In,{}),[me.PipeName]:e(Yn,{}),[me.PipeValue]:e(Xa,{}),[me.Unknown]:e(In,{})},lh=t=>{const[n]=ae(),{serverUrl:a}=re(),{period:{start:r,end:o}}=he(),{autocompleteCache:s}=cr(),i=is(),[c,l]=C(!1),[m,d]=C([]),[u,h]=C([]),p=Q(new AbortController),v=X(g=>{const _=B(r*1e3).startOf("day").valueOf()/1e3,y=B(o*1e3).endOf("day").valueOf()/1e3;return new URLSearchParams({...g||{},limit:`${St.queryLimit}`,start:`${_}`,end:`${y}`})},[r,o]),b=(g,_)=>g.map(y=>({value:y.value,type:`${_}`,icon:ih[_]})),f=async({urlSuffix:g,setter:_,type:y,params:w})=>{p.current.abort(),p.current=new AbortController;const{signal:S}=p.current,N={AccountID:n.get("accountID")||"0",ProjectID:n.get("projectID")||"0"},k=new URLSearchParams(N).toString(),T=`${g}?${w==null?void 0:w.toString()}&${k}`;l(!0);try{const x=s.get(T);if(x){_(b(x,y)),l(!1);return}const M=await fetch(`${a}/select/logsql/${g}?${w}`,{signal:S,headers:{...N}});if(M.ok){const E=await M.json(),I=(E==null?void 0:E.values)||[];_(I?b(I,y):[]),i({type:"SET_AUTOCOMPLETE_CACHE",payload:{key:T,value:I}})}l(!1)}catch(x){x instanceof Error&&x.name!=="AbortError"&&(i({type:"SET_AUTOCOMPLETE_CACHE",payload:{key:T,value:[]}}),l(!1),console.error(x))}};return A(()=>{const _=![me.FilterName,me.FilterUnknown].includes((t==null?void 0:t.contextType)||me.Unknown);if(!(!a||_))return d([]),f({urlSuffix:"field_names",setter:d,type:me.FilterName,params:v({query:"*"})}),()=>{var y;return(y=p.current)==null?void 0:y.abort()}},[a,t]),A(()=>{const g=(t==null?void 0:t.contextType)!==me.FilterValue;if(!(!a||g||!(t!=null&&t.filterName)))return h([]),f({urlSuffix:"field_values",setter:h,type:me.FilterValue,params:v({query:"*",field:t.filterName})}),()=>{var _;return(_=p.current)==null?void 0:_.abort()}},[a,t]),{fieldNames:m,fieldValues:u,loading:c}},ch=({value:t,anchorEl:n,caretPosition:a,hasHelperText:r,onSelect:o,onFoundOptions:s})=>{const[i,c]=C({top:0,left:0}),l=L(()=>{if(a[0]!==a[1])return{valueBeforeCursor:t,valueAfterCursor:""};const _=t.substring(0,a[0]),y=t.substring(a[1]);return{valueBeforeCursor:_,valueAfterCursor:y}},[t,a]),m=L(()=>oh(t),[t]),d=L(()=>{if(a[0]!==a[1])return;const _=m.find(w=>a[0]>=w.position[0]&&a[0]<=w.position[1]);if(!_)return;const y=a[0]-_.position[0];return{..._,...sh(_,y)}},[m,a]),{fieldNames:u,fieldValues:h,loading:p}=lh(d),v=L(()=>{switch(d==null?void 0:d.contextType){case me.FilterName:case me.FilterUnknown:return u;case me.FilterValue:return h;case me.PipeName:return ci;default:return[]}},[d,u,h]),b=(_,y,w)=>y.reduce((S,N)=>{const k=N.id===w?_:N.value,T=N.type===kt.Pipe?" | ":" ";return`${S}${T}${k}`},"").trim(),f=(_,y,w="",S)=>{let N=_;if(S===me.FilterName)N+=":";else if(y===me.FilterValue){const k=w.startsWith("_stream:")?N:`"${N}"`;N=`${(d==null?void 0:d.filterName)||""}:${k}`}return N},g=X((_,y)=>{const{id:w,contextType:S=me.FilterUnknown,value:N="",position:k=[0,0]}=d||{},T=f(_,S,N,y.type),x=b(T,m,w),M=(k[0]||1)+T.length+(y.type===me.PipeName?1:0);o(x,M)},[d,m]);return A(()=>{if(!n.current){c({top:0,left:0});return}const _=n.current.querySelector("textarea")||n.current,y=window.getComputedStyle(_),w=`${y.getPropertyValue("font-size")}`,S=`${y.getPropertyValue("font-family")}`,N=parseInt(`${y.getPropertyValue("line-height")}`),k=document.createElement("div");k.style.font=`${w} ${S}`,k.style.padding=y.getPropertyValue("padding"),k.style.lineHeight=`${N}px`,k.style.width=`${_.offsetWidth}px`,k.style.maxWidth=`${_.offsetWidth}px`,k.style.whiteSpace=y.getPropertyValue("white-space"),k.style.overflowWrap=y.getPropertyValue("overflow-wrap");const T=document.createElement("span");k.appendChild(document.createTextNode(l.valueBeforeCursor||"")),k.appendChild(T),k.appendChild(document.createTextNode(l.valueAfterCursor||"")),document.body.appendChild(k);const x=k.getBoundingClientRect(),M=T.getBoundingClientRect(),E=M.left-x.left,I=M.bottom-x.bottom-(r?N:0);c({top:I,left:E}),k.remove(),T.remove()},[n,a,r,l]),e(U,{children:e(_r,{loading:p,disabledFullScreen:!0,value:(d==null?void 0:d.valueContext)||"",options:v,anchor:n,minLength:0,offset:i,onSelect:g,onFoundOptions:s,maxDisplayResults:{limit:St.displayResults,message:"Please, specify the query more precisely."}})})},dh=({query:t,limit:n,error:a,isLoading:r,onChange:o,onChangeLimit:s,onRun:i})=>{const{isMobile:c}=W(),{autocomplete:l}=Ee(),m=Qt(),[d,u]=C(""),[h,p]=C(n),v=f=>{const g=+f;p(g),isNaN(g)||g<0?u("Number must be bigger than zero"):(u(""),s(g))},b=()=>{m({type:"TOGGLE_AUTOCOMPLETE"})};return A(()=>{p(n)},[n]),e("div",{className:D({"vm-explore-logs-header":!0,"vm-block":!0,"vm-block_mobile":c}),children:[e("div",{className:"vm-explore-logs-header-top",children:[e(bs,{value:t,autocomplete:l,autocompleteEl:ch,onArrowUp:()=>null,onArrowDown:()=>null,onEnter:i,onChange:o,label:"Log query",error:a}),e(le,{label:"Limit entries",type:"number",value:h,error:d,onChange:v,onEnter:i})]}),e("div",{className:"vm-explore-logs-header-bottom",children:[e("div",{className:"vm-explore-logs-header-bottom-contols",children:e(ye,{label:"Autocomplete",value:l,onChange:b,fullWidth:c})}),e("div",{className:"vm-explore-logs-header-bottom-helpful",children:[e("a",{className:"vm-link vm-link_with-icon",target:"_blank",href:"https://docs.victoriametrics.com/victorialogs/logsql/",rel:"help noreferrer",children:[e(st,{}),"Query language docs"]}),e("a",{className:"vm-link vm-link_with-icon",target:"_blank",href:"https://docs.victoriametrics.com/victorialogs/",rel:"help noreferrer",children:[e(it,{}),"Documentation"]})]}),e("div",{className:"vm-explore-logs-header-bottom-execute",children:e(P,{startIcon:r?e(nr,{}):e(dt,{}),onClick:i,fullWidth:!0,children:[e("span",{className:"vm-explore-logs-header-bottom-execute__text",children:r?"Cancel Query":"Execute Query"}),e("span",{className:"vm-explore-logs-header-bottom-execute__text_hidden",children:"Execute Query"})]})})]})]})},No=t=>B(t*1e3).tz().format(Ge),mh=({data:t,focusDataIdx:n,uPlotInst:a})=>{const r=Q(null),o=L(()=>{var p,v;const i=(a==null?void 0:a.series)||[],[c,...l]=t.map(b=>b[n]||0),m=t[0][1]-t[0][0],d=c+m,u=l.map((b,f)=>{var S;const g=i[f+1],_=(S=g==null?void 0:g.stroke)==null?void 0:S.call(g),y=g==null?void 0:g.label,w=g==null?void 0:g.show;return{label:y,stroke:_,value:b,show:w}}).filter(b=>b.value>0&&b.show).sort(ii("value"));return{point:{top:u[0]&&((p=a==null?void 0:a.valToPos)==null?void 0:p.call(a,u[0].value,"y"))||0,left:((v=a==null?void 0:a.valToPos)==null?void 0:v.call(a,c,"x"))||0},values:u,total:u.reduce((b,f)=>b+f.value,0),timestamp:`${No(c)} - ${No(d)}`}},[n,a,t]),s=L(()=>{if(!a||!o.total||!r.current)return;const{top:i,left:c}=o.point,l={left:parseFloat(a.over.style.left),top:parseFloat(a.over.style.top)},{width:m,height:d}=a.over.getBoundingClientRect(),{width:u,height:h}=r.current.getBoundingClientRect(),p=50,v=c+u>=m?u+2*p:0,b=i+h>=d?h+2*p:0,f={top:i+l.top+p-b,left:c+l.left+p-v};return f.left<0&&(f.left=20),f.top<0&&(f.top=20),f},[o,a,r.current]);return e("div",{className:D({"vm-chart-tooltip":!0,"vm-chart-tooltip_hits":!0,"vm-bar-hits-tooltip":!0,"vm-bar-hits-tooltip_visible":n!==-1&&o.values.length}),ref:r,style:s,children:[e("div",{children:o.values.map((i,c)=>e("div",{className:"vm-chart-tooltip-data",children:[e("span",{className:"vm-chart-tooltip-data__marker",style:{background:i.stroke}}),e("p",{className:"vm-bar-hits-tooltip-item",children:[e("span",{className:"vm-bar-hits-tooltip-item__label",children:i.label}),e("span",{children:i.value.toLocaleString("en-US")})]})]},c))}),o.values.length>1&&e("div",{className:"vm-chart-tooltip-data",children:[e("span",{}),e("p",{className:"vm-bar-hits-tooltip-item",children:[e("span",{className:"vm-bar-hits-tooltip-item__label",children:"Total"}),e("span",{children:o.total.toLocaleString("en-US")})]})]}),e("div",{className:"vm-chart-tooltip-header",children:e("div",{className:"vm-chart-tooltip-header__title vm-bar-hits-tooltip__date",children:o.timestamp})})]})},uh=({onChange:t})=>{const[n,a]=ae(),r=Q(null),{value:o,toggle:s,setFalse:i}=se(!1),[c,l]=Ae(!1,"stacked"),[m,d]=Ae("true","fill"),[u,h]=Ae(!1,"hide_chart"),p=L(()=>({graphStyle:nt.BAR,stacked:c,fill:m==="true",hideChart:u}),[c,m,u]),v=g=>{d(`${g}`),n.set("fill",`${g}`),a(n)},b=g=>{l(g),g?n.set("stacked","true"):n.delete("stacked"),a(n)},f=()=>{h(g=>{const _=!g;return _?n.set("hide_chart","true"):n.delete("hide_chart"),a(n),_})};return A(()=>{t(p)},[p]),e("div",{className:"vm-bar-hits-options",children:[e(Y,{title:u?"Show chart and resume hits updates":"Hide chart and pause hits updates",children:e(P,{variant:"text",color:"primary",startIcon:u?e(Wa,{}):e(Ht,{}),onClick:f,ariaLabel:"settings"})}),e("div",{ref:r,children:e(Y,{title:"Graph settings",children:e(P,{variant:"text",color:"primary",startIcon:e(ot,{}),onClick:s,ariaLabel:"settings"})})}),e(Ie,{open:o,placement:"bottom-right",onClose:i,buttonRef:r,title:"Graph settings",children:e("div",{className:"vm-bar-hits-options-settings",children:[e("div",{className:"vm-bar-hits-options-settings-item",children:e(ye,{label:"Stacked",value:c,onChange:b})}),e("div",{className:"vm-bar-hits-options-settings-item",children:e(ye,{label:"Fill",value:m==="true",onChange:v})})]})})]})};function hh(t,n){const a=[];let r=[];const o=t[0].length,s=Array(o);for(let i=0;i<o;i++)s[i]=0;for(let i=1;i<t.length;i++)a.push(n(i)?t[i]:t[i].map((c,l)=>s[l]+=+(c??0)));for(let i=1;i<t.length;i++)!n(i)&&r.push({series:[t.findIndex((c,l)=>l>i&&!n(l)),i]});return r=r.filter(i=>i.series[1]>-1),{data:[t[0]].concat(a),bands:r}}const ph=({legend:t})=>{const n=t.total.toLocaleString("en-US"),a=Math.round(t.total/t.totalHits*100);return e("div",{className:"vm-legend-hits-menu-section",children:e("div",{className:"vm-legend-hits-menu-row",children:e("div",{className:"vm-legend-hits-menu-row__title",children:["Total: ",n," (",a,"%)"]})})})},ra=({title:t,handler:n,iconStart:a,iconEnd:r,className:o,submenu:s})=>{const i=Q(null),c=Q(null),l=Q(null),[m,d]=C(!1),[u,h]=C(!1),[p,v]=C(!1),b=!!(s!=null&&s.length),f=()=>{h(w=>!w)},g=()=>{h(!1)},_=()=>{n&&n(),b&&f()};A(()=>{c.current&&d(c.current.scrollWidth>c.current.clientWidth)},[t,c]),A(()=>{requestAnimationFrame(()=>{if(!u||!l.current){v(!1);return}const{left:w,width:S}=l.current.getBoundingClientRect();v(w+S>window.innerWidth)})},[l,u]),dn(i,g);const y=e("div",{ref:c,className:"vm-legend-hits-menu-row__title",children:t});return e("div",{ref:i,className:D({"vm-legend-hits-menu-row":!0,"vm-legend-hits-menu-row_interactive":!!n||b,[`${o}`]:o}),onClick:_,children:[a&&e("div",{className:"vm-legend-hits-menu-row__icon",children:a}),m?e(Y,{title:t,children:y}):y,r&&!b&&e("div",{className:"vm-legend-hits-menu-row__icon",children:r}),b&&e("div",{className:"vm-legend-hits-menu-row__icon vm-legend-hits-menu-row__icon_drop",children:e(Qe,{})}),u&&s&&e("div",{ref:l,className:D({"vm-legend-hits-menu":!0,"vm-legend-hits-menu_submenu":!0,"vm-legend-hits-menu_submenu_left":p}),children:e("div",{className:"vm-legend-hits-menu-section",children:s.map(({icon:w,title:S,handler:N})=>e(ra,{iconStart:w,title:S,handler:N},S))})})]})},gh=({legend:t,onApplyFilter:n,onClose:a})=>{const r=Fe(),o=()=>{n(`${Me}: ${t.label}`),a()},s=()=>{n(`(NOT ${Me}: ${t.label})`),a()},i=async()=>{await r(t.label,`${t.label} has been copied`),a()},c=[{title:`Copy ${Me} name`,icon:e(Xe,{}),handler:i},{title:`Add ${Me} to filter`,icon:e(ar,{}),handler:o},{title:`Exclude ${Me} to filter`,icon:e(rr,{}),handler:s}];return e("div",{className:"vm-legend-hits-menu-section",children:c.map(({icon:l,title:m,handler:d})=>e(ra,{iconStart:l,title:m,handler:d},m))})},vh=({fields:t,onApplyFilter:n,onClose:a})=>{const r=Fe(),o=m=>async()=>{await r(m,`${m} has been copied`),a()},s=m=>()=>{n(m),a()},i=m=>()=>{n(`-${m}`),a()},c=m=>[{title:"Copy",icon:e(Xe,{}),handler:o(m)},{title:"Add to filter",icon:e(ar,{}),handler:s(m)},{title:"Exclude to filter",icon:e(rr,{}),handler:i(m)}],l=L(()=>t.map(m=>{const d=si(m);return{title:d,submenu:c(d)}}),[t]);return e("div",{className:"vm-legend-hits-menu-section",children:l==null?void 0:l.map(m=>e(ra,{...m},m.title))})},fh=`aggregated results for fields not in the top ${Vs}`,_h=({legend:t,fields:n,onApplyFilter:a,onClose:r})=>e("div",{className:"vm-legend-hits-menu",children:[e("div",{className:"vm-legend-hits-menu-section",children:e(ra,{className:"vm-legend-hits-menu-row_info",title:t.isOther?fh:t.label})}),!t.isOther&&e(gh,{legend:t,onApplyFilter:a,onClose:r}),!t.isOther&&e(vh,{fields:n,onApplyFilter:a,onClose:r}),e(ph,{legend:t})]}),bh=({legend:t,series:n,onRedrawGraph:a,onApplyFilter:r})=>{const{value:o,setTrue:s,setFalse:i}=se(!1),c=Q(null),[l,m]=C(null),d=L(()=>n.find(f=>f.label===t.label),[n]),u=L(()=>ri(t.label),[t.label]),h=u.join(", "),p=Qc(t.total),v=f=>{if(d){if(f.metaKey||f.ctrlKey)d.show=!d.show;else{const g=n.every(_=>_===d||!_.show);n.forEach(_=>{_.show=g||_===d})}a()}},b=f=>{f.preventDefault(),m({top:f.clientY,left:f.clientX}),s()};return e("div",{ref:c,className:D({"vm-bar-hits-legend-item":!0,"vm-bar-hits-legend-item_other":t.isOther,"vm-bar-hits-legend-item_hide":!(d!=null&&d.show)}),onClick:v,onContextMenu:b,children:[e("div",{className:"vm-bar-hits-legend-item__marker",style:{backgroundColor:`${t.stroke}`}}),e("div",{className:"vm-bar-hits-legend-item__label",children:h}),e("span",{className:"vm-bar-hits-legend-item__total",children:["(",p,")"]}),e(Ie,{placement:"fixed",open:o,buttonRef:c,placementPosition:l,onClose:i,children:e(_h,{legend:t,fields:u,onApplyFilter:r,onClose:i})})]})},yh=({uPlotInst:t,legendDetails:n,onApplyFilter:a})=>{var l;const[r,o]=C([]),s=((l=n[0])==null?void 0:l.totalHits)||0,i=()=>t.series.filter(m=>m.scale!=="x"),c=()=>{t.redraw(),o(i())};return A(()=>{o(i())},[t]),e("div",{className:"vm-bar-hits-legend",children:[n.map(m=>e(bh,{legend:m,series:r,onRedrawGraph:c,onApplyFilter:a},m.label)),e("div",{className:"vm-bar-hits-legend-info",children:[e("div",{children:["Total hits: ",e("b",{children:s.toLocaleString("en-US")})]}),e("div",{children:[e("code",{children:"L-Click"})," toggles visibility. ",e("code",{children:"R-Click"})," opens menu."]})]})]})},wh=({logHits:t,data:n,period:a,setPeriod:r,onApplyFilter:o})=>{const[s,i]=qs(),c=Q(null),[l,m]=C(),[d,u]=C({graphStyle:nt.LINE_STEPPED,stacked:!1,fill:!1,hideChart:!1}),{xRange:h,setPlotScale:p}=Ir({period:a,setPeriod:r}),{onReadyChart:v,isPanning:b}=Mr(p);Dr({uPlotInst:l,xRange:h,setPlotScale:p});const f=L(()=>n.every(T=>T.length===0),[n]),{data:g,bands:_}=L(()=>d.stacked?hh(n,()=>!1):{data:n,bands:[]},[d,n]),{options:y,series:w,focusDataIdx:S}=zu({data:g,logHits:t,bands:_,xRange:h,containerSize:i,onReadyChart:v,setPlotScale:p,graphOptions:d}),N=X((T,x)=>T.map(M=>{var $;const E=ai(M);return{label:E,isOther:M._isOther,fields:M.fields,total:M.total||0,totalHits:x,stroke:($=w.find(O=>O.label===E))==null?void 0:$.stroke}}).sort(ii("total")),[w]),k=L(()=>{const T=Hu(t);return N(t,T)},[t,N]);return A(()=>{l&&(xr(l),Ms(l,w,!0),$s(l,w),l.redraw())},[w]),A(()=>{if(!c.current)return;const T=new Bt(y,g,c.current);return m(T),()=>T.destroy()},[c.current,y]),A(()=>{l&&(l.scales.x.range=()=>[h.min,h.max],l.redraw())},[h]),A(()=>{l&&(l.setSize(i),l.redraw())},[i]),A(()=>{l&&(l.setData(g),l.redraw())},[g]),e("div",{className:D({"vm-bar-hits-chart__wrapper":!0,"vm-bar-hits-chart__wrapper_hidden":d.hideChart}),children:[!d.hideChart&&e("div",{className:D({"vm-bar-hits-chart":!0,"vm-bar-hits-chart_panning":b}),ref:s,children:[e("div",{className:"vm-line-chart__u-plot",ref:c}),e(mh,{uPlotInst:l,data:n,focusDataIdx:S})]}),e(uh,{onChange:u}),l&&!f&&!d.hideChart&&e(yh,{uPlotInst:l,onApplyFilter:o,legendDetails:k})]})},Ch=({logHits:t,period:n,error:a,isLoading:r,onApplyFilter:o})=>{const{isMobile:s}=W(),i=Ve(),[c]=ae(),l=L(()=>c.get("hide_chart"),[c]),m=(v,b)=>v.map(f=>{const g=new Map;return f.timestamps.forEach((_,y)=>{const w=B(_).unix();g.set(w,f.values[y]||null)}),b.map(_=>g.get(_)||null)}),d=X(v=>{const b=[],{start:f,end:g,step:_}=oi(n),y=Math.ceil(f.diff(v,"milliseconds")/_);let w=v.add(y*_,"milliseconds");w.isBefore(f)&&(w=f.clone());const S=Math.floor(g.diff(w,"milliseconds")/_);for(let N=0;N<=S;N++)b.push(w.add(N*_,"milliseconds").unix());return b},[n]),u=L(()=>{if(!t.length)return[[],[]];const v=d(B(t[0].timestamps[0])),b=m(t,v);return[v,...b]},[t]),h=L(()=>{const v=u.every(g=>g.length===0),b=u[0].length===0,f=u[1].length===0;return l?"Chart hidden. Hits updates paused.":v?`No logs volume available
No volume information available for the current queries and time range.`:b?"No timestamp information available for the current queries and time range.":f?"No value information available for the current queries and time range.":""},[u,l]),p=({from:v,to:b})=>{i({type:"SET_PERIOD",payload:{from:v,to:b}})};return e("section",{className:D({"vm-explore-logs-chart":!0,"vm-block":!0,"vm-block_mobile":s}),children:[r&&e(Xn,{}),!a&&h&&e("div",{className:"vm-explore-logs-chart__empty",children:e(ie,{variant:"info",children:h})}),a&&h&&e("div",{className:"vm-explore-logs-chart__empty",children:e(ie,{variant:"error",children:a})}),u&&e(wh,{logHits:t,data:u,period:n,setPeriod:p,onApplyFilter:o})]})},Nh=(t,n)=>{const[a]=ae(),[r,o]=C([]),[s,i]=C([]),[c,l]=C(),m=Q(new AbortController),d=L(()=>Ju(t),[t]),u=L(()=>({AccountID:a.get("accountID")||"0",ProjectID:a.get("projectID")||"0"}),[a]),h=(v,b,f)=>{const{start:g,end:_,step:y}=oi(b);return{signal:f,method:"POST",headers:{...u},body:new URLSearchParams({query:v.trim(),step:`${y}ms`,start:g.toISOString(),end:_.toISOString(),fields_limit:`${Vs}`,field:Me})}},p=X(async v=>{m.current.abort(),m.current=new AbortController;const{signal:b}=m.current,f=Date.now();i(g=>({...g,[f]:!0})),l(void 0);try{const g=h(n,v,b),_=await fetch(d,g);if(!_.ok||!_.body){const S=await _.text();l(S),o([]),i(N=>({...N,[f]:!1}));return}const y=await _.json(),w=y==null?void 0:y.hits;w||l("Error: No 'hits' field in response"),o(w.map(kh).sort(Sh))}catch(g){g instanceof Error&&g.name!=="AbortError"&&(l(String(g)),console.error(g),o([]))}i(g=>({...g,[f]:!1}))},[d,n,a]);return A(()=>()=>{m.current.abort()},[]),{logHits:r,isLoading:Object.values(s).some(v=>v),error:c,fetchLogHits:p,abortController:m.current}},kh=t=>({...t,_isOther:tm(t.fields)}),Sh=(t,n)=>t._isOther!==n._isOther?t._isOther?-1:1:n.total-t.total,ko=Number(xe("LOGS_LIMIT")),Th=isNaN(ko)?Ad:ko,Ah=()=>{const{serverUrl:t}=re(),{duration:n,relativeTime:a,period:r}=he(),{setSearchParamsFromKeys:o}=ft(),[s]=ae(),i=L(()=>s.get("hide_chart"),[s]),[c,l]=Ae(Th,"limit"),[m,d]=Ae("*","query"),[u,h]=C(!1),[p,v]=C(r),[b,f]=C(""),{logs:g,isLoading:_,error:y,fetchLogs:w,abortController:S}=Zu(t,m,c),{fetchLogHits:N,...k}=Nh(t,m),T=X(()=>{const $=Xt.find(z=>z.id===a);if(!$)return r;const{duration:O,until:V}=$;return yt(O,V())},[r,a]),x=()=>{if(!m){f(be.validQuery);return}f("");const $=T();v($),w($).then(O=>{O&&!i&&N($)}).catch(O=>O),o({query:m,"g0.range_input":n,"g0.end_input":$.date,"g0.relative_time":a||"none"})},M=$=>{l($),o({limit:$}),Te("LOGS_LIMIT",`${$}`)},E=$=>{d(O=>`${$} AND (${O})`),h(!0)},I=()=>{_||k.isLoading?(S.abort&&S.abort(),k.abortController.abort&&k.abortController.abort()):x()};return A(()=>{m&&x()},[r]),A(()=>{u&&(x(),h(!1))},[m,u]),A(()=>{!i&&N(p)},[i]),e("div",{className:"vm-explore-logs",children:[e(dh,{query:m,error:b,limit:c,onChange:d,onChangeLimit:M,onRun:I,isLoading:_||k.isLoading}),y&&e(ie,{variant:"error",children:y}),!y&&e(Ch,{...k,query:m,period:p,onApplyFilter:E}),e(Wu,{data:g,isLoading:_})]})},xh=()=>{const t=Ce(),{isMobile:n}=W(),a=Ve(),[r,o]=ae(),[s,i]=Ae("0","accountID"),[c,l]=Ae("0","projectID"),m=`${s}:${c}`,d=Q(null),{value:u,toggle:h,setFalse:p}=se(!1),v=()=>{r.set("accountID",s),r.set("projectID",c),o(r),p(),a({type:"RUN_QUERY"})},b=()=>{i(r.get("accountID")||"0"),l(r.get("projectID")||"0")};return A(()=>{u||b()},[u]),e("div",{className:"vm-tenant-input",children:[e(Y,{title:"Define Tenant ID if you need request to another storage",children:e("div",{ref:d,children:n?e("div",{className:"vm-mobile-option",onClick:h,children:[e("span",{className:"vm-mobile-option__icon",children:e(Tt,{})}),e("div",{className:"vm-mobile-option-text",children:[e("span",{className:"vm-mobile-option-text__label",children:"Tenant ID"}),e("span",{className:"vm-mobile-option-text__value",children:m})]}),e("span",{className:"vm-mobile-option__arrow",children:e(ve,{})})]}):e(P,{className:t?"":"vm-header-button",variant:"contained",color:"primary",fullWidth:!0,startIcon:e(Tt,{}),endIcon:e("div",{className:D({"vm-execution-controls-buttons__arrow":!0,"vm-execution-controls-buttons__arrow_open":u}),children:e(ve,{})}),onClick:h,children:m})})}),e(Ie,{open:u,placement:"bottom-right",onClose:p,buttonRef:d,title:n?"Define Tenant ID":void 0,children:e("div",{className:D({"vm-list vm-tenant-input-list":!0,"vm-list vm-tenant-input-list_mobile":n,"vm-tenant-input-list_inline":!0}),children:[e(le,{autofocus:!0,label:"accountID",value:s,onChange:i,type:"number"}),e(le,{autofocus:!0,label:"projectID",value:c,onChange:l,type:"number"}),e("div",{className:"vm-tenant-input-list__buttons",children:[e(Y,{title:"Multitenancy in VictoriaLogs documentation",children:e("a",{href:"https://docs.victoriametrics.com/victorialogs/#multitenancy",target:"_blank",rel:"help noreferrer",children:e(P,{variant:"text",color:"gray",startIcon:e(Ja,{})})})}),e(P,{variant:"contained",color:"primary",onClick:v,children:"Apply"})]})]})})]})},Eh=({isMobile:t})=>e("div",{className:D({"vm-header-controls":!0,"vm-header-controls_mobile":t}),children:[e(xh,{}),e(pr,{}),e(gr,{}),e(vr,{})]}),Lh=()=>{const t=Ce(),{isMobile:n}=W(),{pathname:a}=lt();return fr(),A(()=>{var i;const o="vmui for VictoriaLogs",s=(i=ct[J.logs])==null?void 0:i.title;document.title=`${s} - ${o}`},[a]),e("section",{className:"vm-container",children:[e(ur,{controlsComponent:Eh}),e("div",{className:D({"vm-container-body":!0,"vm-container-body_mobile":n,"vm-container-body_app":t}),children:e(Da,{})}),!t&&e(hr,{links:Hl})]})},Mh={100:"💯",1234:"🔢",grinning:"😀",smiley:"😃",smile:"😄",grin:"😁",laughing:"😆",satisfied:"😆",sweat_smile:"😅",rofl:"🤣",joy:"😂",slightly_smiling_face:"🙂",upside_down_face:"🙃",melting_face:"🫠",wink:"😉",blush:"😊",innocent:"😇",smiling_face_with_three_hearts:"🥰",heart_eyes:"😍",star_struck:"🤩",kissing_heart:"😘",kissing:"😗",relaxed:"☺️",kissing_closed_eyes:"😚",kissing_smiling_eyes:"😙",smiling_face_with_tear:"🥲",yum:"😋",stuck_out_tongue:"😛",stuck_out_tongue_winking_eye:"😜",zany_face:"🤪",stuck_out_tongue_closed_eyes:"😝",money_mouth_face:"🤑",hugs:"🤗",hand_over_mouth:"🤭",face_with_open_eyes_and_hand_over_mouth:"🫢",face_with_peeking_eye:"🫣",shushing_face:"🤫",thinking:"🤔",saluting_face:"🫡",zipper_mouth_face:"🤐",raised_eyebrow:"🤨",neutral_face:"😐",expressionless:"😑",no_mouth:"😶",dotted_line_face:"🫥",face_in_clouds:"😶‍🌫️",smirk:"😏",unamused:"😒",roll_eyes:"🙄",grimacing:"😬",face_exhaling:"😮‍💨",lying_face:"🤥",shaking_face:"🫨",relieved:"😌",pensive:"😔",sleepy:"😪",drooling_face:"🤤",sleeping:"😴",mask:"😷",face_with_thermometer:"🤒",face_with_head_bandage:"🤕",nauseated_face:"🤢",vomiting_face:"🤮",sneezing_face:"🤧",hot_face:"🥵",cold_face:"🥶",woozy_face:"🥴",dizzy_face:"😵",face_with_spiral_eyes:"😵‍💫",exploding_head:"🤯",cowboy_hat_face:"🤠",partying_face:"🥳",disguised_face:"🥸",sunglasses:"😎",nerd_face:"🤓",monocle_face:"🧐",confused:"😕",face_with_diagonal_mouth:"🫤",worried:"😟",slightly_frowning_face:"🙁",frowning_face:"☹️",open_mouth:"😮",hushed:"😯",astonished:"😲",flushed:"😳",pleading_face:"🥺",face_holding_back_tears:"🥹",frowning:"😦",anguished:"😧",fearful:"😨",cold_sweat:"😰",disappointed_relieved:"😥",cry:"😢",sob:"😭",scream:"😱",confounded:"😖",persevere:"😣",disappointed:"😞",sweat:"😓",weary:"😩",tired_face:"😫",yawning_face:"🥱",triumph:"😤",rage:"😡",pout:"😡",angry:"😠",cursing_face:"🤬",smiling_imp:"😈",imp:"👿",skull:"💀",skull_and_crossbones:"☠️",hankey:"💩",poop:"💩",shit:"💩",clown_face:"🤡",japanese_ogre:"👹",japanese_goblin:"👺",ghost:"👻",alien:"👽",space_invader:"👾",robot:"🤖",smiley_cat:"😺",smile_cat:"😸",joy_cat:"😹",heart_eyes_cat:"😻",smirk_cat:"😼",kissing_cat:"😽",scream_cat:"🙀",crying_cat_face:"😿",pouting_cat:"😾",see_no_evil:"🙈",hear_no_evil:"🙉",speak_no_evil:"🙊",love_letter:"💌",cupid:"💘",gift_heart:"💝",sparkling_heart:"💖",heartpulse:"💗",heartbeat:"💓",revolving_hearts:"💞",two_hearts:"💕",heart_decoration:"💟",heavy_heart_exclamation:"❣️",broken_heart:"💔",heart_on_fire:"❤️‍🔥",mending_heart:"❤️‍🩹",heart:"❤️",pink_heart:"🩷",orange_heart:"🧡",yellow_heart:"💛",green_heart:"💚",blue_heart:"💙",light_blue_heart:"🩵",purple_heart:"💜",brown_heart:"🤎",black_heart:"🖤",grey_heart:"🩶",white_heart:"🤍",kiss:"💋",anger:"💢",boom:"💥",collision:"💥",dizzy:"💫",sweat_drops:"💦",dash:"💨",hole:"🕳️",speech_balloon:"💬",eye_speech_bubble:"👁️‍🗨️",left_speech_bubble:"🗨️",right_anger_bubble:"🗯️",thought_balloon:"💭",zzz:"💤",wave:"👋",raised_back_of_hand:"🤚",raised_hand_with_fingers_splayed:"🖐️",hand:"✋",raised_hand:"✋",vulcan_salute:"🖖",rightwards_hand:"🫱",leftwards_hand:"🫲",palm_down_hand:"🫳",palm_up_hand:"🫴",leftwards_pushing_hand:"🫷",rightwards_pushing_hand:"🫸",ok_hand:"👌",pinched_fingers:"🤌",pinching_hand:"🤏",v:"✌️",crossed_fingers:"🤞",hand_with_index_finger_and_thumb_crossed:"🫰",love_you_gesture:"🤟",metal:"🤘",call_me_hand:"🤙",point_left:"👈",point_right:"👉",point_up_2:"👆",middle_finger:"🖕",fu:"🖕",point_down:"👇",point_up:"☝️",index_pointing_at_the_viewer:"🫵","+1":"👍",thumbsup:"👍","-1":"👎",thumbsdown:"👎",fist_raised:"✊",fist:"✊",fist_oncoming:"👊",facepunch:"👊",punch:"👊",fist_left:"🤛",fist_right:"🤜",clap:"👏",raised_hands:"🙌",heart_hands:"🫶",open_hands:"👐",palms_up_together:"🤲",handshake:"🤝",pray:"🙏",writing_hand:"✍️",nail_care:"💅",selfie:"🤳",muscle:"💪",mechanical_arm:"🦾",mechanical_leg:"🦿",leg:"🦵",foot:"🦶",ear:"👂",ear_with_hearing_aid:"🦻",nose:"👃",brain:"🧠",anatomical_heart:"🫀",lungs:"🫁",tooth:"🦷",bone:"🦴",eyes:"👀",eye:"👁️",tongue:"👅",lips:"👄",biting_lip:"🫦",baby:"👶",child:"🧒",boy:"👦",girl:"👧",adult:"🧑",blond_haired_person:"👱",man:"👨",bearded_person:"🧔",man_beard:"🧔‍♂️",woman_beard:"🧔‍♀️",red_haired_man:"👨‍🦰",curly_haired_man:"👨‍🦱",white_haired_man:"👨‍🦳",bald_man:"👨‍🦲",woman:"👩",red_haired_woman:"👩‍🦰",person_red_hair:"🧑‍🦰",curly_haired_woman:"👩‍🦱",person_curly_hair:"🧑‍🦱",white_haired_woman:"👩‍🦳",person_white_hair:"🧑‍🦳",bald_woman:"👩‍🦲",person_bald:"🧑‍🦲",blond_haired_woman:"👱‍♀️",blonde_woman:"👱‍♀️",blond_haired_man:"👱‍♂️",older_adult:"🧓",older_man:"👴",older_woman:"👵",frowning_person:"🙍",frowning_man:"🙍‍♂️",frowning_woman:"🙍‍♀️",pouting_face:"🙎",pouting_man:"🙎‍♂️",pouting_woman:"🙎‍♀️",no_good:"🙅",no_good_man:"🙅‍♂️",ng_man:"🙅‍♂️",no_good_woman:"🙅‍♀️",ng_woman:"🙅‍♀️",ok_person:"🙆",ok_man:"🙆‍♂️",ok_woman:"🙆‍♀️",tipping_hand_person:"💁",information_desk_person:"💁",tipping_hand_man:"💁‍♂️",sassy_man:"💁‍♂️",tipping_hand_woman:"💁‍♀️",sassy_woman:"💁‍♀️",raising_hand:"🙋",raising_hand_man:"🙋‍♂️",raising_hand_woman:"🙋‍♀️",deaf_person:"🧏",deaf_man:"🧏‍♂️",deaf_woman:"🧏‍♀️",bow:"🙇",bowing_man:"🙇‍♂️",bowing_woman:"🙇‍♀️",facepalm:"🤦",man_facepalming:"🤦‍♂️",woman_facepalming:"🤦‍♀️",shrug:"🤷",man_shrugging:"🤷‍♂️",woman_shrugging:"🤷‍♀️",health_worker:"🧑‍⚕️",man_health_worker:"👨‍⚕️",woman_health_worker:"👩‍⚕️",student:"🧑‍🎓",man_student:"👨‍🎓",woman_student:"👩‍🎓",teacher:"🧑‍🏫",man_teacher:"👨‍🏫",woman_teacher:"👩‍🏫",judge:"🧑‍⚖️",man_judge:"👨‍⚖️",woman_judge:"👩‍⚖️",farmer:"🧑‍🌾",man_farmer:"👨‍🌾",woman_farmer:"👩‍🌾",cook:"🧑‍🍳",man_cook:"👨‍🍳",woman_cook:"👩‍🍳",mechanic:"🧑‍🔧",man_mechanic:"👨‍🔧",woman_mechanic:"👩‍🔧",factory_worker:"🧑‍🏭",man_factory_worker:"👨‍🏭",woman_factory_worker:"👩‍🏭",office_worker:"🧑‍💼",man_office_worker:"👨‍💼",woman_office_worker:"👩‍💼",scientist:"🧑‍🔬",man_scientist:"👨‍🔬",woman_scientist:"👩‍🔬",technologist:"🧑‍💻",man_technologist:"👨‍💻",woman_technologist:"👩‍💻",singer:"🧑‍🎤",man_singer:"👨‍🎤",woman_singer:"👩‍🎤",artist:"🧑‍🎨",man_artist:"👨‍🎨",woman_artist:"👩‍🎨",pilot:"🧑‍✈️",man_pilot:"👨‍✈️",woman_pilot:"👩‍✈️",astronaut:"🧑‍🚀",man_astronaut:"👨‍🚀",woman_astronaut:"👩‍🚀",firefighter:"🧑‍🚒",man_firefighter:"👨‍🚒",woman_firefighter:"👩‍🚒",police_officer:"👮",cop:"👮",policeman:"👮‍♂️",policewoman:"👮‍♀️",detective:"🕵️",male_detective:"🕵️‍♂️",female_detective:"🕵️‍♀️",guard:"💂",guardsman:"💂‍♂️",guardswoman:"💂‍♀️",ninja:"🥷",construction_worker:"👷",construction_worker_man:"👷‍♂️",construction_worker_woman:"👷‍♀️",person_with_crown:"🫅",prince:"🤴",princess:"👸",person_with_turban:"👳",man_with_turban:"👳‍♂️",woman_with_turban:"👳‍♀️",man_with_gua_pi_mao:"👲",woman_with_headscarf:"🧕",person_in_tuxedo:"🤵",man_in_tuxedo:"🤵‍♂️",woman_in_tuxedo:"🤵‍♀️",person_with_veil:"👰",man_with_veil:"👰‍♂️",woman_with_veil:"👰‍♀️",bride_with_veil:"👰‍♀️",pregnant_woman:"🤰",pregnant_man:"🫃",pregnant_person:"🫄",breast_feeding:"🤱",woman_feeding_baby:"👩‍🍼",man_feeding_baby:"👨‍🍼",person_feeding_baby:"🧑‍🍼",angel:"👼",santa:"🎅",mrs_claus:"🤶",mx_claus:"🧑‍🎄",superhero:"🦸",superhero_man:"🦸‍♂️",superhero_woman:"🦸‍♀️",supervillain:"🦹",supervillain_man:"🦹‍♂️",supervillain_woman:"🦹‍♀️",mage:"🧙",mage_man:"🧙‍♂️",mage_woman:"🧙‍♀️",fairy:"🧚",fairy_man:"🧚‍♂️",fairy_woman:"🧚‍♀️",vampire:"🧛",vampire_man:"🧛‍♂️",vampire_woman:"🧛‍♀️",merperson:"🧜",merman:"🧜‍♂️",mermaid:"🧜‍♀️",elf:"🧝",elf_man:"🧝‍♂️",elf_woman:"🧝‍♀️",genie:"🧞",genie_man:"🧞‍♂️",genie_woman:"🧞‍♀️",zombie:"🧟",zombie_man:"🧟‍♂️",zombie_woman:"🧟‍♀️",troll:"🧌",massage:"💆",massage_man:"💆‍♂️",massage_woman:"💆‍♀️",haircut:"💇",haircut_man:"💇‍♂️",haircut_woman:"💇‍♀️",walking:"🚶",walking_man:"🚶‍♂️",walking_woman:"🚶‍♀️",standing_person:"🧍",standing_man:"🧍‍♂️",standing_woman:"🧍‍♀️",kneeling_person:"🧎",kneeling_man:"🧎‍♂️",kneeling_woman:"🧎‍♀️",person_with_probing_cane:"🧑‍🦯",man_with_probing_cane:"👨‍🦯",woman_with_probing_cane:"👩‍🦯",person_in_motorized_wheelchair:"🧑‍🦼",man_in_motorized_wheelchair:"👨‍🦼",woman_in_motorized_wheelchair:"👩‍🦼",person_in_manual_wheelchair:"🧑‍🦽",man_in_manual_wheelchair:"👨‍🦽",woman_in_manual_wheelchair:"👩‍🦽",runner:"🏃",running:"🏃",running_man:"🏃‍♂️",running_woman:"🏃‍♀️",woman_dancing:"💃",dancer:"💃",man_dancing:"🕺",business_suit_levitating:"🕴️",dancers:"👯",dancing_men:"👯‍♂️",dancing_women:"👯‍♀️",sauna_person:"🧖",sauna_man:"🧖‍♂️",sauna_woman:"🧖‍♀️",climbing:"🧗",climbing_man:"🧗‍♂️",climbing_woman:"🧗‍♀️",person_fencing:"🤺",horse_racing:"🏇",skier:"⛷️",snowboarder:"🏂",golfing:"🏌️",golfing_man:"🏌️‍♂️",golfing_woman:"🏌️‍♀️",surfer:"🏄",surfing_man:"🏄‍♂️",surfing_woman:"🏄‍♀️",rowboat:"🚣",rowing_man:"🚣‍♂️",rowing_woman:"🚣‍♀️",swimmer:"🏊",swimming_man:"🏊‍♂️",swimming_woman:"🏊‍♀️",bouncing_ball_person:"⛹️",bouncing_ball_man:"⛹️‍♂️",basketball_man:"⛹️‍♂️",bouncing_ball_woman:"⛹️‍♀️",basketball_woman:"⛹️‍♀️",weight_lifting:"🏋️",weight_lifting_man:"🏋️‍♂️",weight_lifting_woman:"🏋️‍♀️",bicyclist:"🚴",biking_man:"🚴‍♂️",biking_woman:"🚴‍♀️",mountain_bicyclist:"🚵",mountain_biking_man:"🚵‍♂️",mountain_biking_woman:"🚵‍♀️",cartwheeling:"🤸",man_cartwheeling:"🤸‍♂️",woman_cartwheeling:"🤸‍♀️",wrestling:"🤼",men_wrestling:"🤼‍♂️",women_wrestling:"🤼‍♀️",water_polo:"🤽",man_playing_water_polo:"🤽‍♂️",woman_playing_water_polo:"🤽‍♀️",handball_person:"🤾",man_playing_handball:"🤾‍♂️",woman_playing_handball:"🤾‍♀️",juggling_person:"🤹",man_juggling:"🤹‍♂️",woman_juggling:"🤹‍♀️",lotus_position:"🧘",lotus_position_man:"🧘‍♂️",lotus_position_woman:"🧘‍♀️",bath:"🛀",sleeping_bed:"🛌",people_holding_hands:"🧑‍🤝‍🧑",two_women_holding_hands:"👭",couple:"👫",two_men_holding_hands:"👬",couplekiss:"💏",couplekiss_man_woman:"👩‍❤️‍💋‍👨",couplekiss_man_man:"👨‍❤️‍💋‍👨",couplekiss_woman_woman:"👩‍❤️‍💋‍👩",couple_with_heart:"💑",couple_with_heart_woman_man:"👩‍❤️‍👨",couple_with_heart_man_man:"👨‍❤️‍👨",couple_with_heart_woman_woman:"👩‍❤️‍👩",family:"👪",family_man_woman_boy:"👨‍👩‍👦",family_man_woman_girl:"👨‍👩‍👧",family_man_woman_girl_boy:"👨‍👩‍👧‍👦",family_man_woman_boy_boy:"👨‍👩‍👦‍👦",family_man_woman_girl_girl:"👨‍👩‍👧‍👧",family_man_man_boy:"👨‍👨‍👦",family_man_man_girl:"👨‍👨‍👧",family_man_man_girl_boy:"👨‍👨‍👧‍👦",family_man_man_boy_boy:"👨‍👨‍👦‍👦",family_man_man_girl_girl:"👨‍👨‍👧‍👧",family_woman_woman_boy:"👩‍👩‍👦",family_woman_woman_girl:"👩‍👩‍👧",family_woman_woman_girl_boy:"👩‍👩‍👧‍👦",family_woman_woman_boy_boy:"👩‍👩‍👦‍👦",family_woman_woman_girl_girl:"👩‍👩‍👧‍👧",family_man_boy:"👨‍👦",family_man_boy_boy:"👨‍👦‍👦",family_man_girl:"👨‍👧",family_man_girl_boy:"👨‍👧‍👦",family_man_girl_girl:"👨‍👧‍👧",family_woman_boy:"👩‍👦",family_woman_boy_boy:"👩‍👦‍👦",family_woman_girl:"👩‍👧",family_woman_girl_boy:"👩‍👧‍👦",family_woman_girl_girl:"👩‍👧‍👧",speaking_head:"🗣️",bust_in_silhouette:"👤",busts_in_silhouette:"👥",people_hugging:"🫂",footprints:"👣",monkey_face:"🐵",monkey:"🐒",gorilla:"🦍",orangutan:"🦧",dog:"🐶",dog2:"🐕",guide_dog:"🦮",service_dog:"🐕‍🦺",poodle:"🐩",wolf:"🐺",fox_face:"🦊",raccoon:"🦝",cat:"🐱",cat2:"🐈",black_cat:"🐈‍⬛",lion:"🦁",tiger:"🐯",tiger2:"🐅",leopard:"🐆",horse:"🐴",moose:"🫎",donkey:"🫏",racehorse:"🐎",unicorn:"🦄",zebra:"🦓",deer:"🦌",bison:"🦬",cow:"🐮",ox:"🐂",water_buffalo:"🐃",cow2:"🐄",pig:"🐷",pig2:"🐖",boar:"🐗",pig_nose:"🐽",ram:"🐏",sheep:"🐑",goat:"🐐",dromedary_camel:"🐪",camel:"🐫",llama:"🦙",giraffe:"🦒",elephant:"🐘",mammoth:"🦣",rhinoceros:"🦏",hippopotamus:"🦛",mouse:"🐭",mouse2:"🐁",rat:"🐀",hamster:"🐹",rabbit:"🐰",rabbit2:"🐇",chipmunk:"🐿️",beaver:"🦫",hedgehog:"🦔",bat:"🦇",bear:"🐻",polar_bear:"🐻‍❄️",koala:"🐨",panda_face:"🐼",sloth:"🦥",otter:"🦦",skunk:"🦨",kangaroo:"🦘",badger:"🦡",feet:"🐾",paw_prints:"🐾",turkey:"🦃",chicken:"🐔",rooster:"🐓",hatching_chick:"🐣",baby_chick:"🐤",hatched_chick:"🐥",bird:"🐦",penguin:"🐧",dove:"🕊️",eagle:"🦅",duck:"🦆",swan:"🦢",owl:"🦉",dodo:"🦤",feather:"🪶",flamingo:"🦩",peacock:"🦚",parrot:"🦜",wing:"🪽",black_bird:"🐦‍⬛",goose:"🪿",frog:"🐸",crocodile:"🐊",turtle:"🐢",lizard:"🦎",snake:"🐍",dragon_face:"🐲",dragon:"🐉",sauropod:"🦕","t-rex":"🦖",whale:"🐳",whale2:"🐋",dolphin:"🐬",flipper:"🐬",seal:"🦭",fish:"🐟",tropical_fish:"🐠",blowfish:"🐡",shark:"🦈",octopus:"🐙",shell:"🐚",coral:"🪸",jellyfish:"🪼",snail:"🐌",butterfly:"🦋",bug:"🐛",ant:"🐜",bee:"🐝",honeybee:"🐝",beetle:"🪲",lady_beetle:"🐞",cricket:"🦗",cockroach:"🪳",spider:"🕷️",spider_web:"🕸️",scorpion:"🦂",mosquito:"🦟",fly:"🪰",worm:"🪱",microbe:"🦠",bouquet:"💐",cherry_blossom:"🌸",white_flower:"💮",lotus:"🪷",rosette:"🏵️",rose:"🌹",wilted_flower:"🥀",hibiscus:"🌺",sunflower:"🌻",blossom:"🌼",tulip:"🌷",hyacinth:"🪻",seedling:"🌱",potted_plant:"🪴",evergreen_tree:"🌲",deciduous_tree:"🌳",palm_tree:"🌴",cactus:"🌵",ear_of_rice:"🌾",herb:"🌿",shamrock:"☘️",four_leaf_clover:"🍀",maple_leaf:"🍁",fallen_leaf:"🍂",leaves:"🍃",empty_nest:"🪹",nest_with_eggs:"🪺",mushroom:"🍄",grapes:"🍇",melon:"🍈",watermelon:"🍉",tangerine:"🍊",orange:"🍊",mandarin:"🍊",lemon:"🍋",banana:"🍌",pineapple:"🍍",mango:"🥭",apple:"🍎",green_apple:"🍏",pear:"🍐",peach:"🍑",cherries:"🍒",strawberry:"🍓",blueberries:"🫐",kiwi_fruit:"🥝",tomato:"🍅",olive:"🫒",coconut:"🥥",avocado:"🥑",eggplant:"🍆",potato:"🥔",carrot:"🥕",corn:"🌽",hot_pepper:"🌶️",bell_pepper:"🫑",cucumber:"🥒",leafy_green:"🥬",broccoli:"🥦",garlic:"🧄",onion:"🧅",peanuts:"🥜",beans:"🫘",chestnut:"🌰",ginger_root:"🫚",pea_pod:"🫛",bread:"🍞",croissant:"🥐",baguette_bread:"🥖",flatbread:"🫓",pretzel:"🥨",bagel:"🥯",pancakes:"🥞",waffle:"🧇",cheese:"🧀",meat_on_bone:"🍖",poultry_leg:"🍗",cut_of_meat:"🥩",bacon:"🥓",hamburger:"🍔",fries:"🍟",pizza:"🍕",hotdog:"🌭",sandwich:"🥪",taco:"🌮",burrito:"🌯",tamale:"🫔",stuffed_flatbread:"🥙",falafel:"🧆",egg:"🥚",fried_egg:"🍳",shallow_pan_of_food:"🥘",stew:"🍲",fondue:"🫕",bowl_with_spoon:"🥣",green_salad:"🥗",popcorn:"🍿",butter:"🧈",salt:"🧂",canned_food:"🥫",bento:"🍱",rice_cracker:"🍘",rice_ball:"🍙",rice:"🍚",curry:"🍛",ramen:"🍜",spaghetti:"🍝",sweet_potato:"🍠",oden:"🍢",sushi:"🍣",fried_shrimp:"🍤",fish_cake:"🍥",moon_cake:"🥮",dango:"🍡",dumpling:"🥟",fortune_cookie:"🥠",takeout_box:"🥡",crab:"🦀",lobster:"🦞",shrimp:"🦐",squid:"🦑",oyster:"🦪",icecream:"🍦",shaved_ice:"🍧",ice_cream:"🍨",doughnut:"🍩",cookie:"🍪",birthday:"🎂",cake:"🍰",cupcake:"🧁",pie:"🥧",chocolate_bar:"🍫",candy:"🍬",lollipop:"🍭",custard:"🍮",honey_pot:"🍯",baby_bottle:"🍼",milk_glass:"🥛",coffee:"☕",teapot:"🫖",tea:"🍵",sake:"🍶",champagne:"🍾",wine_glass:"🍷",cocktail:"🍸",tropical_drink:"🍹",beer:"🍺",beers:"🍻",clinking_glasses:"🥂",tumbler_glass:"🥃",pouring_liquid:"🫗",cup_with_straw:"🥤",bubble_tea:"🧋",beverage_box:"🧃",mate:"🧉",ice_cube:"🧊",chopsticks:"🥢",plate_with_cutlery:"🍽️",fork_and_knife:"🍴",spoon:"🥄",hocho:"🔪",knife:"🔪",jar:"🫙",amphora:"🏺",earth_africa:"🌍",earth_americas:"🌎",earth_asia:"🌏",globe_with_meridians:"🌐",world_map:"🗺️",japan:"🗾",compass:"🧭",mountain_snow:"🏔️",mountain:"⛰️",volcano:"🌋",mount_fuji:"🗻",camping:"🏕️",beach_umbrella:"🏖️",desert:"🏜️",desert_island:"🏝️",national_park:"🏞️",stadium:"🏟️",classical_building:"🏛️",building_construction:"🏗️",bricks:"🧱",rock:"🪨",wood:"🪵",hut:"🛖",houses:"🏘️",derelict_house:"🏚️",house:"🏠",house_with_garden:"🏡",office:"🏢",post_office:"🏣",european_post_office:"🏤",hospital:"🏥",bank:"🏦",hotel:"🏨",love_hotel:"🏩",convenience_store:"🏪",school:"🏫",department_store:"🏬",factory:"🏭",japanese_castle:"🏯",european_castle:"🏰",wedding:"💒",tokyo_tower:"🗼",statue_of_liberty:"🗽",church:"⛪",mosque:"🕌",hindu_temple:"🛕",synagogue:"🕍",shinto_shrine:"⛩️",kaaba:"🕋",fountain:"⛲",tent:"⛺",foggy:"🌁",night_with_stars:"🌃",cityscape:"🏙️",sunrise_over_mountains:"🌄",sunrise:"🌅",city_sunset:"🌆",city_sunrise:"🌇",bridge_at_night:"🌉",hotsprings:"♨️",carousel_horse:"🎠",playground_slide:"🛝",ferris_wheel:"🎡",roller_coaster:"🎢",barber:"💈",circus_tent:"🎪",steam_locomotive:"🚂",railway_car:"🚃",bullettrain_side:"🚄",bullettrain_front:"🚅",train2:"🚆",metro:"🚇",light_rail:"🚈",station:"🚉",tram:"🚊",monorail:"🚝",mountain_railway:"🚞",train:"🚋",bus:"🚌",oncoming_bus:"🚍",trolleybus:"🚎",minibus:"🚐",ambulance:"🚑",fire_engine:"🚒",police_car:"🚓",oncoming_police_car:"🚔",taxi:"🚕",oncoming_taxi:"🚖",car:"🚗",red_car:"🚗",oncoming_automobile:"🚘",blue_car:"🚙",pickup_truck:"🛻",truck:"🚚",articulated_lorry:"🚛",tractor:"🚜",racing_car:"🏎️",motorcycle:"🏍️",motor_scooter:"🛵",manual_wheelchair:"🦽",motorized_wheelchair:"🦼",auto_rickshaw:"🛺",bike:"🚲",kick_scooter:"🛴",skateboard:"🛹",roller_skate:"🛼",busstop:"🚏",motorway:"🛣️",railway_track:"🛤️",oil_drum:"🛢️",fuelpump:"⛽",wheel:"🛞",rotating_light:"🚨",traffic_light:"🚥",vertical_traffic_light:"🚦",stop_sign:"🛑",construction:"🚧",anchor:"⚓",ring_buoy:"🛟",boat:"⛵",sailboat:"⛵",canoe:"🛶",speedboat:"🚤",passenger_ship:"🛳️",ferry:"⛴️",motor_boat:"🛥️",ship:"🚢",airplane:"✈️",small_airplane:"🛩️",flight_departure:"🛫",flight_arrival:"🛬",parachute:"🪂",seat:"💺",helicopter:"🚁",suspension_railway:"🚟",mountain_cableway:"🚠",aerial_tramway:"🚡",artificial_satellite:"🛰️",rocket:"🚀",flying_saucer:"🛸",bellhop_bell:"🛎️",luggage:"🧳",hourglass:"⌛",hourglass_flowing_sand:"⏳",watch:"⌚",alarm_clock:"⏰",stopwatch:"⏱️",timer_clock:"⏲️",mantelpiece_clock:"🕰️",clock12:"🕛",clock1230:"🕧",clock1:"🕐",clock130:"🕜",clock2:"🕑",clock230:"🕝",clock3:"🕒",clock330:"🕞",clock4:"🕓",clock430:"🕟",clock5:"🕔",clock530:"🕠",clock6:"🕕",clock630:"🕡",clock7:"🕖",clock730:"🕢",clock8:"🕗",clock830:"🕣",clock9:"🕘",clock930:"🕤",clock10:"🕙",clock1030:"🕥",clock11:"🕚",clock1130:"🕦",new_moon:"🌑",waxing_crescent_moon:"🌒",first_quarter_moon:"🌓",moon:"🌔",waxing_gibbous_moon:"🌔",full_moon:"🌕",waning_gibbous_moon:"🌖",last_quarter_moon:"🌗",waning_crescent_moon:"🌘",crescent_moon:"🌙",new_moon_with_face:"🌚",first_quarter_moon_with_face:"🌛",last_quarter_moon_with_face:"🌜",thermometer:"🌡️",sunny:"☀️",full_moon_with_face:"🌝",sun_with_face:"🌞",ringed_planet:"🪐",star:"⭐",star2:"🌟",stars:"🌠",milky_way:"🌌",cloud:"☁️",partly_sunny:"⛅",cloud_with_lightning_and_rain:"⛈️",sun_behind_small_cloud:"🌤️",sun_behind_large_cloud:"🌥️",sun_behind_rain_cloud:"🌦️",cloud_with_rain:"🌧️",cloud_with_snow:"🌨️",cloud_with_lightning:"🌩️",tornado:"🌪️",fog:"🌫️",wind_face:"🌬️",cyclone:"🌀",rainbow:"🌈",closed_umbrella:"🌂",open_umbrella:"☂️",umbrella:"☔",parasol_on_ground:"⛱️",zap:"⚡",snowflake:"❄️",snowman_with_snow:"☃️",snowman:"⛄",comet:"☄️",fire:"🔥",droplet:"💧",ocean:"🌊",jack_o_lantern:"🎃",christmas_tree:"🎄",fireworks:"🎆",sparkler:"🎇",firecracker:"🧨",sparkles:"✨",balloon:"🎈",tada:"🎉",confetti_ball:"🎊",tanabata_tree:"🎋",bamboo:"🎍",dolls:"🎎",flags:"🎏",wind_chime:"🎐",rice_scene:"🎑",red_envelope:"🧧",ribbon:"🎀",gift:"🎁",reminder_ribbon:"🎗️",tickets:"🎟️",ticket:"🎫",medal_military:"🎖️",trophy:"🏆",medal_sports:"🏅","1st_place_medal":"🥇","2nd_place_medal":"🥈","3rd_place_medal":"🥉",soccer:"⚽",baseball:"⚾",softball:"🥎",basketball:"🏀",volleyball:"🏐",football:"🏈",rugby_football:"🏉",tennis:"🎾",flying_disc:"🥏",bowling:"🎳",cricket_game:"🏏",field_hockey:"🏑",ice_hockey:"🏒",lacrosse:"🥍",ping_pong:"🏓",badminton:"🏸",boxing_glove:"🥊",martial_arts_uniform:"🥋",goal_net:"🥅",golf:"⛳",ice_skate:"⛸️",fishing_pole_and_fish:"🎣",diving_mask:"🤿",running_shirt_with_sash:"🎽",ski:"🎿",sled:"🛷",curling_stone:"🥌",dart:"🎯",yo_yo:"🪀",kite:"🪁",gun:"🔫","8ball":"🎱",crystal_ball:"🔮",magic_wand:"🪄",video_game:"🎮",joystick:"🕹️",slot_machine:"🎰",game_die:"🎲",jigsaw:"🧩",teddy_bear:"🧸",pinata:"🪅",mirror_ball:"🪩",nesting_dolls:"🪆",spades:"♠️",hearts:"♥️",diamonds:"♦️",clubs:"♣️",chess_pawn:"♟️",black_joker:"🃏",mahjong:"🀄",flower_playing_cards:"🎴",performing_arts:"🎭",framed_picture:"🖼️",art:"🎨",thread:"🧵",sewing_needle:"🪡",yarn:"🧶",knot:"🪢",eyeglasses:"👓",dark_sunglasses:"🕶️",goggles:"🥽",lab_coat:"🥼",safety_vest:"🦺",necktie:"👔",shirt:"👕",tshirt:"👕",jeans:"👖",scarf:"🧣",gloves:"🧤",coat:"🧥",socks:"🧦",dress:"👗",kimono:"👘",sari:"🥻",one_piece_swimsuit:"🩱",swim_brief:"🩲",shorts:"🩳",bikini:"👙",womans_clothes:"👚",folding_hand_fan:"🪭",purse:"👛",handbag:"👜",pouch:"👝",shopping:"🛍️",school_satchel:"🎒",thong_sandal:"🩴",mans_shoe:"👞",shoe:"👞",athletic_shoe:"👟",hiking_boot:"🥾",flat_shoe:"🥿",high_heel:"👠",sandal:"👡",ballet_shoes:"🩰",boot:"👢",hair_pick:"🪮",crown:"👑",womans_hat:"👒",tophat:"🎩",mortar_board:"🎓",billed_cap:"🧢",military_helmet:"🪖",rescue_worker_helmet:"⛑️",prayer_beads:"📿",lipstick:"💄",ring:"💍",gem:"💎",mute:"🔇",speaker:"🔈",sound:"🔉",loud_sound:"🔊",loudspeaker:"📢",mega:"📣",postal_horn:"📯",bell:"🔔",no_bell:"🔕",musical_score:"🎼",musical_note:"🎵",notes:"🎶",studio_microphone:"🎙️",level_slider:"🎚️",control_knobs:"🎛️",microphone:"🎤",headphones:"🎧",radio:"📻",saxophone:"🎷",accordion:"🪗",guitar:"🎸",musical_keyboard:"🎹",trumpet:"🎺",violin:"🎻",banjo:"🪕",drum:"🥁",long_drum:"🪘",maracas:"🪇",flute:"🪈",iphone:"📱",calling:"📲",phone:"☎️",telephone:"☎️",telephone_receiver:"📞",pager:"📟",fax:"📠",battery:"🔋",low_battery:"🪫",electric_plug:"🔌",computer:"💻",desktop_computer:"🖥️",printer:"🖨️",keyboard:"⌨️",computer_mouse:"🖱️",trackball:"🖲️",minidisc:"💽",floppy_disk:"💾",cd:"💿",dvd:"📀",abacus:"🧮",movie_camera:"🎥",film_strip:"🎞️",film_projector:"📽️",clapper:"🎬",tv:"📺",camera:"📷",camera_flash:"📸",video_camera:"📹",vhs:"📼",mag:"🔍",mag_right:"🔎",candle:"🕯️",bulb:"💡",flashlight:"🔦",izakaya_lantern:"🏮",lantern:"🏮",diya_lamp:"🪔",notebook_with_decorative_cover:"📔",closed_book:"📕",book:"📖",open_book:"📖",green_book:"📗",blue_book:"📘",orange_book:"📙",books:"📚",notebook:"📓",ledger:"📒",page_with_curl:"📃",scroll:"📜",page_facing_up:"📄",newspaper:"📰",newspaper_roll:"🗞️",bookmark_tabs:"📑",bookmark:"🔖",label:"🏷️",moneybag:"💰",coin:"🪙",yen:"💴",dollar:"💵",euro:"💶",pound:"💷",money_with_wings:"💸",credit_card:"💳",receipt:"🧾",chart:"💹",envelope:"✉️",email:"📧","e-mail":"📧",incoming_envelope:"📨",envelope_with_arrow:"📩",outbox_tray:"📤",inbox_tray:"📥",package:"📦",mailbox:"📫",mailbox_closed:"📪",mailbox_with_mail:"📬",mailbox_with_no_mail:"📭",postbox:"📮",ballot_box:"🗳️",pencil2:"✏️",black_nib:"✒️",fountain_pen:"🖋️",pen:"🖊️",paintbrush:"🖌️",crayon:"🖍️",memo:"📝",pencil:"📝",briefcase:"💼",file_folder:"📁",open_file_folder:"📂",card_index_dividers:"🗂️",date:"📅",calendar:"📆",spiral_notepad:"🗒️",spiral_calendar:"🗓️",card_index:"📇",chart_with_upwards_trend:"📈",chart_with_downwards_trend:"📉",bar_chart:"📊",clipboard:"📋",pushpin:"📌",round_pushpin:"📍",paperclip:"📎",paperclips:"🖇️",straight_ruler:"📏",triangular_ruler:"📐",scissors:"✂️",card_file_box:"🗃️",file_cabinet:"🗄️",wastebasket:"🗑️",lock:"🔒",unlock:"🔓",lock_with_ink_pen:"🔏",closed_lock_with_key:"🔐",key:"🔑",old_key:"🗝️",hammer:"🔨",axe:"🪓",pick:"⛏️",hammer_and_pick:"⚒️",hammer_and_wrench:"🛠️",dagger:"🗡️",crossed_swords:"⚔️",bomb:"💣",boomerang:"🪃",bow_and_arrow:"🏹",shield:"🛡️",carpentry_saw:"🪚",wrench:"🔧",screwdriver:"🪛",nut_and_bolt:"🔩",gear:"⚙️",clamp:"🗜️",balance_scale:"⚖️",probing_cane:"🦯",link:"🔗",chains:"⛓️",hook:"🪝",toolbox:"🧰",magnet:"🧲",ladder:"🪜",alembic:"⚗️",test_tube:"🧪",petri_dish:"🧫",dna:"🧬",microscope:"🔬",telescope:"🔭",satellite:"📡",syringe:"💉",drop_of_blood:"🩸",pill:"💊",adhesive_bandage:"🩹",crutch:"🩼",stethoscope:"🩺",x_ray:"🩻",door:"🚪",elevator:"🛗",mirror:"🪞",window:"🪟",bed:"🛏️",couch_and_lamp:"🛋️",chair:"🪑",toilet:"🚽",plunger:"🪠",shower:"🚿",bathtub:"🛁",mouse_trap:"🪤",razor:"🪒",lotion_bottle:"🧴",safety_pin:"🧷",broom:"🧹",basket:"🧺",roll_of_paper:"🧻",bucket:"🪣",soap:"🧼",bubbles:"🫧",toothbrush:"🪥",sponge:"🧽",fire_extinguisher:"🧯",shopping_cart:"🛒",smoking:"🚬",coffin:"⚰️",headstone:"🪦",funeral_urn:"⚱️",nazar_amulet:"🧿",hamsa:"🪬",moyai:"🗿",placard:"🪧",identification_card:"🪪",atm:"🏧",put_litter_in_its_place:"🚮",potable_water:"🚰",wheelchair:"♿",men:"🚹",women:"🚺",restroom:"🚻",baby_symbol:"🚼",wc:"🚾",passport_control:"🛂",customs:"🛃",baggage_claim:"🛄",left_luggage:"🛅",warning:"⚠️",children_crossing:"🚸",no_entry:"⛔",no_entry_sign:"🚫",no_bicycles:"🚳",no_smoking:"🚭",do_not_litter:"🚯","non-potable_water":"🚱",no_pedestrians:"🚷",no_mobile_phones:"📵",underage:"🔞",radioactive:"☢️",biohazard:"☣️",arrow_up:"⬆️",arrow_upper_right:"↗️",arrow_right:"➡️",arrow_lower_right:"↘️",arrow_down:"⬇️",arrow_lower_left:"↙️",arrow_left:"⬅️",arrow_upper_left:"↖️",arrow_up_down:"↕️",left_right_arrow:"↔️",leftwards_arrow_with_hook:"↩️",arrow_right_hook:"↪️",arrow_heading_up:"⤴️",arrow_heading_down:"⤵️",arrows_clockwise:"🔃",arrows_counterclockwise:"🔄",back:"🔙",end:"🔚",on:"🔛",soon:"🔜",top:"🔝",place_of_worship:"🛐",atom_symbol:"⚛️",om:"🕉️",star_of_david:"✡️",wheel_of_dharma:"☸️",yin_yang:"☯️",latin_cross:"✝️",orthodox_cross:"☦️",star_and_crescent:"☪️",peace_symbol:"☮️",menorah:"🕎",six_pointed_star:"🔯",khanda:"🪯",aries:"♈",taurus:"♉",gemini:"♊",cancer:"♋",leo:"♌",virgo:"♍",libra:"♎",scorpius:"♏",sagittarius:"♐",capricorn:"♑",aquarius:"♒",pisces:"♓",ophiuchus:"⛎",twisted_rightwards_arrows:"🔀",repeat:"🔁",repeat_one:"🔂",arrow_forward:"▶️",fast_forward:"⏩",next_track_button:"⏭️",play_or_pause_button:"⏯️",arrow_backward:"◀️",rewind:"⏪",previous_track_button:"⏮️",arrow_up_small:"🔼",arrow_double_up:"⏫",arrow_down_small:"🔽",arrow_double_down:"⏬",pause_button:"⏸️",stop_button:"⏹️",record_button:"⏺️",eject_button:"⏏️",cinema:"🎦",low_brightness:"🔅",high_brightness:"🔆",signal_strength:"📶",wireless:"🛜",vibration_mode:"📳",mobile_phone_off:"📴",female_sign:"♀️",male_sign:"♂️",transgender_symbol:"⚧️",heavy_multiplication_x:"✖️",heavy_plus_sign:"➕",heavy_minus_sign:"➖",heavy_division_sign:"➗",heavy_equals_sign:"🟰",infinity:"♾️",bangbang:"‼️",interrobang:"⁉️",question:"❓",grey_question:"❔",grey_exclamation:"❕",exclamation:"❗",heavy_exclamation_mark:"❗",wavy_dash:"〰️",currency_exchange:"💱",heavy_dollar_sign:"💲",medical_symbol:"⚕️",recycle:"♻️",fleur_de_lis:"⚜️",trident:"🔱",name_badge:"📛",beginner:"🔰",o:"⭕",white_check_mark:"✅",ballot_box_with_check:"☑️",heavy_check_mark:"✔️",x:"❌",negative_squared_cross_mark:"❎",curly_loop:"➰",loop:"➿",part_alternation_mark:"〽️",eight_spoked_asterisk:"✳️",eight_pointed_black_star:"✴️",sparkle:"❇️",copyright:"©️",registered:"®️",tm:"™️",hash:"#️⃣",asterisk:"*️⃣",zero:"0️⃣",one:"1️⃣",two:"2️⃣",three:"3️⃣",four:"4️⃣",five:"5️⃣",six:"6️⃣",seven:"7️⃣",eight:"8️⃣",nine:"9️⃣",keycap_ten:"🔟",capital_abcd:"🔠",abcd:"🔡",symbols:"🔣",abc:"🔤",a:"🅰️",ab:"🆎",b:"🅱️",cl:"🆑",cool:"🆒",free:"🆓",information_source:"ℹ️",id:"🆔",m:"Ⓜ️",new:"🆕",ng:"🆖",o2:"🅾️",ok:"🆗",parking:"🅿️",sos:"🆘",up:"🆙",vs:"🆚",koko:"🈁",sa:"🈂️",u6708:"🈷️",u6709:"🈶",u6307:"🈯",ideograph_advantage:"🉐",u5272:"🈹",u7121:"🈚",u7981:"🈲",accept:"🉑",u7533:"🈸",u5408:"🈴",u7a7a:"🈳",congratulations:"㊗️",secret:"㊙️",u55b6:"🈺",u6e80:"🈵",red_circle:"🔴",orange_circle:"🟠",yellow_circle:"🟡",green_circle:"🟢",large_blue_circle:"🔵",purple_circle:"🟣",brown_circle:"🟤",black_circle:"⚫",white_circle:"⚪",red_square:"🟥",orange_square:"🟧",yellow_square:"🟨",green_square:"🟩",blue_square:"🟦",purple_square:"🟪",brown_square:"🟫",black_large_square:"⬛",white_large_square:"⬜",black_medium_square:"◼️",white_medium_square:"◻️",black_medium_small_square:"◾",white_medium_small_square:"◽",black_small_square:"▪️",white_small_square:"▫️",large_orange_diamond:"🔶",large_blue_diamond:"🔷",small_orange_diamond:"🔸",small_blue_diamond:"🔹",small_red_triangle:"🔺",small_red_triangle_down:"🔻",diamond_shape_with_a_dot_inside:"💠",radio_button:"🔘",white_square_button:"🔳",black_square_button:"🔲",checkered_flag:"🏁",triangular_flag_on_post:"🚩",crossed_flags:"🎌",black_flag:"🏴",white_flag:"🏳️",rainbow_flag:"🏳️‍🌈",transgender_flag:"🏳️‍⚧️",pirate_flag:"🏴‍☠️",ascension_island:"🇦🇨",andorra:"🇦🇩",united_arab_emirates:"🇦🇪",afghanistan:"🇦🇫",antigua_barbuda:"🇦🇬",anguilla:"🇦🇮",albania:"🇦🇱",armenia:"🇦🇲",angola:"🇦🇴",antarctica:"🇦🇶",argentina:"🇦🇷",american_samoa:"🇦🇸",austria:"🇦🇹",australia:"🇦🇺",aruba:"🇦🇼",aland_islands:"🇦🇽",azerbaijan:"🇦🇿",bosnia_herzegovina:"🇧🇦",barbados:"🇧🇧",bangladesh:"🇧🇩",belgium:"🇧🇪",burkina_faso:"🇧🇫",bulgaria:"🇧🇬",bahrain:"🇧🇭",burundi:"🇧🇮",benin:"🇧🇯",st_barthelemy:"🇧🇱",bermuda:"🇧🇲",brunei:"🇧🇳",bolivia:"🇧🇴",caribbean_netherlands:"🇧🇶",brazil:"🇧🇷",bahamas:"🇧🇸",bhutan:"🇧🇹",bouvet_island:"🇧🇻",botswana:"🇧🇼",belarus:"⬜️🟥⬜",belize:"🇧🇿",canada:"🇨🇦",cocos_islands:"🇨🇨",congo_kinshasa:"🇨🇩",central_african_republic:"🇨🇫",congo_brazzaville:"🇨🇬",switzerland:"🇨🇭",cote_divoire:"🇨🇮",cook_islands:"🇨🇰",chile:"🇨🇱",cameroon:"🇨🇲",cn:"🇨🇳",colombia:"🇨🇴",clipperton_island:"🇨🇵",costa_rica:"🇨🇷",cuba:"🇨🇺",cape_verde:"🇨🇻",curacao:"🇨🇼",christmas_island:"🇨🇽",cyprus:"🇨🇾",czech_republic:"🇨🇿",de:"🇩🇪",diego_garcia:"🇩🇬",djibouti:"🇩🇯",denmark:"🇩🇰",dominica:"🇩🇲",dominican_republic:"🇩🇴",algeria:"🇩🇿",ceuta_melilla:"🇪🇦",ecuador:"🇪🇨",estonia:"🇪🇪",egypt:"🇪🇬",western_sahara:"🇪🇭",eritrea:"🇪🇷",es:"🇪🇸",ethiopia:"🇪🇹",eu:"🇪🇺",european_union:"🇪🇺",finland:"🇫🇮",fiji:"🇫🇯",falkland_islands:"🇫🇰",micronesia:"🇫🇲",faroe_islands:"🇫🇴",fr:"🇫🇷",gabon:"🇬🇦",gb:"🇬🇧",uk:"🇬🇧",grenada:"🇬🇩",georgia:"🇬🇪",french_guiana:"🇬🇫",guernsey:"🇬🇬",ghana:"🇬🇭",gibraltar:"🇬🇮",greenland:"🇬🇱",gambia:"🇬🇲",guinea:"🇬🇳",guadeloupe:"🇬🇵",equatorial_guinea:"🇬🇶",greece:"🇬🇷",south_georgia_south_sandwich_islands:"🇬🇸",guatemala:"🇬🇹",guam:"🇬🇺",guinea_bissau:"🇬🇼",guyana:"🇬🇾",hong_kong:"🇭🇰",heard_mcdonald_islands:"🇭🇲",honduras:"🇭🇳",croatia:"🇭🇷",haiti:"🇭🇹",hungary:"🇭🇺",canary_islands:"🇮🇨",indonesia:"🇮🇩",ireland:"🇮🇪",israel:"🇮🇱",isle_of_man:"🇮🇲",india:"🇮🇳",british_indian_ocean_territory:"🇮🇴",iraq:"🇮🇶",iran:"🇮🇷",iceland:"🇮🇸",it:"🇮🇹",jersey:"🇯🇪",jamaica:"🇯🇲",jordan:"🇯🇴",jp:"🇯🇵",kenya:"🇰🇪",kyrgyzstan:"🇰🇬",cambodia:"🇰🇭",kiribati:"🇰🇮",comoros:"🇰🇲",st_kitts_nevis:"🇰🇳",north_korea:"🇰🇵",kr:"🇰🇷",kuwait:"🇰🇼",cayman_islands:"🇰🇾",kazakhstan:"🇰🇿",laos:"🇱🇦",lebanon:"🇱🇧",st_lucia:"🇱🇨",liechtenstein:"🇱🇮",sri_lanka:"🇱🇰",liberia:"🇱🇷",lesotho:"🇱🇸",lithuania:"🇱🇹",luxembourg:"🇱🇺",latvia:"🇱🇻",libya:"🇱🇾",morocco:"🇲🇦",monaco:"🇲🇨",moldova:"🇲🇩",montenegro:"🇲🇪",st_martin:"🇲🇫",madagascar:"🇲🇬",marshall_islands:"🇲🇭",macedonia:"🇲🇰",mali:"🇲🇱",myanmar:"🇲🇲",mongolia:"🇲🇳",macau:"🇲🇴",northern_mariana_islands:"🇲🇵",martinique:"🇲🇶",mauritania:"🇲🇷",montserrat:"🇲🇸",malta:"🇲🇹",mauritius:"🇲🇺",maldives:"🇲🇻",malawi:"🇲🇼",mexico:"🇲🇽",malaysia:"🇲🇾",mozambique:"🇲🇿",namibia:"🇳🇦",new_caledonia:"🇳🇨",niger:"🇳🇪",norfolk_island:"🇳🇫",nigeria:"🇳🇬",nicaragua:"🇳🇮",netherlands:"🇳🇱",norway:"🇳🇴",nepal:"🇳🇵",nauru:"🇳🇷",niue:"🇳🇺",new_zealand:"🇳🇿",oman:"🇴🇲",panama:"🇵🇦",peru:"🇵🇪",french_polynesia:"🇵🇫",papua_new_guinea:"🇵🇬",philippines:"🇵🇭",pakistan:"🇵🇰",poland:"🇵🇱",st_pierre_miquelon:"🇵🇲",pitcairn_islands:"🇵🇳",puerto_rico:"🇵🇷",palestinian_territories:"🇵🇸",portugal:"🇵🇹",palau:"🇵🇼",paraguay:"🇵🇾",qatar:"🇶🇦",reunion:"🇷🇪",romania:"🇷🇴",serbia:"🇷🇸",ru:"🇷🇺",rwanda:"🇷🇼",saudi_arabia:"🇸🇦",solomon_islands:"🇸🇧",seychelles:"🇸🇨",sudan:"🇸🇩",sweden:"🇸🇪",singapore:"🇸🇬",st_helena:"🇸🇭",slovenia:"🇸🇮",svalbard_jan_mayen:"🇸🇯",slovakia:"🇸🇰",sierra_leone:"🇸🇱",san_marino:"🇸🇲",senegal:"🇸🇳",somalia:"🇸🇴",suriname:"🇸🇷",south_sudan:"🇸🇸",sao_tome_principe:"🇸🇹",el_salvador:"🇸🇻",sint_maarten:"🇸🇽",syria:"🇸🇾",swaziland:"🇸🇿",tristan_da_cunha:"🇹🇦",turks_caicos_islands:"🇹🇨",chad:"🇹🇩",french_southern_territories:"🇹🇫",togo:"🇹🇬",thailand:"🇹🇭",tajikistan:"🇹🇯",tokelau:"🇹🇰",timor_leste:"🇹🇱",turkmenistan:"🇹🇲",tunisia:"🇹🇳",tonga:"🇹🇴",tr:"🇹🇷",trinidad_tobago:"🇹🇹",tuvalu:"🇹🇻",taiwan:"🇹🇼",tanzania:"🇹🇿",ukraine:"🇺🇦",uganda:"🇺🇬",us_outlying_islands:"🇺🇲",united_nations:"🇺🇳",us:"🇺🇸",uruguay:"🇺🇾",uzbekistan:"🇺🇿",vatican_city:"🇻🇦",st_vincent_grenadines:"🇻🇨",venezuela:"🇻🇪",british_virgin_islands:"🇻🇬",us_virgin_islands:"🇻🇮",vietnam:"🇻🇳",vanuatu:"🇻🇺",wallis_futuna:"🇼🇫",samoa:"🇼🇸",kosovo:"🇽🇰",yemen:"🇾🇪",mayotte:"🇾🇹",south_africa:"🇿🇦",zambia:"🇿🇲",zimbabwe:"🇿🇼",england:"🏴󠁧󠁢󠁥󠁮󠁧󠁿",scotland:"🏴󠁧󠁢󠁳󠁣󠁴󠁿",wales:"🏴󠁧󠁢󠁷󠁬󠁳󠁿"};qt.use(_i({emojis:Mh,renderer:t=>t.emoji}));const Dh=()=>{const[t,n]=C(!1);return e(U,{children:e(Ia,{children:e(dr,{children:e(U,{children:[e(Vr,{onLoaded:n}),t&&e(Pa,{children:e(ge,{path:"/",element:e(Lh,{}),children:e(ge,{path:"/",element:e(Ah,{})})})})]})})})})},Ih=({displaySidebar:t,isMobile:n,headerSetup:a,accountIds:r})=>e("div",{className:D({"vm-header-controls":!0,"vm-header-controls_mobile":n}),children:[(a==null?void 0:a.tenant)&&e(gs,{accountIds:r||[]}),(a==null?void 0:a.stepControl)&&e(vs,{}),(a==null?void 0:a.timeSelector)&&e(pr,{}),(a==null?void 0:a.cardinalityDatePicker)&&e(_s,{}),(a==null?void 0:a.executionControls)&&e(gr,{}),e(vr,{}),!t&&e(hs,{})]}),Ph=()=>{const t=Ce(),{isMobile:n}=W(),{pathname:a}=lt(),[r,o]=ae();fr();const s=()=>{var m;const c="vmui for vmanomaly",l=(m=ct[a])==null?void 0:m.title;document.title=l?`${l} - ${c}`:c},i=()=>{const{search:c,href:l}=window.location;if(c){const d=Ea.parse(c,{ignoreQueryPrefix:!0});Object.entries(d).forEach(([u,h])=>r.set(u,h)),o(r),window.location.search=""}const m=l.replace(/\/\?#\//,"/#/");m!==l&&window.location.replace(m)};return A(s,[a]),A(i,[]),e("section",{className:"vm-container",children:[e(ur,{controlsComponent:Ih}),e("div",{className:D({"vm-container-body":!0,"vm-container-body_mobile":n,"vm-container-body_app":t}),children:e(Da,{})}),!t&&e(hr,{})]})},$h=1,Oh=()=>{wr();const{isMobile:t}=W(),{query:n}=Ee(),{customStep:a}=Re(),r=Q(null),[o]=C([]),[s,i]=C(!n[0]),[c,l]=C(!1),{isLoading:m,graphData:d,error:u,queryErrors:h,setQueryErrors:p,queryStats:v,warning:b}=Zn({visible:!0,customStep:a,hideQuery:o,showAllSeries:c}),f=L(()=>{if(!d)return[];const _=d.map(k=>({...Es(k.metric),...k})),y=_.filter(k=>k.value===ne.actual),w=_.filter(k=>k.value===ne.anomaly),S=y.map(k=>{const T=Sa(k.metric),x=w.find(M=>Sa(M.metric)===T);return{group:1,metric:{...k.metric,__name__:ne.anomaly},values:k.values.filter(([M])=>{if(!x)return!1;const E=x.values.find(([I])=>I===M);return E&&an(E[1])>$h})}});return _.filter(k=>k.value!==ne.anomaly&&k.value).concat(S)},[d]),g=()=>{i(!1)};return e("div",{className:D({"vm-custom-panel":!0,"vm-custom-panel_mobile":t}),children:[e(br,{queryErrors:s?[]:h,setQueryErrors:p,setHideError:i,stats:v,onRunQuery:g,hideButtons:{addQuery:!0,prettify:!1,autocomplete:!1,traceQuery:!0,anomalyConfig:!0,reduceMemUsage:!0}}),m&&e(qe,{}),!s&&u&&e(ie,{variant:"error",children:u}),b&&e(ea,{warning:b,query:n,onChange:l}),e("div",{className:D({"vm-custom-panel-body":!0,"vm-custom-panel-body_mobile":t,"vm-block":!0,"vm-block_mobile":t}),children:[e("div",{className:"vm-custom-panel-body-header",ref:r,children:e("div",{})}),f&&e(js,{graphData:f,isHistogram:!1,controlsRef:r,isAnomalyView:!0})]})]})},Rh=()=>{const[t,n]=C(!1);return e(U,{children:e(Ia,{children:e(dr,{children:e(U,{children:[e(Vr,{onLoaded:n}),t&&e(Pa,{children:e(ge,{path:"/",element:e(Ph,{}),children:[e(ge,{path:"/",element:e(Oh,{})}),e(ge,{path:J.query,element:e(Zs,{})})]})})]})})})})},Fh=()=>{switch(jt){case rt.victorialogs:return e(Dh,{});case rt.vmanomaly:return e(Rh,{});default:return e(Tu,{})}},So=document.getElementById("root");So&&bi(Fh(),So);
