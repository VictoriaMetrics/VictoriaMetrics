var Bs=Object.defineProperty;var js=(t,a,n)=>a in t?Bs(t,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[a]=n;var Je=(t,a,n)=>js(t,typeof a!="symbol"?a+"":a,n);import{d as q,t as Qs,a as Ys,u as Gs,q as gn,g as ft,J as pt,p as St,T as D,b as e,x as Ee,N as co,c as I,A as Y,y as x,h as C,k as V,e as Z,f as Na,i as it,$ as Ft,M as _n,D as ka,I as Ws,j as ie,F as fn,O as bn,l as Sa,m as Ht,n as Vt,o as Js,L as Ta,H as yn,R as wn,r as ve,s as Aa,v as Ks,w as Zs}from"./vendor-DojlIpLz.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(o){if(o.ep)return;o.ep=!0;const s=n(o);fetch(o.href,s)}})();q.extend(Qs);q.extend(Ys);q.extend(Gs);var ot=(t=>(t.victoriametrics="victoriametrics",t.victorialogs="victorialogs",t.vmanomaly="vmanomaly",t))(ot||{});const Ut="victorialogs",mo=Ut==="victorialogs",Xs=Ut==="vmanomaly",K={home:"/",metrics:"/metrics",dashboards:"/dashboards",cardinality:"/cardinality",topQueries:"/top-queries",trace:"/trace",withTemplate:"/expand-with-exprs",relabel:"/relabeling",logs:"/logs",activeQueries:"/active-queries",queryAnalyzer:"/query-analyzer",icons:"/icons",anomaly:"/anomaly",query:"/query",rawQuery:"/raw-query",downsamplingDebug:"/downsampling-filters-debug",retentionDebug:"/retention-filters-debug"},Yt={header:{tenant:!0,stepControl:!1,timeSelector:!1,executionControls:!1}},lt={[K.home]:{title:"Query",...Yt},[K.rawQuery]:{title:"Raw query",...Yt},[K.metrics]:{title:"Explore Prometheus metrics",header:{tenant:!0,stepControl:!0,timeSelector:!0}},[K.cardinality]:{title:"Explore cardinality",header:{tenant:!0,cardinalityDatePicker:!0}},[K.topQueries]:{title:"Top queries",header:{tenant:!0}},[K.trace]:{title:"Trace analyzer",header:{}},[K.queryAnalyzer]:{title:"Query analyzer",header:{}},[K.dashboards]:{title:"Dashboards",...Yt},[K.withTemplate]:{title:"WITH templates",header:{}},[K.relabel]:{title:"Metric relabel debug",header:{}},[K.logs]:{title:"Logs Explorer",header:{}},[K.activeQueries]:{title:"Active Queries",header:{}},[K.icons]:{title:"Icons",header:{}},[K.anomaly]:{title:"Anomaly exploration",...Yt},[K.query]:{title:"Query",...Yt},[K.downsamplingDebug]:{title:"Downsampling filters debug",header:{}},[K.retentionDebug]:{title:"Retention filters debug",header:{}}},ta=()=>{var a;const t=((a=document.getElementById("root"))==null?void 0:a.dataset.params)||"{}";try{return JSON.parse(t)}catch(n){return console.error(n),{}}},ye=()=>!!Object.keys(ta()).length,uo=/(\/select\/)(\d+|\d.+)(\/)(.+)/,ho=(t,a)=>t.replace(uo,`$1${a}/$4`),aa=t=>{var a;return((a=t.match(uo))==null?void 0:a[2])||""},Le=(t,a)=>{a?window.localStorage.setItem(t,JSON.stringify({value:a})):po([t]),window.dispatchEvent(new Event("storage"))},ze=t=>{var n;const a=window.localStorage.getItem(t);if(a!==null)try{return(n=JSON.parse(a))==null?void 0:n.value}catch{return a}},po=t=>t.forEach(a=>window.localStorage.removeItem(a)),ei=t=>{const{serverURL:a}=ta(),n=ze("SERVER_URL"),r=window.location.href.replace(/\/(select\/)?(vmui)\/.*/,""),o=`${window.location.origin}${window.location.pathname.replace(/^\/vmui/,"")}`,s=window.location.href.replace(/\/(?:prometheus\/)?(?:graph|vmui)\/.*/,"/prometheus"),i=a||n||s;switch(Ut){case ot.victorialogs:return r;case ot.vmanomaly:return n||o;default:return t?ho(i,t):i}},ha=10,vo=25,go={table:100,chart:20,code:1e3},pa=[{id:"small",isDefault:!0,height:()=>window.innerHeight*.2},{id:"medium",height:()=>window.innerHeight*.4},{id:"large",height:()=>window.innerHeight*.8}],_o=["min","median","max"],De=(t,a)=>{const n=window.location.hash.split("?")[1],r=gn.parse(n,{ignoreQueryPrefix:!0});return ft(r,t,a||"")},fo=()=>{var n;const a=((n=(window.location.hash.split("?")[1]||"").match(/g\d+\.expr/g))==null?void 0:n.length)||1;return new Array(a>ha?ha:a).fill(1).map((r,o)=>De(`g${o}.expr`,""))};var ae=(t=>(t.yhat="yhat",t.yhatUpper="yhat_upper",t.yhatLower="yhat_lower",t.anomaly="vmui_anomalies_points",t.training="vmui_training_data",t.actual="actual",t.anomalyScore="anomaly_score",t))(ae||{}),_e=(t=>(t.table="table",t.chart="chart",t.code="code",t))(_e||{}),be=(t=>(t.emptyServer="Please enter Server URL",t.validServer="Please provide a valid Server URL",t.validQuery="Please enter a valid Query and execute it",t.traceNotFound="Not found the tracing information",t.emptyTitle="Please enter title",t.positiveNumber="Please enter positive number",t.validStep="Please enter a valid step",t.unknownType="Unknown server response format: must have 'errorType'",t))(be||{}),Qe=(t=>(t.system="system",t.light="light",t.dark="dark",t))(Qe||{}),Ae=(t=>(t.empty="empty",t.metricsql="metricsql",t.label="label",t.labelValue="labelValue",t))(Ae||{});const Xe=t=>getComputedStyle(document.documentElement).getPropertyValue(`--${t}`),Dt=(t,a)=>{document.documentElement.style.setProperty(`--${t}`,a)},va=()=>window.matchMedia("(prefers-color-scheme: dark)").matches,ti=t=>t===Qe.system&&va()||t===Qe.dark,Cn=t=>{let a;try{a=new URL(t)}catch{return!1}return a.protocol==="http:"||a.protocol==="https:"},bo=t=>t.replace(/\/$/,""),ai=(t,a)=>{if(Array.from(t.entries()).length!==Array.from(a.entries()).length)return!1;for(const[n,r]of t)if(a.get(n)!==r)return!1;return!0},ni=t=>{try{const a=t.match(/\/api\/v1\/[^?]+/);return a?a[0]:null}catch(a){return console.error("Invalid URL:",a),null}},Ar=De("g0.tenantID",""),ri={serverUrl:bo(ei(Ar)),tenantId:Ar,theme:ze("THEME")||Qe.system,isDarkTheme:null,flags:{},appConfig:{}};function oi(t,a){switch(a.type){case"SET_SERVER":return{...t,serverUrl:bo(a.payload)};case"SET_TENANT_ID":return{...t,tenantId:a.payload};case"SET_THEME":return Le("THEME",a.payload),{...t,theme:a.payload};case"SET_DARK_THEME":return{...t,isDarkTheme:ti(t.theme)};case"SET_FLAGS":return{...t,flags:a.payload};case"SET_APP_CONFIG":return{...t,appConfig:a.payload};default:throw new Error}}const Nn=pt({}),re=()=>Ee(Nn).state,Tt=()=>Ee(Nn).dispatch,si=Object.entries(ri).reduce((t,[a,n])=>({...t,[a]:De(a)||n}),{}),ii=({children:t})=>{const[a,n]=St(oi,si),r=D(()=>({state:a,dispatch:n}),[a,n]);return e(Nn.Provider,{value:r,children:t})},yt="YYYY-MM-DD",Ke="YYYY-MM-DD HH:mm:ss",ga="YYYY-MM-DD HH:mm:ss:SSS (Z)",kn="YYYY-MM-DD[T]HH:mm:ss",yo="YYYY-MM-DD_HHmmss",li=["Africa/Abidjan","Africa/Accra","Africa/Addis_Ababa","Africa/Algiers","Africa/Asmera","Africa/Bamako","Africa/Bangui","Africa/Banjul","Africa/Bissau","Africa/Blantyre","Africa/Brazzaville","Africa/Bujumbura","Africa/Cairo","Africa/Casablanca","Africa/Ceuta","Africa/Conakry","Africa/Dakar","Africa/Dar_es_Salaam","Africa/Djibouti","Africa/Douala","Africa/El_Aaiun","Africa/Freetown","Africa/Gaborone","Africa/Harare","Africa/Johannesburg","Africa/Juba","Africa/Kampala","Africa/Khartoum","Africa/Kigali","Africa/Kinshasa","Africa/Lagos","Africa/Libreville","Africa/Lome","Africa/Luanda","Africa/Lubumbashi","Africa/Lusaka","Africa/Malabo","Africa/Maputo","Africa/Maseru","Africa/Mbabane","Africa/Mogadishu","Africa/Monrovia","Africa/Nairobi","Africa/Ndjamena","Africa/Niamey","Africa/Nouakchott","Africa/Ouagadougou","Africa/Porto-Novo","Africa/Sao_Tome","Africa/Tripoli","Africa/Tunis","Africa/Windhoek","America/Adak","America/Anchorage","America/Anguilla","America/Antigua","America/Araguaina","America/Argentina/La_Rioja","America/Argentina/Rio_Gallegos","America/Argentina/Salta","America/Argentina/San_Juan","America/Argentina/San_Luis","America/Argentina/Tucuman","America/Argentina/Ushuaia","America/Aruba","America/Asuncion","America/Bahia","America/Bahia_Banderas","America/Barbados","America/Belem","America/Belize","America/Blanc-Sablon","America/Boa_Vista","America/Bogota","America/Boise","America/Buenos_Aires","America/Cambridge_Bay","America/Campo_Grande","America/Cancun","America/Caracas","America/Catamarca","America/Cayenne","America/Cayman","America/Chicago","America/Chihuahua","America/Coral_Harbour","America/Cordoba","America/Costa_Rica","America/Creston","America/Cuiaba","America/Curacao","America/Danmarkshavn","America/Dawson","America/Dawson_Creek","America/Denver","America/Detroit","America/Dominica","America/Edmonton","America/Eirunepe","America/El_Salvador","America/Fort_Nelson","America/Fortaleza","America/Glace_Bay","America/Godthab","America/Goose_Bay","America/Grand_Turk","America/Grenada","America/Guadeloupe","America/Guatemala","America/Guayaquil","America/Guyana","America/Halifax","America/Havana","America/Hermosillo","America/Indiana/Knox","America/Indiana/Marengo","America/Indiana/Petersburg","America/Indiana/Tell_City","America/Indiana/Vevay","America/Indiana/Vincennes","America/Indiana/Winamac","America/Indianapolis","America/Inuvik","America/Iqaluit","America/Jamaica","America/Jujuy","America/Juneau","America/Kentucky/Monticello","America/Kralendijk","America/La_Paz","America/Lima","America/Los_Angeles","America/Louisville","America/Lower_Princes","America/Maceio","America/Managua","America/Manaus","America/Marigot","America/Martinique","America/Matamoros","America/Mazatlan","America/Mendoza","America/Menominee","America/Merida","America/Metlakatla","America/Mexico_City","America/Miquelon","America/Moncton","America/Monterrey","America/Montevideo","America/Montreal","America/Montserrat","America/Nassau","America/New_York","America/Nipigon","America/Nome","America/Noronha","America/North_Dakota/Beulah","America/North_Dakota/Center","America/North_Dakota/New_Salem","America/Ojinaga","America/Panama","America/Pangnirtung","America/Paramaribo","America/Phoenix","America/Port-au-Prince","America/Port_of_Spain","America/Porto_Velho","America/Puerto_Rico","America/Punta_Arenas","America/Rainy_River","America/Rankin_Inlet","America/Recife","America/Regina","America/Resolute","America/Rio_Branco","America/Santa_Isabel","America/Santarem","America/Santiago","America/Santo_Domingo","America/Sao_Paulo","America/Scoresbysund","America/Sitka","America/St_Barthelemy","America/St_Johns","America/St_Kitts","America/St_Lucia","America/St_Thomas","America/St_Vincent","America/Swift_Current","America/Tegucigalpa","America/Thule","America/Thunder_Bay","America/Tijuana","America/Toronto","America/Tortola","America/Vancouver","America/Whitehorse","America/Winnipeg","America/Yakutat","America/Yellowknife","Antarctica/Casey","Antarctica/Davis","Antarctica/DumontDUrville","Antarctica/Macquarie","Antarctica/Mawson","Antarctica/McMurdo","Antarctica/Palmer","Antarctica/Rothera","Antarctica/Syowa","Antarctica/Troll","Antarctica/Vostok","Arctic/Longyearbyen","Asia/Aden","Asia/Almaty","Asia/Amman","Asia/Anadyr","Asia/Aqtau","Asia/Aqtobe","Asia/Ashgabat","Asia/Atyrau","Asia/Baghdad","Asia/Bahrain","Asia/Baku","Asia/Bangkok","Asia/Barnaul","Asia/Beirut","Asia/Bishkek","Asia/Brunei","Asia/Calcutta","Asia/Chita","Asia/Choibalsan","Asia/Colombo","Asia/Damascus","Asia/Dhaka","Asia/Dili","Asia/Dubai","Asia/Dushanbe","Asia/Famagusta","Asia/Gaza","Asia/Hebron","Asia/Hong_Kong","Asia/Hovd","Asia/Irkutsk","Asia/Jakarta","Asia/Jayapura","Asia/Jerusalem","Asia/Kabul","Asia/Kamchatka","Asia/Karachi","Asia/Katmandu","Asia/Khandyga","Asia/Krasnoyarsk","Asia/Kuala_Lumpur","Asia/Kuching","Asia/Kuwait","Asia/Macau","Asia/Magadan","Asia/Makassar","Asia/Manila","Asia/Muscat","Asia/Nicosia","Asia/Novokuznetsk","Asia/Novosibirsk","Asia/Omsk","Asia/Oral","Asia/Phnom_Penh","Asia/Pontianak","Asia/Pyongyang","Asia/Qatar","Asia/Qostanay","Asia/Qyzylorda","Asia/Rangoon","Asia/Riyadh","Asia/Saigon","Asia/Sakhalin","Asia/Samarkand","Asia/Seoul","Asia/Shanghai","Asia/Singapore","Asia/Srednekolymsk","Asia/Taipei","Asia/Tashkent","Asia/Tbilisi","Asia/Tehran","Asia/Thimphu","Asia/Tokyo","Asia/Tomsk","Asia/Ulaanbaatar","Asia/Urumqi","Asia/Ust-Nera","Asia/Vientiane","Asia/Vladivostok","Asia/Yakutsk","Asia/Yekaterinburg","Asia/Yerevan","Atlantic/Azores","Atlantic/Bermuda","Atlantic/Canary","Atlantic/Cape_Verde","Atlantic/Faeroe","Atlantic/Madeira","Atlantic/Reykjavik","Atlantic/South_Georgia","Atlantic/St_Helena","Atlantic/Stanley","Australia/Adelaide","Australia/Brisbane","Australia/Broken_Hill","Australia/Currie","Australia/Darwin","Australia/Eucla","Australia/Hobart","Australia/Lindeman","Australia/Lord_Howe","Australia/Melbourne","Australia/Perth","Australia/Sydney","Europe/Amsterdam","Europe/Andorra","Europe/Astrakhan","Europe/Athens","Europe/Belgrade","Europe/Berlin","Europe/Bratislava","Europe/Brussels","Europe/Bucharest","Europe/Budapest","Europe/Busingen","Europe/Chisinau","Europe/Copenhagen","Europe/Dublin","Europe/Gibraltar","Europe/Guernsey","Europe/Helsinki","Europe/Isle_of_Man","Europe/Istanbul","Europe/Jersey","Europe/Kaliningrad","Europe/Kiev","Europe/Kirov","Europe/Lisbon","Europe/Ljubljana","Europe/London","Europe/Luxembourg","Europe/Madrid","Europe/Malta","Europe/Mariehamn","Europe/Minsk","Europe/Monaco","Europe/Moscow","Europe/Oslo","Europe/Paris","Europe/Podgorica","Europe/Prague","Europe/Riga","Europe/Rome","Europe/Samara","Europe/San_Marino","Europe/Sarajevo","Europe/Saratov","Europe/Simferopol","Europe/Skopje","Europe/Sofia","Europe/Stockholm","Europe/Tallinn","Europe/Tirane","Europe/Ulyanovsk","Europe/Uzhgorod","Europe/Vaduz","Europe/Vatican","Europe/Vienna","Europe/Vilnius","Europe/Volgograd","Europe/Warsaw","Europe/Zagreb","Europe/Zaporozhye","Europe/Zurich","Indian/Antananarivo","Indian/Chagos","Indian/Christmas","Indian/Cocos","Indian/Comoro","Indian/Kerguelen","Indian/Mahe","Indian/Maldives","Indian/Mauritius","Indian/Mayotte","Indian/Reunion","Pacific/Apia","Pacific/Auckland","Pacific/Bougainville","Pacific/Chatham","Pacific/Easter","Pacific/Efate","Pacific/Enderbury","Pacific/Fakaofo","Pacific/Fiji","Pacific/Funafuti","Pacific/Galapagos","Pacific/Gambier","Pacific/Guadalcanal","Pacific/Guam","Pacific/Honolulu","Pacific/Johnston","Pacific/Kiritimati","Pacific/Kosrae","Pacific/Kwajalein","Pacific/Majuro","Pacific/Marquesas","Pacific/Midway","Pacific/Nauru","Pacific/Niue","Pacific/Norfolk","Pacific/Noumea","Pacific/Pago_Pago","Pacific/Palau","Pacific/Pitcairn","Pacific/Ponape","Pacific/Port_Moresby","Pacific/Rarotonga","Pacific/Saipan","Pacific/Tahiti","Pacific/Tarawa","Pacific/Tongatapu","Pacific/Truk","Pacific/Wake","Pacific/Wallis"],ci=window.innerWidth/4,di=window.innerWidth/40,xr={min:1,max:1578e8},Lr=Intl.supportedValuesOf,mi=Lr?Lr("timeZone"):li,Sn=[{long:"years",short:"y",possible:"year"},{long:"weeks",short:"w",possible:"week"},{long:"days",short:"d",possible:"day"},{long:"hours",short:"h",possible:"hour"},{long:"minutes",short:"m",possible:"min"},{long:"seconds",short:"s",possible:"sec"},{long:"milliseconds",short:"ms",possible:"millisecond"}],ui=Sn.map(t=>t.short),da=t=>Math.round(t*1e3)/1e3,Tn=t=>xa(q.duration(t,"seconds").asMilliseconds()),cn=t=>{let a=da(t);const n=Math.round(t);return t>=100&&(a=n-n%10),t<100&&t>=10&&(a=n-n%5),t<10&&t>=1&&(a=n),t<1&&t>.01&&(a=Math.round(t*40)/40),Tn(a||.001).replace(/\s/g,"")},wo=t=>{const a=t.match(/\d+/g),n=t.match(/[a-zA-Z]+/g);if(n&&a&&ui.includes(n[0]))return{[n[0]]:a[0]}},An=t=>{const a=Sn.map(s=>s.short).join("|"),n=new RegExp(`\\d+(\\.\\d+)?[${a}]+`,"g"),o=(t.match(n)||[]).reduce((s,i)=>{const c=wo(i);return c?{...s,...c}:{...s}},{});return q.duration(o).asSeconds()},hi=[_e.table,_e.code],na=(t,a,n)=>n&&hi.includes(n)?cn(t):cn(t/(a?di:ci)),_t=(t,a)=>{const n=(a||q().toDate()).valueOf()/1e3,r=An(t);return{start:n-r,end:n,step:na(r),date:Co(a||q().toDate())}},pi=t=>q(t).utcOffset(0,!0).toDate(),Co=t=>q.tz(t).utc().format(kn),Pt=t=>q.tz(t).format(kn),vi=()=>q().utc().format(kn),xa=t=>{const a=Math.floor(t%1e3),n=Math.floor(t/1e3%60),r=Math.floor(t/1e3/60%60),o=Math.floor(t/1e3/3600%24),s=Math.floor(t/(1e3*60*60*24)),i=["d","h","m","s","ms"];return[s,o,r,n,a].map((l,m)=>l?`${l}${i[m]}`:"").filter(l=>l).join("")},gi=t=>{const a=t.to.valueOf()-t.from.valueOf();return xa(a)},Ye=t=>{const a=q(t*1e3);return a.isValid()?a.toDate():new Date},_i=()=>q().tz().subtract(1,"day").endOf("day").toDate(),fi=()=>q().tz().endOf("day").toDate(),Jt=[{title:"Last 5 minutes",duration:"5m",isDefault:mo},{title:"Last 15 minutes",duration:"15m"},{title:"Last 30 minutes",duration:"30m",isDefault:!1},{title:"Last 1 hour",duration:"1h"},{title:"Last 3 hours",duration:"3h"},{title:"Last 6 hours",duration:"6h"},{title:"Last 12 hours",duration:"12h"},{title:"Last 24 hours",duration:"24h"},{title:"Last 2 days",duration:"2d"},{title:"Last 7 days",duration:"7d"},{title:"Last 30 days",duration:"30d"},{title:"Last 90 days",duration:"90d"},{title:"Last 180 days",duration:"180d"},{title:"Last 1 year",duration:"1y"},{title:"Yesterday",duration:"1d",until:_i},{title:"Today",duration:"1d",until:fi}].map(t=>({id:t.title.replace(/\s/g,"_").toLocaleLowerCase(),until:t.until?t.until:()=>q().tz().toDate(),...t})),xn=({relativeTimeId:t,defaultDuration:a,defaultEndInput:n})=>{var i;const r=(i=Jt.find(c=>c.isDefault))==null?void 0:i.id,o=t||De("g0.relative_time",r),s=Jt.find(c=>c.id===o);return{relativeTimeId:s?o:"none",duration:s?s.duration:a,endInput:s?s.until():n}},Wt=t=>`UTC${q().tz(t).format("Z")}`,Er=(t="")=>{const a=new RegExp(t,"i");return mi.reduce((n,r)=>{const o=(r.match(/^(.*?)\//)||[])[1]||"unknown",s=Wt(r),i=s.replace(/UTC|0/,""),c=r.replace(/[/_]/g," "),l={region:r,utc:s,search:`${r} ${s} ${c} ${i}`},m=!t||t&&a.test(l.search);return m&&n[o]?n[o].push(l):m&&(n[o]=[l]),n},{})},No=t=>{q.tz.setDefault(t)},bi=t=>{try{return q().tz(t),!0}catch{return!1}},ko=()=>{const t=q.tz.guess(),a=bi(t);return{isValid:a,title:a?`Browser Time (${t})`:"Browser timezone (UTC)",region:a?t:"UTC"}},So=ze("TIMEZONE")||ko().region;No(So);const To=()=>{const t=De("g0.range_input"),{duration:a,endInput:n,relativeTimeId:r}=xn({defaultDuration:t||"1h",defaultEndInput:pi(De("g0.end_input",vi())),relativeTimeId:t?De("g0.relative_time","none"):void 0});return{duration:a,period:_t(a,n),relativeTime:r}},yi={...To(),timezone:So};function wi(t,a){switch(a.type){case"SET_TIME_STATE":return{...t,...a.payload};case"SET_DURATION":return{...t,duration:a.payload,period:_t(a.payload,Ye(t.period.end)),relativeTime:"none"};case"SET_RELATIVE_TIME":return{...t,duration:a.payload.duration,period:_t(a.payload.duration,a.payload.until),relativeTime:a.payload.id};case"SET_PERIOD":const n=gi(a.payload);return{...t,duration:n,period:_t(n,a.payload.to),relativeTime:"none"};case"RUN_QUERY":const{duration:r,endInput:o}=xn({relativeTimeId:t.relativeTime,defaultDuration:t.duration,defaultEndInput:Ye(t.period.end)});return{...t,period:_t(r,o)};case"RUN_QUERY_TO_NOW":return{...t,period:_t(t.duration)};case"SET_TIMEZONE":return No(a.payload),Le("TIMEZONE",a.payload),t.defaultTimezone&&Le("DISABLED_DEFAULT_TIMEZONE",a.payload!==t.defaultTimezone),{...t,timezone:a.payload};case"SET_DEFAULT_TIMEZONE":return{...t,defaultTimezone:a.payload};default:throw new Error}}const Ln=pt({}),he=()=>Ee(Ln).state,Fe=()=>Ee(Ln).dispatch,Ci=({children:t})=>{const[a,n]=St(wi,yi),r=D(()=>({state:a,dispatch:n}),[a,n]);return e(Ln.Provider,{value:r,children:t})},It=t=>{const a=ze(t);return a?JSON.parse(a):[]},Ni=t=>{const a=t.map(s=>s.values[s.index]),n=It("QUERY_HISTORY");n[0]||(n[0]=[]);const r=n[0],o=vo*ha;a.forEach(s=>{!r.includes(s)&&s&&r.unshift(s),r.length>o&&r.shift()}),Le("QUERY_HISTORY",JSON.stringify(n))},Ct={displayResults:50,queryLimit:1e3,cacheLimit:1e3};class ki{constructor(){Je(this,"maxSize");Je(this,"map");this.maxSize=Ct.cacheLimit,this.map=new Map}get(a){for(const[n,r]of this.map){const o=JSON.parse(n),s=o.start===a.start&&o.end===a.end,i=o.type===a.type,c=a.value&&o.value&&a.value.includes(o.value),l=o.match===a.match||c,m=r.length<Ct.queryLimit;if(l&&s&&i&&m)return r}return this.map.get(JSON.stringify(a))}put(a,n){if(this.map.size>=this.maxSize){const r=this.map.keys().next().value;r&&this.map.delete(r)}this.map.set(JSON.stringify(a),n)}}const Mr=fo(),Si={query:Mr,queryHistory:Mr.map(t=>({index:0,values:[t]})),autocomplete:ze("AUTOCOMPLETE")||!1,autocompleteQuick:!1,autocompleteCache:new ki,metricsQLFunctions:[]};function Ti(t,a){switch(a.type){case"SET_QUERY":return{...t,query:a.payload.map(n=>n)};case"SET_QUERY_HISTORY":return Ni(a.payload),{...t,queryHistory:a.payload};case"SET_QUERY_HISTORY_BY_INDEX":return t.queryHistory.splice(a.payload.queryNumber,1,a.payload.value),{...t,queryHistory:t.queryHistory};case"TOGGLE_AUTOCOMPLETE":return Le("AUTOCOMPLETE",!t.autocomplete),{...t,autocomplete:!t.autocomplete};case"SET_AUTOCOMPLETE_QUICK":return{...t,autocompleteQuick:a.payload};case"SET_AUTOCOMPLETE_CACHE":return t.autocompleteCache.put(a.payload.key,a.payload.value),{...t};case"SET_METRICSQL_FUNCTIONS":return{...t,metricsQLFunctions:a.payload};default:throw new Error}}const En=pt({}),ke=()=>Ee(En).state,qt=()=>Ee(En).dispatch,Ai=({children:t})=>{const[a,n]=St(Ti,Si),r=D(()=>({state:a,dispatch:n}),[a,n]);return e(En.Provider,{value:r,children:t})},Ao=()=>e("svg",{viewBox:"0 0 74 24",fill:"currentColor",children:e("path",{d:"M6.12 10.48c.36.28.8.43 1.26.43h.05c.48 0 .96-.19 1.25-.44 1.5-1.28 5.88-5.29 5.88-5.29C15.73 4.1 12.46 3.01 7.43 3h-.06C2.33 3-.93 4.1.24 5.18c0 0 4.37 4 5.88 5.3Zm2.56 2.16c-.36.28-.8.44-1.26.45h-.04c-.46 0-.9-.17-1.26-.45-1.04-.88-4.74-4.22-6.12-5.5v1.94c0 .21.08.5.22.63l.07.06c1.05.96 4.55 4.16 5.83 5.25.36.28.8.43 1.26.44h.04c.49-.02.96-.2 1.26-.44 1.3-1.11 4.94-4.45 5.88-5.31.15-.14.23-.42.23-.63V7.15a454.94 454.94 0 0 1-6.11 5.5Zm-1.26 4.99c.46 0 .9-.16 1.26-.44a454.4 454.4 0 0 0 6.1-5.5v1.94c0 .2-.07.48-.22.62-.94.87-4.57 4.2-5.88 5.3-.3.26-.77.44-1.26.45h-.04c-.46 0-.9-.16-1.26-.44-1.2-1.02-4.38-3.92-5.62-5.06l-.28-.25c-.14-.14-.22-.42-.22-.62v-1.94c1.38 1.26 5.08 4.6 6.12 5.5.36.28.8.43 1.26.44h.04ZM35 5l-5.84 14.46h-2.43L20.89 5h2.16a.9.9 0 0 1 .9.61l3.41 8.82a18.8 18.8 0 0 1 .62 2.02 19.44 19.44 0 0 1 .57-2.02l3.39-8.82c.05-.15.16-.3.31-.42a.9.9 0 0 1 .58-.19H35Zm17.18 0v14.46H49.8v-9.34c0-.37.02-.78.06-1.21l-4.37 8.21c-.21.4-.53.59-.95.59h-.38c-.43 0-.75-.2-.95-.59L38.8 8.88a22.96 22.96 0 0 1 .07 1.24v9.34H36.5V5h2.03l.3.01c.1 0 .17.02.24.05.07.03.13.07.19.13a1 1 0 0 1 .17.24l4.33 8.03a16.97 16.97 0 0 1 .6 1.36 14.34 14.34 0 0 1 .6-1.38l4.28-8.01c.05-.1.1-.18.17-.24.06-.06.12-.1.19-.13a.9.9 0 0 1 .24-.05l.3-.01h2.04Zm8.88 13.73a4.5 4.5 0 0 0 1.82-.35 3.96 3.96 0 0 0 2.22-2.47c.2-.57.3-1.19.3-1.85V5.31h1.02v8.75c0 .78-.12 1.51-.37 2.19a4.88 4.88 0 0 1-2.76 2.95c-.66.29-1.4.43-2.23.43-.82 0-1.57-.14-2.24-.43a5.01 5.01 0 0 1-2.75-2.95 6.37 6.37 0 0 1-.37-2.19V5.31h1.03v8.74c0 .66.1 1.28.3 1.85a3.98 3.98 0 0 0 2.21 2.47c.53.24 1.14.36 1.82.36Zm10.38.73h-1.03V5.31h1.03v14.15Z"})}),xo=()=>e("svg",{viewBox:"0 0 85 38",fill:"currentColor",children:[e("path",{d:"M11.12 10.48c.36.28.8.43 1.26.43h.05c.48 0 .96-.19 1.25-.44 1.5-1.28 5.88-5.29 5.88-5.29 1.17-1.09-2.1-2.17-7.13-2.18h-.06c-5.04 0-8.3 1.1-7.13 2.18 0 0 4.37 4 5.88 5.3Zm2.56 2.16c-.36.28-.8.44-1.26.45h-.04c-.46 0-.9-.17-1.26-.45-1.04-.88-4.74-4.22-6.12-5.5v1.94c0 .21.08.5.22.63l.07.06c1.05.96 4.55 4.16 5.83 5.25.36.28.8.43 1.26.44h.04c.49-.02.96-.2 1.26-.44 1.3-1.11 4.94-4.45 5.88-5.31.15-.14.23-.42.23-.63V7.15a455.13 455.13 0 0 1-6.11 5.5Zm-1.26 4.99c.46 0 .9-.16 1.26-.44 2.05-1.82 4.09-3.65 6.1-5.5v1.94c0 .2-.07.48-.22.62-.94.87-4.57 4.2-5.88 5.3-.3.26-.77.44-1.26.45h-.04c-.46 0-.9-.16-1.26-.44-1.2-1.02-4.38-3.92-5.62-5.06l-.28-.25c-.14-.14-.22-.42-.22-.62v-1.94c1.38 1.26 5.08 4.6 6.12 5.5.36.28.8.43 1.26.44h.04ZM40 5l-5.84 14.46h-2.43L25.89 5h2.16a.9.9 0 0 1 .9.61l3.41 8.82a18.8 18.8 0 0 1 .62 2.02 19.44 19.44 0 0 1 .57-2.02l3.39-8.82c.05-.15.16-.3.31-.42a.9.9 0 0 1 .58-.19H40Zm17.18 0v14.46H54.8v-9.34c0-.37.02-.78.06-1.21l-4.37 8.21c-.21.4-.53.59-.95.59h-.38c-.43 0-.75-.2-.95-.59L43.8 8.88a22.96 22.96 0 0 1 .07 1.24v9.34H41.5V5h2.03l.3.01c.1 0 .17.02.24.05.07.03.13.07.19.13a1 1 0 0 1 .17.24l4.33 8.03a16.97 16.97 0 0 1 .6 1.36 14.34 14.34 0 0 1 .6-1.38l4.28-8.01c.05-.1.1-.18.17-.24.06-.06.12-.1.19-.13a.9.9 0 0 1 .24-.05l.3-.01h2.04Zm8.88 13.73a4.5 4.5 0 0 0 1.82-.35 3.96 3.96 0 0 0 2.22-2.47c.2-.57.3-1.19.3-1.85V5.31h1.02v8.75c0 .78-.12 1.51-.37 2.19a4.88 4.88 0 0 1-2.76 2.95c-.66.29-1.4.43-2.23.43-.82 0-1.57-.14-2.24-.43a5.01 5.01 0 0 1-2.75-2.95 6.37 6.37 0 0 1-.37-2.19V5.31h1.03v8.74c0 .66.1 1.28.3 1.85a3.98 3.98 0 0 0 2.21 2.47c.53.24 1.14.36 1.82.36Zm10.38.73h-1.03V5.31h1.03v14.15ZM1.73 36v-5.17l-.67-.07a.6.6 0 0 1-.21-.1.23.23 0 0 1-.08-.18v-.44h.96v-.59c0-.34.05-.65.14-.92a1.79 1.79 0 0 1 1.08-1.11 2.45 2.45 0 0 1 1.62-.02l-.03.53c0 .1-.06.15-.16.16H4c-.18 0-.35.03-.5.08a.95.95 0 0 0-.39.23c-.1.11-.19.25-.25.43-.05.18-.08.4-.08.65v.56h1.75v.78H2.8V36H1.73Zm6.17-6.17c.45 0 .85.07 1.2.22a2.57 2.57 0 0 1 1.5 1.62c.13.38.2.81.2 1.29s-.07.91-.2 1.3a2.57 2.57 0 0 1-1.49 1.61c-.36.14-.76.21-1.2.21-.45 0-.86-.07-1.22-.21a2.57 2.57 0 0 1-1.5-1.62c-.12-.38-.19-.81-.19-1.3 0-.47.07-.9.2-1.28a2.57 2.57 0 0 1 1.5-1.62c.35-.15.76-.22 1.2-.22Zm0 5.42c.6 0 1.05-.2 1.35-.6.3-.4.44-.97.44-1.69s-.15-1.28-.44-1.69c-.3-.4-.75-.6-1.35-.6-.3 0-.57.05-.8.15-.22.1-.4.26-.56.45-.15.2-.26.44-.33.73-.08.28-.11.6-.11.96 0 .72.15 1.29.44 1.69.3.4.76.6 1.36.6Zm5.26-4.11c.2-.42.43-.74.71-.97.28-.24.62-.36 1.03-.36.13 0 .25.02.36.05.12.02.23.07.32.13l-.08.8c-.02.1-.08.15-.18.15l-.24-.04a1.7 1.7 0 0 0-.88.05c-.15.05-.29.14-.4.25-.12.1-.23.24-.32.4-.1.17-.18.35-.26.56V36h-1.07v-6.08h.61c.12 0 .2.02.24.07.05.04.08.12.1.23l.06.92Zm13.73-3.82L23.39 36h-1.46l-3.5-8.68h1.29a.54.54 0 0 1 .54.37l2.04 5.3a11.31 11.31 0 0 1 .37 1.21 11.65 11.65 0 0 1 .35-1.22l2.03-5.29c.03-.1.1-.18.19-.25.1-.08.21-.12.35-.12h1.3Zm2.2 2.52V36H27.6v-6.16h1.49Zm.2-1.79c0 .13-.02.25-.08.36a1 1 0 0 1-.51.5.96.96 0 0 1-.73 0 1.02 1.02 0 0 1-.5-.5.96.96 0 0 1 0-.73.93.93 0 0 1 .86-.58.9.9 0 0 1 .37.08c.12.05.22.11.3.2a.94.94 0 0 1 .3.67Zm5.72 3.1a.68.68 0 0 1-.13.13c-.04.03-.1.05-.18.05a.42.42 0 0 1-.22-.07 3.95 3.95 0 0 0-.62-.31c-.14-.05-.3-.07-.51-.07-.26 0-.5.04-.69.14-.2.1-.36.23-.49.4-.13.18-.22.4-.29.64-.06.25-.1.53-.1.85 0 .33.04.62.1.88.08.25.18.47.32.64.13.18.29.3.48.4.18.09.4.13.63.13a1.6 1.6 0 0 0 .94-.27l.26-.2a.4.4 0 0 1 .25-.09.3.3 0 0 1 .27.14l.43.54a2.76 2.76 0 0 1-1.77.96c-.22.03-.43.05-.65.05a2.57 2.57 0 0 1-1.96-.83c-.25-.28-.45-.6-.6-1-.14-.4-.21-.85-.21-1.35 0-.45.06-.87.2-1.25a2.61 2.61 0 0 1 1.51-1.67c.37-.16.8-.24 1.28-.24.46 0 .86.07 1.2.22.35.15.66.36.94.64l-.4.54Zm3.43 4.95c-.54 0-.95-.15-1.24-.45-.28-.3-.42-.73-.42-1.26v-3.44h-.63a.29.29 0 0 1-.2-.07c-.06-.06-.09-.13-.09-.24v-.59l.99-.16.31-1.68a.33.33 0 0 1 .12-.18.34.34 0 0 1 .21-.07h.77v1.94h1.64v1.05h-1.64v3.34c0 .2.05.34.14.45.1.1.22.16.39.16a.73.73 0 0 0 .39-.1l.12-.07a.2.2 0 0 1 .11-.03c.05 0 .08.01.11.03l.09.1.44.72c-.21.18-.46.32-.74.4-.28.1-.57.15-.87.15Zm5.09-6.35c.46 0 .87.07 1.24.22a2.7 2.7 0 0 1 1.58 1.63c.14.39.22.83.22 1.31 0 .49-.08.93-.22 1.32-.14.4-.35.73-.62 1-.26.28-.58.49-.96.64-.37.15-.78.22-1.24.22a3.4 3.4 0 0 1-1.25-.22 2.71 2.71 0 0 1-1.59-1.64 3.8 3.8 0 0 1-.21-1.32c0-.48.07-.92.21-1.31a2.75 2.75 0 0 1 1.58-1.63c.38-.15.8-.22 1.26-.22Zm0 5.2c.51 0 .89-.17 1.13-.52.25-.34.38-.84.38-1.5a2.6 2.6 0 0 0-.38-1.53c-.24-.34-.62-.52-1.13-.52-.52 0-.9.18-1.16.53-.25.35-.37.85-.37 1.51s.12 1.17.37 1.51c.25.35.64.52 1.16.52Zm5.56-4.04c.2-.37.42-.65.69-.86.26-.21.57-.32.94-.32.28 0 .5.06.68.19l-.1 1.1a.3.3 0 0 1-.09.16.24.24 0 0 1-.15.04 1.8 1.8 0 0 1-.27-.03 2.01 2.01 0 0 0-.34-.03c-.16 0-.3.03-.44.08a1.1 1.1 0 0 0-.34.2c-.1.1-.2.2-.27.33-.08.13-.15.27-.22.44V36H47.7v-6.16h.87c.15 0 .26.03.31.09.06.05.1.15.13.29l.09.7Zm4.62-1.07V36h-1.49v-6.16h1.49Zm.2-1.79c0 .13-.02.25-.07.36a1 1 0 0 1-.51.5.96.96 0 0 1-.74 0 1.02 1.02 0 0 1-.5-.5.96.96 0 0 1 0-.73.93.93 0 0 1 .86-.58.9.9 0 0 1 .38.08c.11.05.21.11.3.2a.94.94 0 0 1 .28.67Zm4.56 5.32a7.8 7.8 0 0 0-1.08.12c-.29.05-.52.12-.7.2a.92.92 0 0 0-.38.3.64.64 0 0 0-.11.36c0 .26.07.45.23.56.15.11.35.17.6.17.3 0 .57-.06.79-.17.22-.1.44-.28.65-.5v-1.04Zm-3.4-2.67c.71-.65 1.57-.97 2.56-.97.36 0 .68.06.97.18a1.99 1.99 0 0 1 1.16 1.24c.1.3.16.61.16.96V36h-.67a.7.7 0 0 1-.33-.06c-.07-.04-.13-.13-.18-.26l-.13-.44c-.16.14-.3.26-.46.37a2.8 2.8 0 0 1-.97.43 2.77 2.77 0 0 1-1.32-.05 1.62 1.62 0 0 1-.57-.31 1.41 1.41 0 0 1-.38-.53 1.85 1.85 0 0 1-.05-1.18c.05-.16.14-.3.25-.45.12-.14.28-.27.46-.4a3 3 0 0 1 .7-.32 9.19 9.19 0 0 1 2.2-.33v-.36c0-.41-.09-.71-.26-.91-.18-.2-.43-.3-.76-.3a1.84 1.84 0 0 0-1.02.28l-.33.18c-.1.06-.2.09-.32.09-.1 0-.2-.03-.27-.08a.72.72 0 0 1-.17-.2l-.26-.47Zm11.49 4.32V36h-4.88v-8.6h1.16v7.62h3.72Zm3.16-5.2c.44 0 .84.08 1.2.23a2.57 2.57 0 0 1 1.49 1.62c.13.38.2.81.2 1.29s-.07.91-.2 1.3a2.57 2.57 0 0 1-1.49 1.61c-.36.14-.76.21-1.2.21-.45 0-.85-.07-1.21-.21a2.57 2.57 0 0 1-1.5-1.62c-.13-.38-.2-.81-.2-1.3 0-.47.07-.9.2-1.28.14-.39.33-.72.59-1 .25-.26.55-.47.9-.62.37-.15.77-.22 1.22-.22Zm0 5.43c.6 0 1.05-.2 1.34-.6.3-.4.45-.97.45-1.69s-.15-1.28-.45-1.69c-.3-.4-.74-.6-1.34-.6-.3 0-.57.05-.8.15-.22.1-.4.26-.56.45-.15.2-.26.44-.34.73-.07.28-.1.6-.1.96 0 .72.14 1.29.44 1.69.3.4.75.6 1.36.6Zm6.33-2.22c.22 0 .4-.03.57-.09.16-.06.3-.14.41-.25.12-.11.2-.24.26-.39.05-.15.08-.31.08-.5 0-.37-.11-.66-.34-.88-.23-.22-.55-.33-.98-.33-.43 0-.76.1-.99.33-.22.22-.34.51-.34.89 0 .18.03.34.09.5a1.1 1.1 0 0 0 .67.63c.16.06.35.09.57.09Zm1.93 3.3a.51.51 0 0 0-.13-.36.84.84 0 0 0-.34-.22 8.57 8.57 0 0 0-1.73-.2 7.5 7.5 0 0 1-.62-.05c-.23.1-.41.23-.56.4a.8.8 0 0 0-.1.92c.07.12.18.22.32.3.14.1.32.16.54.21a3.5 3.5 0 0 0 1.55 0c.23-.05.42-.12.57-.22.16-.1.29-.21.37-.34a.8.8 0 0 0 .13-.44Zm1.08-6.17v.4c0 .13-.08.21-.25.25l-.69.09c.14.26.2.56.2.88a1.86 1.86 0 0 1-1.36 1.82 3.07 3.07 0 0 1-1.72.04c-.12.08-.22.16-.29.25a.44.44 0 0 0-.1.27c0 .15.06.26.17.33.12.08.28.13.47.16a5 5 0 0 0 .66.06 16.56 16.56 0 0 1 1.5.13c.26.05.48.12.67.22.19.1.34.24.46.41.12.18.18.4.18.69 0 .26-.07.5-.2.75s-.31.46-.56.65c-.24.2-.54.34-.9.46a4.57 4.57 0 0 1-2.36.04c-.33-.09-.6-.2-.82-.36a1.56 1.56 0 0 1-.5-.51c-.1-.2-.16-.4-.16-.6 0-.3.1-.56.28-.77.19-.2.45-.37.77-.5a1.15 1.15 0 0 1-.43-.32.88.88 0 0 1-.15-.54c0-.09.01-.18.04-.27.04-.1.08-.2.15-.28a1.55 1.55 0 0 1 .58-.5c-.3-.16-.53-.39-.7-.66-.17-.28-.25-.6-.25-.97 0-.3.05-.57.16-.8.12-.25.28-.46.48-.63.2-.17.45-.3.73-.4a3 3 0 0 1 2.3.21h1.64Zm4.65.76a.24.24 0 0 1-.23.14.42.42 0 0 1-.2-.07 3.59 3.59 0 0 0-.67-.3 1.8 1.8 0 0 0-1.03 0c-.14.05-.27.11-.37.2a.87.87 0 0 0-.23.27.75.75 0 0 0-.08.35c0 .15.04.28.13.39.1.1.21.19.36.27.15.07.32.14.5.2a13.63 13.63 0 0 1 1.16.4c.2.08.36.18.5.3a1.33 1.33 0 0 1 .5 1.07 2 2 0 0 1-.15.78c-.1.24-.25.44-.45.62-.2.17-.43.3-.72.4a3.1 3.1 0 0 1-2.14-.05 2.97 2.97 0 0 1-.87-.53l.25-.41c.04-.05.07-.1.12-.12a.3.3 0 0 1 .17-.04.4.4 0 0 1 .22.08l.3.19a1.91 1.91 0 0 0 1.03.27c.2 0 .38-.03.54-.08.16-.06.29-.13.4-.22a.96.96 0 0 0 .3-.7c0-.17-.05-.31-.14-.42-.09-.11-.2-.2-.36-.28a2.6 2.6 0 0 0-.5-.2l-.59-.19c-.2-.06-.39-.14-.58-.22a2.14 2.14 0 0 1-.5-.3 1.45 1.45 0 0 1-.36-.46c-.1-.19-.14-.41-.14-.67a1.6 1.6 0 0 1 .57-1.23c.18-.16.4-.3.68-.39.26-.1.57-.14.91-.14a2.84 2.84 0 0 1 1.9.7l-.23.4Z"}),e("defs",{children:e("path",{d:"M0 0h85v38H0z"})})]}),Lo=()=>e("svg",{viewBox:"0 0 85 38",fill:"currentColor",children:e("path",{d:"M11.118 10.476c.36.28.801.433 1.257.436h.052c.48-.007.961-.192 1.25-.444 1.509-1.279 5.88-5.287 5.88-5.287 1.168-1.087-2.093-2.174-7.13-2.181h-.06c-5.036.007-8.298 1.094-7.13 2.181 0 0 4.372 4.008 5.88 5.295zm2.559 2.166c-.359.283-.801.439-1.258.444h-.044a2.071 2.071 0 0 1-1.257-.444C10.082 11.755 6.384 8.42 5 7.148v1.93c0 .215.081.496.222.629l.07.064c1.045.955 4.546 4.154 5.825 5.245.358.283.8.438 1.257.444h.044c.489-.015.962-.2 1.258-.444 1.309-1.11 4.948-4.444 5.887-5.31.148-.132.222-.413.222-.628v-1.93a455.127 455.127 0 0 1-6.11 5.494zm-1.258 4.984a2.071 2.071 0 0 0 1.258-.436c2.053-1.815 4.09-3.65 6.11-5.502v1.938c0 .207-.075.488-.223.621-.94.873-4.578 4.2-5.887 5.31-.296.25-.77.436-1.258.443h-.044a2.071 2.071 0 0 1-1.257-.436c-1.204-1.027-4.376-3.928-5.616-5.062l-.28-.255c-.14-.133-.221-.414-.221-.621v-1.938c1.383 1.265 5.081 4.607 6.117 5.495.358.282.8.438 1.257.443h.044zM40 5l-5.84 14.46h-2.43L25.89 5h2.16c.233 0 .423.057.57.17.146.113.256.26.33.44l3.41 8.82c.113.287.22.603.32.95.106.34.206.697.3 1.07.08-.373.166-.73.26-1.07a8.84 8.84 0 0 1 .31-.95l3.39-8.82a.959.959 0 0 1 .31-.42.906.906 0 0 1 .58-.19H40zm17.176 0v14.46h-2.37v-9.34c0-.373.02-.777.06-1.21l-4.37 8.21c-.206.393-.523.59-.95.59h-.38c-.426 0-.743-.197-.95-.59l-4.42-8.24c.02.22.037.437.05.65.014.213.02.41.02.59v9.34h-2.37V5h2.03c.12 0 .224.003.31.01a.778.778 0 0 1 .23.05c.074.027.137.07.19.13.06.06.117.14.17.24l4.33 8.03c.114.213.217.433.31.66.1.227.197.46.29.7.094-.247.19-.483.29-.71.1-.233.207-.457.32-.67l4.27-8.01c.054-.1.11-.18.17-.24a.57.57 0 0 1 .19-.13.903.903 0 0 1 .24-.05c.087-.007.19-.01.31-.01h2.03zm8.887 13.73c.68 0 1.286-.117 1.82-.35.54-.24.996-.57 1.37-.99a4.28 4.28 0 0 0 .85-1.48c.2-.573.3-1.19.3-1.85V5.31h1.02v8.75c0 .78-.124 1.51-.37 2.19a5.248 5.248 0 0 1-1.07 1.77c-.46.5-1.024.893-1.69 1.18-.66.287-1.404.43-2.23.43-.827 0-1.574-.143-2.24-.43a5.012 5.012 0 0 1-1.69-1.18 5.33 5.33 0 0 1-1.06-1.77 6.373 6.373 0 0 1-.37-2.19V5.31h1.03v8.74c0 .66.096 1.277.29 1.85.2.567.483 1.06.85 1.48.373.42.826.75 1.36.99.54.24 1.15.36 1.83.36zm10.38.73h-1.03V5.31h1.03v14.15zM4.242 35v-5.166l-.672-.078a.595.595 0 0 1-.21-.09.23.23 0 0 1-.078-.186v-.438h.96v-.588c0-.348.048-.656.144-.924.1-.272.24-.5.42-.684a1.79 1.79 0 0 1 .66-.426c.256-.096.544-.144.864-.144.272 0 .522.04.75.12l-.024.534c-.008.096-.062.148-.162.156a4.947 4.947 0 0 1-.39.012c-.184 0-.352.024-.504.072a.949.949 0 0 0-.384.234c-.108.108-.192.25-.252.426a2.184 2.184 0 0 0-.084.654v.558h1.752v.774H5.316V35H4.242zM10.416 28.826a3.1 3.1 0 0 1 1.2.222c.356.148.66.358.912.63s.444.602.576.99c.136.384.204.814.204 1.29 0 .48-.068.912-.204 1.296a2.735 2.735 0 0 1-.576.984 2.572 2.572 0 0 1-.912.63 3.175 3.175 0 0 1-1.2.216c-.448 0-.852-.072-1.212-.216a2.572 2.572 0 0 1-.912-.63 2.805 2.805 0 0 1-.582-.984 3.972 3.972 0 0 1-.198-1.296c0-.476.066-.906.198-1.29.136-.388.33-.718.582-.99.252-.272.556-.482.912-.63.36-.148.764-.222 1.212-.222zm0 5.424c.6 0 1.048-.2 1.344-.6.296-.404.444-.966.444-1.686 0-.724-.148-1.288-.444-1.692-.296-.404-.744-.606-1.344-.606-.304 0-.57.052-.798.156a1.507 1.507 0 0 0-.564.45c-.148.196-.26.438-.336.726a3.941 3.941 0 0 0-.108.966c0 .72.148 1.282.444 1.686.3.4.754.6 1.362.6zM15.677 30.14c.192-.416.428-.74.708-.972.28-.236.622-.354 1.026-.354.128 0 .25.014.366.042.12.028.226.072.318.132l-.078.798c-.024.1-.084.15-.18.15-.056 0-.138-.012-.246-.036a1.694 1.694 0 0 0-.366-.036c-.192 0-.364.028-.516.084-.148.056-.282.14-.402.252a1.782 1.782 0 0 0-.318.408c-.092.16-.176.344-.252.552V35h-1.074v-6.078h.612c.116 0 .196.022.24.066.044.044.074.12.09.228l.072.924zM26.761 28.922 24.283 35h-.96l-2.478-6.078h.87a.33.33 0 0 1 .33.222l1.542 3.912c.048.148.09.292.126.432.036.14.07.28.102.42.032-.14.066-.28.102-.42.036-.14.08-.284.132-.432l1.56-3.912a.33.33 0 0 1 .12-.156.311.311 0 0 1 .198-.066h.834zM27.74 35v-6.078h.643c.152 0 .246.074.282.222l.078.624c.224-.276.476-.502.756-.678.28-.176.604-.264.972-.264.408 0 .738.114.99.342.256.228.44.536.552.924.088-.22.2-.41.336-.57a1.987 1.987 0 0 1 1.014-.624c.196-.048.394-.072.594-.072.32 0 .604.052.852.156.252.1.464.248.636.444.176.196.31.438.402.726.092.284.138.61.138.978V35H34.91v-3.87c0-.476-.104-.836-.312-1.08-.208-.248-.508-.372-.9-.372-.176 0-.344.032-.504.096-.156.06-.294.15-.414.27-.12.12-.216.272-.288.456-.068.18-.102.39-.102.63V35h-1.074v-3.87c0-.488-.098-.852-.294-1.092-.196-.24-.482-.36-.858-.36-.264 0-.508.072-.732.216a2.38 2.38 0 0 0-.618.576V35H27.74zM40.746 32.372c-.428.02-.788.058-1.08.114-.292.052-.526.12-.702.204a.923.923 0 0 0-.378.294.639.639 0 0 0-.114.366c0 .26.076.446.228.558.156.112.358.168.606.168.304 0 .566-.054.786-.162.224-.112.442-.28.654-.504v-1.038zm-3.396-2.67c.708-.648 1.56-.972 2.556-.972.36 0 .682.06.966.18.284.116.524.28.72.492.196.208.344.458.444.75.104.292.156.612.156.96V35h-.672a.708.708 0 0 1-.324-.06c-.076-.044-.136-.13-.18-.258l-.132-.444c-.156.14-.308.264-.456.372a2.804 2.804 0 0 1-.462.264c-.16.072-.332.126-.516.162-.18.04-.38.06-.6.06-.26 0-.5-.034-.72-.102a1.618 1.618 0 0 1-.57-.318 1.414 1.414 0 0 1-.372-.522 1.852 1.852 0 0 1-.132-.726 1.419 1.419 0 0 1 .33-.906c.12-.14.274-.272.462-.396s.418-.232.69-.324c.276-.092.596-.166.96-.222.364-.06.78-.096 1.248-.108v-.36c0-.412-.088-.716-.264-.912-.176-.2-.43-.3-.762-.3-.24 0-.44.028-.6.084-.156.056-.294.12-.414.192l-.33.186a.631.631 0 0 1-.324.084.439.439 0 0 1-.264-.078.716.716 0 0 1-.174-.192l-.264-.474zM44.974 29.6c.124-.124.254-.238.39-.342a2.395 2.395 0 0 1 .936-.444c.176-.044.368-.066.576-.066.336 0 .634.058.894.174.26.112.476.272.648.48.176.204.308.45.396.738.092.284.138.598.138.942V35H47.47v-3.918c0-.376-.086-.666-.258-.87-.172-.208-.434-.312-.786-.312-.256 0-.496.058-.72.174a2.58 2.58 0 0 0-.636.474V35h-1.482v-6.156h.906c.192 0 .318.09.378.27l.102.486zM53.085 28.748c.456 0 .87.074 1.242.222a2.692 2.692 0 0 1 1.578 1.626c.144.392.216.83.216 1.314 0 .488-.072.928-.216 1.32-.144.392-.35.726-.618 1.002a2.653 2.653 0 0 1-.96.636 3.333 3.333 0 0 1-1.242.222c-.46 0-.878-.074-1.254-.222a2.712 2.712 0 0 1-.966-.636 2.922 2.922 0 0 1-.618-1.002 3.807 3.807 0 0 1-.216-1.32c0-.484.072-.922.216-1.314.148-.392.354-.724.618-.996.268-.272.59-.482.966-.63a3.397 3.397 0 0 1 1.254-.222zm0 5.202c.512 0 .89-.172 1.134-.516.248-.344.372-.848.372-1.512s-.124-1.17-.372-1.518c-.244-.348-.622-.522-1.134-.522-.52 0-.906.176-1.158.528-.248.348-.372.852-.372 1.512s.124 1.164.372 1.512c.252.344.638.516 1.158.516zM57.252 35v-6.156h.906c.192 0 .318.09.378.27l.096.456c.108-.12.22-.23.336-.33a2.017 2.017 0 0 1 1.32-.492c.388 0 .706.106.954.318.252.208.44.486.564.834a1.93 1.93 0 0 1 .834-.882c.172-.092.354-.16.546-.204.196-.044.392-.066.588-.066.34 0 .642.052.906.156.264.104.486.256.666.456.18.2.316.444.408.732.096.288.144.618.144.99V35h-1.482v-3.918c0-.392-.086-.686-.258-.882-.172-.2-.424-.3-.756-.3-.152 0-.294.026-.426.078a1.026 1.026 0 0 0-.342.228 1.019 1.019 0 0 0-.228.366 1.435 1.435 0 0 0-.084.51V35h-1.488v-3.918c0-.412-.084-.712-.252-.9-.164-.188-.406-.282-.726-.282-.216 0-.418.054-.606.162a1.979 1.979 0 0 0-.516.432V35h-1.482zM70.558 32.372c-.428.02-.788.058-1.08.114-.292.052-.526.12-.702.204a.923.923 0 0 0-.378.294.639.639 0 0 0-.114.366c0 .26.076.446.228.558.156.112.358.168.606.168.304 0 .566-.054.786-.162.224-.112.442-.28.654-.504v-1.038zm-3.396-2.67c.708-.648 1.56-.972 2.556-.972.36 0 .682.06.966.18.284.116.524.28.72.492.196.208.344.458.444.75.104.292.156.612.156.96V35h-.672a.708.708 0 0 1-.324-.06c-.076-.044-.136-.13-.18-.258l-.132-.444c-.156.14-.308.264-.456.372a2.804 2.804 0 0 1-.462.264c-.16.072-.332.126-.516.162-.18.04-.38.06-.6.06-.26 0-.5-.034-.72-.102a1.618 1.618 0 0 1-.57-.318 1.414 1.414 0 0 1-.372-.522 1.852 1.852 0 0 1-.132-.726 1.419 1.419 0 0 1 .33-.906c.12-.14.274-.272.462-.396s.418-.232.69-.324c.276-.092.596-.166.96-.222.364-.06.78-.096 1.248-.108v-.36c0-.412-.088-.716-.264-.912-.176-.2-.43-.3-.762-.3-.24 0-.44.028-.6.084-.156.056-.294.12-.414.192l-.33.186a.631.631 0 0 1-.324.084.439.439 0 0 1-.264-.078.716.716 0 0 1-.174-.192l-.264-.474zM74.9 26.084V35h-1.482v-8.916H74.9zM81.969 28.844l-3.354 7.848a.538.538 0 0 1-.174.234c-.068.056-.174.084-.318.084h-1.104l1.152-2.472-2.49-5.694h1.302c.116 0 .206.028.27.084.068.056.118.12.15.192l1.308 3.192c.044.108.08.216.108.324.032.108.062.218.09.33a32.3 32.3 0 0 1 .108-.33c.036-.112.076-.222.12-.33l1.236-3.186a.437.437 0 0 1 .408-.276h1.188z"})}),Eo=()=>e("svg",{viewBox:"0 0 15 17",fill:"currentColor",children:e("path",{d:"M6.11767 7.47586C6.47736 7.75563 6.91931 7.90898 7.37503 7.91213H7.42681C7.90756 7.90474 8.38832 7.71987 8.67677 7.46846C10.1856 6.18921 14.5568 2.18138 14.5568 2.18138C15.7254 1.09438 12.4637 0.00739 7.42681 0H7.36764C2.3308 0.00739 -0.930935 1.09438 0.237669 2.18138C0.237669 2.18138 4.60884 6.18921 6.11767 7.47586ZM8.67677 9.64243C8.31803 9.92483 7.87599 10.0808 7.41941 10.0861H7.37503C6.91845 10.0808 6.47641 9.92483 6.11767 9.64243C5.0822 8.75513 1.38409 5.42018 0.000989555 4.14832V6.07829C0.000989555 6.29273 0.0823481 6.57372 0.222877 6.70682L0.293316 6.7712L0.293344 6.77122C1.33784 7.72579 4.83903 10.9255 6.11767 12.0161C6.47641 12.2985 6.91845 12.4545 7.37503 12.4597H7.41941C7.90756 12.4449 8.38092 12.2601 8.67677 12.0161C9.9859 10.9069 13.6249 7.57198 14.5642 6.70682C14.7121 6.57372 14.7861 6.29273 14.7861 6.07829V4.14832C12.7662 5.99804 10.7297 7.82949 8.67677 9.64243ZM7.41941 14.6263C7.87513 14.6232 8.31708 14.4698 8.67677 14.19C10.7298 12.3746 12.7663 10.5407 14.7861 8.68853V10.6259C14.7861 10.8329 14.7121 11.1139 14.5642 11.247C13.6249 12.1196 9.9859 15.4471 8.67677 16.5563C8.38092 16.8077 7.90756 16.9926 7.41941 17H7.37503C6.91931 16.9968 6.47736 16.8435 6.11767 16.5637C4.91427 15.5373 1.74219 12.6364 0.502294 11.5025C0.393358 11.4029 0.299337 11.3169 0.222877 11.247C0.0823481 11.1139 0.000989555 10.8329 0.000989555 10.6259V8.68853C1.38409 9.95303 5.0822 13.2953 6.11767 14.1827C6.47641 14.4651 6.91845 14.6211 7.37503 14.6263H7.41941Z"})}),ht=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"})}),Re=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})}),rt=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M12 5V2L8 6l4 4V7c3.31 0 6 2.69 6 6 0 2.97-2.17 5.43-5 5.91v2.02c3.95-.49 7-3.85 7-7.93 0-4.42-3.58-8-8-8zm-6 8c0-1.65.67-3.15 1.76-4.24L6.34 7.34C4.9 8.79 4 10.79 4 13c0 4.08 3.05 7.44 7 7.93v-2.02c-2.83-.48-5-2.94-5-5.91z"})}),Ge=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"})}),Mn=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"})}),Dn=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"})}),Mo=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"})}),La=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M12 6v3l4-4-4-4v3c-4.42 0-8 3.58-8 8 0 1.57.46 3.03 1.24 4.26L6.7 14.8c-.45-.83-.7-1.79-.7-2.8 0-3.31 2.69-6 6-6zm6.76 1.74L17.3 9.2c.44.84.7 1.79.7 2.8 0 3.31-2.69 6-6 6v-3l-4 4 4 4v-3c4.42 0 8-3.58 8-8 0-1.57-.46-3.03-1.24-4.26z"})}),ge=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M7.41 8.59 12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"})}),We=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"m7 10 5 5 5-5z"})}),Kt=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:[e("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),e("path",{d:"M12.5 7H11v6l5.25 3.15.75-1.23-4.5-2.67z"})]}),_a=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M20 3h-1V1h-2v2H7V1H5v2H4c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 18H4V8h16v13z"})}),Do=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"m22 5.72-4.6-3.86-1.29 1.53 4.6 3.86L22 5.72zM7.88 3.39 6.6 1.86 2 5.71l1.29 1.53 4.59-3.85zM12.5 8H11v6l4.75 2.85.75-1.23-4-2.37V8zM12 4c-4.97 0-9 4.03-9 9s4.02 9 9 9c4.97 0 9-4.03 9-9s-4.03-9-9-9zm0 16c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"})}),Io=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M20 5H4c-1.1 0-1.99.9-1.99 2L2 17c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm-9 3h2v2h-2V8zm0 3h2v2h-2v-2zM8 8h2v2H8V8zm0 3h2v2H8v-2zm-1 2H5v-2h2v2zm0-3H5V8h2v2zm9 7H8v-2h8v2zm0-4h-2v-2h2v2zm0-3h-2V8h2v2zm3 3h-2v-2h2v2zm0-3h-2V8h2v2z"})}),ct=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M8 5v14l11-7z"})}),Ea=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"m10 16.5 6-4.5-6-4.5v9zM12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"})}),In=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"m3.5 18.49 6-6.01 4 4L22 6.92l-1.41-1.41-7.09 7.97-4-4L2 16.99z"})}),ra=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M10 10.02h5V21h-5zM17 21h3c1.1 0 2-.9 2-2v-9h-5v11zm3-18H5c-1.1 0-2 .9-2 2v3h19V5c0-1.1-.9-2-2-2zM3 19c0 1.1.9 2 2 2h3V10H3v9z"})}),At=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M9.4 16.6 4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0 4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z"})}),Ma=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"})}),Pn=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"})}),Po=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M19 13H5v-2h14v2z"})}),Da=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M8.9999 14.7854L18.8928 4.8925C19.0803 4.70497 19.3347 4.59961 19.5999 4.59961C19.8651 4.59961 20.1195 4.70497 20.307 4.8925L21.707 6.2925C22.0975 6.68303 22.0975 7.31619 21.707 7.70672L9.70701 19.7067C9.31648 20.0972 8.68332 20.0972 8.2928 19.7067L2.6928 14.1067C2.50526 13.9192 2.3999 13.6648 2.3999 13.3996C2.3999 13.1344 2.50526 12.88 2.6928 12.6925L4.0928 11.2925C4.48332 10.902 5.11648 10.902 5.50701 11.2925L8.9999 14.7854Z"})}),zt=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"})}),$n=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7zM2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3 2 4.27zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2zm4.31-.78 3.15 3.15.02-.16c0-1.66-1.34-3-3-3l-.17.01z"})}),$o=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M19 9l1.25-2.75L23 5l-2.75-1.25L19 1l-1.25 2.75L15 5l2.75 1.25L19 9zm-7.5.5L9 4 6.5 9.5 1 12l5.5 2.5L9 20l2.5-5.5L17 12l-5.5-2.5zM19 15l-1.25 2.75L15 19l2.75 1.25L19 23l1.25-2.75L23 19l-2.75-1.25L19 15z"})}),et=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"})}),On=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M20 9H4v2h16V9zM4 15h16v-2H4v2z"})}),fa=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M23 8c0 1.1-.9 2-2 2-.18 0-.35-.02-.51-.07l-3.56 3.55c.05.16.07.34.07.52 0 1.1-.9 2-2 2s-2-.9-2-2c0-.18.02-.36.07-.52l-2.55-2.55c-.16.05-.34.07-.52.07s-.36-.02-.52-.07l-4.55 4.56c.05.16.07.33.07.51 0 1.1-.9 2-2 2s-2-.9-2-2 .9-2 2-2c.18 0 .35.02.51.07l4.56-4.55C8.02 9.36 8 9.18 8 9c0-1.1.9-2 2-2s2 .9 2 2c0 .18-.02.36-.07.52l2.55 2.55c.16-.05.34-.07.52-.07s.36.02.52.07l3.55-3.56C19.02 8.35 19 8.18 19 8c0-1.1.9-2 2-2s2 .9 2 2z"})}),st=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:[e("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M21 5C19.89 4.65 18.67 4.5 17.5 4.5C15.55 4.5 13.45 4.9 12 6C10.55 4.9 8.45 4.5 6.5 4.5C5.33 4.5 4.11 4.65 3 5C2.25 5.25 1.6 5.55 1 6V20.6C1 20.85 1.25 21.1 1.5 21.1C1.6 21.1 1.65 21.1 1.75 21.05C3.15 20.3 4.85 20 6.5 20C8.2 20 10.65 20.65 12 21.5C13.35 20.65 15.8 20 17.5 20C19.15 20 20.85 20.3 22.25 21.05C22.35 21.1 22.4 21.1 22.5 21.1C22.75 21.1 23 20.85 23 20.6V6C22.4 5.55 21.75 5.25 21 5ZM21 18.5C19.9 18.15 18.7 18 17.5 18C15.8 18 13.35 18.65 12 19.5C10.65 18.65 8.2 18 6.5 18C5.3 18 4.1 18.15 3 18.5V7C4.1 6.65 5.3 6.5 6.5 6.5C8.2 6.5 10.65 7.15 12 8C13.35 7.15 15.8 6.5 17.5 6.5C18.7 6.5 19.9 6.65 21 7V18.5Z"}),e("path",{d:"M17.5 10.5C18.38 10.5 19.23 10.59 20 10.76V9.24C19.21 9.09 18.36 9 17.5 9C15.8 9 14.26 9.29 13 9.83V11.49C14.13 10.85 15.7 10.5 17.5 10.5ZM13 12.49V14.15C14.13 13.51 15.7 13.16 17.5 13.16C18.38 13.16 19.23 13.25 20 13.42V11.9C19.21 11.75 18.36 11.66 17.5 11.66C15.8 11.66 14.26 11.96 13 12.49ZM17.5 14.33C15.8 14.33 14.26 14.62 13 15.16V16.82C14.13 16.18 15.7 15.83 17.5 15.83C18.38 15.83 19.23 15.92 20 16.09V14.57C19.21 14.41 18.36 14.33 17.5 14.33Z"}),e("path",{d:"M6.5 10.5C5.62 10.5 4.77 10.59 4 10.76V9.24C4.79 9.09 5.64 9 6.5 9C8.2 9 9.74 9.29 11 9.83V11.49C9.87 10.85 8.3 10.5 6.5 10.5ZM11 12.49V14.15C9.87 13.51 8.3 13.16 6.5 13.16C5.62 13.16 4.77 13.25 4 13.42V11.9C4.79 11.75 5.64 11.66 6.5 11.66C8.2 11.66 9.74 11.96 11 12.49ZM6.5 14.33C8.2 14.33 9.74 14.62 11 15.16V16.82C9.87 16.18 8.3 15.83 6.5 15.83C5.62 15.83 4.77 15.92 4 16.09V14.57C4.79 14.41 5.64 14.33 6.5 14.33Z"})]}),Oo=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M12 2C6.49 2 2 6.49 2 12s4.49 10 10 10 10-4.49 10-10S17.51 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm3-8c0 1.66-1.34 3-3 3s-3-1.34-3-3 1.34-3 3-3 3 1.34 3 3z"})}),Rn=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2ZM12 6C9.79 6 8 7.79 8 10H10C10 8.9 10.9 8 12 8C13.1 8 14 8.9 14 10C14 10.8792 13.4202 11.3236 12.7704 11.8217C11.9421 12.4566 11 13.1787 11 15H13C13 13.9046 13.711 13.2833 14.4408 12.6455C15.21 11.9733 16 11.2829 16 10C16 7.79 14.21 6 12 6ZM13 16V18H11V16H13Z"})}),Nt=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M4 20h16c1.1 0 2-.9 2-2s-.9-2-2-2H4c-1.1 0-2 .9-2 2s.9 2 2 2zm0-3h2v2H4v-2zM2 6c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2s-.9-2-2-2H4c-1.1 0-2 .9-2 2zm4 1H4V5h2v2zm-2 7h16c1.1 0 2-.9 2-2s-.9-2-2-2H4c-1.1 0-2 .9-2 2s.9 2 2 2zm0-3h2v2H4v-2z"})}),zn=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"})}),Ro=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M3 17v2h6v-2H3zM3 5v2h10V5H3zm10 16v-2h8v-2h-8v-2h-2v6h2zM7 9v2H3v2h4v2h2V9H7zm14 4v-2H11v2h10zm-6-4h2V7h4V5h-4V3h-2v6z"})}),oa=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M7 20h4c0 1.1-.9 2-2 2s-2-.9-2-2zm-2-1h8v-2H5v2zm11.5-9.5c0 3.82-2.66 5.86-3.77 6.5H5.27c-1.11-.64-3.77-2.68-3.77-6.5C1.5 5.36 4.86 2 9 2s7.5 3.36 7.5 7.5zm4.87-2.13L20 8l1.37.63L22 10l.63-1.37L24 8l-1.37-.63L22 6l-.63 1.37zM19 6l.94-2.06L22 3l-2.06-.94L19 0l-.94 2.06L16 3l2.06.94L19 6z"})}),zo=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M3 14h4v-4H3v4zm0 5h4v-4H3v4zM3 9h4V5H3v4zm5 5h13v-4H8v4zm0 5h13v-4H8v4zM8 5v4h13V5H8z"})}),Fo=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"m22 9.24-7.19-.62L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21 12 17.27 18.18 21l-1.63-7.03L22 9.24zM12 15.4l-3.76 2.27 1-4.28-3.32-2.88 4.38-.38L12 6.1l1.71 4.04 4.38.38-3.32 2.88 1 4.28L12 15.4z"})}),Ho=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M12 17.27 18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"})}),ba=()=>e("svg",{viewBox:"0 0 16 16",fill:Xe("color-error"),children:e("path",{d:"M13.5095 4L8.50952 1H7.50952L2.50952 4L2.01953 4.85999V10.86L2.50952 11.71L7.50952 14.71H8.50952L13.5095 11.71L13.9995 10.86V4.85999L13.5095 4ZM7.50952 13.5601L3.00952 10.86V5.69995L7.50952 8.15002V13.5601ZM3.26953 4.69995L8.00952 1.85999L12.7495 4.69995L8.00952 7.29004L3.26953 4.69995ZM13.0095 10.86L8.50952 13.5601V8.15002L13.0095 5.69995V10.86Z"})}),Ia=()=>e("svg",{viewBox:"0 0 16 16",fill:Xe("color-primary"),children:e("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2 5H4V4H1.5L1 4.5V12.5L1.5 13H4V12H2V5ZM14.5 4H12V5H14V12H12V13H14.5L15 12.5V4.5L14.5 4ZM11.76 6.56995L12 7V9.51001L11.7 9.95996L7.19995 11.96H6.73999L4.23999 10.46L4 10.03V7.53003L4.30005 7.06995L8.80005 5.06995H9.26001L11.76 6.56995ZM5 9.70996L6.5 10.61V9.28003L5 8.38V9.70996ZM5.57996 7.56006L7.03003 8.43005L10.42 6.93005L8.96997 6.06006L5.57996 7.56006ZM7.53003 10.73L11.03 9.17004V7.77002L7.53003 9.31995V10.73Z"})}),Fn=()=>e("svg",{viewBox:"0 0 16 16",fill:Xe("color-warning"),children:e("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14 2H8L7 3V6H8V3H14V8H10V9H14L15 8V3L14 2ZM9 6H13V7H9.41L9 6.59V6ZM7 7H2L1 8V13L2 14H8L9 13V8L8 7H7ZM8 13H2V8H8V9V13ZM3 9H7V10H3V9ZM3 11H7V12H3V11ZM9 4H13V5H9V4Z"})}),ya=()=>e("svg",{viewBox:"0 0 16 16",fill:Xe("color-primary"),children:e("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7 3L8 2H14L15 3V8L14 9H10V8H14V3H8V6H7V3ZM9 9V8L8 7H7H2L1 8V13L2 14H8L9 13V9ZM8 8V9V13H2V8H7H8ZM9.41421 7L9 6.58579V6H13V7H9.41421ZM9 4H13V5H9V4ZM7 10H3V11H7V10Z"})}),Pa=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"})}),Hn=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M12 5.83 15.17 9l1.41-1.41L12 3 7.41 7.59 8.83 9zm0 12.34L8.83 15l-1.41 1.41L12 21l4.59-4.59L15.17 15z"})}),Vn=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M7.41 18.59 8.83 20 12 16.83 15.17 20l1.41-1.41L12 14zm9.18-13.18L15.17 4 12 7.17 8.83 4 7.41 5.41 12 10z"})}),Vo=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"})}),Un=()=>e("svg",{viewBox:"0 0 24 24",children:e("path",{fill:"currentColor",d:"M12,4a8,8,0,0,1,7.89,6.7A1.53,1.53,0,0,0,21.38,12h0a1.5,1.5,0,0,0,1.48-1.75,11,11,0,0,0-21.72,0A1.5,1.5,0,0,0,2.62,12h0a1.53,1.53,0,0,0,1.49-1.3A8,8,0,0,1,12,4Z",children:e("animateTransform",{attributeName:"transform",dur:"0.75s",repeatCount:"indefinite",type:"rotate",values:"0 12 12;360 12 12"})})}),Uo=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M21.99 4c0-1.1-.89-2-1.99-2H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h14l4 4zM18 14H6v-2h12zm0-3H6V9h12zm0-3H6V6h12z"})}),qn=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M4.25 5.61C6.27 8.2 10 13 10 13v6c0 .55.45 1 1 1h2c.55 0 1-.45 1-1v-6s3.72-4.8 5.74-7.39c.51-.66.04-1.61-.79-1.61H5.04c-.83 0-1.3.95-.79 1.61"})}),Bn=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M19.79 5.61C20.3 4.95 19.83 4 19 4H6.83l7.97 7.97zM2.81 2.81 1.39 4.22 10 13v6c0 .55.45 1 1 1h2c.55 0 1-.45 1-1v-2.17l5.78 5.78 1.41-1.41z"})}),xi=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M19 19H5V5h7V3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2v-7h-2zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3z"})}),Li=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M19 4H5c-1.11 0-2 .9-2 2v12c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.89-2-2-2m0 14H5V8h14z"})}),Ei=Object.freeze(Object.defineProperty({__proto__:null,AlarmIcon:Do,ArrowDownIcon:ge,ArrowDropDownIcon:We,CalendarIcon:_a,ChartIcon:In,ClockIcon:Kt,CloseIcon:Re,CodeIcon:At,CollapseIcon:Vn,CommentIcon:Uo,CopyIcon:et,DeleteIcon:Ma,DoneIcon:Da,DownloadIcon:Pa,DragIcon:On,ErrorIcon:Dn,ExpandIcon:Hn,FilterIcon:qn,FilterOffIcon:Bn,FunctionIcon:Ia,InfoIcon:Ge,IssueIcon:Oo,KeyboardIcon:Io,LabelIcon:Fn,ListIcon:zo,LogoAnomalyIcon:Lo,LogoIcon:Ao,LogoLogsIcon:xo,LogoShortIcon:Eo,MetricIcon:ba,MinusIcon:Po,ModalIcon:Li,MoreIcon:zn,OpenNewIcon:xi,PlayCircleOutlineIcon:Ea,PlayIcon:ct,PlusIcon:Pn,Prettify:$o,QuestionIcon:Rn,RefreshIcon:La,RestartIcon:rt,SearchIcon:Vo,SettingsIcon:ht,SpinnerIcon:Un,StarBorderIcon:Fo,StarIcon:Ho,StorageIcon:Nt,SuccessIcon:Mo,TableIcon:ra,TimelineIcon:fa,TipIcon:oa,TuneIcon:Ro,ValueIcon:ya,VisibilityIcon:zt,VisibilityOffIcon:$n,WarningIcon:Mn,WikiIcon:st},Symbol.toStringTag,{value:"Module"})),Mi=({to:t,isNavLink:a,children:n,...r})=>a?e(co,{to:t,...r,children:n}):e("div",{...r,children:n}),Di=({activeItem:t,item:a,color:n=Xe("color-primary"),activeNavRef:r,onChange:o,isNavLink:s})=>{const i=c=>()=>{o&&o(c)};return e(Mi,{className:I({"vm-tabs-item":!0,"vm-tabs-item_active":t===a.value,[a.className||""]:a.className}),isNavLink:s,to:a.value,style:{color:n},onClick:i(a.value),ref:t===a.value?r:void 0,children:[a.icon&&e("div",{className:I({"vm-tabs-item__icon":!0,"vm-tabs-item__icon_single":!a.label}),children:a.icon}),a.label]})};function ce(t,a,n,r){const o=Y(a);x(()=>{o.current=a},[a]),x(()=>{const s=(n==null?void 0:n.current)??window;if(!(s&&s.addEventListener))return;const i=c=>o.current(c);return s.addEventListener(t,i,r),()=>{s.removeEventListener(t,i,r)}},[t,n,r])}const xt=()=>{const[t,a]=C({width:0,height:0}),n=()=>{a({width:window.innerWidth,height:window.innerHeight})};return ce("resize",n),x(n,[]),t},Bt=({activeItem:t,items:a,color:n=Xe("color-primary"),onChange:r,indicatorPlacement:o="bottom",isNavLink:s})=>{const i=xt(),c=Y(null),[l,m]=C({left:0,width:0,bottom:0});return x(()=>{var d;if(((d=c.current)==null?void 0:d.base)instanceof HTMLElement){const{offsetLeft:u,offsetWidth:h,offsetHeight:v}=c.current.base;m({left:u,width:h,bottom:o==="top"?v-2:0})}},[i,t,c,a]),e("div",{className:"vm-tabs",children:[a.map(d=>e(Di,{activeItem:t,item:d,onChange:r,color:n,activeNavRef:c,isNavLink:s},d.value)),e("div",{className:"vm-tabs__indicator",style:{...l,borderColor:n}})]})},Ot=[{value:_e.chart,icon:e(In,{}),label:"Graph",prometheusCode:0},{value:_e.code,icon:e(At,{}),label:"JSON",prometheusCode:3},{value:_e.table,icon:e(ra,{}),label:"Table",prometheusCode:1}],qo=({tabFilter:t})=>{const{displayType:a}=He(),n=jt(),r=s=>{n({type:"SET_DISPLAY_TYPE",payload:s??a})},o=Ot.filter(t??(()=>!0));return e(Bt,{activeItem:a,items:o,onChange:r})},Bo=()=>{const t=De("g0.tab",0),a=Ot.find(n=>n.prometheusCode===+t||n.value===t);return(a==null?void 0:a.value)||_e.chart},Dr=ze("SERIES_LIMITS"),Ii={displayType:Bo(),nocache:!1,isTracingEnabled:!1,seriesLimits:Dr?JSON.parse(Dr):go,tableCompact:ze("TABLE_COMPACT")||!1,reduceMemUsage:!1};function Pi(t,a){switch(a.type){case"SET_DISPLAY_TYPE":return{...t,displayType:a.payload};case"SET_SERIES_LIMITS":return Le("SERIES_LIMITS",JSON.stringify(a.payload)),{...t,seriesLimits:a.payload};case"TOGGLE_QUERY_TRACING":return{...t,isTracingEnabled:!t.isTracingEnabled};case"TOGGLE_NO_CACHE":return{...t,nocache:!t.nocache};case"TOGGLE_TABLE_COMPACT":return Le("TABLE_COMPACT",!t.tableCompact),{...t,tableCompact:!t.tableCompact};case"TOGGLE_REDUCE_MEM_USAGE":return Le("TABLE_COMPACT",!t.reduceMemUsage),{...t,reduceMemUsage:!t.reduceMemUsage};default:throw new Error}}const jn=pt({}),He=()=>Ee(jn).state,jt=()=>Ee(jn).dispatch,$i=({children:t})=>{const[a,n]=St(Pi,Ii),r=D(()=>({state:a,dispatch:n}),[a,n]);return e(jn.Provider,{value:r,children:t})},Oi={customStep:De("g0.step_input",""),yaxis:{limits:{enable:!1,range:{1:[0,0]}}},isHistogram:!1,isEmptyHistogram:!1,spanGaps:!1};function Ri(t,a){switch(a.type){case"TOGGLE_ENABLE_YAXIS_LIMITS":return{...t,yaxis:{...t.yaxis,limits:{...t.yaxis.limits,enable:!t.yaxis.limits.enable}}};case"SET_CUSTOM_STEP":return{...t,customStep:a.payload};case"SET_YAXIS_LIMITS":return{...t,yaxis:{...t.yaxis,limits:{...t.yaxis.limits,range:a.payload}}};case"SET_IS_HISTOGRAM":return{...t,isHistogram:a.payload};case"SET_IS_EMPTY_HISTOGRAM":return{...t,isEmptyHistogram:a.payload};case"SET_SPAN_GAPS":return{...t,spanGaps:a.payload};default:throw new Error}}const Qn=pt({}),Ve=()=>Ee(Qn).state,Lt=()=>Ee(Qn).dispatch,zi=({children:t})=>{const[a,n]=St(Ri,Oi),r=D(()=>({state:a,dispatch:n}),[a,n]);return e(Qn.Provider,{value:r,children:t})},Fi={dashboardsSettings:[],dashboardsLoading:!1,dashboardsError:""};function Hi(t,a){switch(a.type){case"SET_DASHBOARDS_SETTINGS":return{...t,dashboardsSettings:a.payload};case"SET_DASHBOARDS_LOADING":return{...t,dashboardsLoading:a.payload};case"SET_DASHBOARDS_ERROR":return{...t,dashboardsError:a.payload};default:throw new Error}}const Yn=pt({}),jo=()=>Ee(Yn).state,Vi=()=>Ee(Yn).dispatch,Ui=({children:t})=>{const[a,n]=St(Hi,Fi),r=D(()=>({state:a,dispatch:n}),[a,n]);return e(Yn.Provider,{value:r,children:t})},qi={markdownParsing:ze("LOGS_MARKDOWN")==="true",autocompleteCache:new Map};function Bi(t,a){switch(a.type){case"SET_MARKDOWN_PARSING":return Le("LOGS_MARKDOWN",`${a.payload}`),{...t,markdownParsing:a.payload};case"SET_AUTOCOMPLETE_CACHE":{if(t.autocompleteCache.size>=Ct.cacheLimit){const n=t.autocompleteCache.keys().next().value;n&&t.autocompleteCache.delete(n)}return t.autocompleteCache.set(a.payload.key,a.payload.value),{...t,autocompleteCache:t.autocompleteCache}}default:throw new Error}}const Gn=pt({}),Wn=()=>Ee(Gn).state,Qo=()=>Ee(Gn).dispatch,ji=({children:t})=>{const[a,n]=St(Bi,qi),r=D(()=>({state:a,dispatch:n}),[a,n]);return e(Gn.Provider,{value:r,children:t})},Yo={windows:"Windows",mac:"Mac OS",linux:"Linux"},Qi=()=>Object.values(Yo).find(t=>navigator.userAgent.indexOf(t)>=0)||"unknown",$a=()=>Qi()===Yo.mac,Yi=()=>["Android","webOS","iPhone","iPad","iPod","BlackBerry","Windows Phone"].map(n=>navigator.userAgent.match(new RegExp(n,"i"))).some(n=>n);function J(){const t=xt(),a=()=>{const o=Yi(),s=window.innerWidth<500;return o||s},[n,r]=C(a());return x(()=>{r(a())},[t]),{isMobile:n}}const Gi={success:e(Mo,{}),error:e(Dn,{}),warning:e(Mn,{}),info:e(Ge,{})},se=({variant:t,children:a})=>{const{isDarkTheme:n}=re(),{isMobile:r}=J();return e("div",{className:I({"vm-alert":!0,[`vm-alert_${t}`]:t,"vm-alert_dark":n,"vm-alert_mobile":r}),children:[e("div",{className:"vm-alert__icon",children:Gi[t||"info"]}),e("div",{className:"vm-alert__content",children:a})]})},Go=pt({showInfoMessage:()=>{}}),Wi=()=>Ee(Go),Ji=({children:t})=>{const{isMobile:a}=J(),[n,r]=C({text:"",type:"info"}),[o,s]=C(!1),[i,c]=C(null);x(()=>{if(!i)return;r({...i,key:Date.now()}),s(!0);const m=setTimeout(l,i.timeout||4e3);return()=>clearTimeout(m)},[i]);const l=()=>{c(null),s(!1)};return e(Go.Provider,{value:{showInfoMessage:c},children:[o&&e("div",{className:I({"vm-snackbar":!0,"vm-snackbar_mobile":a}),children:e(se,{variant:n.type,children:e("div",{className:"vm-snackbar-content",children:[e("span",{children:n.text}),e("div",{className:"vm-snackbar-content__close",onClick:l,children:e(Re,{})})]})})}),t]})},Ki=(...t)=>t.reduce((a,n)=>({children:r})=>e(a,{children:e(n,{children:r})}),({children:a})=>e(V,{children:a})),Zi=[ii,Ci,Ai,$i,zi,Ji,Ui,ji],Jn=Ki(...Zi);var Zt=(t=>(t[t.internalLink=0]="internalLink",t[t.externalLink=1]="externalLink",t))(Zt||{});const Xi=(t,a)=>({label:"Alerts",value:!!aa(t)?`${t}/vmalert`:t.replace(/\/prometheus$/,"/vmalert"),type:1,hide:!a}),el=t=>[{value:K.trace},{value:K.queryAnalyzer},{value:K.withTemplate},{value:K.relabel},{value:K.downsamplingDebug,hide:!t},{value:K.retentionDebug,hide:!t}],tl=()=>[{value:K.metrics},{value:K.cardinality},{value:K.topQueries},{value:K.activeQueries}],al=({serverUrl:t,isEnterpriseLicense:a,showPredefinedDashboards:n,showAlertLink:r})=>[{value:K.home},{value:K.rawQuery},{label:"Explore",submenu:tl()},{label:"Tools",submenu:el(a)},{value:K.dashboards,hide:!n},Xi(t,r)],nl=()=>[{label:lt[K.logs].title,value:K.home}],rl=()=>[{label:lt[K.anomaly].title,value:K.home}],dn=({activeMenu:t,label:a,value:n,type:r,color:o})=>r===Zt.externalLink?e("a",{className:I({"vm-header-nav-item":!0,"vm-header-nav-item_active":t===n}),style:{color:o},href:n,target:"_blank",rel:"noreferrer",children:a}):e(co,{className:I({"vm-header-nav-item":!0,"vm-header-nav-item_active":t===n}),style:{color:o},to:n,children:a}),sa=(t,a,n)=>{const r=Z(o=>{const s=t==null?void 0:t.current,i=o.target,c=(n==null?void 0:n.current)&&n.current.contains(i);!s||s.contains((o==null?void 0:o.target)||null)||c||a(o)},[t,a]);ce("mouseup",r),ce("touchstart",r)},$=({variant:t="contained",color:a="primary",size:n="medium",ariaLabel:r,children:o,endIcon:s,startIcon:i,fullWidth:c=!1,className:l,disabled:m,onClick:d,onMouseDown:u})=>{const h=I({"vm-button":!0,[`vm-button_${t}_${a}`]:!0,[`vm-button_${n}`]:n,"vm-button_icon":(i||s)&&!o,"vm-button_full-width":c,"vm-button_with-icon":i||s,"vm-button_disabled":m,[l||""]:l});return e("button",{className:h,disabled:m,"aria-label":r,onClick:d,onMouseDown:u,children:e(V,{children:[i&&e("span",{className:"vm-button__start-icon",children:i}),o&&e("span",{children:o}),s&&e("span",{className:"vm-button__end-icon",children:s})]})})},Se=({children:t,buttonRef:a,placement:n="bottom-left",placementPosition:r,open:o=!1,onClose:s,offset:i={top:6,left:0},clickOutside:c=!0,fullWidth:l,title:m,disabledFullScreen:d,variant:u})=>{const{isMobile:h}=J(),v=Na(),_=it(),[f,p]=C({width:0,height:0}),[g,b]=C(!1),y=Y(null);x(()=>(b(o),!o&&s&&s(),o&&h&&!d&&(document.body.style.overflow="hidden"),()=>{document.body.style.overflow="auto"}),[o]),x(()=>{var A,L;p({width:((A=y==null?void 0:y.current)==null?void 0:A.clientWidth)||0,height:((L=y==null?void 0:y.current)==null?void 0:L.clientHeight)||0}),b(!1)},[y]);const w=D(()=>{const A=a.current;if(!A||!g)return{};const L=A.getBoundingClientRect(),E={top:0,left:0,width:"auto"},M=n==="bottom-right"||n==="top-right",P=n==null?void 0:n.includes("top"),R=(i==null?void 0:i.top)||0,Q=(i==null?void 0:i.left)||0;if(E.left=E.left=L.left+Q,E.top=L.height+L.top+R,M&&(E.left=L.right-f.width),P&&(E.top=L.top-f.height-R),n==="fixed"&&r)return E.top=Math.max(r.top+i.top,0),E.left=Math.max(r.left+i.left,0),E;const{innerWidth:H,innerHeight:B}=window,F=E.top+f.height>B,te=E.top<0,de=E.left+f.width>H,W=E.left<0;return F&&(E.top=L.top-f.height-R),te&&(E.top=L.height+L.top+R),de&&(E.left=L.right-f.width-Q),W&&(E.left=L.left+Q),l&&(E.width=`${L.width}px`),E.top<0&&(E.top=0),E.left<0&&(E.left=0),E},[a,n,g,t,l]),T=A=>{A.stopPropagation(),s()},S=()=>{b(!1),s()},N=()=>{c&&S()};x(()=>{if(!y.current||!g||h&&!d)return;const{right:A,width:L}=y.current.getBoundingClientRect();if(A>window.innerWidth){const E=window.innerWidth-L;y.current.style.left=`${E}px`}},[g,y,r]);const k=Z(()=>{g&&h&&!d&&(v(_,{replace:!0}),s())},[g,h,d,_,s]);return ce("scroll",S),ce("popstate",k),sa(y,N,a),e(V,{children:(g||!f.width)&&Ft(e("div",{className:I({"vm-popper":!0,[`vm-popper_${u}`]:u,"vm-popper_mobile":h&&!d,"vm-popper_open":(h||Object.keys(w).length)&&g}),ref:y,style:h&&!d?{}:w,children:[(m||h&&!d)&&e("div",{className:"vm-popper-header",children:[e("p",{className:"vm-popper-header__title",children:m}),e($,{variant:"text",color:u==="dark"?"white":"primary",size:"small",onClick:T,ariaLabel:"close",children:e(Re,{})})]}),t]}),document.body)})},oe=t=>{const[a,n]=C(!!t),r=Z(()=>n(!0),[]),o=Z(()=>n(!1),[]),s=Z(()=>n(i=>!i),[]);return{value:a,setValue:n,setTrue:r,setFalse:o,toggle:s}},ol=({activeMenu:t,label:a,color:n,background:r,submenu:o,direction:s})=>{const{pathname:i}=it(),[c,l]=C(null),m=Y(null),{value:d,setFalse:u,setTrue:h}=oe(!1),v=()=>{h(),c&&clearTimeout(c)},_=()=>{c&&clearTimeout(c);const p=setTimeout(u,300);l(p)},f=()=>{c&&clearTimeout(c)};return x(()=>{u()},[i]),s==="column"?e(V,{children:o.map(p=>e(dn,{activeMenu:t,value:p.value||"",label:p.label||"",type:p.type||Zt.internalLink},p.value))}):e("div",{className:I({"vm-header-nav-item":!0,"vm-header-nav-item_sub":!0,"vm-header-nav-item_open":d,"vm-header-nav-item_active":o.find(p=>p.value===t)}),style:{color:n},onMouseEnter:v,onMouseLeave:_,ref:m,children:[a,e(We,{}),e(Se,{open:d,placement:"bottom-left",offset:{top:12,left:0},onClose:u,buttonRef:m,children:e("div",{className:"vm-header-nav-item-submenu",style:{background:r},onMouseLeave:_,onMouseEnter:f,children:o.map(p=>e(dn,{activeMenu:t,value:p.value||"",label:p.label||"",color:n,type:p.type||Zt.internalLink},p.value))})})]})},sl=t=>{try{return t.replace(/^\/+/,"").replace(/-/g," ").trim().replace(/^\w/,a=>a.toUpperCase())}catch{return t}},Wo=t=>t.filter(a=>!a.hide).map(a=>{var r;const n={...a};return n.value&&!n.label&&(n.label=((r=lt[n.value])==null?void 0:r.title)||sl(n.value)),n.submenu&&n.submenu.length>0&&(n.submenu=Wo(n.submenu)),n}),il=()=>{var d;const t=ye(),{dashboardsSettings:a}=jo(),{serverUrl:n,flags:r,appConfig:o}=re(),s=((d=o.license)==null?void 0:d.type)==="enterprise",i=!!r["vmalert.proxyURL"],c=!!(!t&&a.length),l=D(()=>({serverUrl:n,isEnterpriseLicense:s,showAlertLink:i,showPredefinedDashboards:c}),[n,s,i,c]),m=D(()=>{switch(Ut){case ot.victorialogs:return nl();case ot.vmanomaly:return rl();default:return al(l)}},[l]);return Wo(m)},Jo=({color:t,background:a,direction:n})=>{const{pathname:r}=it(),[o,s]=C(r),i=il();return x(()=>{s(r)},[r]),e("nav",{className:I({"vm-header-nav":!0,[`vm-header-nav_${n}`]:n}),children:i.map(c=>c.submenu?e(ol,{activeMenu:o,label:c.label||"",submenu:c.submenu,color:t,background:a,direction:n},c.label):e(dn,{activeMenu:o,value:c.value||"",label:c.label||"",color:t,type:c.type||Zt.internalLink},c.value))})},Ie=({title:t,children:a,onClose:n,className:r,isOpen:o=!0})=>{const{isMobile:s}=J(),i=Na(),c=it(),l=Z(h=>{o&&h.key==="Escape"&&n()},[o]),m=h=>{h.stopPropagation()},d=Z(()=>{o&&(i(c,{replace:!0}),n())},[o,c,n]);return x(()=>{if(o)return document.body.style.overflow="hidden",()=>{document.body.style.overflow="auto"}},[o]),ce("popstate",d),ce("keyup",l),Ft(e("div",{className:I({"vm-modal":!0,"vm-modal_mobile":s,[`${r}`]:r}),onMouseDown:n,children:e("div",{className:"vm-modal-content",onMouseDown:m,children:[e("div",{className:"vm-modal-content-header",children:[t&&e("div",{className:"vm-modal-content-header__title",children:t}),e("div",{className:"vm-modal-header__close",children:e($,{variant:"text",size:"small",onClick:n,ariaLabel:"close",children:e(Re,{})})})]}),e("div",{className:"vm-modal-content-body",tabIndex:0,children:a})]})}),document.body)},G=({children:t,title:a,open:n,placement:r="bottom-center",offset:o={top:6,left:0}})=>{const{isMobile:s}=J(),[i,c]=C(!1),[l,m]=C({width:0,height:0}),d=Y(null),u=Y(null),h=()=>c(!1);x(()=>{if(!(!u.current||!i))return m({width:u.current.clientWidth,height:u.current.clientHeight}),window.addEventListener("scroll",h),()=>{window.removeEventListener("scroll",h)}},[i,a]);const v=D(()=>{var Q;const p=(Q=d==null?void 0:d.current)==null?void 0:Q.base;if(!p||!i)return{};const g=p.getBoundingClientRect(),b={top:0,left:0},y=r==="bottom-right"||r==="top-right",w=r==="bottom-left"||r==="top-left",T=r==null?void 0:r.includes("top"),S=(o==null?void 0:o.top)||0,N=(o==null?void 0:o.left)||0;b.left=g.left-(l.width-g.width)/2+N,b.top=g.height+g.top+S,y&&(b.left=g.right-l.width),w&&(b.left=g.left+N),T&&(b.top=g.top-l.height-S);const{innerWidth:k,innerHeight:A}=window,L=20,E=b.top+l.height+L>A,M=b.top-L<0,P=b.left+l.width+L>k,R=b.left-L<0;return E&&(b.top=g.top-l.height-S),M&&(b.top=g.height+g.top+S),P&&(b.left=g.right-l.width-N),R&&(b.left=g.left+N),b.top<0&&(b.top=20),b.left<0&&(b.left=20),b},[d,r,i,l]),_=()=>{typeof n!="boolean"&&c(!0)},f=()=>{c(!1)};return x(()=>{typeof n=="boolean"&&c(n)},[n]),x(()=>{var g;const p=(g=d==null?void 0:d.current)==null?void 0:g.base;if(p)return p.addEventListener("mouseenter",_),p.addEventListener("mouseleave",f),()=>{p.removeEventListener("mouseenter",_),p.removeEventListener("mouseleave",f)}},[d]),e(V,{children:[e(V,{ref:d,children:t}),!s&&i&&Ft(e("div",{className:"vm-tooltip",ref:u,style:v,children:a}),document.body)]})},ma=e("code",{children:$a()?"Cmd":"Ctrl"}),ll=[{title:"Zoom in",description:e(V,{children:["To zoom in, hold down the ",ma," + ",e("code",{children:"scroll up"}),", or press the ",e("code",{children:"+"}),". Also, you can zoom in on a range on the graph by holding down your mouse button and selecting the range."]})},{title:"Zoom out",description:e(V,{children:["To zoom out, hold down the ",ma," + ",e("code",{children:"scroll down"}),", or press the ",e("code",{children:"-"}),"."]})},{title:"Move horizontal axis",description:e(V,{children:["To move the graph, hold down the ",ma," + ",e("code",{children:"drag"})," the graph to the right or left."]})},{title:"Fixing a tooltip",description:e(V,{children:["To fix the tooltip, ",e("code",{children:"click"})," mouse when it's open. Then, you can drag the fixed tooltip by ",e("code",{children:"clicking"})," and ",e("code",{children:"dragging"})," on the ",e(On,{})," icon."]})},{title:"Set a custom range for the vertical axis",description:e(V,{children:["To set a custom range for the vertical axis, click on the ",e(ht,{})," icon located in the upper right corner of the graph, activate the toggle, and set the values."]})}],cl=[{title:"Show/hide a legend item",description:e(V,{children:[e("code",{children:"click"})," on a legend item to isolate it on the graph.",ma," + ",e("code",{children:"click"})," on a legend item to remove it from the graph. To revert to the previous state, click again."]})},{title:"Copy label key-value pairs",description:e(V,{children:[e("code",{children:"click"})," on a label key-value pair to save it to the clipboard."]})},{title:"Collapse/Expand the legend group",description:e(V,{children:[e("code",{children:"click"})," on the group name (e.g. ",e("b",{children:'Query 1: {__name__!=""}'}),") to collapse or expand the legend."]})}],dl=ll.concat(cl),Kn=()=>{const{value:t,setFalse:a,setTrue:n}=oe(!1);return e(V,{children:[e(G,{title:"Show tips on working with the graph",children:e($,{variant:"text",color:"gray",startIcon:e(oa,{}),onClick:n,ariaLabel:"open the tips"})}),t&&e(Ie,{title:"Tips on working with the graph and the legend",onClose:a,children:e("div",{className:"fc-graph-tips",children:dl.map(({title:r,description:o})=>e("div",{className:"fc-graph-tips-item",children:[e("h4",{className:"fc-graph-tips-item__action",children:r}),e("p",{className:"fc-graph-tips-item__description",children:o})]},r))})})]})},gt=e("code",{children:$a()?"Cmd":"Ctrl"}),Ko=e(V,{children:[e("code",{children:$a()?"Option":"Ctrl"})," + ",e("code",{children:"Space"})]}),ml=[{title:"Query",list:[{keys:e("code",{children:"Enter"}),description:"Run"},{keys:e(V,{children:[e("code",{children:"Shift"})," + ",e("code",{children:"Enter"})]}),description:"Multi-line queries"},{keys:e(V,{children:[gt," + ",e("code",{children:"Arrow Up"})]}),description:"Previous command from the Query history"},{keys:e(V,{children:[gt," + ",e("code",{children:"Arrow Down"})]}),description:"Next command from the Query history"},{keys:e(V,{children:[gt," + ",e("code",{children:"click"})," by ",e(zt,{})]}),description:"Toggle multiple queries"},{keys:Ko,description:"Show quick autocomplete tips"}]},{title:"Graph",readMore:e(Kn,{}),list:[{keys:e(V,{children:[gt," + ",e("code",{children:"scroll Up"})," or ",e("code",{children:"+"})]}),description:"Zoom in"},{keys:e(V,{children:[gt," + ",e("code",{children:"scroll Down"})," or ",e("code",{children:"-"})]}),description:"Zoom out"},{keys:e(V,{children:[gt," + ",e("code",{children:"drag"})]}),description:"Move the graph left/right"},{keys:e(V,{children:e("code",{children:"click"})}),description:"Select the series in the legend"},{keys:e(V,{children:[gt," + ",e("code",{children:"click"})]}),description:"Toggle multiple series in the legend"}]}],Ga="Shortcut keys",mn=$a(),ul=mn?"Cmd + /":"F1",Zo=({showTitle:t})=>{const a=ye(),{value:n,setTrue:r,setFalse:o}=oe(!1),s=Z(i=>{const c=mn&&i.key==="/"&&i.metaKey,l=!mn&&i.key==="F1"&&!i.metaKey;(c||l)&&r()},[r]);return ce("keydown",s),e(V,{children:[e(G,{open:t===!0?!1:void 0,title:`${Ga} (${ul})`,placement:"bottom-center",children:e($,{className:a?"":"vm-header-button",variant:"contained",color:"primary",startIcon:e(Io,{}),onClick:r,ariaLabel:Ga,children:t&&Ga})}),n&&e(Ie,{title:"Shortcut keys",onClose:o,children:e("div",{className:"vm-shortcuts",children:ml.map(i=>e("div",{className:"vm-shortcuts-section",children:[i.readMore&&e("div",{className:"vm-shortcuts-section__read-more",children:i.readMore}),e("h3",{className:"vm-shortcuts-section__title",children:i.title}),e("div",{className:"vm-shortcuts-section-list",children:i.list.map((c,l)=>e("div",{className:"vm-shortcuts-section-list-item",children:[e("div",{className:"vm-shortcuts-section-list-item__key",children:c.keys}),e("p",{className:"vm-shortcuts-section-list-item__description",children:c.description})]},`${i.title}_${l}`))})]},i.title))})})]})},hl=({open:t})=>e("button",{className:I({"vm-menu-burger":!0,"vm-menu-burger_opened":t}),"aria-label":"menu",children:e("span",{})}),pl=({background:t,color:a})=>{const{pathname:n}=it(),{isMobile:r}=J(),o=Y(null),{value:s,toggle:i,setFalse:c}=oe(!1);return x(c,[n]),sa(o,c),e("div",{className:"vm-header-sidebar",ref:o,children:[e("div",{className:I({"vm-header-sidebar-button":!0,"vm-header-sidebar-button_open":s}),onClick:i,children:e(hl,{open:s})}),e("div",{className:I({"vm-header-sidebar-menu":!0,"vm-header-sidebar-menu_open":s}),children:[e("div",{children:e(Jo,{color:a,background:t,direction:"column"})}),e("div",{className:"vm-header-sidebar-menu-settings",children:!r&&!1})]})]})},vl=t=>`${t.replace(/^(.+)(\/select.+)/,"$1")}/admin/tenants`,gl=()=>{const{useTenantID:t}=ta(),a=ye(),{serverUrl:n}=re(),[r,o]=C(!1),[s,i]=C(),[c,l]=C([]),m=D(()=>vl(n),[n]),d=D(()=>!!aa(n),[n]),u=a?!t:!d;return x(()=>{if(u)return;(async()=>{o(!0);try{const v=await fetch(m),_=await v.json(),f=_.data||[];l(f.sort((p,g)=>p.localeCompare(g))),v.ok?i(void 0):i(`${_.errorType}\r
${_==null?void 0:_.error}`)}catch(v){v instanceof Error&&i(`${v.name}: ${v.message}`)}o(!1)})().catch(console.error)},[m]),{accountIds:c,isLoading:r,error:s}},_l=({controlsComponent:t,isMobile:a,...n})=>{const r=ye(),{pathname:o}=it(),{accountIds:s}=gl(),{value:i,toggle:c,setFalse:l}=oe(!1),m=D(()=>(lt[o]||{}).header||{},[o]),d=e(t,{...n,isMobile:a,accountIds:s,headerSetup:m});return a?e(V,{children:[e("div",{children:e($,{className:I({"vm-header-button":!r}),startIcon:e(zn,{}),onClick:c,ariaLabel:"controls"})}),e(Ie,{title:"Controls",onClose:l,isOpen:i,className:I({"vm-header-controls-modal":!0,"vm-header-controls-modal_open":i}),children:d})]}):d},Ir=()=>{switch(Ut){case ot.victorialogs:return e(xo,{});case ot.vmanomaly:return e(Lo,{});default:return e(Ao,{})}},Zn=({controlsComponent:t})=>{const{isMobile:a}=J(),n=xt(),r=D(()=>window.innerWidth<1e3,[n]),{isDarkTheme:o}=re(),s=ye(),i=D(()=>Xe(o?"color-background-block":"color-primary"),[o]),{background:c,color:l}=D(()=>{const{headerStyles:{background:u=s?"#FFF":i,color:h=s?i:"#FFF"}={}}=ta();return{background:u,color:h}},[i]),m=Na(),d=()=>{m({pathname:K.home}),window.location.reload()};return e("header",{className:I({"vm-header":!0,"vm-header_app":s,"vm-header_dark":o,"vm-header_sidebar":r,"vm-header_mobile":a}),style:{background:c,color:l},children:[r?e(pl,{background:c,color:l}):e(V,{children:[!s&&e("div",{className:"vm-header-logo",onClick:d,style:{color:l},children:e(Ir,{})}),e(Jo,{color:l,background:c})]}),r&&e("div",{className:I({"vm-header-logo":!0,"vm-header-logo_mobile":!0}),onClick:d,style:{color:l},children:e(Ir,{})}),e(_l,{controlsComponent:t,displaySidebar:r,isMobile:a})]})},Xo={href:"https://github.com/VictoriaMetrics/VictoriaMetrics/issues/new/choose",Icon:Oo,title:"Create an issue"},fl=[{href:"https://docs.victoriametrics.com/MetricsQL.html",Icon:At,title:"MetricsQL"},{href:"https://docs.victoriametrics.com/#vmui",Icon:st,title:"Documentation"},Xo],bl=[{href:"https://docs.victoriametrics.com/victorialogs/logsql/",Icon:At,title:"LogsQL"},{href:"https://docs.victoriametrics.com/victorialogs/",Icon:st,title:"Documentation"},Xo],Xn=_n(({links:t=fl})=>{const a=`2019-${new Date().getFullYear()}`;return e("footer",{className:"vm-footer",children:[e("a",{className:"vm-link vm-footer__website",target:"_blank",href:"https://victoriametrics.com/",rel:"me noreferrer",children:[e(Eo,{}),"victoriametrics.com"]}),t.map(({href:n,Icon:r,title:o})=>e("a",{className:"vm-link vm-footer__link",target:"_blank",href:n,rel:"help noreferrer",children:[e(r,{}),o]},`${n}-${o}`)),e("div",{className:"vm-footer__copyright",children:[" ",a," VictoriaMetrics"]})]})}),yl=()=>{const t=ye(),{serverUrl:a}=re(),n=Vi(),[r,o]=C(!1),[s,i]=C(""),[c,l]=C([]),m=async()=>{};return x(()=>{t||(l([]),m())},[a]),x(()=>{n({type:"SET_DASHBOARDS_SETTINGS",payload:c})},[c]),x(()=>{n({type:"SET_DASHBOARDS_LOADING",payload:r})},[r]),x(()=>{n({type:"SET_DASHBOARDS_ERROR",payload:s})},[s]),{dashboardsSettings:c,isLoading:r,error:s}},wl=({error:t,warning:a,info:n})=>{const r=Y(null),[o,s]=C(!1),[i,c]=C(!1),m=`${D(()=>t?"ERROR: ":a?"WARNING: ":"",[t,a])}${t||a||n}`,d=()=>{const h=r.current;if(h){const{offsetWidth:v,scrollWidth:_,offsetHeight:f,scrollHeight:p}=h,g=v+1<_||f+1<p;s(g)}else s(!1)},u=()=>{o&&(c(!0),s(!1))};return x(()=>{c(!1),d()},[r,m]),ce("resize",d),!t&&!a&&!n?null:e("span",{className:I({"vm-text-field__error":!0,"vm-text-field__warning":a&&!t,"vm-text-field__helper-text":!a&&!t,"vm-text-field__error_overflowed":o,"vm-text-field__error_full":i}),"data-show":!!m,ref:r,onClick:u,children:m})},le=({label:t,value:a,type:n="text",error:r="",warning:o="",helperText:s="",placeholder:i,endIcon:c,startIcon:l,disabled:m=!1,autofocus:d=!1,inputmode:u="text",caretPosition:h,onChange:v,onEnter:_,onKeyDown:f,onFocus:p,onBlur:g,onChangeCaret:b})=>{const{isDarkTheme:y}=re(),{isMobile:w}=J(),T=Y(null),S=Y(null),N=D(()=>n==="textarea"?S:T,[n]),k=I({"vm-text-field__input":!0,"vm-text-field__input_error":r,"vm-text-field__input_warning":!r&&o,"vm-text-field__input_icon-start":l,"vm-text-field__input_disabled":m,"vm-text-field__input_textarea":n==="textarea"}),A=B=>{if(!b)return;const{selectionStart:F,selectionEnd:te}=B;b&&b([F||0,te||0])},L=B=>{A(B.currentTarget)},E=B=>{f&&f(B);const{key:F,ctrlKey:te,metaKey:de}=B,W=F==="Enter";(n!=="textarea"?W:W&&(de||te))&&_&&(B.preventDefault(),_())},M=B=>{A(B.currentTarget)},P=B=>{m||(v&&v(B.currentTarget.value),A(B.currentTarget))},R=()=>{p&&p()},Q=()=>{g&&g()},H=B=>{try{N.current&&N.current.setSelectionRange(B[0],B[1])}catch(F){return F}};return x(()=>{var B;!d||w||(B=N==null?void 0:N.current)!=null&&B.focus&&N.current.focus()},[N,d]),x(()=>{h&&H(h)},[h]),e("label",{className:I({"vm-text-field":!0,"vm-text-field_textarea":n==="textarea","vm-text-field_dark":y}),"data-replicated-value":a,children:[l&&e("div",{className:"vm-text-field__icon-start",children:l}),c&&e("div",{className:"vm-text-field__icon-end",children:c}),n==="textarea"?e("textarea",{className:k,disabled:m,ref:S,value:a,rows:1,inputMode:u,placeholder:i,autoCapitalize:"none",onInput:P,onKeyDown:E,onKeyUp:M,onFocus:R,onBlur:Q,onMouseUp:L}):e("input",{className:k,disabled:m,ref:T,value:a,type:n,placeholder:i,inputMode:u,autoCapitalize:"none",onInput:P,onKeyDown:E,onKeyUp:M,onFocus:R,onBlur:Q,onMouseUp:L}),t&&e("span",{className:"vm-text-field__label",children:t}),e(wl,{error:r,warning:o,info:s})]})},es=({accountIds:t})=>{const a=ye(),{isMobile:n}=J(),{tenantId:r,serverUrl:o}=re(),s=Tt(),i=Fe(),[c,l]=C(""),m=Y(null),{value:d,toggle:u,setFalse:h}=oe(!1),v=D(()=>{if(!c)return t;try{const p=new RegExp(c,"i");return t.filter(b=>p.test(b)).sort((b,y)=>{var w,T;return(((w=b.match(p))==null?void 0:w.index)||0)-(((T=y.match(p))==null?void 0:T.index)||0)})}catch{return[]}},[c,t]),_=D(()=>t.length>1,[t]),f=p=>()=>{const g=p;if(s({type:"SET_TENANT_ID",payload:g}),o){const b=ho(o,g);if(b===o)return;s({type:"SET_SERVER",payload:b}),i({type:"RUN_QUERY"})}h()};return x(()=>{const p=aa(o);r&&r!==p?f(r)():f(p)()},[o]),_?e("div",{className:"vm-tenant-input",children:[e(G,{title:"Define Tenant ID if you need request to another storage",children:e("div",{ref:m,children:n?e("div",{className:"vm-mobile-option",onClick:u,children:[e("span",{className:"vm-mobile-option__icon",children:e(Nt,{})}),e("div",{className:"vm-mobile-option-text",children:[e("span",{className:"vm-mobile-option-text__label",children:"Tenant ID"}),e("span",{className:"vm-mobile-option-text__value",children:r})]}),e("span",{className:"vm-mobile-option__arrow",children:e(ge,{})})]}):e($,{className:a?"":"vm-header-button",variant:"contained",color:"primary",fullWidth:!0,startIcon:e(Nt,{}),endIcon:e("div",{className:I({"vm-execution-controls-buttons__arrow":!0,"vm-execution-controls-buttons__arrow_open":d}),children:e(ge,{})}),onClick:u,children:r})})}),e(Se,{open:d,placement:"bottom-right",onClose:h,buttonRef:m,title:n?"Define Tenant ID":void 0,children:e("div",{className:I({"vm-list vm-tenant-input-list":!0,"vm-list vm-tenant-input-list_mobile":n}),children:[e("div",{className:"vm-tenant-input-list__search",children:e(le,{autofocus:!0,label:"Search",value:c,onChange:l,type:"search"})}),v.map(p=>e("div",{className:I({"vm-list-item":!0,"vm-list-item_mobile":n,"vm-list-item_active":p===r}),onClick:f(p),children:p},p))]})})]}):null};function Xt(t){const a=Y();return x(()=>{a.current=t},[t]),a.current}const we=({text:t,href:a,children:n,colored:r=!0,underlined:o=!1,withIcon:s=!1})=>e("a",{href:a,className:I({"vm-link":!0,"vm-link_colored":r,"vm-link_underlined":o,"vm-link_with-icon":s}),target:"_blank",rel:"noreferrer",children:t||n}),ts=()=>{const t=ye(),{isMobile:a}=J(),{customStep:n,isHistogram:r}=Ve(),{period:{step:o,end:s,start:i}}=he(),c=Lt(),{displayType:l}=He(),m=Xt(s-i),d=D(()=>na(s-i,r,l),[s,i,r,l]),u=Xt(d),[h,v]=C(n||d),[_,f]=C(""),p=n===d,{value:g,toggle:b,setFalse:y}=oe(!1),w=Y(null),T=E=>{const M=E||h||d||"1s",R=(M.match(/[a-zA-Z]+/g)||[]).length?M:`${M}s`;c({type:"SET_CUSTOM_STEP",payload:R}),v(R),f("")},S=()=>{T(),y()},N=()=>{document.activeElement instanceof HTMLInputElement&&document.activeElement.select()},k=()=>{T(),S()},A=E=>{const M=E.match(/[-+]?([0-9]*\.[0-9]+|[0-9]+)/g)||[],P=E.match(/[a-zA-Z]+/g)||[],R=M.length&&M.every(B=>parseFloat(B)>0),Q=P.every(B=>Sn.find(F=>F.short===B)),H=R&&Q;v(E),f(H?"":be.validStep)},L=()=>{const E=d||"1s";A(E),T(E)};return x(()=>{n&&T(n)},[n]),x(()=>{!n&&d&&T(d)},[d]),x(()=>{s-i===m||!m||n!==u||d&&T(d)},[m,d]),x(()=>{(o===n||o===d)&&T(d)},[r,l]),e("div",{className:"vm-step-control",ref:w,children:[a?e("div",{className:"vm-mobile-option",onClick:b,children:[e("span",{className:"vm-mobile-option__icon",children:e(fa,{})}),e("div",{className:"vm-mobile-option-text",children:[e("span",{className:"vm-mobile-option-text__label",children:"Step"}),e("span",{className:"vm-mobile-option-text__value",children:h})]}),e("span",{className:"vm-mobile-option__arrow",children:e(ge,{})})]}):e($,{className:t?"":"vm-header-button",variant:"contained",color:"primary",startIcon:e(fa,{}),onClick:b,children:["Step: ",p?`auto (${h})`:h]}),e(Se,{open:g,placement:"bottom-right",onClose:S,buttonRef:w,title:a?"Query resolution step width":void 0,children:e("div",{className:I({"vm-step-control-popper":!0,"vm-step-control-popper_mobile":a}),children:[e(le,{autofocus:!0,label:"Step value",value:h,error:_,onChange:A,onEnter:k,onFocus:N,onBlur:T,endIcon:e(G,{title:`Reset to auto step (${d})`,children:e($,{size:"small",variant:"text",color:"primary",startIcon:e(rt,{}),onClick:L,ariaLabel:"reset step"})})}),e("div",{className:"vm-step-control-popper-info",children:[e("p",{children:[e("code",{children:"step"})," - the ",e(we,{href:"https://prometheus.io/docs/prometheus/latest/querying/basics/#time-durations",text:"interval"})," between datapoints, which must be returned from the range query. The ",e("code",{children:"query"})," is executed at ",e("code",{children:"start"}),", ",e("code",{children:"start+step"}),", ",e("code",{children:"start+2*step"}),", , ",e("code",{children:"end"})," timestamps."]}),e("p",{children:["Read more about ",e(we,{href:"https://docs.victoriametrics.com/keyConcepts.html#range-query",text:"Range"})," and ",e(we,{href:"https://docs.victoriametrics.com/keyconcepts/#instant-query",text:"Instant"})," queries."]})]})]})})]})},Cl=({relativeTime:t,setDuration:a})=>{const{isMobile:n}=J(),r=o=>()=>{a(o)};return e("div",{className:I({"vm-time-duration":!0,"vm-time-duration_mobile":n}),children:Jt.map(({id:o,duration:s,until:i,title:c})=>e("div",{className:I({"vm-list-item":!0,"vm-list-item_mobile":n,"vm-list-item_active":o===t}),onClick:r({duration:s,until:i(),id:o}),children:c||s},o))})},Nl=({viewDate:t,showArrowNav:a,onChangeViewDate:n,toggleDisplayYears:r})=>{const o=()=>{n(t.subtract(1,"month"))},s=()=>{n(t.add(1,"month"))};return e("div",{className:"vm-calendar-header",children:[e("div",{className:"vm-calendar-header-left",onClick:r,children:[e("span",{className:"vm-calendar-header-left__date",children:t.format("MMMM YYYY")}),e("div",{className:"vm-calendar-header-left__select-year",children:e(We,{})})]}),a&&e("div",{className:"vm-calendar-header-right",children:[e("div",{className:"vm-calendar-header-right__prev",onClick:o,children:e(ge,{})}),e("div",{className:"vm-calendar-header-right__next",onClick:s,children:e(ge,{})})]})]})},kl=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],Sl=({viewDate:t,selectDate:a,onChangeSelectDate:n})=>{const r="YYYY-MM-DD",o=q.tz(),s=q(t.format(r)),i=D(()=>{const l=new Array(42).fill(null),m=s.startOf("month"),u=s.endOf("month").diff(m,"day")+1,h=new Array(u).fill(m).map((_,f)=>_.add(f,"day")),v=m.day();return l.splice(v,u,...h),l},[s]),c=l=>()=>{l&&n(l)};return e("div",{className:"vm-calendar-body",children:[kl.map(l=>e(G,{title:l,children:e("div",{className:"vm-calendar-body-cell vm-calendar-body-cell_weekday",children:l[0]})},l)),i.map((l,m)=>e("div",{className:I({"vm-calendar-body-cell":!0,"vm-calendar-body-cell_day":!0,"vm-calendar-body-cell_day_empty":!l,"vm-calendar-body-cell_day_active":(l&&l.format(r))===a.format(r),"vm-calendar-body-cell_day_today":(l&&l.format(r))===o.format(r)}),onClick:c(l),children:l&&l.format("D")},l?l.format(r):m))]})},Tl=({viewDate:t,onChangeViewDate:a})=>{const n=q().format("YYYY"),r=D(()=>t.format("YYYY"),[t]),o=D(()=>{const l=q().subtract(18/2,"year");return new Array(18).fill(l).map((m,d)=>m.add(d,"year"))},[t]);x(()=>{const i=document.getElementById(`vm-calendar-year-${r}`);i&&i.scrollIntoView({block:"center"})},[]);const s=i=>()=>{a(i)};return e("div",{className:"vm-calendar-years",children:o.map(i=>e("div",{className:I({"vm-calendar-years__year":!0,"vm-calendar-years__year_selected":i.format("YYYY")===r,"vm-calendar-years__year_today":i.format("YYYY")===n}),id:`vm-calendar-year-${i.format("YYYY")}`,onClick:s(i),children:i.format("YYYY")},i.format("YYYY")))})},Al=({viewDate:t,selectDate:a,onChangeViewDate:n})=>{const r=q().format("MM"),o=D(()=>a.format("MM"),[a]),s=D(()=>new Array(12).fill("").map((c,l)=>q(t).month(l)),[t]);x(()=>{const c=document.getElementById(`vm-calendar-year-${o}`);c&&c.scrollIntoView({block:"center"})},[]);const i=c=>()=>{n(c)};return e("div",{className:"vm-calendar-years",children:s.map(c=>e("div",{className:I({"vm-calendar-years__year":!0,"vm-calendar-years__year_selected":c.format("MM")===o,"vm-calendar-years__year_today":c.format("MM")===r}),id:`vm-calendar-year-${c.format("MM")}`,onClick:i(c),children:c.format("MMMM")},c.format("MM")))})},xl=({date:t,format:a=Ke,onChange:n})=>{const[r,o]=C(0),[s,i]=C(q.tz(t)),[c,l]=C(q.tz(t)),m=q.tz(),d=m.format(yt)===s.format(yt),{isMobile:u}=J(),h=()=>{o(p=>p===2?0:2)},v=p=>{i(p),o(g=>g===2?1:0)},_=p=>{l(p)},f=()=>{i(m)};return x(()=>{c.format()!==q.tz(t).format()&&n(c.format(a))},[c]),x(()=>{const p=q.tz(t);i(p),l(p)},[t]),e("div",{className:I({"vm-calendar":!0,"vm-calendar_mobile":u}),children:[e(Nl,{viewDate:s,onChangeViewDate:v,toggleDisplayYears:h,showArrowNav:r===0}),r===0&&e(Sl,{viewDate:s,selectDate:c,onChangeSelectDate:_}),r===2&&e(Tl,{viewDate:s,onChangeViewDate:v}),r===1&&e(Al,{selectDate:c,viewDate:s,onChangeViewDate:v}),!d&&r===0&&e("div",{className:"vm-calendar-footer",children:e($,{variant:"text",size:"small",onClick:f,children:"show today"})})]})},as=ka(({date:t,targetRef:a,format:n=Ke,onChange:r,label:o},s)=>{const i=D(()=>q(t).isValid()?q.tz(t):q().tz(),[t]),{isMobile:c}=J(),{value:l,toggle:m,setFalse:d}=oe(!1),u=v=>{r(v),d()},h=v=>{(v.key==="Escape"||v.key==="Enter")&&d()};return ce("click",m,a),ce("keyup",h),e(V,{children:e(Se,{open:l,buttonRef:a,placement:"bottom-right",onClose:d,title:c?o:void 0,children:e("div",{ref:s,children:e(xl,{date:i,format:n,onChange:u})})})})}),Pr=t=>q(t).isValid()?q.tz(t).format(Ke):t,$r=({value:t="",label:a,pickerLabel:n,pickerRef:r,onChange:o,onEnter:s})=>{const i=Y(null),[c,l]=C(null),[m,d]=C(Pr(t)),[u,h]=C(!1),[v,_]=C(!1),f=q(m).isValid()?"":"Invalid date format",p=w=>{d(w.currentTarget.value)},g=()=>{o(m)},b=w=>{w.key==="Enter"&&(o(m),_(!0))},y=w=>{d(w),h(!0)};return x(()=>{const w=Pr(t);w!==m&&d(w),v&&(s(),_(!1))},[t]),x(()=>{u&&c&&(c.focus(),c.setSelectionRange(11,11),h(!1))},[u]),e("div",{className:I({"vm-date-time-input":!0,"vm-date-time-input_error":f}),children:[e("label",{children:a}),e(Ws,{tabIndex:1,inputRef:l,mask:"9999-99-99 99:99:99",placeholder:"YYYY-MM-DD HH:mm:ss",value:m,autoCapitalize:"none",inputMode:"numeric",maskChar:null,onChange:p,onBlur:g,onKeyUp:b}),f&&e("span",{className:"vm-date-time-input__error-text",children:f}),e("div",{className:"vm-date-time-input__icon",ref:i,children:e($,{variant:"text",color:"gray",size:"small",startIcon:e(_a,{}),ariaLabel:"calendar"})}),e(as,{label:n,ref:r,date:m,onChange:y,targetRef:i})]})},er=()=>{const{isMobile:t}=J(),{isDarkTheme:a}=re(),n=Y(null),r=xt(),o=D(()=>r.width>1120,[r]),[s,i]=C(),[c,l]=C(),{period:{end:m,start:d},relativeTime:u,timezone:h,duration:v}=he(),_=Fe(),f=ye(),p=Xt(h),{value:g,toggle:b,setFalse:y}=oe(!1),w=D(()=>({region:h,utc:Wt(h)}),[h]);x(()=>{i(Pt(Ye(m)))},[h,m]),x(()=>{l(Pt(Ye(d)))},[h,d]);const T=({duration:R,until:Q,id:H})=>{_({type:"SET_RELATIVE_TIME",payload:{duration:R,until:Q,id:H}}),y()},S=D(()=>{const R=q.tz(Ye(d)).format(Ke),Q=q.tz(Ye(m)).format(Ke);return{start:R,end:Q}},[d,m,h]),N=D(()=>u&&u!=="none"?u.replace(/_/g," "):`${S.start} - ${S.end}`,[u,S]),k=Y(null),A=Y(null),L=Y(null),E=()=>{c&&s&&_({type:"SET_PERIOD",payload:{from:q.tz(c).toDate(),to:q.tz(s).toDate()}}),y()},M=()=>_({type:"RUN_QUERY_TO_NOW"}),P=()=>{i(Pt(Ye(m))),l(Pt(Ye(d))),y()};return x(()=>{const R=xn({relativeTimeId:u,defaultDuration:v,defaultEndInput:Ye(m)});p&&h!==p&&T({id:R.relativeTimeId,duration:R.duration,until:R.endInput})},[h,p]),sa(n,R=>{var F,te;if(t)return;const Q=R.target,H=(k==null?void 0:k.current)&&((F=k==null?void 0:k.current)==null?void 0:F.contains(Q)),B=(A==null?void 0:A.current)&&((te=A==null?void 0:A.current)==null?void 0:te.contains(Q));H||B||y()}),e(V,{children:[e("div",{ref:L,children:t?e("div",{className:"vm-mobile-option",onClick:b,children:[e("span",{className:"vm-mobile-option__icon",children:e(Kt,{})}),e("div",{className:"vm-mobile-option-text",children:[e("span",{className:"vm-mobile-option-text__label",children:"Time range"}),e("span",{className:"vm-mobile-option-text__value",children:N})]}),e("span",{className:"vm-mobile-option__arrow",children:e(ge,{})})]}):e(G,{title:o?"Time range controls":N,children:e($,{className:f?"":"vm-header-button",variant:"contained",color:"primary",startIcon:e(Kt,{}),onClick:b,ariaLabel:"time range controls",children:o&&e("span",{children:N})})})}),e(Se,{open:g,buttonRef:L,placement:"bottom-right",onClose:y,clickOutside:!1,title:t?"Time range controls":"",children:e("div",{className:I({"vm-time-selector":!0,"vm-time-selector_mobile":t}),ref:n,children:[e("div",{className:"vm-time-selector-left",children:[e("div",{className:I({"vm-time-selector-left-inputs":!0,"vm-time-selector-left-inputs_dark":a}),children:[e($r,{value:c,label:"From:",pickerLabel:"Date From",pickerRef:k,onChange:l,onEnter:E}),e($r,{value:s,label:"To:",pickerLabel:"Date To",pickerRef:A,onChange:i,onEnter:E})]}),e("div",{className:"vm-time-selector-left-timezone",children:[e("div",{className:"vm-time-selector-left-timezone__title",children:w.region}),e("div",{className:"vm-time-selector-left-timezone__utc",children:w.utc})]}),e($,{variant:"text",startIcon:e(Do,{}),onClick:M,children:"switch to now"}),e("div",{className:"vm-time-selector-left__controls",children:[e($,{color:"error",variant:"outlined",onClick:P,children:"Cancel"}),e($,{color:"primary",onClick:E,children:"Apply"})]})]}),e(Cl,{relativeTime:u||"",setDuration:T})]})})]})},vt=()=>{const t=Na(),[a,n]=ie();return{setSearchParamsFromKeys:Z(o=>{const s=!!Array.from(a.values()).length;let i=!1;Object.entries(o).forEach(([c,l])=>{a.get(c)!==`${l}`&&(a.set(c,`${l}`),i=!0)}),i&&(s?n(a):t(`?${a.toString()}`,{replace:!0}))},[a,t])}},ns=()=>{const{isMobile:t}=J(),a=ye(),n=Y(null),[r]=ie(),{setSearchParamsFromKeys:o}=vt(),s=r.get("date")||q().tz().format(yt),i=D(()=>q.tz(s).format(yt),[s]),c=l=>{o({date:l})};return x(()=>{c(s)},[]),e("div",{children:[e("div",{ref:n,children:t?e("div",{className:"vm-mobile-option",children:[e("span",{className:"vm-mobile-option__icon",children:e(_a,{})}),e("div",{className:"vm-mobile-option-text",children:[e("span",{className:"vm-mobile-option-text__label",children:"Date control"}),e("span",{className:"vm-mobile-option-text__value",children:i})]}),e("span",{className:"vm-mobile-option__arrow",children:e(ge,{})})]}):e(G,{title:"Date control",children:e($,{className:a?"":"vm-header-button",variant:"contained",color:"primary",startIcon:e(_a,{}),children:i})})}),e(as,{label:"Date control",date:s||"",format:yt,onChange:c,targetRef:n})]})},Wa=[{seconds:0,title:"Off"},{seconds:1,title:"1s"},{seconds:2,title:"2s"},{seconds:5,title:"5s"},{seconds:10,title:"10s"},{seconds:30,title:"30s"},{seconds:60,title:"1m"},{seconds:300,title:"5m"},{seconds:900,title:"15m"},{seconds:1800,title:"30m"},{seconds:3600,title:"1h"},{seconds:7200,title:"2h"}],tr=()=>{const{isMobile:t}=J(),a=Fe(),n=ye(),[r,o]=C(!1),[s,i]=C(Wa[0]),{value:c,toggle:l,setFalse:m}=oe(!1),d=Y(null),u=_=>{(r&&!_.seconds||!r&&_.seconds)&&o(f=>!f),i(_),m()},h=()=>{a({type:"RUN_QUERY"})};x(()=>{const _=s.seconds;let f;return r?f=setInterval(()=>{a({type:"RUN_QUERY"})},_*1e3):i(Wa[0]),()=>{f&&clearInterval(f)}},[s,r]);const v=_=>()=>{u(_)};return e(V,{children:[e("div",{className:"vm-execution-controls",children:e("div",{className:I({"vm-execution-controls-buttons":!0,"vm-execution-controls-buttons_mobile":t,"vm-header-button":!n}),children:[!t&&e(G,{title:"Refresh dashboard",children:e($,{variant:"contained",color:"primary",onClick:h,startIcon:e(La,{}),ariaLabel:"refresh dashboard"})}),t?e("div",{className:"vm-mobile-option",onClick:l,children:[e("span",{className:"vm-mobile-option__icon",children:e(rt,{})}),e("div",{className:"vm-mobile-option-text",children:[e("span",{className:"vm-mobile-option-text__label",children:"Auto-refresh"}),e("span",{className:"vm-mobile-option-text__value",children:s.title})]}),e("span",{className:"vm-mobile-option__arrow",children:e(ge,{})})]}):e(G,{title:"Auto-refresh control",children:e("div",{ref:d,children:e($,{variant:"contained",color:"primary",fullWidth:!0,endIcon:e("div",{className:I({"vm-execution-controls-buttons__arrow":!0,"vm-execution-controls-buttons__arrow_open":c}),children:e(ge,{})}),onClick:l,children:s.title})})})]})}),e(Se,{open:c,placement:"bottom-right",onClose:m,buttonRef:d,title:t?"Auto-refresh duration":void 0,children:e("div",{className:I({"vm-execution-controls-list":!0,"vm-execution-controls-list_mobile":t}),children:Wa.map(_=>e("div",{className:I({"vm-list-item":!0,"vm-list-item_mobile":t,"vm-list-item_active":_.seconds===s.seconds}),onClick:v(_),children:_.title},_.seconds))})})]})},Or={enable:"Enable to save the modified server URL to local storage, preventing reset upon page refresh.",disable:"Disable to stop saving the server URL to local storage, reverting to the default URL on page refresh."},Ll=ka(({onClose:t},a)=>{const{serverUrl:n}=re(),r=Tt(),{value:o,toggle:s}=oe(!!ze("SERVER_URL")),[i,c]=C(n),[l,m]=C(""),d=h=>{c(h||""),m("")},u=Z(()=>{const h=aa(i);h!==""&&r({type:"SET_TENANT_ID",payload:h}),r({type:"SET_SERVER",payload:i}),t()},[i]);return x(()=>{n||m(be.emptyServer),Cn(n)||m(be.validServer)},[n]),x(()=>{o?Le("SERVER_URL",i):po(["SERVER_URL"])},[o]),x(()=>{o&&Le("SERVER_URL",i)},[i]),x(()=>{n!==i&&c(n)},[n]),fn(a,()=>({handleApply:u}),[u]),e("div",{children:[e("div",{className:"vm-server-configurator__title",children:"Server URL"}),e("div",{className:"vm-server-configurator-url",children:[e(le,{autofocus:!0,value:i,error:l,onChange:d,onEnter:u,inputmode:"url"}),e(G,{title:o?Or.disable:Or.enable,children:e($,{className:"vm-server-configurator-url__button",variant:"text",color:o?"primary":"gray",onClick:s,startIcon:e(Nt,{})})})]})]})}),El=[{label:"Graph",type:_e.chart},{label:"JSON",type:_e.code},{label:"Table",type:_e.table}],Ml=ka(({onClose:t},a)=>{const{isMobile:n}=J(),{seriesLimits:r}=He(),o=jt(),[s,i]=C(r),[c,l]=C({table:"",chart:"",code:""}),m=()=>{i(go)},d=h=>v=>{const _=v||"";l(f=>({...f,[h]:+_<0?be.positiveNumber:""})),i({...s,[h]:_||1/0})},u=Z(()=>{o({type:"SET_SERIES_LIMITS",payload:s}),t()},[s]);return fn(a,()=>({handleApply:u}),[u]),e("div",{className:"vm-limits-configurator",children:[e("div",{className:"vm-server-configurator__title",children:["Series limits by tabs",e(G,{title:"Set to 0 to disable the limit",children:e($,{variant:"text",color:"primary",size:"small",startIcon:e(Ge,{})})}),e("div",{className:"vm-limits-configurator-title__reset",children:e($,{variant:"text",color:"primary",size:"small",startIcon:e(rt,{}),onClick:m,children:"Reset limits"})})]}),e("div",{className:I({"vm-limits-configurator__inputs":!0,"vm-limits-configurator__inputs_mobile":n}),children:El.map(h=>e("div",{children:e(le,{label:h.label,value:s[h.type],error:c[h.type],onChange:d(h.type),onEnter:u,type:"number"})},h.type))})]})}),Oa=({defaultExpanded:t=!1,onChange:a,title:n,children:r})=>{const[o,s]=C(t),i=()=>{const c=window.getSelection();c&&c.toString()||s(l=>!l)};return x(()=>{a&&a(o)},[o]),x(()=>{s(t)},[t]),e(V,{children:[e("header",{className:`vm-accordion-header ${o&&"vm-accordion-header_open"}`,onClick:i,children:[n,e("div",{className:`vm-accordion-header__arrow ${o&&"vm-accordion-header__arrow_open"}`,children:e(ge,{})})]}),o&&e("section",{className:"vm-accordion-section",children:r},"content")]})},Dl="Browser timezone is not recognized, supported, or could not be determined.",Il=()=>e(G,{title:Dl,children:e(Mn,{})}),ia=ko(),Pl=ka((t,a)=>{const{isMobile:n}=J(),r=Er(),{timezone:o,defaultTimezone:s}=he(),i=Fe(),[c,l]=C(o),[m,d]=C(""),u=Y(null),{value:h,toggle:v,setFalse:_}=oe(!1),f=D(()=>[{title:`Default time (${s})`,region:s,utc:s?Wt(s):"UTC"},{title:ia.title,region:ia.region,utc:Wt(ia.region),isInvalid:!ia.isValid},{title:"UTC (Coordinated Universal Time)",region:"UTC",utc:"UTC"}].filter(S=>S.region),[s]),p=D(()=>{if(!m)return r;try{return Er(m)}catch{return{}}},[m,r]),g=D(()=>Object.keys(p),[p]),b=D(()=>({region:c,utc:Wt(c)}),[c]),y=S=>{d(S)},w=S=>{l(S.region),d(""),_()},T=S=>()=>{w(S)};return x(()=>{l(o)},[o]),fn(a,()=>({handleApply:()=>{i({type:"SET_TIMEZONE",payload:c})}}),[c]),e("div",{className:"vm-timezones",children:[e("div",{className:"vm-server-configurator__title",children:"Time zone"}),e("div",{className:"vm-timezones-item vm-timezones-item_selected",onClick:v,ref:u,children:[e("div",{className:"vm-timezones-item__title",children:b.region}),e("div",{className:"vm-timezones-item__utc",children:b.utc}),e("div",{className:I({"vm-timezones-item__icon":!0,"vm-timezones-item__icon_open":h}),children:e(We,{})})]}),e(Se,{open:h,buttonRef:u,placement:"bottom-left",onClose:_,fullWidth:!0,title:n?"Time zone":void 0,children:e("div",{className:I({"vm-timezones-list":!0,"vm-timezones-list_mobile":n}),children:[e("div",{className:"vm-timezones-list-header",children:[e("div",{className:"vm-timezones-list-header__search",children:e(le,{autofocus:!0,label:"Search",value:m,onChange:y})}),f.map((S,N)=>S&&e("div",{className:"vm-timezones-item vm-timezones-list-group-options__item",onClick:T(S),children:[e("div",{className:"vm-timezones-item__title",children:[S.title,S.isInvalid&&e(Il,{})]}),e("div",{className:"vm-timezones-item__utc",children:S.utc})]},`${N}_${S.region}`))]}),g.map(S=>e("div",{className:"vm-timezones-list-group",children:e(Oa,{defaultExpanded:!0,title:e("div",{className:"vm-timezones-list-group__title",children:S}),children:e("div",{className:"vm-timezones-list-group-options",children:p[S]&&p[S].map(N=>e("div",{className:"vm-timezones-item vm-timezones-list-group-options__item",onClick:T(N),children:[e("div",{className:"vm-timezones-item__title",children:N.region}),e("div",{className:"vm-timezones-item__utc",children:N.utc})]},N.search))})})},S))]})})]})}),$l=({options:t,value:a,label:n,onChange:r})=>{const o=Y(null),[s,i]=C({width:"0px",left:"0px",borderRadius:"0px"}),c=l=>()=>{r(l)};return x(()=>{if(!o.current){i({width:"0px",left:"0px",borderRadius:"0px"});return}const l=t.findIndex(v=>v.value===a),{width:m}=o.current.getBoundingClientRect();let d=m,u=l*d,h="0";l===0&&(h="16px 0 0 16px"),l===t.length-1&&(h="10px",u-=1,h="0 16px 16px 0"),l!==0&&l!==t.length-1&&(d+=1,u-=1),i({width:`${d}px`,left:`${u}px`,borderRadius:h})},[o,a,t]),e("div",{className:"vm-toggles",children:[n&&e("label",{className:"vm-toggles__label",children:n}),e("div",{className:"vm-toggles-group",style:{gridTemplateColumns:`repeat(${t.length}, 1fr)`},children:[s.borderRadius&&e("div",{className:"vm-toggles-group__highlight",style:s}),t.map((l,m)=>e("div",{className:I({"vm-toggles-group-item":!0,"vm-toggles-group-item_first":m===0,"vm-toggles-group-item_active":l.value===a,"vm-toggles-group-item_icon":l.icon&&l.title}),onClick:c(l.value),ref:l.value===a?o:null,children:[l.icon,l.title]},l.value))]})]})},Ol=Object.values(Qe).map(t=>({title:t,value:t})),Rl=()=>{const{isMobile:t}=J(),a=Tt(),{theme:n}=re(),r=o=>{a({type:"SET_THEME",payload:o})};return e("div",{className:I({"vm-theme-control":!0,"vm-theme-control_mobile":t}),children:[e("div",{className:"vm-server-configurator__title",children:"Theme preferences"}),e("div",{className:"vm-theme-control__toggle",children:e($l,{options:Ol,value:n,onChange:r})},`${t}`)]})},Ce=({value:t=!1,disabled:a=!1,label:n,color:r="secondary",fullWidth:o,onChange:s})=>{const i=()=>{a||s(!t)},c=I({"vm-switch":!0,"vm-switch_full-width":o,"vm-switch_disabled":a,"vm-switch_active":t,[`vm-switch_${r}_active`]:t,[`vm-switch_${r}`]:r});return e("div",{className:c,onClick:i,children:[e("div",{className:"vm-switch-track",children:e("div",{className:"vm-switch-track__thumb"})}),n&&e("span",{className:"vm-switch__label",children:n})]})},zl=()=>{const{isMobile:t}=J(),{markdownParsing:a}=Wn(),n=Qo();return e("div",{children:[e("div",{className:"vm-server-configurator__title",children:"Markdown Parsing for Logs"}),e(Ce,{label:a?"Disable markdown parsing":"Enable markdown parsing",value:a,onChange:o=>{n({type:"SET_MARKDOWN_PARSING",payload:o})},fullWidth:t}),e("div",{className:"vm-server-configurator__info",children:"Toggle this switch to enable or disable the Markdown formatting for log entries. Enabling this will parse log texts to Markdown."})]})},Ja="Settings",ar=()=>{const{isMobile:t}=J(),a=ye(),n=Y(null),r=Y(null),o=Y(null),{value:s,setTrue:i,setFalse:c}=oe(!1),l=()=>{n.current&&n.current.handleApply(),r.current&&r.current.handleApply(),o.current&&o.current.handleApply(),c()},m=[{show:!a&&!1,component:e(Ll,{ref:n,onClose:c})},{show:!1,component:e(Ml,{ref:r,onClose:c})},{show:mo,component:e(zl,{})},{show:!0,component:e(Pl,{ref:o})},{show:!a,component:e(Rl,{})}].filter(d=>d.show);return e(V,{children:[t?e("div",{className:"vm-mobile-option",onClick:i,children:[e("span",{className:"vm-mobile-option__icon",children:e(ht,{})}),e("div",{className:"vm-mobile-option-text",children:e("span",{className:"vm-mobile-option-text__label",children:Ja})}),e("span",{className:"vm-mobile-option__arrow",children:e(ge,{})})]}):e(G,{title:Ja,children:e($,{className:I({"vm-header-button":!a}),variant:"contained",color:"primary",startIcon:e(ht,{}),onClick:i,ariaLabel:"settings"})}),s&&e(Ie,{title:Ja,onClose:c,children:e("div",{className:I({"vm-server-configurator":!0,"vm-server-configurator_mobile":t}),children:[m.map((d,u)=>e("div",{className:"vm-server-configurator__input",children:d.component},u)),e("div",{className:"vm-server-configurator-footer",children:[e($,{color:"error",variant:"outlined",onClick:c,children:"Cancel"}),e($,{color:"primary",variant:"contained",onClick:l,children:"Apply"})]})]})})]})},Fl=({displaySidebar:t,isMobile:a,headerSetup:n,accountIds:r})=>e("div",{className:I({"vm-header-controls":!0,"vm-header-controls_mobile":a}),children:[(n==null?void 0:n.tenant)&&e(es,{accountIds:r||[]}),(n==null?void 0:n.stepControl)&&e(ts,{}),(n==null?void 0:n.timeSelector)&&e(er,{}),(n==null?void 0:n.cardinalityDatePicker)&&e(ns,{}),(n==null?void 0:n.executionControls)&&e(tr,{}),e(ar,{}),!t&&e(Zo,{})]});ze("DISABLED_DEFAULT_TIMEZONE");const nr=()=>{const{serverUrl:t}=re();Fe();const[a,n]=C(!1),[r,o]=C(""),s=async()=>{};return x(()=>{s()},[t]),{isLoading:a,error:r}},Hl=()=>{const{serverUrl:t}=re();Tt();const[a,n]=C(!1),[r,o]=C("");return x(()=>{(async()=>{})()},[t]),{isLoading:a,error:r}},Vl=()=>{Tt();const[t,a]=C(!1),[n,r]=C("");return x(()=>{(async()=>{})()},[]),{isLoading:t,error:n}},Ul=()=>{const t=ye(),{isMobile:a}=J(),{pathname:n}=it(),[r,o]=ie();yl(),nr(),Vl(),Hl();const s=()=>{var m;const c="vmui",l=(m=lt[n])==null?void 0:m.title;document.title=l?`${l} - ${c}`:c},i=()=>{const{search:c,href:l}=window.location;if(c){const d=gn.parse(c,{ignoreQueryPrefix:!0});Object.entries(d).forEach(([u,h])=>r.set(u,h)),o(r),window.location.search=""}const m=l.replace(/\/\?#\//,"/#/");m!==l&&window.location.replace(m)};return x(s,[n]),x(i,[]),e("section",{className:"vm-container",children:[e(Zn,{controlsComponent:Fl}),e("div",{className:I({"vm-container-body":!0,"vm-container-body_mobile":a,"vm-container-body_app":t}),children:e(bn,{})}),!t&&e(Xn,{})]})},ql=`No match! 
This query hasn't selected any time series from database.
Either the requested metrics are missing in the database,
or there is a typo in series selector.`,Bl=`The shown results are marked as PARTIAL.
The result is marked as partial if one or more vmstorage nodes failed to respond to the query.`,rs=({value:t,onChange:a,onEnter:n,onArrowUp:r,onArrowDown:o,autocomplete:s,autocompleteEl:i,error:c,stats:l,label:m,disabled:d=!1,includeFunctions:u=!0})=>{const{autocompleteQuick:h}=ke(),{isMobile:v}=J(),[_,f]=C(!1),[p,g]=C([0,0]),[b,y]=C([0,0]),w=Y(null),[T,S]=C(!!i),N=Y(Sa(S,500)).current,k=[{show:(l==null?void 0:l.seriesFetched)==="0"&&!l.resultLength,text:ql},{show:l==null?void 0:l.isPartial,text:Bl}].filter(P=>P.show).map(P=>P.text).join("");l&&(m=`${m} (${l.executionTimeMsec||0}ms)`);const A=(P,R)=>{a(P),y([R,R])},L=P=>{const{key:R,ctrlKey:Q,metaKey:H,shiftKey:B}=P,te=(P.target.value||"").split(`
`).length>1,de=Q||H,W=R==="ArrowUp",ne=R==="ArrowDown",U=R==="Enter";W&&de&&(P.preventDefault(),r()),ne&&de&&(P.preventDefault(),o()),U&&_&&P.preventDefault(),U&&!B&&(!te||de)&&!_&&(P.preventDefault(),n())},E=P=>{f(!!P.length)},M=P=>{g(R=>R[0]===P[0]&&R[1]===P[1]?R:P)};return x(()=>{f(!!i&&h)},[h]),x(()=>{S(!1),N(!0)},[p]),e("div",{className:"vm-query-editor",ref:w,children:[e(le,{value:t,label:m,type:"textarea",autofocus:!v,error:c,warning:k,onKeyDown:L,onChange:a,onChangeCaret:M,disabled:d,inputmode:"search",caretPosition:b}),T&&s&&i&&e(i,{value:t,anchorEl:w,caretPosition:p,hasHelperText:!!(k||c),includeFunctions:u,onSelect:A,onFoundOptions:E})]})},Rr=({isMobile:t,hideButtons:a})=>{const{autocomplete:n}=ke(),r=qt(),{nocache:o,isTracingEnabled:s,reduceMemUsage:i}=He(),c=jt(),l=()=>{c({type:"TOGGLE_NO_CACHE"})},m=()=>{c({type:"TOGGLE_REDUCE_MEM_USAGE"})},d=()=>{c({type:"TOGGLE_QUERY_TRACING"})},u=()=>{r({type:"TOGGLE_AUTOCOMPLETE"})},h=()=>{r({type:"SET_AUTOCOMPLETE_QUICK",payload:!0})};return ce("keydown",_=>{const{code:f,ctrlKey:p,altKey:g}=_;f==="Space"&&(p||g)&&(_.preventDefault(),h())}),e("div",{className:I({"vm-additional-settings":!0,"vm-additional-settings_mobile":t}),children:[!(a!=null&&a.autocomplete)&&e(G,{title:e(V,{children:["Quick tip: ",Ko]}),children:e(Ce,{label:"Autocomplete",value:n,onChange:u,fullWidth:t})}),!(a!=null&&a.disableCache)&&e(Ce,{label:"Disable cache",value:o,onChange:l,fullWidth:t}),!(a!=null&&a.reduceMemUsage)&&e(Ce,{label:"Disable deduplication",value:i,onChange:m,fullWidth:t}),!(a!=null&&a.traceQuery)&&e(Ce,{label:"Trace query",value:s,onChange:d,fullWidth:t})]})},jl=t=>{const{isMobile:a}=J(),n=Y(null),{value:r,toggle:o,setFalse:s}=oe(!1);return a?e(V,{children:[e("div",{ref:n,children:e($,{variant:"outlined",startIcon:e(Ro,{}),onClick:o,ariaLabel:"additional the query settings"})}),e(Se,{open:r,buttonRef:n,placement:"bottom-left",onClose:s,title:"Query settings",children:e(Rr,{isMobile:a,...t})})]}):e(Rr,{...t})},Ra=(t,a)=>t.length===a.length&&t.every((n,r)=>n===a[r]);function os(t,a){const n=t.reduce((r,o)=>{const s=a.map(i=>`${String(i)}: ${o[i]||"-"}`).join("|");return(r[s]=r[s]||[]).push(o),r},{});return Object.entries(n).map(([r,o])=>({keys:r.split("|"),values:o}))}const Ql=()=>{const{serverUrl:t}=re();return async n=>{try{const r=encodeURIComponent(n),o=`${t}/prettify-query?query=${r}`,s=await fetch(o);if(s.status!=200)return{query:n,error:"Error requesting /prettify-query, status: "+s.status};const i=await s.json();return i.status!="success"?{query:n,error:String(i.msg)}:{query:String(i.query),error:""}}catch(r){return console.error(r),r instanceof Error&&r.name!=="AbortError"?{query:n,error:`${r.name}: ${r.message}`}:{query:n,error:String(r)}}}},Ue=()=>{const{showInfoMessage:t}=Wi();return async(a,n)=>{if(!(navigator!=null&&navigator.clipboard))return t({text:e(Yl,{}),type:"error",timeout:2e4}),!1;try{return await navigator.clipboard.writeText(a),n&&t({text:n,type:"success"}),!0}catch(r){return r instanceof Error&&t({text:`${r.name}: ${r.message}`,type:"error"}),console.warn("Copy failed",r),!1}}},Yl=()=>e("div",{className:"vm-snackbar-details",children:[e("p",{className:"vm-snackbar-details__title",children:"Clipboard not supported"}),window.isSecureContext?e("p",{className:"vm-snackbar-details__msg",children:[e("p",{children:"Common reasons:"}),e("ul",{children:[e("li",{children:"Browser restrictions"}),e("li",{children:"Insecure connection (HTTP)"}),e("li",{children:"Permissions not granted"})]}),e("p",{children:["For detailed information, visit the ",e("a",{className:"vm-link vm-link_underlined vm-link_colored",href:"https://developer.mozilla.org/en-US/docs/Web/API/Clipboard_API#security_considerations",target:"_blank",rel:"noopener noreferrer",children:"Clipboard API documentation"})]})]}):e("p",{className:"vm-snackbar-details__msg",children:[e("p",{children:"This page is not running in a secure context (HTTPS)."}),e("p",{children:"Clipboard operations require a secure context."}),e("a",{className:"vm-link vm-link_underlined vm-link_colored",href:"https://developer.mozilla.org/en-US/docs/Web/Security/Secure_Contexts",target:"_blank",rel:"noopener noreferrer",children:"Learn more about secure contexts"})]})]}),Gl=({query:t,favorites:a,onRun:n,onToggleFavorite:r})=>{const o=Ue(),s=D(()=>a.includes(t),[t,a]);return e("div",{className:"vm-query-history-item",children:[e("span",{className:"vm-query-history-item__value",children:t}),e("div",{className:"vm-query-history-item__buttons",children:[e(G,{title:"Execute query",children:e($,{size:"small",variant:"text",onClick:()=>{n(t)},startIcon:e(Ea,{})})}),e(G,{title:"Copy query",children:e($,{size:"small",variant:"text",onClick:async()=>{await o(t,"Query has been copied")},startIcon:e(et,{})})}),e(G,{title:s?"Remove Favorite":"Add to Favorites",children:e($,{size:"small",variant:"text",color:s?"warning":"primary",onClick:()=>{r(t,s)},startIcon:s?e(Ho,{}):e(Fo,{})})})]})]})},bt={session:"session",storage:"saved",favorite:"favorite"},zr=[{label:"Session history",value:bt.session},{label:"Saved history",value:bt.storage},{label:"Favorite queries",value:bt.favorite}],Wl=({handleSelectQuery:t})=>{const{queryHistory:a}=ke(),{isMobile:n}=J(),{value:r,setTrue:o,setFalse:s}=oe(!1),[i,c]=C(zr[0].value),[l,m]=C(It("QUERY_HISTORY")),[d,u]=C(It("QUERY_FAVORITES")),h=D(()=>a.map(w=>w.values.filter(T=>T).reverse()),[a]),v=D(()=>{switch(i){case bt.favorite:return d;case bt.storage:return l;default:return h}},[i,d,l,h]),_=v==null?void 0:v.every(w=>!w.length),f=D(()=>{switch(i){case bt.favorite:return`Favorites queries are empty.
To see your favorites, mark a query as a favorite.`;default:return`Query history is empty.
To see the history, please make a query.`}},[i]),p=w=>T=>{t(T,w),s()},g=(w,T)=>{u(S=>{const N=S[0]||[];return T?[N.filter(k=>k!==w)]:!T&&!N.includes(w)?[[...N,w]]:S})},b=()=>{m(It("QUERY_HISTORY")),u(It("QUERY_FAVORITES"))},y=()=>{Le("QUERY_HISTORY","")};return x(()=>{const w=d[0]||[],T=It("QUERY_FAVORITES")[0]||[];Ra(w,T)||Le("QUERY_FAVORITES",JSON.stringify(d))},[d]),ce("storage",b),e(V,{children:[e(G,{title:"Show history",children:e($,{color:"primary",variant:"text",onClick:o,startIcon:e(Kt,{}),ariaLabel:"Show history"})}),r&&e(Ie,{title:"Query history",onClose:s,children:e("div",{className:I({"vm-query-history":!0,"vm-query-history_mobile":n}),children:[e("div",{className:I({"vm-query-history__tabs":!0,"vm-section-header__tabs":!0,"vm-query-history__tabs_mobile":n}),children:e(Bt,{activeItem:i,items:zr,onChange:c})}),e("div",{className:"vm-query-history-list",children:[_&&e("div",{className:"vm-query-history-list__no-data",children:f}),v.map((w,T)=>e("div",{children:[v.length>1&&e("div",{className:I({"vm-query-history-list__group-title":!0,"vm-query-history-list__group-title_first":T===0}),children:["Query ",T+1]}),w.map((S,N)=>e(Gl,{query:S,favorites:d.flat(),onRun:p(T),onToggleFavorite:g},N))]},T)),i===bt.storage&&!_&&e("div",{className:"vm-query-history-footer",children:e($,{color:"error",variant:"outlined",size:"small",startIcon:e(Ma,{}),onClick:y,children:"clear history"})})]})]})})]})},qe=({containerStyles:t,message:a})=>{const{isDarkTheme:n}=re();return e("div",{className:I({"vm-spinner":!0,"vm-spinner_dark":n}),style:t,children:[e("div",{className:"half-circle-spinner",children:[e("div",{className:"circle circle-1"}),e("div",{className:"circle circle-2"})]}),a&&e("div",{className:"vm-spinner__message",children:a})]})},Jl=()=>{const{serverUrl:t}=re(),{isMobile:a}=J(),{value:n,setTrue:r,setFalse:o}=oe(!1),{query:s}=ke(),{period:i}=he(),[c,l]=C(!1),[m,d]=C(""),[u,h]=C(""),[v,_]=C(""),f=async()=>{l(!0);try{const g=encodeURIComponent(s[0]||""),b=encodeURIComponent(i.step||na(i.end-i.start,!1)),y=`${t}/api/vmanomaly/config.yaml?query=${g}&step=${b}`,w=await fetch(y),T=w.headers.get("Content-Type");if(w.ok)if(T=="application/yaml"){const S=await w.blob(),N=await S.text();d(N),h(URL.createObjectURL(S))}else _("Response Content-Type is not YAML, does `Server URL` point to VMAnomaly server?");else{const S=await w.text();_(` ${w.status} ${w.statusText}: ${S}`)}}catch(g){console.error(g),_(String(g))}l(!1)};return e(V,{children:[e($,{color:"secondary",variant:"outlined",onClick:()=>(r(),_(""),URL.revokeObjectURL(u),d(""),h(""),f()),children:"Open Config"}),n&&e(Ie,{title:"Download config",onClose:o,children:e("div",{className:I({"vm-anomaly-config":!0,"vm-anomaly-config_mobile":a}),children:[c&&e(qe,{containerStyles:{position:"relative"},message:"Loading config..."}),!c&&v&&e("div",{className:"vm-anomaly-config-error",children:[e("div",{className:"vm-anomaly-config-error__icon",children:e(Dn,{})}),e("h3",{className:"vm-anomaly-config-error__title",children:"Cannot download config"}),e("p",{className:"vm-anomaly-config-error__text",children:v})]}),!c&&m&&e(le,{value:m,label:"config.yaml",type:"textarea",disabled:!0}),e("div",{className:"vm-anomaly-config-footer",children:u&&e("a",{href:u,download:"config.yaml",children:e($,{variant:"contained",startIcon:e(Pa,{}),children:"download"})})})]})})]})},rr=({value:t,options:a,anchor:n,disabled:r,minLength:o=2,fullWidth:s,selected:i,noOptionsText:c,label:l,disabledFullScreen:m,offset:d,maxDisplayResults:u,loading:h,onSelect:v,onOpenAutocomplete:_,onFoundOptions:f,onChangeWrapperRef:p})=>{var de;const{isMobile:g}=J(),b=Y(null),[y,w]=C({index:-1}),[T,S]=C(""),[N,k]=C(0),{value:A,setValue:L,setFalse:E}=oe(!1),M=D(()=>{if(!A)return[];try{const W=new RegExp(String(t.trim()),"i"),U=a.filter(O=>W.test(O.value)).sort((O,z)=>{var j,X;return O.value.toLowerCase()===t.trim().toLowerCase()?-1:z.value.toLowerCase()===t.trim().toLowerCase()?1:(((j=O.value.match(W))==null?void 0:j.index)||0)-(((X=z.value.match(W))==null?void 0:X.index)||0)});return k(U.length),S(U.length>Number(u==null?void 0:u.limit)&&(u==null?void 0:u.message)||""),u!=null&&u.limit?U.slice(0,u.limit):U}catch{return[]}},[A,a,t]),P=D(()=>{var W;return M.length===1&&((W=M[0])==null?void 0:W.value)===t},[M]),R=D(()=>c&&!M.length,[c,M]),Q=W=>()=>{r||(v(W.value,W),i||E())},H=W=>()=>{w({index:W,type:0})},B=()=>{w({index:-1})},F=()=>{if(!b.current||y.type===0)return;const W=b.current.childNodes[y.index];W!=null&&W.scrollIntoView&&W.scrollIntoView({block:"center"})},te=Z(W=>{const{key:ne,ctrlKey:U,metaKey:O,shiftKey:z}=W,j=U||O||z,X=M.length&&!P;if(ne==="ArrowUp"&&!j&&X&&(W.preventDefault(),w(({index:ee})=>({index:ee<=0?0:ee-1,type:1}))),ne==="ArrowDown"&&!j&&X){W.preventDefault();const ee=M.length-1;w(({index:ue})=>({index:ue>=ee?ee:ue+1,type:1}))}if(ne==="Enter"){const ee=M[y.index];ee&&v(ee.value,ee),i||E()}ne==="Escape"&&E()},[y,M,P,E,v,i]);return x(()=>{L(t.length>=o)},[t,a]),ce("keydown",te),x(F,[y,M]),x(()=>{w({index:-1})},[M]),x(()=>{_&&_(A)},[A]),x(()=>{f&&f(P?[]:M)},[M,P]),x(()=>{p&&p(b)},[b]),e(Se,{open:A,buttonRef:n,placement:"bottom-left",onClose:E,fullWidth:s,title:g?l:void 0,disabledFullScreen:m,offset:d,children:[e("div",{className:I({"vm-autocomplete":!0,"vm-autocomplete_mobile":g&&!m}),ref:b,children:[h&&e("div",{className:"vm-autocomplete__loader",children:[e(La,{}),e("span",{children:"Loading..."})]}),R&&e("div",{className:"vm-autocomplete__no-options",children:c}),!P&&M.map((W,ne)=>e("div",{className:I({"vm-list-item":!0,"vm-list-item_mobile":g,"vm-list-item_active":ne===y.index,"vm-list-item_multiselect":i,"vm-list-item_multiselect_selected":i==null?void 0:i.includes(W.value),"vm-list-item_with-icon":W.icon}),id:`$autocomplete$${W.value}`,onClick:Q(W),onMouseEnter:H(ne),onMouseLeave:B,children:[(i==null?void 0:i.includes(W.value))&&e(Da,{}),e(V,{children:W.icon}),e("span",{children:W.value})]},`${ne}${W.value}`))]}),T&&e("div",{className:"vm-autocomplete-message",children:["Shown ",u==null?void 0:u.limit," results out of ",N,". ",T]}),((de=M[y.index])==null?void 0:de.description)&&e("div",{className:"vm-autocomplete-info",children:[e("div",{className:"vm-autocomplete-info__type",children:M[y.index].type}),e("div",{className:"vm-autocomplete-info__description",dangerouslySetInnerHTML:{__html:M[y.index].description||""}})]})]})},wa=t=>t.replace(/[/\-\\^$*+?.()|[\]{}]/g,"\\$&"),la=t=>JSON.stringify(t).slice(1,-1),Fr=t=>{const a=t.match(/["`']/g);return a?a.length%2!==0:!1},Kl={metric:e(ba,{}),label:e(Fn,{}),labelValue:e(ya,{})},Zl=({valueByContext:t,metric:a,label:n,context:r})=>{const{serverUrl:o}=re(),{period:{start:s,end:i}}=he(),{autocompleteCache:c}=ke(),l=qt(),[m,d]=C(!1),[u,h]=C(t),v=Sa(h,500);x(()=>(v(t),v.cancel),[t,v]);const[_,f]=C([]),[p,g]=C([]),[b,y]=C([]),w=Y(new AbortController),T=Z(k=>{const A=q(s*1e3).startOf("day").valueOf()/1e3,L=q(i*1e3).endOf("day").valueOf()/1e3;return new URLSearchParams({...k||{},limit:`${Ct.queryLimit}`,start:`${A}`,end:`${L}`})},[s,i]),S=(k,A)=>k.map(L=>({value:L,type:`${A}`,icon:Kl[A]})),N=async({value:k,urlSuffix:A,setter:L,type:E,params:M})=>{if(!k&&E==="metric")return;w.current.abort(),w.current=new AbortController;const{signal:P}=w.current,R={type:E,value:k,start:(M==null?void 0:M.get("start"))||"",end:(M==null?void 0:M.get("end"))||"",match:(M==null?void 0:M.get("match[]"))||""};d(!0);try{const Q=c.get(R);if(Q){L(S(Q,E)),d(!1);return}const H=await fetch(`${o}/api/v1/${A}?${M}`,{signal:P});if(H.ok){const{data:B}=await H.json();L(S(B,E)),l({type:"SET_AUTOCOMPLETE_CACHE",payload:{key:R,value:B}})}d(!1)}catch(Q){Q instanceof Error&&Q.name!=="AbortError"&&(l({type:"SET_AUTOCOMPLETE_CACHE",payload:{key:R,value:[]}}),d(!1),console.error(Q))}};return x(()=>{const k=r!==Ae.metricsql&&r!==Ae.empty;if(!o||!a||k)return;f([]);const A=la(wa(a));return N({value:u,urlSuffix:"label/__name__/values",setter:f,type:"metric",params:T({"match[]":`{__name__=~".*${A}.*"}`})}),()=>{var L;return(L=w.current)==null?void 0:L.abort()}},[o,u,r,a]),x(()=>{if(!o||r!==Ae.label)return;g([]);const k=la(a);return N({value:u,urlSuffix:"labels",setter:g,type:"label",params:T(a?{"match[]":`{__name__="${k}"}`}:void 0)}),()=>{var A;return(A=w.current)==null?void 0:A.abort()}},[o,u,r,a]),x(()=>{if(!o||!n||r!==Ae.labelValue)return;y([]);const k=la(a),A=la(wa(u)),L=a?`__name__="${k}"`:"",E=`${n}=~".*${A}.*"`,M=[L,E].filter(Boolean).join(",");return N({value:u,urlSuffix:`label/${n}/values`,setter:y,type:"labelValue",params:T({"match[]":`{${M}}`})}),()=>{var P;return(P=w.current)==null?void 0:P.abort()}},[o,u,r,a,n]),{metrics:_,labels:p,labelValues:b,loading:m}},Xl=""+new URL("MetricsQL-BWD_x39p.md",import.meta.url).href,ss="h3",ec="h4",tc="p",ac="https://docs.victoriametrics.com/MetricsQL.html",nc="vm-link vm-link_colored",rc=t=>{const a=`$1 target="_blank" class="${nc}" $2${ac}#`;return t.replace(/(<a) (href=")#/gm,a)},oc=t=>{const a=[];let n=t.nextElementSibling;for(;n&&n.tagName.toLowerCase()===tc;)n&&a.push(n),n=n.nextElementSibling;return a},sc=(t,a)=>{const n=a.textContent??"",o=oc(a).map(s=>s.outerHTML??"").join(`
`);return{type:t,value:n,description:rc(o),icon:e(Ia,{})}},ic=t=>{let a="";return Array.from(t).map(n=>{const r=n.tagName.toLowerCase()===ss;return a=r?n.textContent??"":a,r?null:sc(a,n)}).filter(Boolean)},lc=t=>{const{metricsQLFunctions:a}=ke(),n=qt(),r=o=>{const s=document.createElement("div");s.innerHTML=Ht(o);const i=s.querySelectorAll(`${ss}, ${ec}`);return ic(i)};return x(()=>{if(!t||a.length)return;(async()=>{try{const i=await(await fetch(Xl)).text(),c=r(i);n({type:"SET_METRICSQL_FUNCTIONS",payload:c})}catch(s){console.error("Error fetching or processing the MetricsQL.md file:",s)}})()},[]),t?a:[]},cc=({value:t,anchorEl:a,caretPosition:n,hasHelperText:r,includeFunctions:o,onSelect:s,onFoundOptions:i})=>{const[c,l]=C({top:0,left:0}),m=lc(o),d=D(()=>{if(n[0]!==n[1])return{beforeCursor:t,afterCursor:""};const N=t.substring(0,n[0]),k=t.substring(n[1]);return{beforeCursor:N,afterCursor:k}},[t,n]),u=D(()=>{const N=/\s(or|and|unless|default|ifnot|if|group_left|group_right)\s|}|\+|\|-|\*|\/|\^/i,k=d.beforeCursor.split(N);return k[k.length-1]},[d]),h=D(()=>{const N=/\w+\((?<metricName>[^)]+)\)\s+(by|without|on|ignoring)\s*\(\w*/gi,k=[...u.matchAll(N)];if(k.length>0&&k[0].groups&&k[0].groups.metricName)return k[0].groups.metricName;const A=/^\s*\b(?<metricName>[^{}(),\s]+)(?={|$)/g,L=[...u.matchAll(A)];return L.length>0&&L[0].groups&&L[0].groups.metricName?L[0].groups.metricName:""},[u]),v=D(()=>{const N=/[a-z_:-][\w\-.:/]*\b(?=\s*(=|!=|=~|!~))/g,k=u.match(N);return k?k[k.length-1]:""},[u]),_=N=>{const k=/([{(),+\-*/^]|\b(?:or|and|unless|default|ifnot|if|group_left|group_right|by|without|on|ignoring)\b)/i,A=N.split(/\s+/),L=A.length,E=A[L-1],M=A[L-2],P=!E&&Fr(N),R=(!E||A.length>1)&&!k.test(M);return P||R},f=D(()=>{const N=d.beforeCursor.trim(),k=["}",")"].some(P=>N.endsWith(P)),A=!Fr(N)&&["`","'",'"'].some(P=>N.endsWith(P));if(!d.beforeCursor||k||A||_(d.beforeCursor))return Ae.empty;const L=/(?:by|without|on|ignoring)\s*\(\s*[^)]*$|\{[^}]*$/i,E=`(${wa(h)})?{?.+${wa(v)}(=|!=|=~|!~)"?([^"]*)$`,M=new RegExp(E,"g");switch(!0){case M.test(d.beforeCursor):return Ae.labelValue;case L.test(d.beforeCursor):return Ae.label;default:return Ae.metricsql}},[d,h,v]),p=D(()=>{const N=d.beforeCursor.match(/([\w_.:]+(?![},]))$/);return N?N[0]:""},[d.beforeCursor]),{metrics:g,labels:b,labelValues:y,loading:w}=Zl({valueByContext:p,metric:h,label:v,context:f}),T=D(()=>{switch(f){case Ae.metricsql:return[...g,...m];case Ae.label:return b;case Ae.labelValue:return y;default:return[]}},[f,g,b,y]),S=Z(N=>{const k=d.beforeCursor;let A=d.afterCursor;const L=k.lastIndexOf(p,n[0]),E=L+p.length,M=k.substring(0,L),P=k.substring(E);if(f===Ae.labelValue){const Q='"';A=A.replace(/^[^\s"|},]*/,"");const H=/(?:=|!=|=~|!~)$/.test(M),B=A.trim()[0]!=='"';N=`${H?Q:""}${N}${B?Q:""}`}f===Ae.label&&(A=A.replace(/^[^\s=!,{}()"|+\-/*^]*/,"")),f===Ae.metricsql&&(A=A.replace(/^[^\s[\]{}()"|+\-/*^]*/,""));const R=`${M}${N}${P}${A}`;s(R,M.length+N.length)},[d]);return x(()=>{if(!a.current){l({top:0,left:0});return}const N=a.current.querySelector("textarea")||a.current,k=window.getComputedStyle(N),A=`${k.getPropertyValue("font-size")}`,L=`${k.getPropertyValue("font-family")}`,E=parseInt(`${k.getPropertyValue("line-height")}`),M=document.createElement("div");M.style.font=`${A} ${L}`,M.style.padding=k.getPropertyValue("padding"),M.style.lineHeight=`${E}px`,M.style.width=`${N.offsetWidth}px`,M.style.maxWidth=`${N.offsetWidth}px`,M.style.whiteSpace=k.getPropertyValue("white-space"),M.style.overflowWrap=k.getPropertyValue("overflow-wrap");const P=document.createElement("span");M.appendChild(document.createTextNode(d.beforeCursor)),M.appendChild(P),M.appendChild(document.createTextNode(d.afterCursor)),document.body.appendChild(M);const R=M.getBoundingClientRect(),Q=P.getBoundingClientRect(),H=Q.left-R.left,B=Q.bottom-R.bottom-(r?E:0);l({top:B,left:H}),M.remove(),P.remove()},[a,n,r]),e(V,{children:e(rr,{loading:w,disabledFullScreen:!0,value:p,options:T,anchor:a,minLength:0,offset:c,onSelect:S,onFoundOptions:i,maxDisplayResults:{limit:Ct.displayResults,message:"Please, specify the query more precisely."}})})},or=({queryErrors:t,setQueryErrors:a,setHideError:n,stats:r,label:o,isLoading:s,includeFunctions:i=!0,onHideQuery:c,onRunQuery:l,abortFetch:m,hideButtons:d})=>{const{isMobile:u}=J(),{query:h,queryHistory:v,autocomplete:_,autocompleteQuick:f}=ke(),p=qt(),g=Fe(),[b,y]=C(h||[]),[w,T]=C([]),[S,N]=C(!1),k=Xt(b),A=Ql(),L=()=>{p({type:"SET_QUERY_HISTORY",payload:b.map((U,O)=>{const z=v[O]||{values:[]},j=U===z.values[z.values.length-1],X=!j&&U?[...z.values,U]:z.values;return X.length>vo&&X.shift(),{index:z.values.length-Number(j),values:X}})})},E=()=>{if(s){m&&m();return}L(),p({type:"SET_QUERY",payload:b}),g({type:"RUN_QUERY"}),l()},M=()=>{y(U=>[...U,""])},P=U=>{y(O=>O.filter((z,j)=>j!==U))},R=(U,O)=>{const{ctrlKey:z,metaKey:j}=U;if(z||j){const ee=b.map((ue,Te)=>Te).filter(ue=>ue!==O);T(ue=>Ra(ee,ue)?[]:ee)}else T(ee=>ee.includes(O)?ee.filter(ue=>ue!==O):[...ee,O])},Q=(U,O)=>{y(z=>z.map((j,X)=>X===O?U:j))},H=(U,O)=>{Q(U,O),N(!0)},B=(U,O)=>{const{index:z,values:j}=v[O],X=z+U;X<0||X>=j.length||(Q(j[X]||"",O),p({type:"SET_QUERY_HISTORY_BY_INDEX",payload:{value:{values:j,index:X},queryNumber:O}}))},F=(U,O)=>()=>{B(U,O)},te=U=>O=>{Q(O,U),p({type:"SET_AUTOCOMPLETE_QUICK",payload:!1})},de=U=>()=>{P(U),T(O=>O.includes(U)?O.filter(z=>z!==U):O.map(z=>z>U?z-1:z))},W=U=>O=>{R(O,U)},ne=async U=>{const O=await A(b[U]);n(!1),Q(O.query,U),a(z=>(z[U]=O.error,[...z]))};return x(()=>{k&&b.length<k.length&&E()},[b]),x(()=>{c&&c(w)},[w]),x(()=>{S&&(E(),N(!1))},[b,S]),x(()=>{y(h||[])},[h]),e("div",{className:I({"vm-query-configurator":!0,"vm-block":!0,"vm-block_mobile":u}),children:[e("div",{className:"vm-query-configurator-list",children:b.map((U,O)=>e("div",{className:I({"vm-query-configurator-list-row":!0,"vm-query-configurator-list-row_disabled":w.includes(O),"vm-query-configurator-list-row_mobile":u}),children:[e(rs,{value:b[O],autocomplete:!(d!=null&&d.autocomplete)&&(_||f),autocompleteEl:cc,error:t[O],stats:r[O],onArrowUp:F(-1,O),onArrowDown:F(1,O),onEnter:E,onChange:te(O),label:`${o||"Query"} ${b.length>1?O+1:""}`,disabled:w.includes(O),includeFunctions:i}),c&&e(G,{title:w.includes(O)?"Enable query":"Disable query",children:e("div",{className:"vm-query-configurator-list-row__button",children:e($,{variant:"text",color:"gray",startIcon:w.includes(O)?e($n,{}):e(zt,{}),onClick:W(O),ariaLabel:"visibility query"})})}),!(d!=null&&d.prettify)&&e(G,{title:"Prettify query",children:e("div",{className:"vm-query-configurator-list-row__button",children:e($,{variant:"text",color:"gray",startIcon:e($o,{}),onClick:async()=>await ne(O),className:"prettify",ariaLabel:"prettify the query"})})}),b.length>1&&e(G,{title:"Remove Query",children:e("div",{className:"vm-query-configurator-list-row__button",children:e($,{variant:"text",color:"error",startIcon:e(Ma,{}),onClick:de(O),ariaLabel:"remove query"})})})]},O))}),e("div",{className:"vm-query-configurator-settings",children:[e(jl,{hideButtons:d}),e("div",{className:"vm-query-configurator-settings__buttons",children:[e(Wl,{handleSelectQuery:H}),(d==null?void 0:d.anomalyConfig)&&e(Jl,{}),!(d!=null&&d.addQuery)&&b.length<ha&&e($,{variant:"outlined",onClick:M,startIcon:e(Pn,{}),children:"Add Query"}),e($,{variant:"contained",onClick:E,startIcon:s?e(Un,{}):e(ct,{}),children:`${s?"Cancel":"Execute"} ${u?"":"Query"}`})]})]})]})},dc=(t,a,n,r,o)=>`${t}/api/v1/query_range?query=${encodeURIComponent(a)}&start=${n.start}&end=${n.end}&step=${n.step}${r?"&nocache=1":""}${o?"&trace=1":""}`,mc=(t,a,n,r,o)=>`${t}/api/v1/query?query=${encodeURIComponent(a)}&time=${n.end}&step=${n.step}${r?"&nocache=1":""}${o?"&trace=1":""}`,uc=(t,a,n,r)=>{const o=new URLSearchParams({"match[]":a,start:n.start.toString(),end:n.end.toString()});return r&&o.set("reduce_mem_usage","1"),`${t}/api/v1/export?${o}`};let hc=0;class kt{constructor(a,n){Je(this,"tracing");Je(this,"query");Je(this,"tracingChildren");Je(this,"originalTracing");Je(this,"id");this.tracing=a,this.originalTracing=JSON.parse(JSON.stringify(a)),this.query=n,this.id=hc++;const r=a.children||[];this.tracingChildren=r.map(o=>new kt(o,n))}get queryValue(){return this.query}get idValue(){return this.id}get children(){return this.tracingChildren}get message(){return this.tracing.message}get duration(){return this.tracing.duration_msec}get JSON(){return JSON.stringify(this.tracing,null,2)}get originalJSON(){return JSON.stringify(this.originalTracing,null,2)}setTracing(a){this.tracing=a;const n=a.children||[];this.tracingChildren=n.map(r=>new kt(r,this.query))}setQuery(a){this.query=a}resetTracing(){this.tracing=this.originalTracing}}const un=(t,a,n=!0)=>{const{__name__:r,...o}=t.metric,s=n?`[Query ${t.group}] `:"";if(a)return a.replace(/\{\{(\w+)}}/g,(l,m)=>t.metric[m]||"");const i=`${s}${r||""}`;if(Object.keys(o).length===0)return i||"value";const c=Object.entries(o).map(([l,m])=>`${l}=${JSON.stringify(m)}`).join(", ");return`${i}{${c}}`},ea=t=>{switch(t){case"NaN":return NaN;case"Inf":case"+Inf":return 1/0;case"-Inf":return-1/0;default:return parseFloat(t)}},sr=t=>{if(t.length<2)return!1;const a=["le","vmrange"],n=Object.keys(t[0].metric).filter(o=>!a.includes(o));return t.every(o=>{const s=Object.keys(o.metric).filter(i=>!a.includes(i));return n.length===s.length&&s.every(i=>o.metric[i]===t[0].metric[i])})&&t.every(o=>a.some(s=>s in o.metric))},za=({predefinedQuery:t,visible:a,display:n,customStep:r,hideQuery:o,showAllSeries:s})=>{const{query:i}=ke(),{period:c}=he(),{displayType:l,nocache:m,isTracingEnabled:d,seriesLimits:u}=He(),{serverUrl:h}=re(),{isHistogram:v}=Ve(),[_,f]=C(!1),[p,g]=C(),[b,y]=C(),[w,T]=C(),[S,N]=C(),[k,A]=C([]),[L,E]=C([]),[M,P]=C(),[R,Q]=C([]),[H,B]=C(!1),F=D(()=>{const{end:z,start:j}=c;return na(z-j,v,l)},[c,v,l]),de=Z(Sa(async({fetchUrl:z,fetchQueue:j,displayType:X,query:ee,stateSeriesLimits:ue,showAllSeries:Te,hideQuery:fe})=>{const Pe=new AbortController;Q([...j,Pe]);try{const Be=X===_e.chart,je=Te?1/0:+ue[X]||1/0;let Me=je;const $e=[],Qt=[];let tt=1,Et=0,dt=!1;for await(const ja of z){if(fe==null?void 0:fe.includes(tt-1)){A(mt=>[...mt,""]),E(mt=>[...mt,{}]),tt++;continue}const Qa=new URL(ja),Tr=await fetch(`${Qa.origin}${Qa.pathname}`,{signal:Pe.signal,method:"POST",body:Qa.searchParams}),pe=await Tr.json();if(Tr.ok){if(E(Ze=>[...Ze,{...pe==null?void 0:pe.stats,isPartial:pe==null?void 0:pe.isPartial,resultLength:pe.data.result.length}]),A(Ze=>[...Ze,""]),pe.trace){const Ze=new kt(pe.trace,ee[tt-1]);Qt.push(Ze)}const mt=!!De("display_mode",null);dt=!Xs&&Be&&!mt&&sr(pe.data.result),Me=dt?1/0:je;const Ya=Me-$e.length;pe.data.result.slice(0,Ya).forEach(Ze=>{Ze.group=tt,$e.push(Ze)}),Et+=pe.data.result.length}else{$e.push({metric:{},values:[],group:tt});const mt=pe.errorType||be.unknownType,Ya=(pe==null?void 0:pe.error)||(pe==null?void 0:pe.message)||"see console for more details",Ze=[mt,Ya].join(`,\r
`);A(qs=>[...qs,`${Ze}`]),console.error(`Fetch query error: ${mt}`,pe)}tt++}const Mt=`Showing ${$e.length} series out of ${Et} series due to performance reasons. Please narrow down the query, so it returns less series`;P(Et>Me?Mt:""),Be?g($e):y($e),T(Qt),B(ja=>Et?dt:ja)}catch(Be){const je=Be;if(je.name==="AbortError"){f(!1);return}let $e=`Error executing query: ${je.message}. Please check your serverURL settings and confirm server availability.`;je.message==="Unexpected end of JSON input"&&($e+=`
Additionally, this error can occur if the server response is too large to process. Apply more specific filters to reduce the data volume.`),N($e)}f(!1)},300),[]),W=D(()=>{N(""),A([]),E([]);const z=t??i,j=(n||l)===_e.chart;if(c)if(!h)N(be.emptyServer);else if(z.every(X=>!X.trim()))A(z.map(()=>be.validQuery));else if(Cn(h)){const X={...c};return X.step=r,z.map(ee=>j?dc(h,ee,X,m,d):mc(h,ee,X,m,d))}else N(be.validServer)},[h,c,l,r,o]),ne=Z(()=>{R.map(z=>z.abort()),Q([]),g([]),y([])},[R]),[U,O]=C([]);return x(()=>{const z=W===U&&!!t;if(!a||!(W!=null&&W.length)||z)return;f(!0),de({fetchUrl:W,fetchQueue:R,displayType:n||l,query:t??i,stateSeriesLimits:u,showAllSeries:s,hideQuery:o}),O(W)},[W,a,u,s]),x(()=>{const z=R.slice(0,-1);z.length&&(z.map(j=>j.abort()),Q(R.filter(j=>!j.signal.aborted)))},[R]),x(()=>{F===r&&g([])},[H]),{fetchUrl:W,isLoading:_,graphData:p,liveData:b,error:S,queryErrors:k,setQueryErrors:A,queryStats:L,warning:M,traces:w,isHistogram:H,abortFetch:ne}},Fa=()=>e("div",{className:"vm-line-loader",children:[e("div",{className:"vm-line-loader__background"}),e("div",{className:"vm-line-loader__line"})]}),ir=()=>{const{tenantId:t}=re(),{displayType:a}=He(),{query:n}=ke(),{duration:r,relativeTime:o,period:{date:s,step:i}}=he(),{customStep:c}=Ve(),[l,m]=ie(),d=Tt(),u=Fe(),h=Lt(),v=qt(),_=jt(),[f,p]=C(!1),g=Z(()=>{if(f){p(!1);return}const b=new URLSearchParams(l);n.forEach((w,T)=>{var A;const S=`g${T}`;l.get(`${S}.expr`)!==w&&w&&b.set(`${S}.expr`,w),l.get(`${S}.range_input`)!==r&&b.set(`${S}.range_input`,r),l.get(`${S}.end_input`)!==s&&b.set(`${S}.end_input`,s),l.get(`${S}.relative_time`)!==o&&b.set(`${S}.relative_time`,o||"none");const N=l.get(`${S}.step_input`)||i;N&&N!==c&&b.set(`${S}.step_input`,c);const k=`${((A=Ot.find(L=>L.value===a))==null?void 0:A.prometheusCode)||0}`;l.get(`${S}.tab`)!==k&&b.set(`${S}.tab`,`${k}`),l.get(`${S}.tenantID`)!==t&&t&&b.set(`${S}.tenantID`,t)});const y=n.length-1;Array.from(b.keys()).forEach(w=>{const T=w.match(/^g(\d+)\./);T&&parseInt(T[1],10)>y&&b.delete(w)}),!(ai(b,l)||!b.size)&&m(b)},[t,a,n,r,o,s,i,c]);x(()=>{const b=setTimeout(g,200);return()=>clearTimeout(b)},[g]),x(()=>{if(!f)return;const b=To(),y=b.duration!==r,w=b.relativeTime!==o,T=b.relativeTime==="none"&&b.period.date!==s;(y||w||T)&&u({type:"SET_TIME_STATE",payload:b});const N=Bo();N!==a&&_({type:"SET_DISPLAY_TYPE",payload:N});const k=l.get("g0.tenantID")||"";k!==t&&d({type:"SET_TENANT_ID",payload:k});const A=fo();Ra(A,n)||(v({type:"SET_QUERY",payload:A}),u({type:"RUN_QUERY"}));const L=setTimeout(()=>{const E=l.get("g0.step_input")||i;E&&E!==c&&h({type:"SET_CUSTOM_STEP",payload:E})},50);return()=>clearTimeout(L)},[l,f]),ce("popstate",()=>{p(!0)})},pc=e(we,{text:"last_over_time",href:"https://docs.victoriametrics.com/MetricsQL.html#last_over_time",underlined:!0}),vc=e(we,{text:"instant query",href:"https://docs.victoriametrics.com/keyConcepts.html#instant-query",underlined:!0}),gc=()=>{const{customStep:t}=Ve();return e("div",{children:[e("p",{children:["This tab shows ",vc," results for the last ",t||"5m"," (defined by the ",e("code",{children:"step"}),") ending at the selected time range."]}),e("p",{children:["Please wrap the query into ",pc," if you need results over arbitrary lookbehind interval."]})]})},is=({value:t})=>e("div",{className:"vm-line-progress",children:[e("div",{className:"vm-line-progress-track",children:e("div",{className:"vm-line-progress-track__thumb",style:{width:`${t}%`}})}),e("span",{children:[t.toFixed(2),"%"]})]}),ls=({isRoot:t,trace:a,totalMsec:n,isExpandedAll:r})=>{const{isDarkTheme:o}=re(),{isMobile:s}=J(),[i,c]=C({}),l=Y(null),[m,d]=C(!1),[u,h]=C(!1),v=Tn(a.duration/1e3)||`${a.duration}ms`;x(()=>{if(!l.current)return;const y=l.current,w=l.current.children[0],{height:T}=w.getBoundingClientRect();d(T>y.clientHeight)},[a]);const _=y=>{y.stopPropagation(),h(w=>!w)},f=a.children&&!!a.children.length,p=a.duration/n*100,g=y=>()=>{f&&c(w=>({...w,[y]:!w[y]}))},b=y=>{var T;const w=[y.idValue];return(T=y==null?void 0:y.children)==null||T.forEach(S=>{w.push(...b(S))}),w};return x(()=>{if(!r){c([]);return}const y=b(a),w={};y.forEach(T=>{w[T]=!0}),c(w)},[r]),e("div",{className:I({"vm-nested-nav":!0,"vm-nested-nav_root":t,"vm-nested-nav_dark":o,"vm-nested-nav_mobile":s}),children:[e("div",{className:I({"vm-nested-nav-header":!0,"vm-nested-nav-header_open":i[a.idValue]}),onClick:g(a.idValue),children:[f&&e("div",{className:I({"vm-nested-nav-header__icon":!0,"vm-nested-nav-header__icon_open":i[a.idValue]}),children:e(ge,{})}),e("div",{className:"vm-nested-nav-header__progress",children:e(is,{value:p})}),e("div",{className:I({"vm-nested-nav-header__message":!0,"vm-nested-nav-header__message_show-full":u}),ref:l,children:[e("span",{className:"vm-nested-nav-header__message_duration",children:v}),":",e("span",{children:a.message})]}),e("div",{className:"vm-nested-nav-header-bottom",children:(m||u)&&e($,{variant:"text",size:"small",onClick:_,children:u?"Hide":"Show full query"})})]}),i[a.idValue]&&e("div",{className:"vm-nested-nav__childrens",children:f&&a.children.map(y=>e(ls,{trace:y,totalMsec:n,isExpandedAll:r},y.duration))})]})},cs=({editable:t=!1,defaultTile:a="JSON",displayTitle:n=!0,defaultJson:r="",resetValue:o="",onClose:s,onUpload:i})=>{const c=Ue(),{isMobile:l}=J(),[m,d]=C(r),[u,h]=C(a),[v,_]=C(""),[f,p]=C(""),g=D(()=>{try{const N=JSON.parse(m),k=N.trace||N;return k.duration_msec?(new kt(k,""),""):be.traceNotFound}catch(N){return N instanceof Error?N.message:"Unknown error"}},[m]),b=N=>{h(N)},y=N=>{p(""),d(N)},w=async()=>{await c(m,"Formatted JSON has been copied")},T=()=>{d(o)},S=()=>{p(g),u.trim()||_(be.emptyTitle),!(g||v)&&(i(m,u),s())};return e("div",{className:I({"vm-json-form":!0,"vm-json-form_one-field":!n,"vm-json-form_one-field_mobile":!n&&l,"vm-json-form_mobile":l}),children:[n&&e(le,{value:u,label:"Title",error:v,onEnter:S,onChange:b}),e(le,{value:m,label:"JSON",type:"textarea",error:f,autofocus:!0,onChange:y,onEnter:S,disabled:!t}),e("div",{className:"vm-json-form-footer",children:[e("div",{className:"vm-json-form-footer__controls",children:[e($,{variant:"outlined",startIcon:e(et,{}),onClick:w,children:"Copy JSON"}),o&&e($,{variant:"text",startIcon:e(rt,{}),onClick:T,children:"Reset JSON"})]}),e("div",{className:"vm-json-form-footer__controls vm-json-form-footer__controls_right",children:[e($,{variant:"outlined",color:"error",onClick:s,children:"Cancel"}),e($,{variant:"contained",onClick:S,children:"apply"})]})]})]})},lr=({traces:t,jsonEditor:a=!1,onDeleteClick:n})=>{const{isMobile:r}=J(),[o,s]=C(null),[i,c]=C([]),l=()=>{s(null)},m=(_,f)=>{if(!(!a||!o))try{o.setTracing(JSON.parse(_)),o.setQuery(f),s(null)}catch(p){console.error(p)}};if(!t.length)return e(se,{variant:"info",children:"Please re-run the query to see results of the tracing"});const d=_=>()=>{n(_)},u=_=>()=>{s(_)},h=_=>()=>{const f=new Blob([_.originalJSON],{type:"application/json"}),p=URL.createObjectURL(f),g=document.createElement("a");g.href=p,g.download=`vmui_trace_${_.queryValue}.json`,document.body.appendChild(g),g.click(),document.body.removeChild(g),URL.revokeObjectURL(p)},v=_=>()=>{c(f=>f.includes(_.idValue)?f.filter(p=>p!==_.idValue):[...f,_.idValue])};return e(V,{children:[e("div",{className:"vm-tracings-view",children:t.map(_=>e("div",{className:"vm-tracings-view-trace vm-block vm-block_empty-padding",children:[e("div",{className:"vm-tracings-view-trace-header",children:[e("h3",{className:"vm-tracings-view-trace-header-title",children:["Trace for ",e("b",{className:"vm-tracings-view-trace-header-title__query",children:_.queryValue})]}),e(G,{title:i.includes(_.idValue)?"Collapse All":"Expand All",children:e($,{variant:"text",startIcon:i.includes(_.idValue)?e(Vn,{}):e(Hn,{}),onClick:v(_),ariaLabel:i.includes(_.idValue)?"Collapse All":"Expand All"})}),e(G,{title:"Save Trace to JSON",children:e($,{variant:"text",startIcon:e(Pa,{}),onClick:h(_),ariaLabel:"Save trace to JSON"})}),e(G,{title:"Open JSON",children:e($,{variant:"text",startIcon:e(At,{}),onClick:u(_),ariaLabel:"open JSON"})}),e(G,{title:"Remove trace",children:e($,{variant:"text",color:"error",startIcon:e(Ma,{}),onClick:d(_),ariaLabel:"remove trace"})})]}),e("nav",{className:I({"vm-tracings-view-trace__nav":!0,"vm-tracings-view-trace__nav_mobile":r}),children:e(ls,{isRoot:!0,trace:_,totalMsec:_.duration,isExpandedAll:i.includes(_.idValue)})})]},_.idValue))}),o&&e(Ie,{title:o.queryValue,onClose:l,children:e(cs,{editable:a,displayTitle:a,defaultTile:o.queryValue,defaultJson:o.JSON,resetValue:o.originalJSON,onClose:l,onUpload:m})})]})},_c=({traces:t,displayType:a})=>{const{isTracingEnabled:n}=He(),[r,o]=C([]),s=i=>{const c=r.filter(l=>l.idValue!==i.idValue);o([...c])};return x(()=>{t&&o([...r,...t])},[t]),x(()=>{o([])},[a]),e(V,{children:n&&e("div",{className:"vm-custom-panel__trace",children:e(lr,{traces:r,onDeleteClick:s})})})},Ha=({warning:t,query:a,onChange:n})=>{const{isMobile:r}=J(),{value:o,setTrue:s,setFalse:i}=oe(!1);return x(i,[a]),x(()=>{n(o)},[o]),e(se,{variant:"warning",children:e("div",{className:I({"vm-custom-panel__warning":!0,"vm-custom-panel__warning_mobile":r}),children:[e("p",{children:t}),e($,{color:"warning",variant:"outlined",onClick:s,children:"Show all"})]})})},cr=t=>{let a=t.length,n=-1/0;for(;a--;){const r=t[a];Number.isFinite(r)&&r>n&&(n=r)}return Number.isFinite(n)?n:null},dr=t=>{let a=t.length,n=1/0;for(;a--;){const r=t[a];Number.isFinite(r)&&r<n&&(n=r)}return Number.isFinite(n)?n:null},fc=t=>{let a=t[0],n=1;for(let r=1;r<t.length;r++){const o=t[r];Number.isFinite(o)&&(a=a*(n-1)/n+o/n,n++)}return a},bc=t=>{let a=t.length;const n=[];for(;a--;){const r=t[a];Number.isFinite(r)&&n.push(r)}return n.sort(),n[n.length>>1]},yc=t=>{let a=t.length;for(;a--;){const n=t[a];if(Number.isFinite(n))return n}},wc=t=>t>=1e9?(t/1e9).toFixed(1).replace(/\.0$/,"")+"B":t>=1e6?(t/1e6).toFixed(1).replace(/\.0$/,"")+"M":t>=1e3?(t/1e3).toFixed(1).replace(/\.0$/,"")+"K":t.toString(),Cc=(t,a,n="")=>{const r=a[0],o=a[a.length-1];return n?a.map(s=>`${ut(s,r,o)} ${n}`):a.map(s=>ut(s,r,o))},ut=(t,a,n)=>{if(t==null)return"";n=n||0,a=a||0;const r=Math.abs(n-a);if(isNaN(r)||r==0)return Math.abs(t)>=1e3?t.toLocaleString("en-US"):t.toString();let o=3+Math.floor(1+Math.log10(Math.max(Math.abs(a),Math.abs(n)))-Math.log10(r));return(isNaN(o)||o>20)&&(o=20),t.toLocaleString("en-US",{minimumSignificantDigits:1,maximumSignificantDigits:o})},Nc=(t,a)=>{const n=document.createElement("span");n.innerText=t,n.style.cssText=`position: absolute; z-index: -1; pointer-events: none; opacity: 0; font: ${a}`,document.body.appendChild(n);const r=n.offsetWidth;return n.remove(),r},kc=(t,a)=>{if(a!=null&&a.hasAlias&&(a!=null&&a.label))return a.label;const n=(t==null?void 0:t.metric)||{},o=Object.keys(n).filter(i=>i!="__name__").map(i=>`${i}=${JSON.stringify(n[i])}`);let s=n.__name__||"";return o.length>0&&(s+="{"+o.join(",")+"}"),s},Sc=[[3600*24*365,"{YYYY}",null,null,null,null,null,null,1],[3600*24*28,"{MMM}",`
{YYYY}`,null,null,null,null,null,1],[3600*24,"{MM}-{DD}",`
{YYYY}`,null,null,null,null,null,1],[3600,"{HH}:{mm}",`
{YYYY}-{MM}-{DD}`,null,`
{MM}-{DD}`,null,null,null,1],[60,"{HH}:{mm}",`
{YYYY}-{MM}-{DD}`,null,`
{MM}-{DD}`,null,null,null,1],[1,"{HH}:{mm}:{ss}",`
{YYYY}-{MM}-{DD}`,null,`
{MM}-{DD} {HH}:{mm}`,null,null,null,1],[.001,":{ss}.{fff}",`
{YYYY}-{MM}-{DD} {HH}:{mm}`,null,`
{MM}-{DD} {HH}:{mm}`,null,`
{HH}:{mm}`,null,1]],mr=(t,a)=>Array.from(new Set(t.map(n=>n.scale))).map(n=>{const r="10px Arial",o=Xe("color-text"),s={scale:n,show:!0,size:ds,stroke:o,font:r,values:(i,c)=>Cc(i,c,a)};return n?!(Number(n)%2)&&n!=="y"?{...s,side:1}:s:{space:80,values:Sc,stroke:o,font:r}}),Tc=(t,a,n)=>{const r=An(a)||1,o=Array.from(new Set(t)).sort((m,d)=>m-d);let s=n.start;const i=da(n.end+r);let c=0;const l=[];for(;s<=i;){for(;c<o.length&&o[c]<=s;)s=o[c],c++,l.push(s);s=da(s+r),(c>=o.length||o[c]>s)&&l.push(s)}for(;l.length<2;)l.push(s),s=da(s+r);return l},ur=(t,a)=>{if(t==null||a==null)return[-1,1];const r=.02*(Math.abs(a-t)||Math.abs(t)||1);return[t-r,a+r]},Ac=(t,a)=>{const n={},r=Object.values(t).flat(),o="1",s=dr(r)||0,i=cr(r)||1;return n[o]=a?ur(s,i):[s,i],n},ds=(t,a,n,r)=>{var c;const o=t.axes[n];if(r>1)return o._size||60;let s=6+(((c=o==null?void 0:o.ticks)==null?void 0:c.size)||0)+(o.gap||0);const i=(a??[]).reduce((l,m)=>(m==null?void 0:m.length)>l.length?m:l,"");return i!=""&&(s+=Nc(i,"10px Arial")),Math.ceil(s)},Hr=["#e54040","#32a9dc","#2ee329","#7126a1","#e38f0f","#3d811a","#ffea00","#2d2d2d","#da42a6","#a44e0c"],ms=t=>{if(t.length!=7)return"0, 0, 0";const a=parseInt(t.slice(1,3),16),n=parseInt(t.slice(3,5),16),r=parseInt(t.slice(5,7),16);return`${a}, ${n}, ${r}`},Rt={[ae.yhatUpper]:"#7126a1",[ae.yhatLower]:"#7126a1",[ae.yhat]:"#da42a6",[ae.anomaly]:"#da4242",[ae.anomalyScore]:"#7126a1",[ae.actual]:"#203ea9",[ae.training]:`rgba(${ms("#203ea9")}, 0.2)`},Vr=t=>{let r=1,o=0,s=1;if(t.length>0)for(let c=0;c<t.length;c++)t[c].charCodeAt(0)>o&&(o=t[c].charCodeAt(0)),s=parseInt(String(16777215/o)),r=(r+t[c].charCodeAt(0)*s*49979693)%16777215;let i=(r*t.length%16777215).toString(16);return i=i.padEnd(6,i),`#${i}`},xc=t=>{let a=t.replace("#","").trim();if(a.length===3&&(a=a[0]+a[0]+a[1]+a[1]+a[2]+a[2]),a.length!==6)throw new Error("Invalid HEX color.");const n=parseInt(a.slice(0,2),16),r=parseInt(a.slice(2,4),16),o=parseInt(a.slice(4,6),16);return(n*299+r*587+o*114)/1e3>=128?"#000000":"#FFFFFF"},Lc=(t,a,n)=>{const r=[];for(let o=0;o<n;o++){const s=o/(n-1),i=t[0]+(a[0]-t[0])*s,c=t[1]+(a[1]-t[1])*s,l=t[2]+(a[2]-t[2])*s;r.push([i,c,l].map(m=>Math.round(m)).join(", "))}return r.map(o=>`rgb(${o})`)},hr=Lc([246,226,219],[127,39,4],16),Ec=(t,a)=>{const n=t.data[a][2],r=hr,o=0;let s=1/0,i=-1/0;for(let d=0;d<n.length;d++)n[d]>o&&(s=Math.min(s,n[d]),i=Math.max(i,n[d]));const c=i-s,l=r.length,m=Array(n.length);for(let d=0;d<n.length;d++)m[d]=n[d]===0?-1:Math.min(l-1,Math.floor(l*(n[d]-s)/c));return m},Mc=()=>(t,a)=>{const n=Math.round(devicePixelRatio);Vt.orient(t,a,(r,o,s,i,c,l,m,d,u,h,v,_,f,p)=>{const[g,b,y]=t.data[a],w=g.length,T=Ec(t,a),S=hr??[...Array.from(new Set(T))],N=S.map(()=>new Path2D),k=w-b.lastIndexOf(b[0]),A=w/k,L=b[1]-b[0],E=g[k]-g[0],M=l(E,i,h,d)-l(0,i,h,d)-n,P=m(L,c,v,u)-m(0,c,v,u)+n,R=b.slice(0,k).map(H=>Math.round(m(H,c,v,u)-P/2)),Q=Array.from({length:A},(H,B)=>Math.round(l(g[B*k],i,h,d)-M));for(let H=0;H<w;H++)if(y[H]>0&&g[H]>=(i.min||-1/0)&&g[H]<=(i.max||1/0)&&b[H]>=(c.min||-1/0)&&b[H]<=(c.max||1/0)){const B=Q[~~(H/k)],F=R[H%k],te=N[T[H]];p(te,B,F,M,P)}t.ctx.save(),t.ctx.rect(t.bbox.left,t.bbox.top,t.bbox.width,t.bbox.height),t.ctx.clip(),N.forEach((H,B)=>{t.ctx.fillStyle=S[B],t.ctx.fill(H)}),t.ctx.restore()})},Dc=t=>{var s,i;if(!t.every(c=>c.metric.le))return t;const a=t.sort((c,l)=>parseFloat(c.metric.le)-parseFloat(l.metric.le)),n=((s=t[0])==null?void 0:s.group)||1;let r={metric:{le:""},values:[]};const o=[];for(const c of a){const l=[r.metric.le,c.metric.le].filter(d=>d).join("..."),m=[];for(const[d,u]of c.values){const h=((i=r.values.find(_=>_[0]===d))==null?void 0:i[1])||0,v=+u-+h;m.push([d,`${v}`])}o.push({metric:{vmrange:l},values:m,group:n}),r=c}return o},Ur=t=>{const a=(t.metric.vmrange||t.metric.le||"").split("...");return ea(a[a.length-1])},Ic=(t,a)=>Ur(t)-Ur(a),Pc=(t,a)=>{if(!a)return t;const n=t.sort(Ic),r=Dc(n),o={};return r.forEach(i=>i.values.forEach(([c,l])=>{const m=Number(l),d=isNaN(m)?0:m,u=o[c]||0;o[c]=u+d})),r.map(i=>{const c=i.values.map(([l,m])=>{const d=o[l];return[l,`${Math.round(+m/d*100)}`]});return{...i,values:c}}).filter(i=>!i.values.every(c=>c[1]==="0"))},$c=t=>{Object.keys(t.hooks).forEach(a=>{t.hooks[a]=[]})},hn=t=>{const a=["__name__","for"];return Object.entries(t).filter(([n])=>!a.includes(n)).map(([n,r])=>`${n}: ${r}`).join(",")},us=t=>{const a=(t==null?void 0:t.__name__)||"",n=new RegExp(`(${Object.values(ae).join("|")})$`),r=a.match(n),o=r&&r[0];return{value:/(?:^|[^a-zA-Z0-9_])y(?:$|[^a-zA-Z0-9_])/.test(a)?ae.actual:o,group:hn(t)}},Oc=(t,a,n,r)=>{const o={},s=r?0:Math.min(t.length,Hr.length);for(let i=0;i<s;i++){const c=un(t[i],n[t[i].group-1]);o[c]=Hr[i]}return(i,c)=>{const l=r?us(t[c].metric):null,m=n[i.group-1],d=r?(l==null?void 0:l.group)||"":un(i,m);return{label:d,hasAlias:!!m,dash:Fc(l),width:Hc(l),stroke:qc({metricInfo:l,label:d,isAnomalyUI:r,colorState:o}),points:Vc(l),spanGaps:!1,forecast:l==null?void 0:l.value,forecastGroup:l==null?void 0:l.group,freeFormFields:i.metric,show:!hs(d,a),scale:"1",...Rc(i)}}},Rc=t=>{const a=t.values.map(i=>ea(i[1])),{min:n,max:r,median:o,last:s}={min:dr(a),max:cr(a),median:bc(a),last:yc(a)};return{median:o,statsFormatted:{min:ut(n,n,r),max:ut(r,n,r),median:ut(o,n,r),last:ut(s,n,r)}}},qr=(t,a)=>({group:a,label:t.label||"",color:t.stroke,checked:t.show||!1,freeFormFields:t.freeFormFields,statsFormatted:t.statsFormatted,median:t.median,hasAlias:t.hasAlias||!1}),zc=({hideSeries:t,legend:a,metaKey:n,series:r,isAnomalyView:o})=>{const{label:s}=a,i=hs(s,t),c=r.map(l=>l.label||"");return o?c.filter(l=>l!==s):n?i?t.filter(l=>l!==s):[...t,s]:t.length?i?[...c.filter(l=>l!==s)]:[]:[...c.filter(l=>l!==s)]},hs=(t,a)=>a.includes(`${t}`),pr=t=>{for(let a=t.series.length-1;a>=0;a--)a&&t.delSeries(a)},ps=(t,a,n=!1)=>{a.forEach((r,o)=>{r.label&&(r.spanGaps=n),o&&t.addSeries(r)})},Fc=t=>{const a=(t==null?void 0:t.value)===ae.yhatLower,n=(t==null?void 0:t.value)===ae.yhatUpper,r=(t==null?void 0:t.value)===ae.yhat;return a||n?[10,5]:r?[10,2]:[]},Hc=t=>{const a=(t==null?void 0:t.value)===ae.yhatLower,n=(t==null?void 0:t.value)===ae.yhatUpper,r=(t==null?void 0:t.value)===ae.yhat,o=(t==null?void 0:t.value)===ae.anomaly;return n||a?.7:r?1:o?0:1.4},Vc=t=>(t==null?void 0:t.value)===ae.anomaly?{size:8,width:4,space:0}:{size:4,width:0,show:!0,filter:Uc},Uc=(t,a)=>{const n=t.data[a],r=[];for(let o=0;o<n.length;o++){const s=n[o-1],i=n[o+1];s===null&&i===null&&r.push(o)}return r},qc=({metricInfo:t,label:a,isAnomalyUI:n,colorState:r})=>{const o=r[a]||Vr(a),s=(t==null?void 0:t.value)===ae.anomaly;return n&&s?Rt[ae.anomaly]:n&&!s&&!(t!=null&&t.value)?Rt[ae.actual]:t!=null&&t.value?t!=null&&t.value?Rt[t==null?void 0:t.value]:o:r[a]||Vr(a)},vs=({width:t=400,height:a=500})=>({width:t,height:a,series:[],tzDate:n=>q(Pt(Ye(n))).local().toDate(),legend:{show:!1},cursor:{drag:{x:!0,y:!1},focus:{prox:30},points:{size:5.6,width:1.4},bind:{click:()=>null,dblclick:()=>null}}}),vr=t=>{pr(t),$c(t),t.setData([])},gs=({min:t,max:a})=>[t,a],_s=(t,a=0,n=1,r,o)=>o.limits.enable?o.limits.range[r]:ur(a,n),Bc=(t,a)=>{const n={x:{range:()=>gs(a)}},r=Object.keys(t.limits.range);return(r.length?r:["1"]).forEach(o=>{n[o]={range:(s,i=0,c=1)=>_s(s,i,c,o,t)}}),n},gr=t=>a=>{const n=a.posToVal(a.select.left,"x"),r=a.posToVal(a.select.left+a.select.width,"x");t({min:n,max:r})},fs=(t,a)=>{if(t.delBand(),a.length<2)return;const n=a.map((i,c)=>({...i,index:c})),r=n.filter(i=>i.forecast===ae.yhatUpper),o=n.filter(i=>i.forecast===ae.yhatLower),s=r.map(i=>{const c=o.find(l=>l.forecastGroup===i.forecastGroup);return c?{series:[i.index,c.index],fill:jc(ae.yhatUpper)}:null}).filter(i=>i!==null);s.length&&s.forEach(i=>{t.addBand(i)})};function jc(t){return`rgba(${ms(Rt[t])}, 0.05)`}const Qc=t=>t instanceof MouseEvent,Br=t=>Qc(t)?t.clientX:t.touches[0].clientX,Yc=({dragSpeed:t=.85,setPanning:a,setPlotScale:n})=>{const r=Y({leftStart:0,xUnitsPerPx:0,scXMin:0,scXMax:0}),o=c=>{c.preventDefault();const l=Br(c),{leftStart:m,xUnitsPerPx:d,scXMin:u,scXMax:h}=r.current,v=d*((l-m)*t);n({min:u-v,max:h-v})},s=()=>{a(!1),document.removeEventListener("mousemove",o),document.removeEventListener("mouseup",s),document.removeEventListener("touchmove",o),document.removeEventListener("touchend",s)},i=()=>{document.addEventListener("mousemove",o),document.addEventListener("mouseup",s),document.addEventListener("touchmove",o),document.addEventListener("touchend",s)};return({e:c,u:l})=>{c.preventDefault(),a(!0),r.current={leftStart:Br(c),xUnitsPerPx:l.posToVal(1,"x")-l.posToVal(0,"x"),scXMin:l.scales.x.min||0,scXMax:l.scales.x.max||0},i()}},Gc=t=>{const{ctrlKey:a,metaKey:n,button:r}=t;return r===0&&(a||n)},Ka=.9,_r=t=>{const[a,n]=C(!1),r=Yc({dragSpeed:Ka,setPanning:n,setPlotScale:t});return{onReadyChart:s=>{const i=l=>{const m=l instanceof MouseEvent&&Gc(l),d=window.TouchEvent&&l instanceof TouchEvent&&l.touches.length>1;(m||d)&&r({u:s,e:l})},c=l=>{if(!l.ctrlKey&&!l.metaKey)return;l.preventDefault();const{width:m}=s.over.getBoundingClientRect(),d=s.cursor.left&&s.cursor.left>0?s.cursor.left:0,u=s.posToVal(d,"x"),h=(s.scales.x.max||0)-(s.scales.x.min||0),v=l.deltaY<0?h*Ka:h/Ka,_=u-d/m*v,f=_+v;s.batch(()=>t({min:_,max:f}))};s.over.addEventListener("mousedown",i),s.over.addEventListener("touchstart",i),s.over.addEventListener("wheel",c)},isPanning:a}},jr=t=>{const a=t[0].clientX-t[1].clientX,n=t[0].clientY-t[1].clientY;return Math.sqrt(a*a+n*n)},fr=({uPlotInst:t,xRange:a,setPlotScale:n})=>{const[r,o]=C(0),s=Z(l=>{const{target:m,ctrlKey:d,metaKey:u,key:h}=l,v=m instanceof HTMLInputElement||m instanceof HTMLTextAreaElement;if(!t||v)return;const _=h==="+"||h==="=";if((h==="-"||_)&&!(d||u)){l.preventDefault();const g=(a.max-a.min)/10*(_?1:-1);n({min:a.min+g,max:a.max-g})}},[t,a]),i=l=>{l.touches.length===2&&(l.preventDefault(),o(jr(l.touches)))},c=Z(l=>{if(!t||l.touches.length!==2)return;l.preventDefault();const m=jr(l.touches),d=r-m,u=t.scales.x.max||a.max,h=t.scales.x.min||a.min,v=u-h,_=d>0?-1:1,f=v/50*_;t.batch(()=>n({min:h+f,max:u-f}))},[t,r,a]);return ce("keydown",s),ce("touchmove",c),ce("touchstart",i),null},br=({period:t,setPeriod:a})=>{const[n,r]=C({min:t.start,max:t.end}),o=({min:s,max:i})=>{const c=(i-s)*1e3;c<xr.min||c>xr.max||a({from:q(s*1e3).toDate(),to:q(i*1e3).toDate()})};return x(()=>{r({min:t.start,max:t.end})},[t]),{xRange:n,setPlotScale:o}},Wc=({u:t,metrics:a,series:n,unit:r,isAnomalyView:o})=>{const[s,i]=C(!1),[c,l]=C({seriesIdx:-1,dataIdx:-1}),[m,d]=C([]),u=()=>{d([]),l({seriesIdx:-1,dataIdx:-1})},h=g=>{const b=g.cursor.idx??-1;l(y=>({...y,dataIdx:b}))},v=(g,b)=>{const y=b??-1;l(w=>({...w,seriesIdx:y}))},_=Z(()=>{const{seriesIdx:g,dataIdx:b}=c,y=a[g-1],w=n[g],T=new Set(a.map(M=>M.group)),S=(y==null?void 0:y.group)||0,N=ft(t,["data",g,b],0),k=ft(t,["scales","1","min"],0),A=ft(t,["scales","1","max"],1),L=ft(t,["data",0,b],0),E={top:t?t.valToPos(N||0,(w==null?void 0:w.scale)||"1"):0,left:t?t.valToPos(L,"x"):0};return{unit:r,point:E,u:t,id:`${g}_${b}`,title:T.size>1&&!o?`Query ${S}`:"",dates:[L?q(L*1e3).tz().format(ga):"-"],value:ut(N,k,A),info:kc(y,w),statsFormatted:w==null?void 0:w.statsFormatted,marker:`${w==null?void 0:w.stroke}`}},[t,c,a,n,r,o]),f=Z(()=>{if(!s)return;const g=_();m.find(b=>b.id===g.id)||d(b=>[...b,g])},[_,m,s]),p=g=>{d(b=>b.filter(y=>y.id!==g))};return x(()=>{i(c.dataIdx!==-1&&c.seriesIdx!==-1)},[c]),ce("click",f),{showTooltip:s,stickyTooltips:m,handleUnStick:p,getTooltipProps:_,seriesFocus:v,setCursor:h,resetTooltips:u}},Qr=({u:t,id:a,title:n,dates:r,value:o,point:s,unit:i="",info:c,statsFormatted:l,isSticky:m,marker:d,onClose:u})=>{const h=Y(null),[v,_]=C({top:-999,left:-999}),[f,p]=C(!1),[g,b]=C(!1),y=()=>{u&&u(a)},w=k=>{b(!0),p(!0);const{clientX:A,clientY:L}=k;_({top:L,left:A})},T=Z(k=>{if(!f)return;const{clientX:A,clientY:L}=k;_({top:L,left:A})},[f]),S=()=>{p(!1)};return x(()=>{if(!h.current||!t)return;const{top:k,left:A}=s,L={left:parseFloat(t.over.style.left),top:parseFloat(t.over.style.top)},{width:E,height:M}=t.over.getBoundingClientRect(),{width:P,height:R}=h.current.getBoundingClientRect(),Q=10,H=A+P>=E?P+2*Q:0,B=k+R>=M?R+2*Q:0,F={top:k+L.top+Q-B,left:A+L.left+Q-H};F.left<0&&(F.left=20),F.top<0&&(F.top=20),_(F)},[t,o,s,h]),ce("mousemove",T),ce("mouseup",S),t?Ft(e("div",{className:I({"vm-chart-tooltip":!0,"vm-chart-tooltip_sticky":m,"vm-chart-tooltip_moved":g}),ref:h,style:v,children:[e("div",{className:"vm-chart-tooltip-header",children:[n&&e("div",{className:"vm-chart-tooltip-header__title",children:n}),e("div",{className:"vm-chart-tooltip-header__date",children:r.map((k,A)=>e("span",{children:k},A))}),m&&e(V,{children:[e($,{className:"vm-chart-tooltip-header__drag",variant:"text",size:"small",startIcon:e(On,{}),onMouseDown:w,ariaLabel:"drag the tooltip"}),e($,{className:"vm-chart-tooltip-header__close",variant:"text",size:"small",startIcon:e(Re,{}),onClick:y,ariaLabel:"close the tooltip"})]})]}),e("div",{className:"vm-chart-tooltip-data",children:[d&&e("span",{className:"vm-chart-tooltip-data__marker",style:{background:d}}),e("p",{className:"vm-chart-tooltip-data__value",children:[e("b",{children:o}),i]})]}),l&&e("table",{className:"vm-chart-tooltip-stats",children:_o.map((k,A)=>e("div",{className:"vm-chart-tooltip-stats-row",children:[e("span",{className:"vm-chart-tooltip-stats-row__key",children:[k,":"]}),e("span",{className:"vm-chart-tooltip-stats-row__value",children:l[k]})]},A))}),c&&e("p",{className:"vm-chart-tooltip__info",children:c})]}),t.root):null},bs=({showTooltip:t,tooltipProps:a,stickyTooltips:n,handleUnStick:r})=>e(V,{children:[t&&a&&e(Qr,{...a}),n.map(o=>Js(Qr,{...o,isSticky:!0,key:o.id,onClose:r}))]}),Jc=({data:t,series:a,metrics:n=[],period:r,yaxis:o,unit:s,setPeriod:i,layoutSize:c,height:l,isAnomalyView:m,spanGaps:d=!1})=>{const{isDarkTheme:u}=re(),h=Y(null),[v,_]=C(),{xRange:f,setPlotScale:p}=br({period:r,setPeriod:i}),{onReadyChart:g,isPanning:b}=_r(p);fr({uPlotInst:v,xRange:f,setPlotScale:p});const{showTooltip:y,stickyTooltips:w,handleUnStick:T,getTooltipProps:S,seriesFocus:N,setCursor:k,resetTooltips:A}=Wc({u:v,metrics:n,series:a,unit:s,isAnomalyView:m}),L={...vs({width:c.width,height:l}),series:a,axes:mr([{},{scale:"1"}],s),scales:Bc(o,f),hooks:{ready:[g],setSeries:[N],setCursor:[k],setSelect:[gr(p)],destroy:[vr]},bands:[]};return x(()=>{if(A(),!h.current)return;v&&v.destroy();const E=new Vt(L,t,h.current);return _(E),E.destroy},[h,u]),x(()=>{v&&(v.setData(t),v.redraw())},[t]),x(()=>{v&&(pr(v),ps(v,a,d),fs(v,a),v.redraw())},[a,d]),x(()=>{v&&(Object.keys(o.limits.range).forEach(E=>{v.scales[E]&&(v.scales[E].range=(M,P=0,R=1)=>_s(M,P,R,E,o))}),v.redraw())},[o]),x(()=>{v&&(v.scales.x.range=()=>gs(f),v.redraw())},[f]),x(()=>{v&&(v.setSize({width:c.width||400,height:l||500}),v.redraw())},[l,c]),e("div",{className:I({"vm-line-chart":!0,"vm-line-chart_panning":b}),style:{minWidth:`${c.width||400}px`,minHeight:`${l||500}px`},children:[e("div",{className:"vm-line-chart__u-plot",ref:h}),e(bs,{showTooltip:y,tooltipProps:S(),stickyTooltips:w,handleUnStick:T})]})},Kc=t=>Object.keys(t.freeFormFields).filter(n=>n!=="__name__").map(n=>{const r=`${n}=${JSON.stringify(t.freeFormFields[n])}`;return{id:`${t.label}.${r}`,freeField:r,key:n}}),ys=({legend:t,onChange:a,isHeatmap:n,isAnomalyView:r})=>{const o=Ue(),s=D(()=>{const u=Kc(t);return n?u.filter(h=>h.key!=="vmrange"):u},[t,n]),i=t.statsFormatted,c=Object.values(i).some(u=>u),l=async u=>{await o(u,`${u} has been copied`)},m=u=>h=>{a&&a(u,h.ctrlKey||h.metaKey)},d=u=>h=>{h.stopPropagation(),l(u)};return e("div",{className:I({"vm-legend-item":!0,"vm-legend-row":!0,"vm-legend-item_hide":!t.checked&&!n,"vm-legend-item_static":n}),onClick:m(t),children:[!r&&!n&&e("div",{className:"vm-legend-item__marker",style:{backgroundColor:t.color}}),e("div",{className:"vm-legend-item-info",children:e("span",{className:"vm-legend-item-info__label",children:t.hasAlias?t.label:e(V,{children:[t.freeFormFields.__name__,!!s.length&&e(V,{children:"{"}),s.map((u,h)=>e("span",{className:"vm-legend-item-info__free-fields",onClick:d(u.freeField),title:"copy to clipboard",children:[u.freeField,h+1<s.length&&","]},u.key)),!!s.length&&e(V,{children:"}"})]})})}),!n&&c&&e("div",{className:"vm-legend-item-stats",children:_o.map((u,h)=>e("div",{className:"vm-legend-item-stats-row",children:[e("span",{className:"vm-legend-item-stats-row__key",children:[u,":"]}),e("span",{className:"vm-legend-item-stats-row__value",children:i[u]})]},h))})]})},Zc=({labels:t,query:a,isAnomalyView:n,onChange:r})=>{const o=D(()=>Array.from(new Set(t.map(i=>i.group))),[t]),s=o.length>1;return e(V,{children:e("div",{className:"vm-legend",children:o.map(i=>e("div",{className:"vm-legend-group",children:e(Oa,{defaultExpanded:!0,title:e("div",{className:"vm-legend-group-title",children:[s&&e("span",{className:"vm-legend-group-title__count",children:["Query ",i,": "]}),e("span",{className:"vm-legend-group-title__query",children:a[i-1]})]}),children:e("div",{children:t.filter(c=>c.group===i).sort((c,l)=>(l.median||0)-(c.median||0)).map(c=>e(ys,{legend:c,isAnomalyView:n,onChange:r},c.label))})})},i))})})},Xc=({min:t,max:a,legendValue:n,series:r})=>{var v;const[o,s]=C(0),[i,c]=C(""),[l,m]=C(""),[d,u]=C(""),h=D(()=>parseFloat(String((n==null?void 0:n.value)||0).replace("%","")),[n]);return x(()=>{s(h?(h-t)/(a-t)*100:0),c(h?`${h}%`:""),m(`${t}%`),u(`${a}%`)},[h,t,a]),e("div",{className:"vm-legend-heatmap__wrapper",children:[e("div",{className:"vm-legend-heatmap",children:[e("div",{className:"vm-legend-heatmap-gradient",style:{background:`linear-gradient(to right, ${hr.join(", ")})`},children:!!h&&e("div",{className:"vm-legend-heatmap-gradient__value",style:{left:`${o}%`},children:e("span",{children:i})})}),e("div",{className:"vm-legend-heatmap__value",children:l}),e("div",{className:"vm-legend-heatmap__value",children:d})]}),r[1]&&e(ys,{legend:r[1],isHeatmap:!0},(v=r[1])==null?void 0:v.label)]})},ed=({u:t,metrics:a,unit:n})=>{const[r,o]=C({left:0,top:0}),[s,i]=C([]),c=()=>{i([]),o({left:0,top:0})},l=h=>{const v=h.cursor.left||0,_=h.cursor.top||0;o({left:v,top:_})},m=Z(()=>{var L;const{left:h,top:v}=r,_=ft(t,["data",1,0],[])||[],f=t?t.posToVal(h,"x"):0,p=t?t.posToVal(v,"y"):0,g=_.findIndex((E,M)=>f>=E&&f<_[M+1])||-1,b=_[g+1],y=a[Math.round(p)]||{values:[]},[w=0,T=""]=y.values.find(E=>E[0]===b)||[],S=_[g],N=q(S*1e3).tz().format(ga),k=q(w*1e3).tz().format(ga),A=((L=y==null?void 0:y.metric)==null?void 0:L.vmrange)||"";return{unit:n,point:r,u:t,id:`${A}_${N}`,dates:[N,k],value:`${T}%`,info:A,show:+T>0}},[t,r,a,n]),d=Z(()=>{const h=m();h.show&&(s.find(v=>v.id===h.id)||i(v=>[...v,h]))},[m,s]),u=h=>{i(v=>v.filter(_=>_.id!==h))};return ce("click",d),{stickyTooltips:s,handleUnStick:u,getTooltipProps:m,setCursor:l,resetTooltips:c}},td=({data:t,metrics:a=[],period:n,unit:r,setPeriod:o,layoutSize:s,height:i,onChangeLegend:c})=>{const{isDarkTheme:l}=re(),m=Y(null),[d,u]=C(),{xRange:h,setPlotScale:v}=br({period:n,setPeriod:o}),{onReadyChart:_,isPanning:f}=_r(v);fr({uPlotInst:d,xRange:h,setPlotScale:v});const{stickyTooltips:p,handleUnStick:g,getTooltipProps:b,setCursor:y,resetTooltips:w}=ed({u:d,metrics:a,unit:r}),T=D(()=>b(),[b]),S=()=>{const k=mr([{}],r);return[...k,{scale:"y",stroke:k[0].stroke,font:k[0].font,size:ds,splits:a.map((A,L)=>L),values:a.map(A=>A.metric.vmrange)}]},N={...vs({width:s.width,height:i}),mode:2,series:[{},{paths:Mc(),facets:[{scale:"x",auto:!0,sorted:1},{scale:"y",auto:!0}]}],axes:S(),scales:{x:{time:!0},y:{log:2,time:!1,range:(k,A,L)=>[A-1,L+1]}},hooks:{ready:[_],setCursor:[y],setSelect:[gr(v)],destroy:[vr]}};return x(()=>{w();const k=t[0]===null&&Array.isArray(t[1]);if(!m.current||!k)return;const A=new Vt(N,t,m.current);return u(A),A.destroy},[m,t,l]),x(()=>{d&&(d.setSize({width:s.width||400,height:i||500}),d.redraw())},[i,s]),x(()=>{c(T)},[T]),e("div",{className:I({"vm-line-chart":!0,"vm-line-chart_panning":f}),style:{minWidth:`${s.width||400}px`,minHeight:`${i||500}px`},children:[e("div",{className:"vm-line-chart__u-plot",ref:m}),e(bs,{showTooltip:!!T.show,tooltipProps:T,stickyTooltips:p,handleUnStick:g})]})},ws=()=>{const[t,a]=C(null),[n,r]=C({width:0,height:0}),o=Z(()=>{r({width:(t==null?void 0:t.offsetWidth)||0,height:(t==null?void 0:t.offsetHeight)||0})},[t==null?void 0:t.offsetHeight,t==null?void 0:t.offsetWidth]);return ce("resize",o),x(o,[t==null?void 0:t.offsetHeight,t==null?void 0:t.offsetWidth]),[a,n]},ad={[ae.yhat]:"yhat",[ae.yhatLower]:"yhat_upper - yhat_lower",[ae.yhatUpper]:"yhat_upper - yhat_lower",[ae.anomaly]:"anomalies",[ae.training]:"training data",[ae.actual]:"y"},nd=({series:t})=>{const a=D(()=>{const n=t.reduce((o,s)=>{const i=Object.prototype.hasOwnProperty.call(s,"forecast"),c=s.forecast!==ae.yhatUpper,l=!o.find(m=>m.forecast===s.forecast);return i&&l&&c&&o.push(s),o},[]),r={...n[0],forecast:ae.training,color:Rt[ae.training]};return n.splice(1,0,r),n.map(o=>({...o,color:typeof o.stroke=="string"?o.stroke:Rt[o.forecast||ae.actual]}))},[t]);return e(V,{children:e("div",{className:"vm-legend-anomaly",children:a.filter(n=>n.forecast!==ae.training).map((n,r)=>{var o;return e("div",{className:"vm-legend-anomaly-item",children:[e("svg",{children:n.forecast===ae.anomaly?e("circle",{cx:"15",cy:"7",r:"4",fill:n.color,stroke:n.color,strokeWidth:"1.4"}):e("line",{x1:"0",y1:"7",x2:"30",y2:"7",stroke:n.color,strokeWidth:n.width||1,strokeDasharray:(o=n.dash)==null?void 0:o.join(",")})}),e("div",{className:"vm-legend-anomaly-item__title",children:ad[n.forecast||ae.actual]})]},`${r}_${n.forecast}`)})})})},Va=({data:t=[],period:a,customStep:n,query:r,yaxis:o,unit:s,showLegend:i=!0,setYaxisLimits:c,setPeriod:l,alias:m=[],fullWidth:d=!0,height:u,isHistogram:h,isAnomalyView:v,spanGaps:_})=>{var ne;const f=Lt(),{isMobile:p}=J(),{timezone:g}=he(),b=D(()=>n||a.step||"1s",[a.step,n]),y=D(()=>Pc(t,h),[h,t]),[w,T]=C([[]]),[S,N]=C([]),[k,A]=C([]),[L,E]=C([]),[M,P]=C(null),R=D(()=>Oc(y,L,m,v),[y,L,m,v]),Q=U=>{const O=Ac(U,!h);c(O)},H=(U,O)=>{E(zc({hideSeries:L,legend:U,metaKey:O,series:S,isAnomalyView:v}))},B=U=>{const O=U.slice(1,U.length),z=[],j=[];O.forEach((ee,ue)=>{ee.forEach((Te,fe)=>{const Pe=fe*O.length+ue;j[Pe]=Te})}),U[0].forEach(ee=>{const ue=new Array(O.length).fill(ee);z.push(...ue)});const X=new Array(z.length).fill(0).map((ee,ue)=>ue%O.length);return[null,[z,X,j]]},F=U=>v?os(U,["group","label"]).map(z=>{const j=z.values[0];return{...j,freeFormFields:{...j.freeFormFields,__name__:""}}}):U;x(()=>{const U=[],O={},z=[],j=[{}];y==null||y.forEach((fe,Pe)=>{const Be=R(fe,Pe);j.push(Be),z.push(qr(Be,fe.group));const je=O[fe.group]||[];for(const Me of fe.values)U.push(Me[0]),je.push(ea(Me[1]));O[fe.group]=je});const X=Tc(U,b,a),ee=y.map(fe=>{const Pe=[],Be=fe.values,je=Be.length;let Me=0;for(const dt of X){for(;Me<je&&Be[Me][0]<dt;)Me++;let Mt=null;Me<je&&Be[Me][0]==dt&&(Mt=ea(Be[Me][1]),Number.isFinite(Mt)||(Mt=null)),Pe.push(Mt)}const $e=Pe.filter(dt=>dt!==null),Qt=Math.abs(fc($e)),tt=ur(dr($e),cr($e)),Et=Math.abs(tt[1]-tt[0]);return Qt>Et*1e10&&!v?Pe.map(()=>Qt):Pe});ee.unshift(X),Q(O);const ue=h?B(ee):ee;T(ue),N(j);const Te=F(z);A(Te),v&&E(Te.map(fe=>fe.label||"").slice(1))},[y,g,h,b]),x(()=>{const U=[],O=[{}];y==null||y.forEach((z,j)=>{const X=R(z,j);O.push(X),U.push(qr(X,z.group))}),N(O),A(F(U))},[L]);const[te,de]=ws(),W=((ne=w[0])==null?void 0:ne.length)>0;return x(()=>{const O=(()=>{var z;if(!h||!y[1])return!1;try{return(((z=w==null?void 0:w[1])==null?void 0:z[2])||[]).every(X=>X===null)}catch{return!1}})();f({type:"SET_IS_EMPTY_HISTOGRAM",payload:O})},[w,h]),e("div",{className:I({"vm-graph-view":!0,"vm-graph-view_full-width":d,"vm-graph-view_full-width_mobile":d&&p}),ref:te,children:[!h&&W&&e(Jc,{data:w,series:S,metrics:y,period:a,yaxis:o,unit:s,setPeriod:l,layoutSize:de,height:u,isAnomalyView:v,spanGaps:_}),h&&e(td,{data:w,metrics:y,period:a,unit:s,setPeriod:l,layoutSize:de,height:u,onChangeLegend:P}),v&&i&&e(nd,{series:S}),!h&&i&&e(Zc,{labels:k,query:r,isAnomalyView:v,onChange:H}),h&&i&&e(Xc,{series:S,min:o.limits.range[1][0]||0,max:o.limits.range[1][1]||0,legendValue:M})]})},rd=({yaxis:t,setYaxisLimits:a,toggleEnableLimits:n})=>{const{isMobile:r}=J(),o=D(()=>Object.keys(t.limits.range),[t.limits.range]),i=Z(Sa((l,m,d)=>{const u=t.limits.range;u[m][d]=+l,!(u[m][0]===u[m][1]||u[m][0]>u[m][1])&&a(u)},500),[t.limits.range]),c=(l,m)=>d=>{i(d,l,m)};return e("div",{className:I({"vm-axes-limits":!0,"vm-axes-limits_mobile":r}),children:[e("div",{className:"vm-graph-settings-row",children:[e("span",{className:"vm-graph-settings-row__label",children:"Fixed Y-axis limits"}),e(Ce,{value:t.limits.enable,onChange:n,label:`${t.limits.enable?"Fixed":"Auto"} limits`,fullWidth:r})]}),t.limits.enable&&e("div",{className:"vm-axes-limits-list",children:o.map(l=>e("div",{className:"vm-axes-limits-list__inputs",children:[e(le,{label:`Min ${l}`,type:"number",disabled:!t.limits.enable,value:t.limits.range[l][0],onChange:c(l,0)}),e(le,{label:`Max ${l}`,type:"number",disabled:!t.limits.enable,value:t.limits.range[l][1],onChange:c(l,1)})]},l))})]})},od=({spanGaps:t,onChange:a})=>{const{isMobile:n}=J();return e("div",{className:"vm-graph-settings-row",children:[e("span",{className:"vm-graph-settings-row__label",children:"Connect null values"}),e(Ce,{value:t,onChange:a,label:t?"Enabled":"Disabled",fullWidth:n})]})},Cs=()=>{const[t,a]=ie(),n=Fe();return{handleChange:(o,s)=>{o?t.delete("display_mode"):t.set("display_mode","lines"),a(t),n({type:"RUN_QUERY"}),s&&s()}}},sd=({onChange:t})=>{const{isMobile:a}=J(),{handleChange:n}=Cs(),[r]=ie(),o=!r.get("display_mode");return e("div",{className:"vm-graph-settings-row",children:[e("span",{className:"vm-graph-settings-row__label",children:"Histogram mode"}),e(Ce,{value:o,onChange:i=>{n(i,t)},label:o?"Enabled":"Disabled",fullWidth:a})]})},Yr="Graph settings",yr=({data:t,yaxis:a,setYaxisLimits:n,toggleEnableLimits:r,spanGaps:o})=>{const s=Y(null),i=Y(null),c=sr(t),{value:l,toggle:m,setFalse:d}=oe(!1);return e("div",{className:"vm-graph-settings",children:[e(G,{title:Yr,children:e("div",{ref:i,children:e($,{variant:"text",startIcon:e(ht,{}),onClick:m,ariaLabel:"settings"})})}),e(Se,{open:l,buttonRef:i,placement:"bottom-right",onClose:d,title:Yr,children:e("div",{className:"vm-graph-settings-popper",ref:s,children:e("div",{className:"vm-graph-settings-popper__body",children:[e(rd,{yaxis:a,setYaxisLimits:n,toggleEnableLimits:r}),e(od,{spanGaps:o.value,onChange:o.onChange}),c&&e(sd,{onChange:d})]})})})]})},Ns=({isHistogram:t,graphData:a,controlsRef:n,isAnomalyView:r})=>{const{isMobile:o}=J(),{customStep:s,yaxis:i,spanGaps:c}=Ve(),{period:l}=he(),{query:m}=ke(),d=Fe(),u=Lt(),h=g=>{u({type:"SET_YAXIS_LIMITS",payload:g})},v=()=>{u({type:"TOGGLE_ENABLE_YAXIS_LIMITS"})},_=g=>{u({type:"SET_SPAN_GAPS",payload:g})},f=({from:g,to:b})=>{d({type:"SET_PERIOD",payload:{from:g,to:b}})},p=e("div",{className:"vm-custom-panel-body-header__graph-controls",children:[e(Kn,{}),e(yr,{data:a,yaxis:i,isHistogram:t,setYaxisLimits:h,toggleEnableLimits:v,spanGaps:{value:c,onChange:_}})]});return e(V,{children:[n.current&&Ft(p,n.current),e(Va,{data:a,period:l,customStep:s,query:m,yaxis:i,setYaxisLimits:h,setPeriod:f,height:o?window.innerHeight*.5:500,isHistogram:t,isAnomalyView:r,spanGaps:c})]})},Ua=({data:t})=>{const a=Ue(),n=D(()=>JSON.stringify(t,null,2),[t]);return e("div",{className:"vm-json-view",children:[e("div",{className:"vm-json-view__copy",children:e($,{variant:"outlined",onClick:async()=>{await a(n,"Formatted JSON has been copied")},children:"Copy JSON"})}),e("pre",{className:"vm-json-view__code",children:e("code",{children:n})})]})},wr=t=>{const a={};return t.forEach(n=>Object.entries(n.metric).forEach(r=>a[r[0]]?a[r[0]].options.add(r[1]):a[r[0]]={options:new Set([r[1]])})),Object.entries(a).map(n=>({key:n[0],variations:n[1].options.size})).sort((n,r)=>n.variations-r.variations)},Gr=(t,a)=>D(()=>a?wr(t).filter(r=>a.includes(r.key)):[],[t,a]),ks=({data:t,displayColumns:a})=>{const n=Ue(),{isMobile:r}=J(),{tableCompact:o}=He(),s=Y(null),[i,c]=C(""),[l,m]=C("asc"),d=o?Gr([{group:0,metric:{Data:"Data"}}],["Data"]):Gr(t,a),u=y=>{const{__name__:w,...T}=y;return!w&&!Object.keys(T).length?"":w?`${w} ${JSON.stringify(T)}`:`${JSON.stringify(T)}`},v=new Set(t==null?void 0:t.map(y=>y.group)).size>1,_=D(()=>{const y=t==null?void 0:t.map(S=>({metadata:d.map(N=>o?un(S,"",v):S.metric[N.key]||"-"),value:S.value?S.value[1]:"-",values:S.values?S.values.map(([N,k])=>`${k} @${N}`):[],copyValue:u(S.metric)})),w=i==="Value",T=d.findIndex(S=>S.key===i);return!w&&T===-1?y:y.sort((S,N)=>{const k=w?Number(S.value):S.metadata[T],A=w?Number(N.value):N.metadata[T];return(l==="asc"?k<A:k>A)?-1:1})},[d,t,i,l,o]),f=D(()=>_.some(y=>y.copyValue),[_]),p=y=>{m(w=>w==="asc"&&i===y?"desc":"asc"),c(y)},g=y=>()=>{p(y)},b=y=>async()=>{await n(y,"Row has been copied")};return _.length?e("div",{className:I({"vm-table-view":!0,"vm-table-view_mobile":r}),children:e("table",{className:"vm-table",ref:s,children:[e("thead",{className:"vm-table-header",children:e("tr",{className:"vm-table__row vm-table__row_header",children:[d.map((y,w)=>e("td",{className:"vm-table-cell vm-table-cell_header vm-table-cell_sort",onClick:g(y.key),children:e("div",{className:"vm-table-cell__content",children:[y.key,e("div",{className:I({"vm-table__sort-icon":!0,"vm-table__sort-icon_active":i===y.key,"vm-table__sort-icon_desc":l==="desc"&&i===y.key}),children:e(We,{})})]})},w)),e("td",{className:"vm-table-cell vm-table-cell_header vm-table-cell_right vm-table-cell_sort",onClick:g("Value"),children:e("div",{className:"vm-table-cell__content",children:[e("div",{className:I({"vm-table__sort-icon":!0,"vm-table__sort-icon_active":i==="Value","vm-table__sort-icon_desc":l==="desc"}),children:e(We,{})}),"Value"]})}),f&&e("td",{className:"vm-table-cell vm-table-cell_header"})]})}),e("tbody",{className:"vm-table-body",children:_.map((y,w)=>e("tr",{className:"vm-table__row",children:[y.metadata.map((T,S)=>e("td",{className:I({"vm-table-cell vm-table-cell_no-wrap":!0,"vm-table-cell_gray":_[w-1]&&_[w-1].metadata[S]===T}),children:T},S)),e("td",{className:"vm-table-cell vm-table-cell_right vm-table-cell_no-wrap",children:y.values.length?y.values.map(T=>e("p",{children:T},T)):y.value}),f&&e("td",{className:"vm-table-cell vm-table-cell_right",children:y.copyValue&&e("div",{className:"vm-table-cell__content",children:e(G,{title:"Copy row",children:e($,{variant:"text",color:"gray",size:"small",startIcon:e(et,{}),onClick:b(y.copyValue),ariaLabel:"copy row"})})})})]},w))})]})}):e(se,{variant:"warning",children:"No data to show"})},pn=({checked:t=!1,disabled:a=!1,label:n,color:r="secondary",onChange:o})=>{const s=()=>{a||o(!t)},i=I({"vm-checkbox":!0,"vm-checkbox_disabled":a,"vm-checkbox_active":t,[`vm-checkbox_${r}_active`]:t,[`vm-checkbox_${r}`]:r});return e("div",{className:i,onClick:s,children:[e("div",{className:"vm-checkbox-track",children:e("div",{className:"vm-checkbox-track__thumb",children:e(Da,{})})}),n&&e("span",{className:"vm-checkbox__label",children:n})]})},Za="Table settings",Cr=({columns:t,selectedColumns:a=[],tableCompact:n,onChangeColumns:r,toggleTableCompact:o})=>{const[s,i]=ie(),c=Y(null),{value:l,toggle:m,setFalse:d}=oe(!1),[u,h]=C(""),[v,_]=C(-1),f=D(()=>a.filter(k=>!t.includes(k)),[t,a]),p=D(()=>{const k=f.concat(t);return u?k.filter(A=>A.includes(u)):k},[t,f,u]),g=D(()=>p.every(k=>a.includes(k)),[a,p]),b=k=>{r(k);const A=new URLSearchParams(s.toString());k.length===t.length?A.delete("columns"):A.set("columns",k.map(encodeURIComponent).join(",")),i(A)},y=k=>{const A=a.includes(k)?a.filter(L=>L!==k):[...a,k];b(A)},w=()=>{b(g?a.filter(k=>!p.includes(k)):p)},T=k=>()=>{y(k)},S=()=>{_(-1)},N=k=>{const A=k.key==="ArrowUp",L=k.key==="ArrowDown",E=k.key==="Enter";(L||A||E)&&k.preventDefault(),L?_(M=>M+1>p.length-1?M:M+1):A?_(M=>M-1<0?M:M-1):E&&y(p[v])};return x(()=>{Ra(t,a)||s.has("columns")||r(t)},[t]),x(()=>{if(!s.has("columns"))return;const L=(s.get("columns")||"").split(",").map(decodeURIComponent).filter(Boolean);r(L)},[]),e("div",{className:"vm-table-settings",children:[e(G,{title:Za,children:e("div",{ref:c,children:e($,{variant:"text",startIcon:e(ht,{}),onClick:m,ariaLabel:Za})})}),l&&e(Ie,{title:Za,className:"vm-table-settings-modal",onClose:d,children:[e("div",{className:"vm-table-settings-modal-section",children:[e("div",{className:"vm-table-settings-modal-section__title",children:"Customize columns"}),e("div",{className:"vm-table-settings-modal-columns",children:[e("div",{className:"vm-table-settings-modal-columns__search",children:e(le,{placeholder:"Search columns",startIcon:e(Vo,{}),value:u,onChange:h,onBlur:S,onKeyDown:N,type:"search"})}),e("div",{className:"vm-table-settings-modal-columns-list",children:[!!p.length&&e("div",{className:"vm-table-settings-modal-columns-list__item vm-table-settings-modal-columns-list__item_all",children:e(pn,{checked:g,onChange:w,label:g?"Uncheck all":"Check all",disabled:n})}),!p.length&&e("div",{className:"vm-table-settings-modal-columns-no-found",children:e("p",{className:"vm-table-settings-modal-columns-no-found__info",children:"No columns found."})}),p.map((k,A)=>e("div",{className:I({"vm-table-settings-modal-columns-list__item":!0,"vm-table-settings-modal-columns-list__item_focus":A===v,"vm-table-settings-modal-columns-list__item_custom":f.includes(k)}),children:e(pn,{checked:a.includes(k),onChange:T(k),label:k,disabled:n})},k))]})]})]}),e("div",{className:"vm-table-settings-modal-section",children:[e("div",{className:"vm-table-settings-modal-section__title",children:"Table view"}),e("div",{className:"vm-table-settings-modal-columns-list__item",children:e(Ce,{label:"Compact view",value:n,onChange:o})})]})]})]})},id=({liveData:t,controlsRef:a})=>{const{tableCompact:n}=He(),r=jt(),[o,s]=C(),i=D(()=>wr(t||[]).map(m=>m.key),[t]),l=e(Cr,{columns:i,selectedColumns:o,onChangeColumns:s,tableCompact:n,toggleTableCompact:()=>{r({type:"TOGGLE_TABLE_COMPACT"})}});return e(V,{children:[a.current&&Ft(l,a.current),e(ks,{data:t,displayColumns:o})]})},Ss=({graphData:t,liveData:a,isHistogram:n,displayType:r,controlsRef:o})=>r===_e.code&&a?e(Ua,{data:a}):r===_e.table&&a?e(id,{liveData:a,controlsRef:o}):r===_e.chart&&t?e(Ns,{graphData:t,isHistogram:n,controlsRef:o}):null,ld=e(V,{children:[e("p",{children:"Filename - specify the name for your report file."}),e("p",{children:["Default format: ",e("code",{children:["vmui_report_$",yo,".json"]}),"."]}),e("p",{children:"This name will be used when saving your report on your device."})]}),cd=e(V,{children:[e("p",{children:["Title - specify the title that will be displayed on the ",e(Ta,{to:K.queryAnalyzer,target:"_blank",rel:"noreferrer",className:"vm-link vm-link_underlined",children:lt[K.queryAnalyzer].title})," page."]}),e("p",{children:"This helps identify your report in the interface."})]}),dd=e(V,{children:[e("p",{children:"Comment (optional) - add a comment to your report."}),e("p",{children:"This can be any additional information that will be useful when reviewing the report later."})]}),md=e(V,{children:[e("p",{children:"Query trace - enable this option to include a query trace in your report."}),e("p",{children:"This will assist in analyzing and diagnosing the query processing."})]}),ud=e(V,{children:[e("p",{children:"Generate Report - click this button to generate and save your report. "}),e("p",{children:["After creation, the report can be downloaded and examined on the ",e(Ta,{to:K.queryAnalyzer,target:"_blank",rel:"noreferrer",className:"vm-link vm-link_underlined",children:lt[K.queryAnalyzer].title})," page."]})]}),hd=[ld,cd,dd,md,ud],Ts=t=>{try{return JSON.parse(t)}catch{return null}},pd=[{title:"Write",value:!1},{title:"Preview",value:!0}],vd=({value:t,onChange:a})=>{const{value:n,setTrue:r,setFalse:o}=oe(!1);return e("div",{className:"vm-markdown-editor",children:[e("div",{className:"vm-markdown-editor-header",children:[e("div",{className:"vm-markdown-editor-header-tabs",children:pd.map(({title:s,value:i})=>e("div",{className:I({"vm-markdown-editor-header-tabs__tab":!0,"vm-markdown-editor-header-tabs__tab_active":n===i}),onClick:i?r:o,children:s},s))}),e("span",{className:"vm-markdown-editor-header__info",children:"Markdown is supported"})]}),n?e("div",{className:"vm-markdown-editor-preview vm-markdown",dangerouslySetInnerHTML:{__html:Ht(t)}}):e(le,{type:"textarea",value:t,onChange:a})]})};var As=(t=>(t[t.QUERY_DATA=0]="QUERY_DATA",t[t.RAW_DATA=1]="RAW_DATA",t))(As||{});const gd=t=>{switch(t){case 1:return"Raw report";default:return"Report"}},_d=t=>{const a=q().utc().format(yo);return`vmui_${t.toLowerCase().replace(/ /g,"_")}_${a}`},xs=({fetchUrl:t,reportType:a=0})=>{const{query:n}=ke(),r=gd(a),o=_d(r),[s,i]=C(r),[c,l]=C(o),[m,d]=C(""),[u,h]=C(a===0),[v,_]=C(),[f,p]=C(!1),g=Y(null),b=Y(null),y=Y(null),w=Y(null),T=Y(null),S=[b,g,y,w,T],[N,k]=C(0),{value:A,toggle:L,setFalse:E}=oe(!1),{value:M,toggle:P,setFalse:R}=oe(!1),Q=Z(()=>{if(t)try{return t.map((O,z)=>{const j=new URL(O);return u?j.searchParams.set("trace","1"):j.searchParams.delete("trace"),{id:z,url:j}})}catch(O){_(String(O))}},[t,u]),H=Z(O=>{const z=JSON.stringify(O,null,2),j=new Blob([z],{type:"application/json"}),X=URL.createObjectURL(j),ee=document.createElement("a");ee.href=X,ee.download=`${c||o}.json`,document.body.appendChild(ee),ee.click(),document.body.removeChild(ee),URL.revokeObjectURL(X),E()},[c]),B=({id:O,url:z,comment:j,title:X})=>({id:O,title:X||r,comment:j,endpoint:ni(z.pathname)||"",params:Object.fromEntries(z.searchParams)}),F=async(O,z)=>{const j=[],X=await O.text();return O.ok?X.split(`
`).filter(ue=>ue).forEach(ue=>{const Te=Ts(ue);Te&&j.push({metric:Te.metric,values:Te.values.map((fe,Pe)=>[Te.timestamps[Pe]/1e3,fe])})}):_(String(X)),{data:{result:j,resultType:"matrix"},vmui:B(z)}},te=async(O,z)=>{const j=await O.json();if(O.ok)return j.vmui=B(z),j;{const X=j.errorType?`${j.errorType}\r
`:"";_(`${X}${(j==null?void 0:j.error)||(j==null?void 0:j.message)||"unknown error"}`)}},de=async(O,z)=>{switch(a){case 1:return await F(O,z);default:return await te(O,z)}},W=Z(async()=>{const O=Q();if(!O){_(z=>z||be.validQuery);return}_(""),p(!0);try{const z=[];for await(const j of O){if(!j)continue;const{url:X,id:ee}=j,ue=await fetch(X),Te=await de(ue,{id:ee,url:X,comment:m,title:s});z.push(Te)}z.length&&H(z)}catch(z){z instanceof Error&&z.name!=="AbortError"&&_(`${z.name}: ${z.message}`)}finally{p(!1)}},[Q,m,H,n,s]),ne=O=>()=>{const z=j=>{var ee;const X=j+O;return(ee=S[X])!=null&&ee.current?X:z(X)};k(z)};return x(()=>{_(""),l(o),d("")},[A]),x(()=>{k(0)},[M]),e(V,{children:[e(G,{title:"Export query",children:e($,{variant:"text",startIcon:e(Pa,{}),onClick:L,ariaLabel:"export query"})}),A&&e(Ie,{title:"Export query",onClose:E,isOpen:A,children:e("div",{className:"vm-download-report",children:[e("div",{className:"vm-download-report-settings",children:[e("div",{ref:b,children:[e("div",{className:"vm-download-report-settings__title",children:"Filename"}),e(le,{value:c,onChange:l})]}),e("div",{ref:g,children:[e("div",{className:"vm-download-report-settings__title",children:"Report title"}),e(le,{value:s,onChange:i})]}),e("div",{ref:y,children:[e("div",{className:"vm-download-report-settings__title",children:"Comment"}),e(vd,{value:m,onChange:d})]}),a===0&&e(V,{children:[e("div",{ref:w,children:e(pn,{checked:u,onChange:h,label:"Include query trace"})}),e(se,{variant:"info",children:["If confused with the query results, try viewing the raw samples for selected series in ",e(()=>e(Ta,{className:"vm-link vm-link_underlined vm-link_colored",to:K.rawQuery,children:"Raw Query"}),{})," tab."]})]})]}),v&&e(se,{variant:"error",children:v}),e("div",{className:"vm-download-report__buttons",children:[e($,{variant:"text",onClick:P,children:"Help"}),e("div",{ref:T,children:e($,{onClick:W,disabled:f,children:f?"Loading data...":"Generate Report"})})]}),e(Se,{open:M,buttonRef:S[N],placement:"top-left",variant:"dark",onClose:R,children:e("div",{className:"vm-download-report-helper",children:[e("div",{className:"vm-download-report-helper__description",children:hd[N]}),e("div",{className:"vm-download-report-helper__buttons",children:[N!==0&&e($,{onClick:ne(-1),size:"small",color:"white",children:"Prev"}),e($,{onClick:N===S.length-1?R:ne(1),size:"small",color:"white",variant:"text",children:N===S.length-1?"Close":"Next"})]})]})})]})})]})},Ls=()=>{const{isEmptyHistogram:t}=Ve(),{handleChange:a}=Cs();return t?e(se,{variant:"warning",children:e("div",{className:"vm-warning-heatmap-to-line",children:[e("p",{className:"vm-warning-heatmap-to-line__text",children:'The expression cannot be displayed as a heatmap. To make the graph work, disable the heatmap in the "Graph settings" or modify the expression.'}),e($,{size:"small",color:"primary",variant:"text",onClick:()=>a(!1),children:"Switch to line chart"})]})}):null},Es=()=>{ir();const{isMobile:t}=J(),{displayType:a}=He(),{query:n}=ke(),{customStep:r}=Ve(),o=Lt(),[s,i]=C([]),[c,l]=C(!n[0]),[m,d]=C(!1),u=Y(null),{fetchUrl:h,isLoading:v,liveData:_,graphData:f,error:p,queryErrors:g,setQueryErrors:b,queryStats:y,warning:w,traces:T,isHistogram:S,abortFetch:N}=za({visible:!0,customStep:r,hideQuery:s,showAllSeries:m}),k=!(_!=null&&_.length)&&a!==_e.chart,A=!c&&p,L=M=>{i(M)},E=()=>{l(!1)};return x(()=>{o({type:"SET_IS_HISTOGRAM",payload:S})},[f]),e("div",{className:I({"vm-custom-panel":!0,"vm-custom-panel_mobile":t}),children:[e(or,{queryErrors:c?[]:g,setQueryErrors:b,setHideError:l,stats:y,isLoading:v,onHideQuery:L,onRunQuery:E,abortFetch:N,hideButtons:{reduceMemUsage:!0}}),e(_c,{traces:T,displayType:a}),A&&e(se,{variant:"error",children:p}),k&&e(se,{variant:"info",children:e(gc,{})}),e(Ls,{}),w&&e(Ha,{warning:w,query:n,onChange:d}),e("div",{className:I({"vm-custom-panel-body":!0,"vm-custom-panel-body_mobile":t,"vm-block":!0,"vm-block_mobile":t}),children:[v&&e(Fa,{}),e("div",{className:"vm-custom-panel-body-header",ref:u,children:[e("div",{className:"vm-custom-panel-body-header__tabs",children:e(qo,{})}),(f||_)&&e(xs,{fetchUrl:h})]}),e(Ss,{graphData:f,liveData:_,isHistogram:S,displayType:a,controlsRef:u})]})]})},fd=({title:t,description:a,unit:n,expr:r,showLegend:o,filename:s,alias:i})=>{const{isMobile:c}=J(),{period:l}=he(),{customStep:m}=Ve(),d=Fe(),u=Y(null),[h,v]=C(!1),[_,f]=C(!1),[p,g]=C({limits:{enable:!1,range:{1:[0,0]}}}),b=D(()=>Array.isArray(r)&&r.every(E=>E),[r]),{isLoading:y,graphData:w,error:T,warning:S}=za({predefinedQuery:b?r:[],display:_e.chart,visible:h,customStep:m}),N=E=>{const M={...p};M.limits.range=E,g(M)},k=()=>{const E={...p};E.limits.enable=!E.limits.enable,g(E)},A=({from:E,to:M})=>{d({type:"SET_PERIOD",payload:{from:E,to:M}})};return x(()=>{const E=new IntersectionObserver(M=>{M.forEach(P=>v(P.isIntersecting))},{threshold:.1});return u.current&&E.observe(u.current),()=>{u.current&&E.unobserve(u.current)}},[u]),b?e("div",{className:"vm-predefined-panel",ref:u,children:[e("div",{className:"vm-predefined-panel-header",children:[e(G,{title:e(()=>e("div",{className:"vm-predefined-panel-header__description vm-default-styles",children:[a&&e(V,{children:[e("div",{children:[e("span",{children:"Description:"}),e("div",{dangerouslySetInnerHTML:{__html:Ht(a)}})]}),e("hr",{})]}),e("div",{children:[e("span",{children:"Queries:"}),e("div",{children:r.map((E,M)=>e("div",{children:E},`${M}_${E}`))})]})]}),{}),children:e("div",{className:"vm-predefined-panel-header__info",children:e(Ge,{})})}),e("h3",{className:"vm-predefined-panel-header__title",children:t||""}),e(yr,{data:w||[],yaxis:p,setYaxisLimits:N,toggleEnableLimits:k,spanGaps:{value:_,onChange:f}})]}),e("div",{className:"vm-predefined-panel-body",children:[y&&e(qe,{}),T&&e(se,{variant:"error",children:T}),S&&e(se,{variant:"warning",children:S}),w&&e(Va,{data:w,period:l,customStep:m,query:r,yaxis:p,unit:n,alias:i,showLegend:o,setYaxisLimits:N,setPeriod:A,fullWidth:!1,height:c?window.innerHeight*.5:500,spanGaps:_})]})]}):e(se,{variant:"error",children:[e("code",{children:'"expr"'})," not found. Check the configuration file ",e("b",{children:s}),"."]})},bd=({index:t,title:a,panels:n,filename:r})=>{const o=xt(),s=D(()=>o.width/12,[o]),[i,c]=C(!t),[l,m]=C([]);x(()=>{m(n&&n.map(b=>b.width||12))},[n]);const[d,u]=C({start:0,target:0,enable:!1}),h=Z(b=>{if(!d.enable)return;const{start:y}=d,w=Math.ceil((y-b.clientX)/s);if(Math.abs(w)>=12)return;const T=l.map((S,N)=>S-(N===d.target?w:0));m(T)},[d,s]),v=(b,y)=>{u({start:b.clientX,target:y,enable:!0})},_=Z(()=>{u({...d,enable:!1})},[d]),f=b=>c(b),p=b=>y=>{v(y,b)};return ce("mousemove",h),ce("mouseup",_),e("div",{className:"vm-predefined-dashboard",children:e(Oa,{defaultExpanded:i,onChange:f,title:e(()=>e("div",{className:I({"vm-predefined-dashboard-header":!0,"vm-predefined-dashboard-header_open":i}),children:[(a||r)&&e("span",{className:"vm-predefined-dashboard-header__title",children:a||`${t+1}. ${r}`}),n&&e("span",{className:"vm-predefined-dashboard-header__count",children:["(",n.length," panels)"]})]}),{}),children:e("div",{className:"vm-predefined-dashboard-panels",children:Array.isArray(n)&&n.length?n.map((b,y)=>e("div",{className:"vm-predefined-dashboard-panels-panel vm-block vm-block_empty-padding",style:{gridColumn:`span ${l[y]}`},children:[e(fd,{title:b.title,description:b.description,unit:b.unit,expr:b.expr,alias:b.alias,filename:r,showLegend:b.showLegend}),e("button",{className:"vm-predefined-dashboard-panels-panel__resizer",onMouseDown:p(y),"aria-label":"resize the panel"})]},y)):e("div",{className:"vm-predefined-dashboard-panels-panel__alert",children:e(se,{variant:"error",children:[e("code",{children:'"panels"'})," not found. Check the configuration file ",e("b",{children:r}),"."]})})})})})};function yd(t,a){return Object.fromEntries(Object.entries(t).filter(a))}function Ms(t){return yd(t,a=>!!a[1]||typeof a[1]=="number")}function wd(t){return Object.keys(t).length===0}const Cd=()=>{const{duration:t,relativeTime:a,period:{date:n}}=he(),{customStep:r}=Ve(),{setSearchParamsFromKeys:o}=vt(),s=()=>{const i=Ms({"g0.range_input":t,"g0.end_input":n,"g0.step_input":r,"g0.relative_time":a});o(i)};x(s,[t,a,n,r]),x(s,[])},Nd=()=>{Cd();const{isMobile:t}=J(),{dashboardsSettings:a,dashboardsLoading:n,dashboardsError:r}=jo(),[o,s]=C(0),i=D(()=>a.map((v,_)=>({label:v.title||"",value:_})),[a]),c=D(()=>a[o]||{},[a,o]),l=D(()=>c==null?void 0:c.rows,[c]),m=D(()=>c.title||c.filename||"",[c]),d=D(()=>Array.isArray(l)&&!!l.length,[l]),u=v=>{s(v)},h=v=>()=>{u(v)};return e("div",{className:"vm-predefined-panels",children:[n&&e(qe,{}),!a.length&&r&&e(se,{variant:"error",children:r}),!a.length&&e(se,{variant:"info",children:"Dashboards not found"}),i.length>1&&e("div",{className:I({"vm-predefined-panels-tabs":!0,"vm-predefined-panels-tabs_mobile":t}),children:i.map(v=>e("div",{className:I({"vm-predefined-panels-tabs__tab":!0,"vm-predefined-panels-tabs__tab_active":v.value==o}),onClick:h(v.value),children:v.label},v.value))}),e("div",{className:"vm-predefined-panels__dashboards",children:[d&&l.map((v,_)=>e(bd,{index:_,filename:m,title:v.title,panels:v.panels},`${o}_${_}`)),!!a.length&&!d&&e(se,{variant:"error",children:[e("code",{children:'"rows"'})," not found. Check the configuration file ",e("b",{children:m}),"."]})]})]})},Xa=(t,a)=>{const n=a.match?"&match[]="+encodeURIComponent(a.match):"",r=a.focusLabel?"&focusLabel="+encodeURIComponent(a.focusLabel):"";return`${t}/api/v1/status/tsdb?topN=${a.topN}&date=${a.date}${n}${r}`};class kd{constructor(){Je(this,"tsdbStatus");Je(this,"tabsNames");Je(this,"isPrometheus");this.tsdbStatus=this.defaultTSDBStatus,this.tabsNames=["table","graph"],this.isPrometheus=!1,this.getDefaultState=this.getDefaultState.bind(this)}set tsdbStatusData(a){this.isPrometheus=!!(a!=null&&a.headStats),this.tsdbStatus=a}get tsdbStatusData(){return this.tsdbStatus}get defaultTSDBStatus(){return{totalSeries:0,totalSeriesPrev:0,totalSeriesByAll:0,totalLabelValuePairs:0,seriesCountByMetricName:[],seriesCountByLabelName:[],seriesCountByFocusLabelValue:[],seriesCountByLabelValuePair:[],labelValueCountByLabelName:[]}}get isPrometheusData(){return this.isPrometheus}keys(a,n){const r=a&&/__name__=".+"/.test(a),o=a&&/{.+=".+"}/g.test(a),s=a&&/__name__=".+", .+!=""/g.test(a);let i=[];return n||s?i=i.concat("seriesCountByFocusLabelValue"):r?i=i.concat("labelValueCountByLabelName"):o?i=i.concat("seriesCountByMetricName","seriesCountByLabelName"):i=i.concat("seriesCountByMetricName","seriesCountByLabelName","seriesCountByLabelValuePair","labelValueCountByLabelName"),i}getDefaultState(a,n){return this.keys(a,n).reduce((r,o)=>({...r,tabs:{...r.tabs,[o]:this.tabsNames},containerRefs:{...r.containerRefs,[o]:Y(null)}}),{tabs:{},containerRefs:{}})}sectionsTitles(a){return{seriesCountByMetricName:"Metric names with the highest number of series",seriesCountByLabelName:"Labels with the highest number of series",seriesCountByFocusLabelValue:`Values for "${a}" label with the highest number of series`,seriesCountByLabelValuePair:"Label=value pairs with the highest number of series",labelValueCountByLabelName:"Labels with the highest number of unique values"}}get sectionsTips(){return{seriesCountByMetricName:`
        <p>
          This table returns a list of metrics with the highest cardinality.
          The cardinality of a metric is the number of time series associated with that metric,
          where each time series is defined as a unique combination of key-value label pairs.
        </p>
        <p>
          When looking to reduce the number of active series in your data source,
          you can start by inspecting individual metrics with high cardinality
          (i.e. that have lots of active time series associated with them),
          since that single metric contributes a large fraction of the series that make up your total series count.
        </p>`,seriesCountByLabelName:`
        <p>
          This table returns a list of the labels with the highest number of series.
        </p>
        <p>
          Use this table to identify labels that are storing dimensions with high cardinality
          (many different label values).
        </p>
        <p>
          It is recommended to choose labels such that they have a finite set of values,
          since every unique combination of key-value label pairs creates a new time series
          and therefore can dramatically increase the number of time series in your system.
        </p>`,seriesCountByFocusLabelValue:`
       <p>
          This table returns a list of unique label values per selected label.
       </p>
       <p>
          Use this table to identify label values that are storing per each selected series.
       </p>`,labelValueCountByLabelName:`
       <p>
          This table returns a list of labels with the highest number of the unique values.
       </p>
      `,seriesCountByLabelValuePair:`
        <p>
          This table returns a list of the label values pairs with the highest number of series.
        </p>
        <p>
          Use this table to identify unique label values pairs. This helps to identify same labels 
          is applied to count timeseries in your system, since every unique combination of key-value label pairs 
          creates a new time series and therefore can dramatically increase the number of time series in your system
        </p>`}}get tablesHeaders(){return{seriesCountByMetricName:Sd,seriesCountByLabelName:Td,seriesCountByFocusLabelValue:Ad,seriesCountByLabelValuePair:xd,labelValueCountByLabelName:Ld}}totalSeries(a,n=!1){return a==="labelValueCountByLabelName"?-1:n?this.tsdbStatus.totalSeriesPrev:this.tsdbStatus.totalSeries}}const Sd=[{id:"name",label:"Metric name"},{id:"value",label:"Number of series"},{id:"percentage",label:"Share in total",info:"Shows the share of a metric to the total number of series"},{id:"action",label:""}],Td=[{id:"name",label:"Label name"},{id:"value",label:"Number of series"},{id:"percentage",label:"Share in total",info:"Shows the share of the label to the total number of series"},{id:"action",label:""}],Ad=[{id:"name",label:"Label value"},{id:"value",label:"Number of series"},{id:"percentage",label:"Share in total"},{disablePadding:!1,id:"action",label:"",numeric:!1}],xd=[{id:"name",label:"Label=value pair"},{id:"value",label:"Number of series"},{id:"percentage",label:"Share in total",info:"Shows the share of the label value pair to the total number of series"},{id:"action",label:""}],Ld=[{id:"name",label:"Label name"},{id:"value",label:"Number of unique values"},{id:"action",label:""}],Ed=()=>{const t=new kd,[a]=ie(),n=a.get("match"),r=a.get("focusLabel"),o=+(a.get("topN")||10),s=a.get("date")||q().tz().format(yt),i=Xt(s),c=Y(),{serverUrl:l}=re(),[m,d]=C(!1),[u,h]=C(),[v,_]=C(t.defaultTSDBStatus),[f,p]=C(!1),g=async w=>{const T=await fetch(w);if(T.ok)return await T.json();throw new Error(`Request failed with status ${T.status}`)},b=(w,T)=>{Object.keys(w).forEach(S=>{const N=S,k=w[N],A=T[N];Array.isArray(k)&&Array.isArray(A)&&k.forEach(L=>{var M;const E=(M=A.find(P=>P.name===L.name))==null?void 0:M.value;L.diff=E?L.value-E:0,L.valuePrev=E||0})})},y=async w=>{var k,A,L,E,M,P,R,Q,H,B;if(!l)return;h(""),d(!0),_(t.defaultTSDBStatus);const T={...w,date:w.date,topN:0,match:"",focusLabel:""},S={...w,date:q(w.date).subtract(1,"day").format(yt)},N=[Xa(l,w),Xa(l,S)];i!==s&&(w.match||w.focusLabel)&&N.push(Xa(l,T));try{const[F,te,de]=await Promise.all(N.map(g)),W={...te.data},{data:ne}=de||c.current||F;c.current={data:ne};const U={...F.data,totalSeries:((k=F.data)==null?void 0:k.totalSeries)||((L=(A=F.data)==null?void 0:A.headStats)==null?void 0:L.numSeries)||0,totalLabelValuePairs:((E=F.data)==null?void 0:E.totalLabelValuePairs)||((P=(M=F.data)==null?void 0:M.headStats)==null?void 0:P.numLabelValuePairs)||0,seriesCountByLabelName:((R=F.data)==null?void 0:R.seriesCountByLabelName)||[],seriesCountByFocusLabelValue:((Q=F.data)==null?void 0:Q.seriesCountByFocusLabelValue)||[],totalSeriesByAll:(ne==null?void 0:ne.totalSeries)||((H=ne==null?void 0:ne.headStats)==null?void 0:H.numSeries)||v.totalSeriesByAll||0,totalSeriesPrev:(W==null?void 0:W.totalSeries)||((B=W==null?void 0:W.headStats)==null?void 0:B.numSeries)||0},O=n==null?void 0:n.replace(/[{}"]/g,"");U.seriesCountByLabelValuePair=U.seriesCountByLabelValuePair.filter(z=>z.name!==O),b(U,W),_(U),d(!1)}catch(F){d(!1),F instanceof Error&&h(`${F.name}: ${F.message}`)}};return x(()=>{y({topN:o,match:n,date:s,focusLabel:r})},[l,n,r,o,s]),x(()=>{u&&(_(t.defaultTSDBStatus),d(!1))},[u]),x(()=>{const w=aa(l);p(!!w)},[l]),t.tsdbStatusData=v,{isLoading:m,appConfigurator:t,error:u,isCluster:f}},Md={seriesCountByMetricName:({query:t})=>en("__name__",t),seriesCountByLabelName:({query:t})=>`{${t}!=""}`,seriesCountByFocusLabelValue:({query:t,focusLabel:a})=>en(a,t),seriesCountByLabelValuePair:({query:t})=>{const a=t.split("="),n=a[0],r=a.slice(1).join("=");return en(n,r)},labelValueCountByLabelName:({query:t,match:a})=>a===""?`{${t}!=""}`:`${a.replace("}","")}, ${t}!=""}`},en=(t,a)=>t?"{"+t+"="+JSON.stringify(a)+"}":"",Dd=({totalSeries:t=0,totalSeriesPrev:a=0,totalSeriesAll:n=0,seriesCountByMetricName:r=[],isPrometheus:o})=>{var _;const{isMobile:s}=J(),[i]=ie(),c=i.get("match"),l=i.get("focusLabel"),m=/__name__/.test(c||""),d=((_=r[0])==null?void 0:_.value)/n*100,u=t-a,h=Math.abs(u)/a*100,v=[{title:"Total series",value:t.toLocaleString("en-US"),dynamic:!t||!a||o?"":`${h.toFixed(2)}%`,display:!l,info:`The total number of unique time series for a selected day.
             A time series is uniquely identified by its name plus a set of its labels. 
             For example, temperature{city="NY",country="US"} and temperature{city="SF",country="US"} 
             are two distinct series, since they differ by the "city" label.`},{title:"Percentage from total",value:isNaN(d)?"-":`${d.toFixed(2)}%`,display:m,info:"The share of these series in the total number of time series."}].filter(f=>f.display);return v.length?e("div",{className:I({"vm-cardinality-totals":!0,"vm-cardinality-totals_mobile":s}),children:v.map(({title:f,value:p,info:g,dynamic:b})=>e("div",{className:"vm-cardinality-totals-card",children:[e("h4",{className:"vm-cardinality-totals-card__title",children:[f,g&&e(G,{title:e("p",{className:"vm-cardinality-totals-card__tooltip",children:g}),children:e("div",{className:"vm-cardinality-totals-card__info-icon",children:e(Ge,{})})})]}),e("span",{className:"vm-cardinality-totals-card__value",children:p}),!!b&&e(G,{title:`in relation to the previous day: ${a.toLocaleString("en-US")}`,children:e("span",{className:I({"vm-dynamic-number":!0,"vm-dynamic-number_positive vm-dynamic-number_down":u<0,"vm-dynamic-number_negative vm-dynamic-number_up":u>0}),children:b})})]},f))}):null},Ne=(t,a)=>{const[n]=ie(),r=n.get(a)?n.get(a):t,[o,s]=C(r);return x(()=>{r!==o&&s(r)},[r]),[o,s]},Id=({isPrometheus:t,isCluster:a,...n})=>{const{isMobile:r}=J(),[o]=ie(),{setSearchParamsFromKeys:s}=vt(),i=o.get("tips")||"",[c,l]=Ne("","match"),[m,d]=Ne("","focusLabel"),[u,h]=Ne(10,"topN"),v=D(()=>u<0?"Number must be bigger than zero":"",[u]),_=b=>{const y=+b;h(isNaN(y)?0:y)},f=()=>{s({match:c,topN:u,focusLabel:m})},p=()=>{s({match:"",focusLabel:""})},g=()=>{const b=o.get("tips")||"";s({tips:b?"":"true"})};return x(()=>{const b=o.get("match"),y=+(o.get("topN")||10),w=o.get("focusLabel");b!==c&&l(b||""),y!==u&&h(y),w!==m&&d(w||"")},[o]),e("div",{className:I({"vm-cardinality-configurator":!0,"vm-cardinality-configurator_mobile":r,"vm-block":!0,"vm-block_mobile":r}),children:[e("div",{className:"vm-cardinality-configurator-controls",children:[e("div",{className:"vm-cardinality-configurator-controls__query",children:e(le,{label:"Time series selector",type:"string",value:c,onChange:l,onEnter:f})}),e("div",{className:"vm-cardinality-configurator-controls__item",children:e(le,{label:"Focus label",type:"text",value:m||"",onChange:d,onEnter:f,endIcon:e(G,{title:e("div",{children:e("p",{children:"To identify values with the highest number of series for the selected label."})}),children:e(Rn,{})})})}),e("div",{className:"vm-cardinality-configurator-controls__item vm-cardinality-configurator-controls__item_limit",children:e(le,{label:"Limit entries",type:"number",value:t?10:u,error:v,disabled:t,helperText:t?"not available for Prometheus":"",onChange:_,onEnter:f})})]}),e("div",{className:"vm-cardinality-configurator-bottom",children:[e(Dd,{isPrometheus:t,isCluster:a,...n}),a&&e("div",{className:"vm-cardinality-configurator-bottom-helpful",children:e(we,{href:"https://docs.victoriametrics.com/Single-server-VictoriaMetrics.html#cardinality-explorer-statistic-inaccuracy",withIcon:!0,children:[e(st,{}),"Statistic inaccuracy explanation"]})}),e("div",{className:"vm-cardinality-configurator-bottom-helpful",children:e(we,{href:"https://docs.victoriametrics.com/#cardinality-explorer",withIcon:!0,children:[e(st,{}),"Documentation"]})}),e("div",{className:"vm-cardinality-configurator-bottom__execute",children:[e(G,{title:i?"Hide tips":"Show tips",children:e($,{variant:"text",color:i?"warning":"gray",startIcon:e(oa,{}),onClick:g,ariaLabel:"visibility tips"})}),e($,{variant:"text",startIcon:e(rt,{}),onClick:p,children:"Reset"}),e($,{startIcon:e(ct,{}),onClick:f,children:"Execute Query"})]})]})]})};function Pd(t){const{order:a,orderBy:n,onRequestSort:r,headerCells:o}=t,s=i=>c=>{r(c,i)};return e("thead",{className:"vm-table-header vm-cardinality-panel-table__header",children:e("tr",{className:"vm-table__row vm-table__row_header",children:o.map(i=>e("th",{className:I({"vm-table-cell vm-table-cell_header":!0,"vm-table-cell_sort":i.id!=="action"&&i.id!=="percentage","vm-table-cell_right":i.id==="action"}),onClick:s(i.id),children:e("div",{className:"vm-table-cell__content",children:[i.info?e(G,{title:i.info,children:[e("div",{className:"vm-metrics-content-header__tip-icon",children:e(Ge,{})}),i.label]}):e(V,{children:i.label}),i.id!=="action"&&i.id!=="percentage"&&e("div",{className:I({"vm-table__sort-icon":!0,"vm-table__sort-icon_active":n===i.id,"vm-table__sort-icon_desc":a==="desc"&&n===i.id}),children:e(We,{})})]})},i.id))})})}const Wr=["date","timestamp","time"];function Jr(t,a,n){const r=t[n],o=a[n],s=Wr.includes(String(n))?q(`${r}`).unix():r,i=Wr.includes(String(n))?q(`${o}`).unix():o;return i<s?-1:i>s?1:0}function Nr(t,a){return t==="desc"?(n,r)=>Jr(n,r,a):(n,r)=>-Jr(n,r,a)}function kr(t,a){const n=t.map((r,o)=>[r,o]);return n.sort((r,o)=>{const s=a(r[0],o[0]);return s!==0?s:r[1]-o[1]}),n.map(r=>r[0])}const $d=({rows:t,headerCells:a,defaultSortColumn:n,tableCells:r})=>{const[o,s]=C("desc"),[i,c]=C(n),l=(d,u)=>{s(i===u&&o==="asc"?"desc":"asc"),c(u)},m=kr(t,Nr(o,i));return e("table",{className:"vm-table vm-cardinality-panel-table",children:[e(Pd,{order:o,orderBy:i,onRequestSort:l,rowCount:t.length,headerCells:a}),e("tbody",{className:"vm-table-header",children:m.map(d=>e("tr",{className:"vm-table__row",children:r(d)},d.name))})]})},Od=({row:t,totalSeries:a,totalSeriesPrev:n,onActionClick:r})=>{const o=a>0?t.value/a*100:-1,s=n>0?t.valuePrev/n*100:-1,i=[o,s].some(d=>d===-1),c=o-s,l=i?"":`${c.toFixed(2)}%`,m=()=>{r(t.name)};return e(V,{children:[e("td",{className:"vm-table-cell",children:e("span",{className:"vm-link vm-link_colored",onClick:m,children:t.name})},t.name),e("td",{className:"vm-table-cell",children:[t.value,!!t.diff&&e(G,{title:`in relation to the previous day: ${t.valuePrev}`,children:e("span",{className:I({"vm-dynamic-number":!0,"vm-dynamic-number_positive":t.diff<0,"vm-dynamic-number_negative":t.diff>0}),children:["",t.diff>0?"+":"",t.diff]})})]},t.value),o>0&&e("td",{className:"vm-table-cell",children:e("div",{className:"vm-cardinality-panel-table__progress",children:[e(is,{value:o}),l&&e(G,{title:"in relation to the previous day",children:e("span",{className:I({"vm-dynamic-number":!0,"vm-dynamic-number_positive vm-dynamic-number_down":c<0,"vm-dynamic-number_negative vm-dynamic-number_up":c>0}),children:l})})]})},t.progressValue),e("td",{className:"vm-table-cell vm-table-cell_right",children:e("div",{className:"vm-table-cell__content",children:e(G,{title:`Filter by ${t.name}`,children:e($,{variant:"text",size:"small",onClick:m,children:e(Ea,{})})})})},"action")]})},Rd=({data:t})=>{const[a,n]=C([]),[r,o]=C([0,0]),s=i=>{const c=i.map(u=>u.value),l=Math.ceil(c[0]||1),m=10,d=l/(m-1);return new Array(m+1).fill(l+d).map((u,h)=>Math.round(u-d*h))};return x(()=>{const i=t.sort((l,m)=>m.value-l.value),c=s(i);o(c),n(i.map(l=>({...l,percentage:l.value/c[0]*100})))},[t]),e("div",{className:"vm-simple-bar-chart",children:[e("div",{className:"vm-simple-bar-chart-y-axis",children:r.map(i=>e("div",{className:"vm-simple-bar-chart-y-axis__tick",children:i},i))}),e("div",{className:"vm-simple-bar-chart-data",children:a.map(({name:i,value:c,percentage:l})=>e(G,{title:`${i}: ${c}`,placement:"top-center",children:e("div",{className:"vm-simple-bar-chart-data-item",style:{maxHeight:`${l||0}%`}})},`${i}_${c}`))})]})},zd=({rows:t,tabs:a=[],chartContainer:n,totalSeries:r,totalSeriesPrev:o,onActionClick:s,sectionTitle:i,tip:c,tableHeaderCells:l,isPrometheus:m})=>{const{isMobile:d}=J(),[u,h]=C("table"),v=m&&!t.length,_=p=>e(Od,{row:p,totalSeries:r,totalSeriesPrev:o,onActionClick:s}),f=D(()=>a.map((p,g)=>({value:p,label:p,icon:g===0?e(ra,{}):e(In,{})})),[a]);return e("div",{className:I({"vm-metrics-content":!0,"vm-metrics-content_mobile":d,"vm-block":!0,"vm-block_mobile":d}),children:[e("div",{className:"vm-metrics-content-header vm-section-header",children:[e("h5",{className:I({"vm-metrics-content-header__title":!0,"vm-section-header__title":!0,"vm-section-header__title_mobile":d}),children:[!d&&c&&e(G,{title:e("p",{dangerouslySetInnerHTML:{__html:c},className:"vm-metrics-content-header__tip"}),children:e("div",{className:"vm-metrics-content-header__tip-icon",children:e(Ge,{})})}),i]}),e("div",{className:"vm-section-header__tabs",children:e(Bt,{activeItem:u,items:f,onChange:h})})]}),v&&e("div",{className:"vm-metrics-content-prom-data",children:[e("div",{className:"vm-metrics-content-prom-data__icon",children:e(Ge,{})}),e("h3",{className:"vm-metrics-content-prom-data__title",children:"Prometheus Data Limitation"}),e("p",{className:"vm-metrics-content-prom-data__text",children:["Due to missing data from your Prometheus source, some tables may appear empty.",e("br",{}),"This does not indicate an issue with your system or our tool."]})]}),!v&&u==="table"&&e("div",{ref:n,className:I({"vm-metrics-content__table":!0,"vm-metrics-content__table_mobile":d}),children:e($d,{rows:t,headerCells:l,defaultSortColumn:"value",tableCells:_})}),!v&&u==="graph"&&e("div",{className:"vm-metrics-content__chart",children:e(Rd,{data:t.map(({name:p,value:g})=>({name:p,value:g}))})})]})},qa=({title:t,children:a})=>e("div",{className:"vm-cardinality-tip",children:[e("div",{className:"vm-cardinality-tip-header",children:[e("div",{className:"vm-cardinality-tip-header__tip-icon",children:e(oa,{})}),e("h4",{className:"vm-cardinality-tip-header__title",children:t||"Tips"})]}),e("p",{className:"vm-cardinality-tip__description",children:a})]}),Fd=()=>e(qa,{title:"Metrics with a high number of series",children:e("ul",{children:[e("li",{children:["Identify and eliminate labels with frequently changed values to reduce their",e(we,{href:"https://docs.victoriametrics.com/FAQ.html#what-is-high-cardinality",children:"cardinality"}),"and",e(we,{href:"https://docs.victoriametrics.com/FAQ.html#what-is-high-churn-rate",children:"high churn rate"})]}),e("li",{children:["Find unused time series and",e(we,{href:"https://docs.victoriametrics.com/relabeling.html",children:"drop entire metrics"})]}),e("li",{children:["Aggregate time series before they got ingested into the database via",e(we,{href:"https://docs.victoriametrics.com/stream-aggregation.html",children:"streaming aggregation"})]})]})}),Hd=()=>e(qa,{title:"Labels with a high number of unique values",children:e("ul",{children:[e("li",{children:"Decrease the number of unique label values to reduce cardinality"}),e("li",{children:["Drop the label entirely via",e(we,{href:"https://docs.victoriametrics.com/relabeling.html",children:"relabeling"})]}),e("li",{children:"For volatile label values (such as URL path, user session, etc.) consider printing them to the log file instead of adding to time series"})]})}),Vd=()=>e(qa,{title:"Dashboard of a single metric",children:[e("p",{children:"This dashboard helps to understand the cardinality of a single metric."}),e("p",{children:"Each time series is a unique combination of key-value label pairs. Therefore a label key with many values can create a lot of time series for a particular metric. If youre trying to decrease the cardinality of a metric, start by looking at the labels with the highest number of values."}),e("p",{children:"Use the series selector at the top of the page to apply additional filters."})]}),Ud=()=>e(qa,{title:"Dashboard of a label",children:[e("p",{children:"This dashboard helps you understand the count of time series per label."}),e("p",{children:"Use the selector at the top of the page to pick a label name youd like to inspect. For the selected label name, youll see the label values that have the highest number of series associated with them. So if youve chosen `instance` as your label name, you may see that `657` time series have value host-1 attached to them and `580` time series have value `host-2` attached to them."}),e("p",{children:"This can be helpful in allowing you to determine where the bulk of your time series are coming from. If the label instance=host-1 was applied to 657 series and the label instance=host-2 was only applied to 580 series, youd know, for example, that host-01 was responsible for sending the majority of the time series."})]}),qd=`Please wait while cardinality stats is calculated. 
                        This may take some time if the db contains big number of time series.`,Bd=()=>{const{isMobile:t}=J(),[a]=ie(),{setSearchParamsFromKeys:n}=vt(),r=a.get("tips")||"",o=a.get("match")||"",s=a.get("focusLabel")||"",{isLoading:i,appConfigurator:c,error:l,isCluster:m}=Ed(),{tsdbStatusData:d,getDefaultState:u,tablesHeaders:h,sectionsTips:v}=c,_=u(o,s),f=p=>g=>{const y={match:Md[p]({query:g,focusLabel:s,match:o})};(p==="labelValueCountByLabelName"||p=="seriesCountByLabelName")&&(y.focusLabel=g),p=="seriesCountByFocusLabelValue"&&(y.focusLabel=""),n(y)};return e("div",{className:I({"vm-cardinality-panel":!0,"vm-cardinality-panel_mobile":t}),children:[i&&e(qe,{message:qd}),e(Id,{isPrometheus:c.isPrometheusData,totalSeries:d.totalSeries,totalSeriesPrev:d.totalSeriesPrev,totalSeriesAll:d.totalSeriesByAll,totalLabelValuePairs:d.totalLabelValuePairs,seriesCountByMetricName:d.seriesCountByMetricName,isCluster:m}),r&&e("div",{className:"vm-cardinality-panel-tips",children:[!o&&!s&&e(Fd,{}),o&&!s&&e(Vd,{}),!o&&!s&&e(Hd,{}),s&&e(Ud,{})]}),l&&e(se,{variant:"error",children:l}),c.keys(o,s).map(p=>e(zd,{sectionTitle:c.sectionsTitles(s)[p],tip:v[p],rows:d[p],onActionClick:f(p),tabs:_.tabs[p],chartContainer:_.containerRefs[p],totalSeriesPrev:c.totalSeries(p,!0),totalSeries:c.totalSeries(p),tableHeaderCells:h[p],isPrometheus:c.isPrometheusData},p))]})},jd=(t,a,n)=>`${t}/api/v1/status/top_queries?topN=${a||""}&maxLifetime=${n||""}`,Qd=(t,a)=>{var i;const{query:n,timeRangeSeconds:r}=t,o=[`g0.expr=${encodeURIComponent(n)}`],s=(i=Jt.find(c=>c.duration===a))==null?void 0:i.id;return s&&o.push(`g0.relative_time=${s}`),r&&o.push(`g0.range_input=${a}`),`${K.home}?${o.join("&")}`},Yd=t=>(["topByAvgDuration","topByCount","topBySumDuration"].forEach(n=>{const r=t[n];Array.isArray(r)&&r.forEach(o=>{const s=xa(o.timeRangeSeconds*1e3);o.url=Qd(o,s),o.timeRange=s})}),t),Gd=({topN:t,maxLifetime:a})=>{const{serverUrl:n}=re(),{setSearchParamsFromKeys:r}=vt(),[o,s]=C(null),[i,c]=C(!1),[l,m]=C(),d=D(()=>jd(n,t,a),[n,t,a]);return{data:o,error:l,loading:i,fetch:async()=>{c(!0),r({topN:t,maxLifetime:a});try{const h=await fetch(d),v=await h.json();s(h.ok?Yd(v):null),m(String(v.error||""))}catch(h){h instanceof Error&&h.name!=="AbortError"&&m(`${h.name}: ${h.message}`)}c(!1)}}},Wd=({rows:t,columns:a,defaultOrderBy:n})=>{const r=Ue(),[o,s]=C(n||"count"),[i,c]=C("desc"),l=D(()=>kr(t,Nr(i,o)),[t,o,i]),m=h=>{c(v=>v==="asc"&&o===h?"desc":"asc"),s(h)},d=h=>()=>{m(h)},u=({query:h})=>async()=>{await r(h,"Query has been copied")};return e("table",{className:"vm-table",children:[e("thead",{className:"vm-table-header",children:e("tr",{className:"vm-table__row vm-table__row_header",children:[a.map(h=>e("th",{className:"vm-table-cell vm-table-cell_header vm-table-cell_sort",onClick:d(h.sortBy||h.key),children:e("div",{className:"vm-table-cell__content",children:[h.title||h.key,e("div",{className:I({"vm-table__sort-icon":!0,"vm-table__sort-icon_active":o===h.key,"vm-table__sort-icon_desc":i==="desc"&&o===h.key}),children:e(We,{})})]})},h.key)),e("th",{className:"vm-table-cell vm-table-cell_header"})," "]})}),e("tbody",{className:"vm-table-body",children:l.map((h,v)=>e("tr",{className:"vm-table__row",children:[a.map(_=>e("td",{className:"vm-table-cell",children:h[_.key]||"-"},_.key)),e("td",{className:"vm-table-cell vm-table-cell_no-padding",children:e("div",{className:"vm-top-queries-panels__table-actions",children:[h.url&&e(G,{title:"Execute query",children:e(Ta,{to:h.url,target:"_blank",rel:"noreferrer","aria-disabled":!0,children:e($,{variant:"text",size:"small",startIcon:e(Ea,{}),ariaLabel:"execute query"})})}),e(G,{title:"Copy query",children:e($,{variant:"text",size:"small",startIcon:e(et,{}),onClick:u(h),ariaLabel:"copy query"})})]})})]},v))})]})},Jd=["table","JSON"].map((t,a)=>({value:String(a),label:t,icon:a===0?e(ra,{}):e(At,{})})),tn=({rows:t,title:a,columns:n,defaultOrderBy:r})=>{const{isMobile:o}=J(),[s,i]=C(0),c=l=>{i(+l)};return e("div",{className:I({"vm-top-queries-panel":!0,"vm-block":!0,"vm-block_mobile":o}),children:[e("div",{className:I({"vm-top-queries-panel-header":!0,"vm-section-header":!0,"vm-top-queries-panel-header_mobile":o}),children:[e("h5",{className:I({"vm-section-header__title":!0,"vm-section-header__title_mobile":o}),children:a}),e("div",{className:"vm-section-header__tabs",children:e(Bt,{activeItem:String(s),items:Jd,onChange:c})})]}),e("div",{className:I({"vm-top-queries-panel__table":!0,"vm-top-queries-panel__table_mobile":o}),children:[s===0&&e(Wd,{rows:t,columns:n,defaultOrderBy:r}),s===1&&e(Ua,{data:t})]})]})},Kd="30ms, 15s, 3d4h, 1y2w",Zd=()=>{const{isMobile:t}=J(),[a,n]=Ne(10,"topN"),[r,o]=Ne("10m","maxLifetime"),{data:s,error:i,loading:c,fetch:l}=Gd({topN:a,maxLifetime:r}),m=D(()=>{const b=r.trim().split(" ").reduce((w,T)=>{const S=wo(T);return S?{...w,...S}:{...w}},{});return!!q.duration(b).asMilliseconds()},[r]),d=D(()=>!!a&&a<1,[a]),u=D(()=>d?"Number must be bigger than zero":"",[d]),h=D(()=>m?"":"Invalid duration value",[m]),v=g=>{if(!s)return g;const b=s[g];return typeof b=="number"?ut(b,b,b):b||g},_=g=>{n(+g)},f=g=>{o(g)},p=g=>{g.key==="Enter"&&l()};return x(()=>{s&&(a||n(+s.topN),r||o(s.maxLifetime))},[s]),x(()=>(l(),window.addEventListener("popstate",l),()=>{window.removeEventListener("popstate",l)}),[]),e("div",{className:I({"vm-top-queries":!0,"vm-top-queries_mobile":t}),children:[c&&e(qe,{containerStyles:{height:"500px"}}),e("div",{className:I({"vm-top-queries-controls":!0,"vm-block":!0,"vm-block_mobile":t}),children:[e("div",{className:"vm-top-queries-controls-fields",children:[e("div",{className:"vm-top-queries-controls-fields__item",children:e(le,{label:"Max lifetime",value:r,error:h,helperText:`For example ${Kd}`,onChange:f,onKeyDown:p})}),e("div",{className:"vm-top-queries-controls-fields__item",children:e(le,{label:"Number of returned queries",type:"number",value:a||"",error:u,onChange:_,onKeyDown:p})})]}),e("div",{className:I({"vm-top-queries-controls-bottom":!0,"vm-top-queries-controls-bottom_mobile":t}),children:[e("div",{className:"vm-top-queries-controls-bottom__info",children:["VictoriaMetrics tracks the last",e(G,{title:"search.queryStats.lastQueriesCount",children:e("b",{children:v("search.queryStats.lastQueriesCount")})}),"queries with durations at least",e(G,{title:"search.queryStats.minQueryDuration",children:e("b",{children:v("search.queryStats.minQueryDuration")})})]}),e("div",{className:"vm-top-queries-controls-bottom__button",children:e($,{startIcon:e(ct,{}),onClick:l,children:"Execute"})})]})]}),i&&e(se,{variant:"error",children:i}),s&&e(V,{children:e("div",{className:"vm-top-queries-panels",children:[e(tn,{rows:s.topBySumDuration,title:"Queries with most summary time to execute",columns:[{key:"query"},{key:"sumDurationSeconds",title:"sum duration, sec"},{key:"timeRange",sortBy:"timeRangeSeconds",title:"query time interval"},{key:"count"}],defaultOrderBy:"sumDurationSeconds"}),e(tn,{rows:s.topByAvgDuration,title:"Most heavy queries",columns:[{key:"query"},{key:"avgDurationSeconds",title:"avg duration, sec"},{key:"timeRange",sortBy:"timeRangeSeconds",title:"query time interval"},{key:"count"}],defaultOrderBy:"avgDurationSeconds"}),e(tn,{rows:s.topByCount,title:"Most frequently executed queries",columns:[{key:"query"},{key:"timeRange",sortBy:"timeRangeSeconds",title:"query time interval"},{key:"count"}]})]})})]})},an={"color-primary":"#589DF6","color-secondary":"#316eca","color-error":"#e5534b","color-warning":"#c69026","color-info":"#539bf5","color-success":"#57ab5a","color-background-body":"#22272e","color-background-block":"#2d333b","color-background-tooltip":"rgba(22, 22, 22, 0.8)","color-text":"#cdd9e5","color-text-secondary":"#768390","color-text-disabled":"#636e7b","box-shadow":"rgba(0, 0, 0, 0.16) 1px 2px 6px","box-shadow-popper":"rgba(0, 0, 0, 0.2) 0px 2px 8px 0px","border-divider":"1px solid rgba(99, 110, 123, 0.5)","color-hover-black":"rgba(0, 0, 0, 0.12)","color-log-hits-bar-0":"rgba(255, 255, 255, 0.18)","color-log-hits-bar-1":"#FFB74D","color-log-hits-bar-2":"#81C784","color-log-hits-bar-3":"#64B5F6","color-log-hits-bar-4":"#E57373","color-log-hits-bar-5":"#8a62f0"},nn={"color-primary":"#3F51B5","color-secondary":"#E91E63","color-error":"#FD080E","color-warning":"#FF8308","color-info":"#03A9F4","color-success":"#4CAF50","color-background-body":"#FEFEFF","color-background-block":"#FFFFFF","color-background-tooltip":"rgba(80,80,80,0.9)","color-text":"#110f0f","color-text-secondary":"#706F6F","color-text-disabled":"#A09F9F","box-shadow":"rgba(0, 0, 0, 0.08) 1px 2px 6px","box-shadow-popper":"rgba(0, 0, 0, 0.1) 0px 2px 8px 0px","border-divider":"1px solid rgba(0, 0, 0, 0.15)","color-hover-black":"rgba(0, 0, 0, 0.06)","color-log-hits-bar-0":"rgba(0, 0, 0, 0.18)","color-log-hits-bar-1":"#FFB74D","color-log-hits-bar-2":"#81C784","color-log-hits-bar-3":"#64B5F6","color-log-hits-bar-4":"#E57373","color-log-hits-bar-5":"#8a62f0"},Xd=()=>{const[t,a]=C(va()),n=r=>{a(r.matches)};return x(()=>{const r=window.matchMedia("(prefers-color-scheme: dark)");return r.addEventListener("change",n),()=>r.removeEventListener("change",n)},[]),t},rn=["primary","secondary","error","warning","info","success"],Sr=({onLoaded:t})=>{const a=ye(),{palette:n={}}=ta(),{theme:r}=re(),o=Xd(),s=Tt(),i=xt(),[c,l]=C({[Qe.dark]:an,[Qe.light]:nn,[Qe.system]:va()?an:nn}),m=()=>{const{innerWidth:_,innerHeight:f}=window,{clientWidth:p,clientHeight:g}=document.documentElement;Dt("scrollbar-width",`${_-p}px`),Dt("scrollbar-height",`${f-g}px`),Dt("vh",`${f*.01}px`)},d=()=>{rn.forEach((_,f)=>{const p=Xe(`color-${_}`),g=xc(p);Dt(`${_}-text`,g),f===rn.length-1&&(s({type:"SET_DARK_THEME"}),t(!0))})},u=()=>{rn.forEach(_=>{const f=n[_];f&&Dt(`color-${_}`,f)}),d()},h=()=>{const _=ze("THEME")||Qe.system,f=c[_];Object.entries(f).forEach(([p,g])=>{Dt(p,g)}),d(),a&&u()},v=()=>{const _=va()?an:nn;if(c[Qe.system]===_){h();return}l(f=>({...f,[Qe.system]:_}))};return x(()=>{m(),h()},[c]),x(m,[i]),x(v,[r,o]),x(()=>{a&&s({type:"SET_THEME",payload:Qe.light})},[]),null},Ds=()=>{const[t,a]=C([]),[n,r]=C(!1),o=Y(document.body),s=m=>{const d=Array.from(m||[]);a(d)},i=m=>{m.preventDefault(),m.stopPropagation(),m.type==="dragenter"||m.type==="dragover"?r(!0):m.type==="dragleave"&&r(!1)},c=m=>{var d;m.preventDefault(),m.stopPropagation(),r(!1),(d=m==null?void 0:m.dataTransfer)!=null&&d.files&&m.dataTransfer.files[0]&&s(m.dataTransfer.files)},l=m=>{var h;const d=(h=m.clipboardData)==null?void 0:h.items;if(!d)return;const u=Array.from(d).filter(v=>v.type==="application/json").map(v=>v.getAsFile()).filter(v=>v!==null);a(u)};return ce("dragenter",i,o),ce("dragleave",i,o),ce("dragover",i,o),ce("drop",c,o),ce("paste",l,o),{files:t,dragging:n}},Ca=({onOpenModal:t,onChange:a})=>e("div",{className:"vm-upload-json-buttons",children:[e($,{variant:"outlined",onClick:t,children:"Paste JSON"}),e("div",{className:"vm-upload-json-buttons__upload",children:[e($,{children:"Upload Files"}),e("input",{id:"json",name:"json",type:"file",accept:"application/json",multiple:!0,title:" ",onChange:a})]})]}),em=()=>{const[t,a]=C([]),[n,r]=C([]),o=D(()=>!!t.length,[t]),{value:s,setTrue:i,setFalse:c}=oe(!1),l=(g,b="")=>{r(y=>[{filename:b,text:`: ${g.message}`},...y])},m=(g,b)=>{try{const y=JSON.parse(g),w=y.trace||y;if(!w.duration_msec){l(new Error(be.traceNotFound),b);return}const T=new kt(w,b);a(S=>[T,...S])}catch(y){y instanceof Error&&l(y,b)}},d=g=>{g.map(b=>{const y=new FileReader,w=(b==null?void 0:b.name)||"";y.onload=T=>{var N;const S=String((N=T.target)==null?void 0:N.result);m(S,w)},y.readAsText(b)})},u=g=>{if(!g.target)return;const b=g.target;r([]);const y=Array.from(b.files||[]);d(y),b.value=""},h=g=>{const b=t.filter(y=>y.idValue!==g.idValue);a([...b])},v=g=>{r(b=>b.filter((y,w)=>w!==g))},_=g=>()=>{v(g)},{files:f,dragging:p}=Ds();return x(()=>{d(f)},[f]),e("div",{className:"vm-trace-page",children:[e("div",{className:"vm-trace-page-header",children:[e("div",{className:"vm-trace-page-header-errors",children:n.map((g,b)=>e("div",{className:"vm-trace-page-header-errors-item",children:[e(se,{variant:"error",children:[e("b",{className:"vm-trace-page-header-errors-item__filename",children:g.filename}),e("span",{children:g.text})]}),e($,{className:"vm-trace-page-header-errors-item__close",startIcon:e(Re,{}),variant:"text",color:"error",onClick:_(b)})]},`${g}_${b}`))}),e("div",{children:o&&e(Ca,{onOpenModal:i,onChange:u})})]}),o&&e("div",{children:e(lr,{jsonEditor:!0,traces:t,onDeleteClick:h})}),!o&&e("div",{className:"vm-trace-page-preview",children:[e("p",{className:"vm-trace-page-preview__text",children:["Please, upload file with JSON response content.",`
`,"The file must contain tracing information in JSON format.",`
`,"In order to use tracing please refer to the doc:",e("a",{className:"vm-link vm-link_colored",href:"https://docs.victoriametrics.com/#query-tracing",target:"_blank",rel:"help noreferrer",children:"https://docs.victoriametrics.com/#query-tracing"}),`
`,"Tracing graph will be displayed after file upload.",`
`,"Attach files by dragging & dropping, selecting or pasting them."]}),e(Ca,{onOpenModal:i,onChange:u})]}),s&&e(Ie,{title:"Paste JSON",onClose:c,children:e(cs,{editable:!0,displayTitle:!0,defaultTile:`JSON ${t.length+1}`,onClose:c,onUpload:m})}),p&&e("div",{className:"vm-trace-page__dropzone"})]})},tm=({job:t,instance:a,metrics:n,size:r})=>{const{duration:o,relativeTime:s,period:{date:i}}=he(),{customStep:c}=Ve(),{setSearchParamsFromKeys:l}=vt(),m=()=>{const d=Ms({"g0.range_input":o,"g0.end_input":i,"g0.step_input":c,"g0.relative_time":s,size:r,job:t,instance:a,metrics:n});l(d)};x(m,[o,s,i,c,t,a,n,r]),x(m,[])},am=(t,a)=>`${t}/api/v1/label/job/values?start=${a.start}&end=${a.end}`,nm=(t,a,n)=>{const r=`{job=${JSON.stringify(n)}}`;return`${t}/api/v1/label/instance/values?match[]=${encodeURIComponent(r)}&start=${a.start}&end=${a.end}`},rm=(t,a,n,r)=>{const s=`{${Object.entries({job:n,instance:r}).filter(i=>i[1]).map(([i,c])=>`${i}=${JSON.stringify(c)}`).join(",")}}`;return`${t}/api/v1/label/__name__/values?match[]=${encodeURIComponent(s)}&start=${a.start}&end=${a.end}`},om=()=>{const{serverUrl:t}=re(),{period:a}=he(),[n,r]=C([]),[o,s]=C(!1),[i,c]=C(),l=D(()=>am(t,a),[t,a]);return x(()=>{(async()=>{s(!0);try{const d=await fetch(l),u=await d.json(),h=u.data||[];r(h.sort((v,_)=>v.localeCompare(_))),d.ok?c(void 0):c(`${u.errorType}\r
${u==null?void 0:u.error}`)}catch(d){d instanceof Error&&c(`${d.name}: ${d.message}`)}s(!1)})().catch(console.error)},[l]),{jobs:n,isLoading:o,error:i}},sm=t=>{const{serverUrl:a}=re(),{period:n}=he(),[r,o]=C([]),[s,i]=C(!1),[c,l]=C(),m=D(()=>nm(a,n,t),[a,n,t]);return x(()=>{if(!t)return;(async()=>{i(!0);try{const u=await fetch(m),h=await u.json(),v=h.data||[];o(v.sort((_,f)=>_.localeCompare(f))),u.ok?l(void 0):l(`${h.errorType}\r
${h==null?void 0:h.error}`)}catch(u){u instanceof Error&&l(`${u.name}: ${u.message}`)}i(!1)})().catch(console.error)},[m]),{instances:r,isLoading:s,error:c}},im=(t,a)=>{const{serverUrl:n}=re(),{period:r}=he(),[o,s]=C([]),[i,c]=C(!1),[l,m]=C(),d=D(()=>rm(n,r,t,a),[n,r,t,a]);return x(()=>{if(!t)return;(async()=>{c(!0);try{const h=await fetch(d),v=await h.json(),_=v.data||[];s(_.sort((f,p)=>f.localeCompare(p))),h.ok?m(void 0):m(`${v.errorType}\r
${v==null?void 0:v.error}`)}catch(h){h instanceof Error&&m(`${h.name}: ${h.message}`)}c(!1)})().catch(console.error)},[d]),{names:o,isLoading:i,error:l}},lm=({name:t,job:a,instance:n,rateEnabled:r,isBucket:o,height:s})=>{const{isMobile:i}=J(),{customStep:c,yaxis:l}=Ve(),{period:m}=he(),d=Lt(),u=Fe(),h=na(m.end-m.start),v=An(c),_=xa(v*10*1e3),[f,p]=C(!1),[g,b]=C(!1),y=f&&c===h?_:c,w=D(()=>{const P=Object.entries({job:a,instance:n}).filter(H=>H[1]).map(([H,B])=>`${H}=${JSON.stringify(B)}`);P.push(`__name__=${JSON.stringify(t)}`),t=="node_cpu_seconds_total"&&P.push('mode!="idle"');const R=`{${P.join(",")}}`;return o?`sum(rate(${R})) by (vmrange, le)`:`
with (q = ${r?`rollup_rate(${R})`:`rollup(${R})`}) (
  alias(min(label_match(q, "rollup", "min")), "min"),
  alias(max(label_match(q, "rollup", "max")), "max"),
  alias(avg(label_match(q, "rollup", "avg")), "avg"),
)`},[t,a,n,r,o]),{isLoading:T,graphData:S,error:N,queryErrors:k,warning:A,isHistogram:L}=za({predefinedQuery:[w],visible:!0,customStep:y,showAllSeries:g}),E=P=>{d({type:"SET_YAXIS_LIMITS",payload:P})},M=({from:P,to:R})=>{u({type:"SET_PERIOD",payload:{from:P,to:R}})};return x(()=>{p(L)},[L]),e("div",{className:I({"vm-explore-metrics-graph":!0,"vm-explore-metrics-graph_mobile":i}),children:[T&&e(qe,{}),N&&e(se,{variant:"error",children:N}),k[0]&&e(se,{variant:"error",children:k[0]}),A&&e(Ha,{warning:A,query:[w],onChange:b}),S&&m&&e(Va,{data:S,period:m,customStep:y,query:[w],yaxis:l,setYaxisLimits:E,setPeriod:M,showLegend:!1,height:s,isHistogram:L})]})},cm=({name:t,index:a,length:n,isBucket:r,rateEnabled:o,onChangeRate:s,onRemoveItem:i,onChangeOrder:c})=>{const{isMobile:l}=J(),{value:m,setTrue:d,setFalse:u}=oe(!1),h=()=>{i(t)},v=()=>{c(t,a,a+1)},_=()=>{c(t,a,a-1)};return l?e("div",{className:"vm-explore-metrics-item-header vm-explore-metrics-item-header_mobile",children:[e("div",{className:"vm-explore-metrics-item-header__name",children:t}),e($,{variant:"text",size:"small",startIcon:e(zn,{}),onClick:d,ariaLabel:"open panel settings"}),m&&e(Ie,{title:t,onClose:u,children:e("div",{className:"vm-explore-metrics-item-header-modal",children:[e("div",{className:"vm-explore-metrics-item-header-modal-order",children:[e($,{startIcon:e(Po,{}),variant:"outlined",onClick:_,disabled:a===0,ariaLabel:"move graph up"}),e("p",{children:["position:",e("span",{className:"vm-explore-metrics-item-header-modal-order__index",children:["#",a+1]})]}),e($,{endIcon:e(Pn,{}),variant:"outlined",onClick:v,disabled:a===n-1,ariaLabel:"move graph down"})]}),!r&&e("div",{className:"vm-explore-metrics-item-header-modal__rate",children:[e(Ce,{label:e("span",{children:["enable ",e("code",{children:"rate()"})]}),value:o,onChange:s,fullWidth:!0}),e("p",{children:"calculates the average per-second speed of metrics change"})]}),e($,{startIcon:e(Re,{}),color:"error",variant:"outlined",onClick:h,fullWidth:!0,children:"Remove graph"})]})})]}):e("div",{className:"vm-explore-metrics-item-header",children:[e("div",{className:"vm-explore-metrics-item-header-order",children:[e(G,{title:"move graph up",children:e($,{className:"vm-explore-metrics-item-header-order__up",startIcon:e(ge,{}),variant:"text",color:"gray",size:"small",onClick:_,ariaLabel:"move graph up"})}),e("div",{className:"vm-explore-metrics-item-header__index",children:["#",a+1]}),e(G,{title:"move graph down",children:e($,{className:"vm-explore-metrics-item-header-order__down",startIcon:e(ge,{}),variant:"text",color:"gray",size:"small",onClick:v,ariaLabel:"move graph down"})})]}),e("div",{className:"vm-explore-metrics-item-header__name",children:t}),!r&&e("div",{className:"vm-explore-metrics-item-header__rate",children:e(G,{title:"calculates the average per-second speed of metric's change",children:e(Ce,{label:e("span",{children:["enable ",e("code",{children:"rate()"})]}),value:o,onChange:s})})}),e("div",{className:"vm-explore-metrics-item-header__close",children:e(G,{title:"close graph",children:e($,{startIcon:e(Re,{}),variant:"text",color:"gray",size:"small",onClick:h,ariaLabel:"close graph"})})})]})},dm=({name:t,job:a,instance:n,index:r,length:o,size:s,onRemoveItem:i,onChangeOrder:c})=>{const l=D(()=>/_sum?|_total?|_count?/.test(t),[t]),m=D(()=>/_bucket?/.test(t),[t]),[d,u]=C(l),h=xt(),v=D(s.height,[s,h]);return x(()=>{u(l)},[a]),e("div",{className:"vm-explore-metrics-item vm-block vm-block_empty-padding",children:[e(cm,{name:t,index:r,length:o,isBucket:m,rateEnabled:d,size:s.id,onChangeRate:u,onRemoveItem:i,onChangeOrder:c}),e(lm,{name:t,job:a,instance:n,rateEnabled:d,isBucket:m,height:v},`${t}_${a}_${n}_${d}`)]})},mm=({values:t,onRemoveItem:a})=>{const{isMobile:n}=J(),r=o=>s=>{a(o),s.stopPropagation()};return n?e("span",{className:"vm-select-input-content__counter",children:["selected ",t.length]}):e(V,{children:t.map(o=>e("div",{className:"vm-select-input-content__selected",children:[e("span",{children:o}),e("div",{onClick:r(o),children:e(Re,{})})]},o))})},$t=({value:t,list:a,label:n,placeholder:r,noOptionsText:o,clearable:s=!1,searchable:i=!1,autofocus:c,disabled:l,onChange:m})=>{const{isDarkTheme:d}=re(),{isMobile:u}=J(),[h,v]=C(""),_=Y(null),[f,p]=C(null),[g,b]=C(!1),y=Y(null),w=Array.isArray(t),T=Array.isArray(t)?t:void 0,S=u&&w&&!!(T!=null&&T.length),N=D(()=>g?h:Array.isArray(t)?"":t,[t,h,g,w]),k=D(()=>g?h||"(.+)":"",[h,g]),A=()=>{y.current&&y.current.blur()},L=()=>{b(!1),A()},E=()=>{l||b(!0)},M=()=>{a.includes(h)&&m(h)},P=F=>{F.target instanceof HTMLInputElement||l||b(te=>!te)},R=F=>{v(""),m(F),w||L(),w&&y.current&&y.current.focus()},Q=F=>{v(F.target.value)},H=F=>te=>{R(F),te.stopPropagation()},B=F=>{y.current!==F.target&&b(!1)};return x(()=>{v(""),g&&y.current&&y.current.focus(),g||A()},[g,y]),x(()=>{!c||!y.current||u||y.current.focus()},[c,y]),ce("keyup",B),sa(_,L,f),e("div",{className:I({"vm-select":!0,"vm-select_dark":d,"vm-select_disabled":l}),children:[e("div",{className:"vm-select-input",onClick:P,ref:_,children:[e("div",{className:"vm-select-input-content",children:[!!(T!=null&&T.length)&&e(mm,{values:T,onRemoveItem:R}),!S&&e("input",{value:N,type:"text",placeholder:r,onInput:Q,onFocus:E,onBlur:M,ref:y,readOnly:u||!i})]}),n&&e("span",{className:"vm-text-field__label",children:n}),s&&t&&e("div",{className:"vm-select-input__icon",onClick:H(""),children:e(Re,{})}),e("div",{className:I({"vm-select-input__icon":!0,"vm-select-input__icon_open":g}),children:e(We,{})})]}),e(rr,{label:n,value:k,options:a.map(F=>({value:F})),anchor:_,selected:T,minLength:1,fullWidth:!0,noOptionsText:o,onSelect:R,onOpenAutocomplete:b,onChangeWrapperRef:p})]})},um=pa.map(t=>t.id),hm=({jobs:t,instances:a,names:n,job:r,instance:o,size:s,selectedMetrics:i,onChangeJob:c,onChangeInstance:l,onToggleMetric:m,onChangeSize:d})=>{const u=D(()=>r?"":"No instances. Please select job",[r]),h=D(()=>r?"":"No metric names. Please select job",[r]),{isMobile:v}=J(),{value:_,toggle:f,setFalse:p}=oe(ze("EXPLORE_METRICS_TIPS")!=="false");return x(()=>{Le("EXPLORE_METRICS_TIPS",`${_}`)},[_]),e(V,{children:[e("div",{className:I({"vm-explore-metrics-header":!0,"vm-explore-metrics-header_mobile":v,"vm-block":!0,"vm-block_mobile":v}),children:[e("div",{className:"vm-explore-metrics-header__job",children:e($t,{value:r,list:t,label:"Job",placeholder:"Please select job",onChange:c,autofocus:!r&&!!t.length&&!v,searchable:!0})}),e("div",{className:"vm-explore-metrics-header__instance",children:e($t,{value:o,list:a,label:"Instance",placeholder:"Please select instance",onChange:l,noOptionsText:u,clearable:!0,searchable:!0})}),e("div",{className:"vm-explore-metrics-header__size",children:[e($t,{label:"Size graphs",value:s,list:um,onChange:d}),e(G,{title:`${_?"Hide":"Show"} tip`,children:e($,{variant:"text",color:_?"warning":"gray",startIcon:e(oa,{}),onClick:f,ariaLabel:"visibility tips"})})]}),e("div",{className:"vm-explore-metrics-header-metrics",children:e($t,{label:"Metrics",value:i,list:n,placeholder:"Search metric name",onChange:m,noOptionsText:h,clearable:!0,searchable:!0})})]}),_&&e(se,{variant:"warning",children:e("div",{className:"vm-explore-metrics-header-description",children:[e("p",{children:["Please note: this page is solely designed for exploring Prometheus metrics. Prometheus metrics always contain ",e("code",{children:"job"})," and ",e("code",{children:"instance"})," labels (see ",e("a",{className:"vm-link vm-link_colored",href:"https://prometheus.io/docs/concepts/jobs_instances/",children:"these docs"}),"), and this page relies on them as filters. ",e("br",{}),"Please use this page for Prometheus metrics only, in accordance with their naming conventions."]}),e($,{variant:"text",size:"small",startIcon:e(Re,{}),onClick:p,ariaLabel:"close tips"})]})})]})},pm=De("job",""),vm=De("instance",""),Kr=De("metrics",""),Zr=De("size",""),gm=pa.find(t=>Zr?t.id===Zr:t.isDefault)||pa[0],_m=()=>{const[t,a]=C(pm),[n,r]=C(vm),[o,s]=C(Kr?Kr.split("&"):[]),[i,c]=C(gm);tm({job:t,instance:n,metrics:o.join("&"),size:i.id});const{jobs:l,isLoading:m,error:d}=om(),{instances:u,isLoading:h,error:v}=sm(t),{names:_,isLoading:f,error:p}=im(t,n),g=D(()=>m||h||f,[m,h,f]),b=D(()=>d||v||p,[d,v,p]),y=S=>{s(S?N=>N.includes(S)?N.filter(k=>k!==S):[...N,S]:[])},w=S=>{const N=pa.find(k=>k.id===S);N&&c(N)},T=(S,N,k)=>{const A=k>o.length-1;k<0||A||s(E=>{const M=[...E],[P]=M.splice(N,1);return M.splice(k,0,P),M})};return x(()=>{n&&u.length&&!u.includes(n)&&r("")},[u,n]),e("div",{className:"vm-explore-metrics",children:[e(hm,{jobs:l,instances:u,names:_,job:t,size:i.id,instance:n,selectedMetrics:o,onChangeJob:a,onChangeSize:w,onChangeInstance:r,onToggleMetric:y}),g&&e(qe,{}),b&&e(se,{variant:"error",children:b}),!t&&e(se,{variant:"info",children:"Please select job to see list of metric names."}),t&&!o.length&&e(se,{variant:"info",children:"Please select metric names to see the graphs."}),e("div",{className:"vm-explore-metrics-body",children:o.map((S,N)=>e(dm,{name:S,job:t,instance:n,index:N,length:o.length,size:i,onRemoveItem:y,onChangeOrder:T},S))})]})},fm=()=>{const t=Ue(),a=n=>async()=>{await t(`<${n}/>`,`<${n}/> has been copied`)};return e("div",{className:"vm-preview-icons",children:Object.entries(Ei).map(([n,r])=>e("div",{className:"vm-preview-icons-item",onClick:a(n),children:[e("div",{className:"vm-preview-icons-item__svg",children:r()}),e("div",{className:"vm-preview-icons-item__name",children:`<${n}/>`})]},n))})},at=({code:t})=>{const a=Ue(),[n,r]=C("Copy"),o=async()=>{await a(t),r("Copied")};return x(()=>{let s=null;return n==="Copied"&&(s=setTimeout(()=>r("Copy"),1e3)),()=>{s&&clearTimeout(s)}},[n]),e("code",{className:"vm-code-example",children:[t,e("div",{className:"vm-code-example__copy",children:e(G,{title:n,children:e($,{size:"small",variant:"text",onClick:o,startIcon:e(et,{}),ariaLabel:"close"})})})]})},bm=()=>e("a",{className:"vm-link vm-link_colored",href:"https://docs.victoriametrics.com/MetricsQL.html",target:"_blank",rel:"help noreferrer",children:"MetricsQL"}),Xr=()=>e("a",{className:"vm-link vm-link_colored",href:"https://grafana.com/grafana/dashboards/1860-node-exporter-full/",target:"_blank",rel:"help noreferrer",children:"Node Exporter Full"}),ym=()=>e("section",{className:"vm-with-template-tutorial",children:[e("h2",{className:"vm-with-template-tutorial__title",children:["Tutorial for WITH expressions in ",e(bm,{})]}),e("div",{className:"vm-with-template-tutorial-section",children:[e("p",{className:"vm-with-template-tutorial-section__text",children:["Let's look at the following real query from ",e(Xr,{})," dashboard:"]}),e(at,{code:`(
  (
    node_memory_MemTotal_bytes{instance=~"$node:$port", job=~"$job"}
      -
    node_memory_MemFree_bytes{instance=~"$node:$port", job=~"$job"}
  )
    /
  node_memory_MemTotal_bytes{instance=~"$node:$port", job=~"$job"}
) * 100`}),e("p",{className:"vm-with-template-tutorial-section__text",children:"It is clear the query calculates the percentage of used memory for the given $node, $port and $job. Isn't it? :)"})]}),e("div",{className:"vm-with-template-tutorial-section",children:[e("p",{className:"vm-with-template-tutorial-section__text",children:"What's wrong with this query? Copy-pasted label filters for distinct timeseries which makes it easy to mistype these filters during modification. Let's simplify the query with WITH expressions:"}),e(at,{code:`WITH (
    commonFilters = {instance=~"$node:$port",job=~"$job"}
)
(
  node_memory_MemTotal_bytes{commonFilters}
    -
  node_memory_MemFree_bytes{commonFilters}
)
  /
node_memory_MemTotal_bytes{commonFilters} * 100`})]}),e("div",{className:"vm-with-template-tutorial-section",children:[e("p",{className:"vm-with-template-tutorial-section__text",children:["Now label filters are located in a single place instead of three distinct places. The query mentions node_memory_MemTotal_bytes metric twice and ","{commonFilters}"," three times. WITH expressions may improve this:"]}),e(at,{code:`WITH (
    my_resource_utilization(free, limit, filters) = (limit{filters} - free{filters}) / limit{filters} * 100
)
my_resource_utilization(
  node_memory_MemFree_bytes,
  node_memory_MemTotal_bytes,
  {instance=~"$node:$port",job=~"$job"},
)`}),e("p",{className:"vm-with-template-tutorial-section__text",children:"Now the template function my_resource_utilization() may be used for monitoring arbitrary resources - memory, CPU, network, storage, you name it."})]}),e("div",{className:"vm-with-template-tutorial-section",children:[e("p",{className:"vm-with-template-tutorial-section__text",children:["Let's take another nice query from ",e(Xr,{})," dashboard:"]}),e(at,{code:`(
  (
    (
      count(
        count(node_cpu_seconds_total{instance=~"$node:$port",job=~"$job"}) by (cpu)
      )
    )
      -
    avg(
      sum by (mode) (rate(node_cpu_seconds_total{mode='idle',instance=~"$node:$port",job=~"$job"}[5m]))
    )
  )
    *
  100
)
  /
count(
  count(node_cpu_seconds_total{instance=~"$node:$port",job=~"$job"}) by (cpu)
)`}),e("p",{className:"vm-with-template-tutorial-section__text",children:"Do you understand what does this mess do? Is it manageable? :) WITH expressions are happy to help in a few iterations."})]}),e("div",{className:"vm-with-template-tutorial-section",children:[e("p",{className:"vm-with-template-tutorial-section__text",children:"1. Extract common filters used in multiple places into a commonFilters variable:"}),e(at,{code:`WITH (
    commonFilters = {instance=~"$node:$port",job=~"$job"}
)
(
  (
    (
      count(
        count(node_cpu_seconds_total{commonFilters}) by (cpu)
      )
    )
      -
    avg(
      sum by (mode) (rate(node_cpu_seconds_total{mode='idle',commonFilters}[5m]))
    )
  )
    *
  100
)
  /
count(
  count(node_cpu_seconds_total{commonFilters}) by (cpu)
)`})]}),e("div",{className:"vm-with-template-tutorial-section",children:[e("p",{className:"vm-with-template-tutorial-section__text",children:'2. Extract "count(count(...) by (cpu))" into cpuCount variable:'}),e(at,{code:`WITH (
    commonFilters = {instance=~"$node:$port",job=~"$job"},
    cpuCount = count(count(node_cpu_seconds_total{commonFilters}) by (cpu))
)
(
  (
    cpuCount
      -
    avg(
      sum by (mode) (rate(node_cpu_seconds_total{mode='idle',commonFilters}[5m]))
    )
  )
    *
  100
) / cpuCount`})]}),e("div",{className:"vm-with-template-tutorial-section",children:[e("p",{className:"vm-with-template-tutorial-section__text",children:"3. Extract rate(...) part into cpuIdle variable, since it is clear now that this part calculates the number of idle CPUs:"}),e(at,{code:`WITH (
    commonFilters = {instance=~"$node:$port",job=~"$job"},
    cpuCount = count(count(node_cpu_seconds_total{commonFilters}) by (cpu)),
    cpuIdle = sum(rate(node_cpu_seconds_total{mode='idle',commonFilters}[5m]))
)
((cpuCount - cpuIdle) * 100) / cpuCount`})]}),e("div",{className:"vm-with-template-tutorial-section",children:[e("p",{className:"vm-with-template-tutorial-section__text",children:["4. Put node_cpu_seconds_total","{commonFilters}"," into its own varialbe with the name cpuSeconds:"]}),e(at,{code:`WITH (
    cpuSeconds = node_cpu_seconds_total{instance=~"$node:$port",job=~"$job"},
    cpuCount = count(count(cpuSeconds) by (cpu)),
    cpuIdle = sum(rate(cpuSeconds{mode='idle'}[5m]))
)
((cpuCount - cpuIdle) * 100) / cpuCount`}),e("p",{className:"vm-with-template-tutorial-section__text",children:"Now the query became more clear comparing to the initial query."})]}),e("div",{className:"vm-with-template-tutorial-section",children:[e("p",{className:"vm-with-template-tutorial-section__text",children:"WITH expressions may be nested and may be put anywhere. Try expanding the following query:"}),e(at,{code:`WITH (
    f(a, b) = WITH (
        f1(x) = b-x,
        f2(x) = x+x
    ) f1(a)*f2(b)
) f(foo, with(x=bar) x)`})]})]}),wm=(t,a)=>`${t}/expand-with-exprs?query=${encodeURIComponent(a)}&format=json`,Cm=()=>{const{serverUrl:t}=re(),[a,n]=ie(),[r,o]=C(""),[s,i]=C(!1),[c,l]=C();return{data:r,error:c,loading:s,expand:async d=>{a.set("expr",d),n(a);const u=wm(t,d);i(!0);try{const v=await(await fetch(u)).json();o((v==null?void 0:v.expr)||""),l(String(v.error||""))}catch(h){h instanceof Error&&h.name!=="AbortError"&&l(`${h.name}: ${h.message}`)}i(!1)}}},Nm=()=>{const[t]=ie(),{data:a,loading:n,error:r,expand:o}=Cm(),[s,i]=C(t.get("expr")||""),c=m=>{i(m)},l=()=>{o(s)};return x(()=>{s&&o(s)},[]),e("section",{className:"vm-with-template",children:[n&&e(qe,{}),e("div",{className:"vm-with-template-body vm-block",children:[e("div",{className:"vm-with-template-body__expr",children:e(le,{type:"textarea",label:"MetricsQL query with optional WITH expressions",value:s,error:r,autofocus:!0,onEnter:l,onChange:c})}),e("div",{className:"vm-with-template-body__result",children:e(le,{type:"textarea",label:"MetricsQL query after expanding WITH expressions and applying other optimizations",value:a,disabled:!0})}),e("div",{className:"vm-with-template-body-top",children:e($,{variant:"contained",onClick:l,startIcon:e(ct,{}),children:"Expand"})})]}),e("div",{className:"vm-block",children:e(ym,{})})]})},km=(t,a,n)=>{const r=["format=json",`relabel_configs=${encodeURIComponent(a)}`,`metric=${encodeURIComponent(n)}`];return`${t}/metric-relabel-debug?${r.join("&")}`},Sm=()=>{const{serverUrl:t}=re(),[a,n]=C(null),[r,o]=C(!1),[s,i]=C();return{data:a,error:s,loading:r,fetchData:async(l,m)=>{const d=km(t,l,m);o(!0);try{const h=await(await fetch(d)).json();n(h.error?null:h),i(String(h.error||""))}catch(u){u instanceof Error&&u.name!=="AbortError"&&i(`${u.name}: ${u.message}`)}o(!1)}}},Tm={config:`- if: '{bar_label=~"b.*"}'
  source_labels: [foo_label, bar_label]
  separator: "_"
  target_label: foobar
- action: labeldrop
  regex: "foo_.*"
- target_label: job
  replacement: "my-application-2"`,labels:'{__name__="my_metric", bar_label="bar", foo_label="foo", job="my-application", instance="192.168.0.1"}'},Am=()=>{const[t,a]=ie(),{data:n,loading:r,error:o,fetchData:s}=Sm(),[i,c]=Ne("","config"),[l,m]=Ne("","labels"),d=_=>{c(_||"")},u=_=>{m(_||"")},h=Z(()=>{s(i,l),t.set("config",i),t.set("labels",l),a(t)},[i,l]),v=()=>{const{config:_,labels:f}=Tm;c(_),m(f),s(_,f),t.set("config",_),t.set("labels",f),a(t)};return x(()=>{const _=t.get("config")||"",f=t.get("labels")||"";(f||_)&&(s(_,f),c(_),m(f))},[]),e("section",{className:"vm-relabeling",children:[r&&e(qe,{}),e("div",{className:"vm-relabeling-header vm-block",children:[e("div",{className:"vm-relabeling-header-configs",children:e(le,{type:"textarea",label:"Relabel configs",value:i,autofocus:!0,onChange:d,onEnter:h})}),e("div",{className:"vm-relabeling-header__labels",children:e(le,{type:"textarea",label:"Labels",value:l,onChange:u,onEnter:h})}),e("div",{className:"vm-relabeling-header-bottom",children:[e("a",{className:"vm-link vm-link_with-icon",target:"_blank",href:"https://docs.victoriametrics.com/relabeling.html",rel:"help noreferrer",children:[e(Ge,{}),"Relabeling cookbook"]}),e("a",{className:"vm-link vm-link_with-icon",target:"_blank",href:"https://docs.victoriametrics.com/vmagent.html#relabeling",rel:"help noreferrer",children:[e(st,{}),"Documentation"]}),e($,{variant:"text",onClick:v,children:"Try example"}),e($,{variant:"contained",onClick:h,startIcon:e(ct,{}),children:"Submit"})]})]}),o&&e(se,{variant:"error",children:o}),n&&e("div",{className:"vm-relabeling-steps vm-block",children:[n.originalLabels&&e("div",{className:"vm-relabeling-steps-item",children:e("div",{className:"vm-relabeling-steps-item__row",children:[e("span",{children:"Original labels:"}),e("code",{dangerouslySetInnerHTML:{__html:n.originalLabels}})]})}),n.steps.map((_,f)=>e("div",{className:"vm-relabeling-steps-item",children:[e("div",{className:"vm-relabeling-steps-item__row",children:[e("span",{children:"Step:"}),f+1]}),e("div",{className:"vm-relabeling-steps-item__row",children:[e("span",{children:"Relabeling Rule:"}),e("code",{children:e("pre",{children:_.rule})})]}),e("div",{className:"vm-relabeling-steps-item__row",children:[e("span",{children:"Input Labels:"}),e("code",{children:e("pre",{dangerouslySetInnerHTML:{__html:_.inLabels}})})]}),e("div",{className:"vm-relabeling-steps-item__row",children:[e("span",{children:"Output labels:"}),e("code",{children:e("pre",{dangerouslySetInnerHTML:{__html:_.outLabels}})})]})]},f)),n.resultingLabels&&e("div",{className:"vm-relabeling-steps-item",children:e("div",{className:"vm-relabeling-steps-item__row",children:[e("span",{children:"Resulting labels:"}),e("code",{dangerouslySetInnerHTML:{__html:n.resultingLabels}})]})})]})]})},xm=t=>`${t}/api/v1/status/active_queries`,Lm=()=>{const{serverUrl:t}=re(),[a,n]=C([]),[r,o]=C(q().format(ga)),[s,i]=C(!1),[c,l]=C(),m=D(()=>xm(t),[t]),d=async()=>{i(!0);try{const u=await fetch(m),h=await u.json();n(h.data),o(q().format("HH:mm:ss:SSS")),u.ok?l(void 0):l(`${h.errorType}\r
${h==null?void 0:h.error}`)}catch(u){u instanceof Error&&l(`${u.name}: ${u.message}`)}i(!1)};return x(()=>{d().catch(console.error)},[m]),{data:a,lastUpdated:r,isLoading:s,error:c,fetchData:d}},Is=({rows:t,columns:a,defaultOrderBy:n,defaultOrderDir:r,copyToClipboard:o,paginationOffset:s})=>{const i=Ue(),[c,l]=C(n),[m,d]=C(r||"desc"),[u,h]=C(null),v=D(()=>{const{startIndex:p,endIndex:g}=s;return kr(t,Nr(m,c)).slice(p,g)},[t,c,m,s]),_=p=>()=>{d(g=>g==="asc"&&c===p?"desc":"asc"),l(p)},f=(p,g)=>async()=>{if(u!==g)try{await i(String(p)),h(g)}catch(b){console.error(b)}};return x(()=>{if(u===null)return;const p=setTimeout(()=>h(null),2e3);return()=>clearTimeout(p)},[u]),e("table",{className:"vm-table",children:[e("thead",{className:"vm-table-header",children:e("tr",{className:"vm-table__row vm-table__row_header",children:[a.map(p=>e("th",{className:"vm-table-cell vm-table-cell_header vm-table-cell_sort",onClick:_(p.key),children:e("div",{className:"vm-table-cell__content",children:[e("div",{children:String(p.title||p.key)}),e("div",{className:I({"vm-table__sort-icon":!0,"vm-table__sort-icon_active":c===p.key,"vm-table__sort-icon_desc":m==="desc"&&c===p.key}),children:e(We,{})})]})},String(p.key))),o&&e("th",{className:"vm-table-cell vm-table-cell_header"})]})}),e("tbody",{className:"vm-table-body",children:v.map((p,g)=>e("tr",{className:"vm-table__row",children:[a.map(b=>e("td",{className:I({"vm-table-cell":!0,[`${b.className}`]:b.className}),children:p[b.key]||"-"},String(b.key))),o&&e("td",{className:"vm-table-cell vm-table-cell_right",children:p[o]&&e("div",{className:"vm-table-cell__content",children:e(G,{title:u===g?"Copied":"Copy row",children:e($,{variant:"text",color:u===g?"success":"gray",size:"small",startIcon:u===g?e(Da,{}):e(et,{}),onClick:f(p[o],g),ariaLabel:"copy row"})})})})]},g))})]})},Em=()=>{const{isMobile:t}=J(),{timezone:a}=he(),{data:n,lastUpdated:r,isLoading:o,error:s,fetchData:i}=Lm(),c=D(()=>n.map(d=>{const u=q(d.start).tz().format(Ke),h=q(d.end).tz().format(Ke);return{duration:d.duration,remote_addr:d.remote_addr,query:d.query,args:`${u} to ${h}, step=${cn(d.step)}`,data:JSON.stringify(d,null,2)}}),[n,a]),l=D(()=>{if(!(c!=null&&c.length))return[];const d=Object.keys(c[0]),u={remote_addr:"client address"},h=["data"];return d.filter(v=>!h.includes(v)).map(v=>({key:v,title:u[v]||v}))},[c]),m=async()=>{i().catch(console.error)};return e("div",{className:"vm-active-queries",children:[o&&e(qe,{}),e("div",{className:"vm-active-queries-header",children:[!c.length&&!s&&e(se,{variant:"info",children:"There are currently no active queries running"}),s&&e(se,{variant:"error",children:s}),e("div",{className:"vm-active-queries-header-controls",children:[e($,{variant:"contained",onClick:m,startIcon:e(La,{}),children:"Update"}),e("div",{className:"vm-active-queries-header__update-msg",children:["Last updated: ",r]})]})]}),!!c.length&&e("div",{className:I({"vm-block":!0,"vm-block_mobile":t}),children:e(Is,{rows:c,columns:l,defaultOrderBy:"duration",copyToClipboard:"data",paginationOffset:{startIndex:0,endIndex:1/0}})})]})},Mm=({onClose:t,onUpload:a})=>{const{isMobile:n}=J(),[r,o]=C(""),[s,i]=C(""),c=D(()=>{try{return JSON.parse(r),""}catch(d){return d instanceof Error?d.message:"Unknown error"}},[r]),l=d=>{i(""),o(d)},m=()=>{i(c),!c&&(a(r),t())};return e("div",{className:I({"vm-json-form vm-json-form_one-field":!0,"vm-json-form_mobile vm-json-form_one-field_mobile":n}),children:[e(le,{value:r,label:"JSON",type:"textarea",error:s,autofocus:!0,onChange:l,onEnter:m}),e("div",{className:"vm-json-form-footer",children:e("div",{className:"vm-json-form-footer__controls vm-json-form-footer__controls_right",children:[e($,{variant:"outlined",color:"error",onClick:t,children:"Cancel"}),e($,{variant:"contained",onClick:m,children:"apply"})]})})]})},Dm=({data:t,period:a})=>{const{isMobile:n}=J(),[r,o]=ie(),{tableCompact:s}=He(),i=jt(),[c,l]=C([]),[m,d]=C(),[u,h]=C(),[v,_]=C(!1),[f,p]=C([]),[g,b]=C(),y=D(()=>wr(u||[]).map(H=>H.key),[u]),w=D(()=>{const H=t.some(F=>F.data.resultType==="matrix");return t.some(F=>F.data.resultType==="vector")&&H?Ot:H?Ot.filter(F=>F.value==="chart"):Ot.filter(F=>F.value!=="chart")},[t]),[T,S]=C(w[0].value),{yaxis:N,spanGaps:k}=Ve(),A=Lt(),L=H=>{A({type:"SET_YAXIS_LIMITS",payload:H})},E=()=>{A({type:"TOGGLE_ENABLE_YAXIS_LIMITS"})},M=H=>{A({type:"SET_SPAN_GAPS",payload:H})},P=H=>{S(H)},R=H=>{l(B=>B.filter(F=>F.idValue!==H.idValue))},Q=()=>{i({type:"TOGGLE_TABLE_COMPACT"})};return x(()=>{const H=T==="chart"?"matrix":"vector",B=t.filter(F=>F.data.resultType===H&&F.trace).map(F=>{var te,de;return F.trace?new kt(F.trace,((de=(te=F==null?void 0:F.vmui)==null?void 0:te.params)==null?void 0:de.query)||"Query"):null});l(B.filter(Boolean))},[t,T]),x(()=>{const H=[],B=[],F=[];t.forEach((te,de)=>{var ne,U;const W=te.data.result.map(O=>{var z,j;return{...O,group:Number(((j=(z=te.vmui)==null?void 0:z.params)==null?void 0:j.id)??de)+1}});te.data.resultType==="matrix"?(B.push(...W),H.push(((U=(ne=te.vmui)==null?void 0:ne.params)==null?void 0:U.query)||"Query")):F.push(...W)}),p(H),d(B),h(F),r.delete("display_mode"),o(r)},[t]),x(()=>{const H=!r.get("display_mode");_(!!m&&H&&sr(m))},[m,r]),e("div",{className:I({"vm-query-analyzer-view":!0,"vm-query-analyzer-view_mobile":n}),children:[!!c.length&&e(lr,{traces:c,onDeleteClick:R}),e(Ls,{}),e("div",{className:I({"vm-block":!0,"vm-block_mobile":n}),children:[e("div",{className:"vm-custom-panel-body-header",children:[e("div",{className:"vm-custom-panel-body-header__tabs",children:e(Bt,{activeItem:T,items:w,onChange:P})}),e("div",{className:"vm-custom-panel-body-header__graph-controls",children:[T==="chart"&&e(Kn,{}),T==="chart"&&e(yr,{data:m||[],yaxis:N,isHistogram:v,setYaxisLimits:L,toggleEnableLimits:E,spanGaps:{value:k,onChange:M}}),T==="table"&&e(Cr,{columns:y,selectedColumns:g,onChangeColumns:b,tableCompact:s,toggleTableCompact:Q})]})]}),m&&a&&T==="chart"&&e(Va,{data:m,period:a,customStep:a.step||"1s",query:f,yaxis:N,setYaxisLimits:L,setPeriod:()=>null,height:n?window.innerHeight*.5:500,isHistogram:v,spanGaps:k}),u&&T==="code"&&e(Ua,{data:u}),u&&T==="table"&&e(ks,{data:u,displayColumns:g})]})]})},Im=({data:t,period:a})=>{var d,u,h,v,_;const n=D(()=>t.filter(f=>f.vmui||f.stats),[t]),r=((u=(d=n.find(f=>{var p;return(p=f==null?void 0:f.vmui)==null?void 0:p.title}))==null?void 0:d.vmui)==null?void 0:u.title)||"Report",o=(v=(h=n.find(f=>{var p;return(p=f==null?void 0:f.vmui)==null?void 0:p.comment}))==null?void 0:h.vmui)==null?void 0:v.comment,s=D(()=>["vmui.endpoint",...new Set(n.flatMap(f=>{var p;return[...Object.keys(((p=f.vmui)==null?void 0:p.params)||[]).map(g=>`vmui.params.${g}`),...Object.keys(f.stats||[]).map(g=>`stats.${g}`),"isPartial"]}))].map(f=>({column:f.split(".").pop(),values:n.map(p=>ft(p,f,"-"))})).filter(({values:f})=>f.length&&f.every(p=>p!=="-")),[n]),i=D(()=>{if(!a)return"";const f=q(a.start*1e3).tz().format(Ke),p=q(a.end*1e3).tz().format(Ke);return`${f} - ${p}`},[a]),{value:c,setTrue:l,setFalse:m}=oe(!1);return e(V,{children:[e("div",{className:"vm-query-analyzer-info-header",children:[e("h1",{className:"vm-query-analyzer-info-header__title",children:r}),i&&e("div",{className:"vm-query-analyzer-info-header__timerange",children:[e(Kt,{})," ",i]}),(a==null?void 0:a.step)&&e("div",{className:"vm-query-analyzer-info-header__timerange",children:[e(fa,{})," step ",a.step]}),(o||!!s.length)&&e("div",{className:"vm-query-analyzer-info-header__info",children:e($,{startIcon:e(Ge,{}),variant:"outlined",color:"warning",onClick:l,children:["Show stats",o&&" & comments"]})})]}),c&&e(Ie,{title:r,onClose:m,children:e("div",{className:"vm-query-analyzer-info__modal",children:[!!s.length&&e("div",{className:"vm-query-analyzer-info-stats",children:[e("div",{className:"vm-query-analyzer-info-comment-header",children:[e(Ge,{}),"Stats"]}),e("table",{children:[e("thead",{children:e("tr",{children:s.map(({column:f})=>e("th",{children:f},f))})}),e("tbody",{children:(_=s[0])==null?void 0:_.values.map((f,p)=>e("tr",{children:s.map(({values:g},b)=>e("td",{children:g[p]},b))},p))})]})]}),o&&e("div",{className:"vm-query-analyzer-info-comment",children:[e("div",{className:"vm-query-analyzer-info-comment-header",children:[e(Uo,{}),"Comments"]}),e("div",{className:"vm-query-analyzer-info-comment-body vm-markdown",dangerouslySetInnerHTML:{__html:Ht(o)||o}})]})]})})]})},Pm=t=>{const a=t.slice(1).map((s,i)=>s-t[i]),n={};a.forEach(s=>{const i=s.toString();n[i]=(n[i]||0)+1});let r=0,o=0;for(const s in n)n[s]>o&&(o=n[s],r=Number(s));return r},$m=()=>{const[t,a]=C([]),[n,r]=C(""),o=D(()=>!!t.length,[t]),{value:s,setTrue:i,setFalse:c}=oe(!1),l=D(()=>{var b,y;if(!t)return;const p=(y=(b=t[0])==null?void 0:b.vmui)==null?void 0:y.params,g={start:+((p==null?void 0:p.start)||0),end:+((p==null?void 0:p.end)||0),step:p==null?void 0:p.step,date:""};if(!p){const T=t.filter(N=>N.data.resultType==="matrix").map(N=>N.data.result).flat().map(N=>{var k;return N.values?(k=N.values)==null?void 0:k.map(A=>A[0]):[0]}).flat(),S=Array.from(new Set(T.filter(Boolean))).sort((N,k)=>N-k);g.start=S[0],g.end=S[S.length-1],g.step=Tn(Pm(S))}return g.date=Co(Ye(g.end)),g},[t]),m=p=>p.every(g=>{if(typeof g=="object"&&g!==null){const b=g.data;if(typeof b=="object"&&b!==null){const y=b.result,w=b.resultType;return Array.isArray(y)&&typeof w=="string"}}return!1}),d=p=>{try{const g=JSON.parse(p),b=Array.isArray(g)?g:[g];m(b)?a(b):(r("Invalid structure - JSON does not match the expected format"),a([]))}catch(g){g instanceof Error&&(r(`${g.name}: ${g.message}`),a([]))}},u=p=>{p.map(g=>{const b=new FileReader;b.onload=y=>{var T;const w=String((T=y.target)==null?void 0:T.result);d(w)},b.readAsText(g)})},h=p=>{if(!p.target)return;const g=p.target;r("");const b=Array.from(g.files||[]);u(b),g.value=""},v=()=>{r("")},{files:_,dragging:f}=Ds();return x(()=>{u(_)},[_]),e("div",{className:"vm-query-analyzer",children:[o&&e("div",{className:"vm-query-analyzer-header",children:[e(Im,{data:t,period:l}),e(Ca,{onOpenModal:i,onChange:h})]}),o&&e(Dm,{data:t,period:l}),!o&&e("div",{className:"vm-trace-page-preview",children:[e("p",{className:"vm-trace-page-preview__text",children:["Please, upload file with JSON response content.",`
`,"The file must contain query information in JSON format.",`
`,"Graph will be displayed after file upload.",`
`,"Attach files by dragging & dropping, selecting or pasting them."]}),e(Ca,{onOpenModal:i,onChange:h})]}),n&&e("div",{className:"vm-query-analyzer-error",children:[e(se,{variant:"error",children:n}),e($,{className:"vm-query-analyzer-error__close",startIcon:e(Re,{}),variant:"text",color:"error",onClick:v})]}),s&&e(Ie,{title:"Paste JSON",onClose:c,children:e(Mm,{onClose:c,onUpload:d})}),f&&e("div",{className:"vm-trace-page__dropzone"})]})},Om=(t,a,n)=>{const r=[`flags=${encodeURIComponent(a)}`,`metrics=${encodeURIComponent(n)}`];return`${t}/downsampling-filters-debug?${r.join("&")}`},Rm=()=>{const{serverUrl:t}=re(),[a,n]=ie(),[r,o]=C(new Map),[s,i]=C(!1),[c,l]=C(),[m,d]=C(),[u,h]=C(),v=Z(async(_,f)=>{var g,b;if(l(f?"":"metrics are required"),d(_?"":"flags are required"),!f||!_)return;a.set("flags",_),a.set("metrics",f),n(a);const p=Om(t,_,f);i(!0);try{const w=await(await fetch(p)).json();o(new Map(Object.entries(w.result||{}))),l(((g=w.error)==null?void 0:g.metrics)||""),d(((b=w.error)==null?void 0:b.flags)||""),h("")}catch(y){y instanceof Error&&y.name!=="AbortError"&&h(`${y.name}: ${y.message}`)}i(!1)},[t]);return{data:r,error:u,metricsError:c,flagsError:m,loading:s,applyFilters:v}},eo={flags:`-downsampling.period={env="dev"}:7d:5m,{env="dev"}:30d:30m
-downsampling.period=30d:1m
-downsampling.period=60d:5m
`,metrics:`up
up{env="dev"}
up{env="prod"}`},zm=()=>{const[t]=ie(),{data:a,loading:n,error:r,metricsError:o,flagsError:s,applyFilters:i}=Rm(),[c,l]=C(t.get("metrics")||""),[m,d]=C(t.get("flags")||""),u=Z(p=>{l(p)},[l]),h=Z(p=>{d(p)},[d]),v=Z(()=>{i(m,c)},[i,m,c]),_=Z(()=>{const{flags:p,metrics:g}=eo;d(p),l(g),i(p,g),t.set("flags",p),t.set("metrics",g)},[eo,d,l,t]);x(()=>{m&&c&&v()},[]);const f=[];for(const[p,g]of a)f.push(e("tr",{className:"vm-table__row",children:[e("td",{className:"vm-table-cell",children:p}),e("td",{className:"vm-table-cell",children:g.join(" ")})]}));return e("section",{className:"vm-downsampling-filters",children:[n&&e(qe,{}),e("div",{className:"vm-downsampling-filters-body vm-block",children:[e("div",{className:"vm-downsampling-filters-body__expr",children:[e("div",{className:"vm-retention-filters-body__title",children:e("p",{children:["Provide a list of flags for downsampling configuration. Note that only ",e("code",{children:"-downsampling.period"})," and ",e("code",{children:"-dedup.minScrapeInterval"})," flags are supported"]})}),e(le,{type:"textarea",label:"Flags",value:m,error:r||s,autofocus:!0,onEnter:v,onChange:h,placeholder:"-downsampling.period=30d:1m -downsampling.period=7d:5m -dedup.minScrapeInterval=30s"})]}),e("div",{className:"vm-downsampling-filters-body__expr",children:[e("div",{className:"vm-retention-filters-body__title",children:e("p",{children:"Provide a list of metrics to check downsampling configuration."})}),e(le,{type:"textarea",label:"Metrics",value:c,error:r||o,onEnter:v,onChange:u,placeholder:`up{env="dev"}
up{env="prod"}
`})]}),e("div",{className:"vm-downsampling-filters-body__result",children:e("table",{className:"vm-table",children:[e("thead",{className:"vm-table-header",children:e("tr",{children:[e("th",{className:"vm-table-cell vm-table-cell_header",children:"Metric"}),e("th",{className:"vm-table-cell vm-table-cell_header",children:"Applied downsampling rules"})]})}),e("tbody",{className:"vm-table-body",children:f})]})}),e("div",{className:"vm-downsampling-filters-body-top",children:[e("a",{className:"vm-link vm-link_with-icon",target:"_blank",href:"https://docs.victoriametrics.com/#downsampling",rel:"help noreferrer",children:[e(st,{}),"Documentation"]}),e($,{variant:"text",onClick:_,children:"Try example"}),e($,{variant:"contained",onClick:v,startIcon:e(ct,{}),children:"Apply"})]})]})]})},Fm=(t,a,n)=>{const r=[`flags=${encodeURIComponent(a)}`,`metrics=${encodeURIComponent(n)}`];return`${t}/retention-filters-debug?${r.join("&")}`},Hm=()=>{const{serverUrl:t}=re(),[a,n]=ie(),[r,o]=C(new Map),[s,i]=C(!1),[c,l]=C(),[m,d]=C(),[u,h]=C(),v=Z(async(_,f)=>{var g,b;if(l(f?"":"metrics are required"),d(_?"":"flags are required"),!f||!_)return;a.set("flags",_),a.set("metrics",f),n(a);const p=Fm(t,_,f);i(!0);try{const w=await(await fetch(p)).json();o(new Map(Object.entries(w.result||{}))),l(((g=w.error)==null?void 0:g.metrics)||""),d(((b=w.error)==null?void 0:b.flags)||""),h("")}catch(y){y instanceof Error&&y.name!=="AbortError"&&h(`${y.name}: ${y.message}`)}i(!1)},[t]);return{data:r,error:u,metricsError:c,flagsError:m,loading:s,applyFilters:v}},to={flags:`-retentionPeriod=1y
-retentionFilters={env!="prod"}:2w
`,metrics:`up
up{env="dev"}
up{env="prod"}`},Vm=()=>{const[t]=ie(),{data:a,loading:n,error:r,metricsError:o,flagsError:s,applyFilters:i}=Hm(),[c,l]=C(t.get("metrics")||""),[m,d]=C(t.get("flags")||""),u=Z(p=>{l(p)},[l]),h=Z(p=>{d(p)},[d]),v=Z(()=>{i(m,c)},[i,m,c]),_=Z(()=>{const{flags:p,metrics:g}=to;d(p),l(g),i(p,g),t.set("flags",p),t.set("metrics",g)},[to,d,l,t]);x(()=>{m&&c&&v()},[]);const f=[];for(const[p,g]of a)f.push(e("tr",{className:"vm-table__row",children:[e("td",{className:"vm-table-cell",children:p}),e("td",{className:"vm-table-cell",children:g})]}));return e("section",{className:"vm-retention-filters",children:[n&&e(qe,{}),e("div",{className:"vm-retention-filters-body vm-block",children:[e("div",{className:"vm-retention-filters-body__expr",children:[e("div",{className:"vm-retention-filters-body__title",children:e("p",{children:["Provide a list of flags for retention configuration. Note that only ",e("code",{children:"-retentionPeriod"})," and ",e("code",{children:"-retentionFilters"})," flags are supported."]})}),e(le,{type:"textarea",label:"Flags",value:m,error:r||s,autofocus:!0,onEnter:v,onChange:h,placeholder:'-retentionPeriod=4w -retentionFilters=up{env="dev"}:2w'})]}),e("div",{className:"vm-retention-filters-body__expr",children:[e("div",{className:"vm-retention-filters-body__title",children:e("p",{children:"Provide a list of metrics to check retention configuration."})}),e(le,{type:"textarea",label:"Metrics",value:c,error:r||o,onEnter:v,onChange:u,placeholder:`up{env="dev"}
up{env="prod"}
`})]}),e("div",{className:"vm-retention-filters-body__result",children:e("table",{className:"vm-table",children:[e("thead",{className:"vm-table-header",children:e("tr",{children:[e("th",{className:"vm-table-cell vm-table-cell_header",children:"Metric"}),e("th",{className:"vm-table-cell vm-table-cell_header",children:"Applied retention"})]})}),e("tbody",{className:"vm-table-body",children:f})]})}),e("div",{className:"vm-retention-filters-body-top",children:[e("a",{className:"vm-link vm-link_with-icon",target:"_blank",href:"https://docs.victoriametrics.com/#retention-filters",rel:"help noreferrer",children:[e(st,{}),"Documentation"]}),e($,{variant:"text",onClick:_,children:"Try example"}),e($,{variant:"contained",onClick:v,startIcon:e(ct,{}),children:"Apply"})]})]})]})},Um=({hideQuery:t,showAllSeries:a})=>{const{query:n}=ke(),{period:r}=he(),{displayType:o,reduceMemUsage:s,seriesLimits:i}=He(),{serverUrl:c}=re(),[l,m]=C(!1),[d,u]=C(),[h,v]=C(),[_,f]=C([]),[p,g]=C(),b=Y(new AbortController),y=D(()=>{if(v(""),f([]),!!r)if(!c)v(be.emptyServer);else if(n.every(S=>!S.trim()))f(n.map(()=>be.validQuery));else if(Cn(c)){const S={...r};return n.map(N=>uc(c,N,S,s))}else v(be.validServer)},[c,r,t,s]),w=Z(async({fetchUrl:S,stateSeriesLimits:N,showAllSeries:k})=>{b.current.abort(),b.current=new AbortController;const{signal:A}=b.current;m(!0);try{const L=[],E=k?1/0:+N[o]||1/0;let M=1,P=0;for await(const Q of S){if(t==null?void 0:t.includes(M-1)){f(te=>[...te,""]),M++;continue}const B=await fetch(Q,{signal:A}),F=await B.text();if(!B.ok||!B.body)L.push({metric:{},values:[],group:M}),v(F),f(te=>[...te,`${F}`]);else{f(ne=>[...ne,""]);const te=E-L.length,de=F.split(`
`).filter(ne=>ne);de.slice(0,te).sort().forEach(ne=>{const U=Ts(ne);U&&L.push({group:M,metric:U.metric,values:U.values.map((O,z)=>[U.timestamps[z]/1e3,O])})}),P+=de.length}M++}const R=`Showing ${L.length} series out of ${P} series due to performance reasons. Please narrow down the query, so it returns less series`;g(P>E?R:""),u(L),m(!1)}catch(L){m(!1),L instanceof Error&&L.name!=="AbortError"&&(v(String(L)),console.error(L))}},[o,t]),T=Z(()=>{b.current.abort(),u([])},[b]);return x(()=>{if(!(y!=null&&y.length))return;const S=setTimeout(w,400,{fetchUrl:y,stateSeriesLimits:i,showAllSeries:a});return()=>{var N;(N=b.current)==null||N.abort(),clearTimeout(S)}},[y,i,a]),{fetchUrl:y,isLoading:l,data:d,error:h,queryErrors:_,setQueryErrors:f,warning:p,abortFetch:T}},qm=()=>e(we,{href:"https://docs.victoriametrics.com/keyconcepts/#raw-samples",underlined:!0,children:"raw samples"}),Bm=()=>e(we,{underlined:!0,href:"https://docs.victoriametrics.com/keyconcepts/#query-data",children:"Query API"}),jm=()=>e(we,{underlined:!0,href:"https://docs.victoriametrics.com/keyconcepts/#filtering",children:"time series selector"}),Qm=()=>{ir();const{isMobile:t}=J(),{displayType:a}=He(),{query:n}=ke(),[r,o]=C([]),[s,i]=C(!n[0]),[c,l]=C(!1),[m,d]=C(!0),{data:u,error:h,isLoading:v,warning:_,queryErrors:f,setQueryErrors:p,abortFetch:g,fetchUrl:b}=Um({hideQuery:r,showAllSeries:c}),y=Y(null),w=!s&&h,T=k=>{o(k)},S=()=>{i(!1)},N=()=>{d(!1)};return e("div",{className:I({"vm-custom-panel":!0,"vm-custom-panel_mobile":t}),children:[e(or,{label:"Time series selector",queryErrors:s?[]:f,setQueryErrors:p,setHideError:i,stats:[],isLoading:v,onHideQuery:T,onRunQuery:S,abortFetch:g,hideButtons:{traceQuery:!0,disableCache:!0},includeFunctions:!1}),m&&e(se,{variant:"info",children:e("div",{className:"vm-explore-metrics-header-description",children:[e("ul",{children:[e("li",{children:["This page provides a dedicated view for querying and displaying ",e(qm,{})," from VictoriaMetrics."]}),e("li",{children:["It expects only ",e(jm,{})," as a query argument."]}),e("li",{children:["Deduplication can only be disabled if it was previously enabled on the server (",e("code",{children:"-dedup.minScrapeInterval"}),")."]}),e("li",{children:["Users often assume that the ",e(Bm,{})," returns data exactly as stored, but data samples and timestamps may be modified by the API."]})]}),e($,{variant:"text",size:"small",startIcon:e(Re,{}),onClick:N,ariaLabel:"close tips"})]})}),w&&e(se,{variant:"error",children:h}),_&&e(Ha,{warning:_,query:n,onChange:l}),e("div",{className:I({"vm-custom-panel-body":!0,"vm-custom-panel-body_mobile":t,"vm-block":!0,"vm-block_mobile":t}),children:[v&&e(Fa,{}),e("div",{className:"vm-custom-panel-body-header",ref:y,children:[e("div",{className:"vm-custom-panel-body-header__tabs",children:e(qo,{tabFilter:k=>k.value!==_e.table})}),u&&e(xs,{fetchUrl:b,reportType:As.RAW_DATA})]}),e(Ss,{graphData:u,liveData:u,isHistogram:!1,displayType:a,controlsRef:y})]})]})},Ym=()=>{const[t,a]=C(!1);return e(V,{children:e(yn,{children:e(Jn,{children:e(V,{children:[e(Sr,{onLoaded:a}),t&&e(wn,{children:e(ve,{path:"/",element:e(Ul,{}),children:[e(ve,{path:K.home,element:e(Es,{})}),e(ve,{path:K.rawQuery,element:e(Qm,{})}),e(ve,{path:K.metrics,element:e(_m,{})}),e(ve,{path:K.cardinality,element:e(Bd,{})}),e(ve,{path:K.topQueries,element:e(Zd,{})}),e(ve,{path:K.trace,element:e(em,{})}),e(ve,{path:K.queryAnalyzer,element:e($m,{})}),e(ve,{path:K.dashboards,element:e(Nd,{})}),e(ve,{path:K.withTemplate,element:e(Nm,{})}),e(ve,{path:K.relabel,element:e(Am,{})}),e(ve,{path:K.activeQueries,element:e(Em,{})}),e(ve,{path:K.icons,element:e(fm,{})}),e(ve,{path:K.downsamplingDebug,element:e(zm,{})}),e(ve,{path:K.retentionDebug,element:e(Vm,{})})]})})]})})})})},Gm=({currentPage:t,totalItems:a,itemsPerPage:n,onPageChange:r,maxVisiblePages:o=10})=>{const s=Math.ceil(a/n),i=d=>{d<1||d>s||r(d)},c=D(()=>{const d=[];if(s<=o)for(let u=1;u<=s;u++)d.push(u);else{const u=Math.max(1,t-Math.floor(o/2)),h=Math.min(s,u+o-1);u>1&&(d.push(1),u>2&&d.push("..."));for(let v=u;v<=h;v++)d.push(v);h<s&&(h<s-1&&d.push("..."),d.push(s))}return d},[s,t,o]),l=d=>()=>{i(t+d)},m=d=>()=>{typeof d=="number"&&i(d)};return c.length<=1?null:e("div",{className:"vm-pagination",children:[e("button",{className:"vm-pagination__page vm-pagination__arrow vm-pagination__arrow_prev",onClick:l(-1),disabled:t===1,children:e(ge,{})}),c.map((d,u)=>e("button",{onClick:m(d),className:I({"vm-pagination__page":!0,"vm-pagination__page_active":t===d,"vm-pagination__page_disabled":d==="..."}),disabled:d==="...",children:d},u)),e("button",{className:"vm-pagination__page vm-pagination__arrow vm-pagination__arrow_next",onClick:l(1),disabled:t===s,children:e(ge,{})})]})},Wm=t=>{switch(t){case"_time":return"vm-table-cell_logs-time";default:return"vm-table-cell_logs"}},Jm=[{key:"_vmui_data",title:"Data",className:"vm-table-cell_logs vm-table-cell_pre"}],Km=({logs:t,displayColumns:a,tableCompact:n,columns:r,rowsPerPage:o})=>{const s=Y(null),[i,c]=C(1),l=D(()=>t.map(v=>{const _=JSON.stringify(v,null,2);return{...v,_vmui_data:_}}),[t]),m=D(()=>r.map(v=>({key:v,title:v,className:Wm(v)})),[r]),d=D(()=>n?Jm:a!=null&&a.length?m.filter(v=>a.includes(v.key)):[],[m,a,n]),u=D(()=>{const v=(i-1)*o,_=v+o;return{startIndex:v,endIndex:_}},[i,o]),h=v=>{if(c(v),s.current){const _=s.current.getBoundingClientRect().top+window.scrollY-50;window.scrollTo({top:_})}};return x(()=>{c(1)},[t,o]),e(V,{children:[e("div",{ref:s,children:e(Is,{rows:l,columns:d,defaultOrderBy:"_time",defaultOrderDir:"desc",copyToClipboard:"_vmui_data",paginationOffset:u})}),e(Gm,{currentPage:i,totalItems:l.length,itemsPerPage:o,onPageChange:h})]})},Zm=50,Ps=100,$s=5,Os="Ungrouped",xe="_stream",ua="_msg",Gt=`${Ke}.SSS`,Oe={GROUP_BY:"groupBy",DISPLAY_FIELDS:"displayFields",NO_WRAP_LINES:"noWrapLines",COMPACT_GROUP_HEADER:"compactGroupHeader",DATE_FORMAT:"dateFormat"},Xm=({field:t,value:a})=>{const n=Ue(),[r,o]=ie(),[s,i]=C(!1),c=r.get(Oe.GROUP_BY)||xe,l=r.get(Oe.DISPLAY_FIELDS)||"",m=l?l.split(","):[],d=m.includes(t),u=c===t,h=Z(async()=>{if(!s)try{await n(`${t}: "${a}"`),i(!0)}catch(f){console.error(f)}},[s,n]),v=()=>{const f=m,p=f.includes(t)?f.filter(g=>g!==t):[...f,t];r.set(Oe.DISPLAY_FIELDS,p.join(",")),o(r)},_=()=>{u?r.delete(Oe.GROUP_BY):r.set(Oe.GROUP_BY,t),o(r)};return x(()=>{if(s===null)return;const f=setTimeout(()=>i(!1),2e3);return()=>clearTimeout(f)},[s]),e("tr",{className:"vm-group-logs-row-fields-item",children:[e("td",{className:"vm-group-logs-row-fields-item-controls",children:e("div",{className:"vm-group-logs-row-fields-item-controls__wrapper",children:[e(G,{title:s?"Copied":"Copy to clipboard",children:e($,{className:"vm-group-logs-row-fields-item-controls__button",variant:"text",color:"gray",size:"small",startIcon:e(et,{}),onClick:h,ariaLabel:"copy to clipboard"})}),e(G,{title:d?"Hide this field":"Show this field instead of the message",children:e($,{className:"vm-group-logs-row-fields-item-controls__button",variant:"text",color:d?"secondary":"gray",size:"small",startIcon:d?e(zt,{}):e(zt,{}),onClick:v,ariaLabel:"copy to clipboard"})},`${t}_${d}_${u}`),e(G,{title:u?"Ungroup this field":"Group by this field",children:e($,{className:"vm-group-logs-row-fields-item-controls__button",variant:"text",color:u?"secondary":"gray",size:"small",startIcon:e(Nt,{}),onClick:_,ariaLabel:"copy to clipboard"})},`${t}_${d}_${u}`)]})}),e("td",{className:"vm-group-logs-row-fields-item__key",children:t}),e("td",{className:"vm-group-logs-row-fields-item__value",children:a})]})},eu=_n(Xm),tu=({log:t,displayFields:a=["_msg"]})=>{const{value:n,toggle:r}=oe(!1),[o]=ie(),{markdownParsing:s}=Wn(),{timezone:i}=he(),c=o.get(Oe.NO_WRAP_LINES)==="true",l=o.get(Oe.DATE_FORMAT)||Gt,m=D(()=>t._time?q(t._time).tz().format(l):"",[t._time,i,l]),d=D(()=>!s||!t._msg?"":Ht(t._msg.replace(/```/g,"\n```\n")),[t._msg,s]),u=D(()=>Object.entries(t),[t]),h=u.length>0,v=D(()=>{if(a.length)return a.filter(f=>t[f]).map((f,p)=>e("span",{className:"vm-group-logs-row-content__sub-msg",children:t[f]},f+p));if(t._msg)return t._msg;if(!h)return;const _=u.reduce((f,[p,g])=>(f[p]=g,f),{});return JSON.stringify(_)},[t,u,h,a]);return e("div",{className:"vm-group-logs-row",children:[e("div",{className:"vm-group-logs-row-content",onClick:r,children:[h&&e("div",{className:I({"vm-group-logs-row-content__arrow":!0,"vm-group-logs-row-content__arrow_open":n}),children:e(ge,{})}),e("div",{className:I({"vm-group-logs-row-content__time":!0,"vm-group-logs-row-content__time_missing":!m}),children:m||"timestamp missing"}),e("div",{className:I({"vm-group-logs-row-content__msg":!0,"vm-group-logs-row-content__msg_empty-msg":!t._msg,"vm-group-logs-row-content__msg_missing":!v,"vm-group-logs-row-content__msg_single-line":c}),dangerouslySetInnerHTML:s&&d?{__html:d}:void 0,children:v||"-"})]},`${t._msg}${t._time}`),h&&n&&e("div",{className:"vm-group-logs-row-fields",children:e("table",{children:e("tbody",{children:u.map(([_,f])=>e(eu,{field:_,value:f},_))})})})]})},au=_n(tu);var nt=(t=>(t.BAR="Bars",t.LINE="Lines",t.LINE_STEPPED="Stepped lines",t.POINTS="Points",t))(nt||{});const nu=(t,a,n,r)=>{var i,c,l;const o=t.under.clientWidth/Ps-1,s=(l=(c=(i=Vt)==null?void 0:i.paths)==null?void 0:c.bars)==null?void 0:l.call(c,{size:[.96,o]});return s?s(t,a,n,r):null},ru=(t,a,n,r)=>{var s,i,c;const o=(c=(i=(s=Vt)==null?void 0:s.paths)==null?void 0:i.stepped)==null?void 0:c.call(i,{align:1});return o?o(t,a,n,r):null},ou=t=>{switch(t){case nt.BAR:return nu;case nt.LINE_STEPPED:return ru;default:return}},su=["color-log-hits-bar-1","color-log-hits-bar-2","color-log-hits-bar-3","color-log-hits-bar-4","color-log-hits-bar-5"],iu={[nt.BAR]:1,[nt.LINE_STEPPED]:2,[nt.LINE]:1.2,[nt.POINTS]:0},vn="other",Rs=t=>t!=null&&t._isOther?vn:Object.values((t==null?void 0:t.fields)||{}).map(n=>n||'""').join(", "),lu=({data:t,logHits:a,xRange:n,bands:r,containerSize:o,onReadyChart:s,setPlotScale:i,graphOptions:c})=>{const{isDarkTheme:l}=re(),[m,d]=C(-1),u=_=>{const f=_.cursor.idx??-1;d(f)},h=D(()=>{let _=0;return t.map((f,p)=>{if(p===0)return{};const g=a==null?void 0:a[p-1],b=Rs(g),y=Xe(g!=null&&g._isOther?"color-log-hits-bar-0":su[_]);return g!=null&&g._isOther||_++,{label:b,width:iu[c.graphStyle],spanGaps:!0,stroke:y,fill:c.fill?y+(g!=null&&g._isOther?"":"80"):"",paths:ou(c.graphStyle)}})},[l,t,c]);return{options:D(()=>({series:h,bands:r,width:o.width||window.innerWidth/2,height:o.height||200,cursor:{points:{width:(_,f,p)=>p/4,size:(_,f)=>{var p,g,b;return(((b=(g=(p=_.series)==null?void 0:p[f])==null?void 0:g.points)==null?void 0:b.size)||1)*1.5},stroke:(_,f)=>{var p;return`${((p=h==null?void 0:h[f])==null?void 0:p.stroke)||"#ffffff"}`},fill:()=>"#ffffff"}},scales:{x:{time:!0,range:()=>[n.min,n.max]}},hooks:{drawSeries:[],ready:[s],setCursor:[u],setSelect:[gr(i)],destroy:[vr]},legend:{show:!1},axes:mr([{},{scale:"y"}]),tzDate:_=>q(Pt(Ye(_))).local().toDate()}),[l,h,r]),series:h,focusDataIdx:m}},zs=t=>(/^{.+}$/.test(t)?t.slice(1,-1).split(","):[t]).filter(Boolean),Fs=t=>{const a=q(t.start*1e3),n=q(t.end*1e3),r=n.diff(a,"milliseconds"),o=Math.ceil(r/Ps)||1;return{start:a,end:n,step:o}},Hs=(t,a=xe)=>/(.+)?=(".+")/.test(t)?t.replace(/=/,": "):`${a}: "${t}"`,cu=t=>t.reduce((a,n)=>a+(n.total||0),0),Vs=t=>(a,n)=>{if(a.label===vn)return 1;if(n.label===vn)return-1;const r=a[t];return n[t]-r},{GROUP_BY:ao,NO_WRAP_LINES:no,COMPACT_GROUP_HEADER:ro,DISPLAY_FIELDS:on,DATE_FORMAT:sn}=Oe,ca="Group view settings",du=({logs:t})=>{const[a,n]=ie(),r=a.get(ao)||xe,o=a.get(no)==="true",s=a.get(ro)==="true",i=a.get(on)||"",c=i?i.split(","):[ua],[l,m]=C(a.get(sn)||Gt),[d,u]=C(""),h=r!==xe,v=c.length!==1||c[0]!==ua,_=a.get(sn)!==Gt,f=[h,v,o,s,_].some(Boolean),p=D(()=>Array.from(new Set(t.map(M=>Object.keys(M)).flat())),[t]),{value:g,toggle:b,setFalse:y}=oe(!1),w=M=>{a.set(ao,M),n(a)},T=M=>{const P=c,R=P.includes(M)?P.filter(Q=>Q!==M):[...P,M];a.set(on,R.join(",")),n(a)},S=()=>{a.delete(on),n(a)},N=()=>{a.set(no,String(!o)),n(a)},k=()=>{a.set(ro,String(!s)),n(a)},A=M=>{q(new Date,M,!0).isValid()||u("Invalid date format"),m(M)},L=()=>{a.set(sn,l),n(a),y()};return e(V,{children:[e("div",{className:"vm-group-logs-configurator-button",children:[e(G,{title:f?e("div",{className:"vm-group-logs-configurator__tooltip",children:[e("p",{children:ca}),e("hr",{}),e("ul",{children:[h&&e("li",{children:["Group by ",e("code",{children:`"${r}"`})]}),v&&e("li",{children:["Display fields: ",c.length||1]}),o&&e("li",{children:"Single-line text is enabled"}),s&&e("li",{children:"Compact group header is enabled"}),_&&e("li",{children:["Date format: ",e("code",{children:l})]})]})]}):ca,children:e($,{variant:"text",startIcon:e(ht,{}),onClick:b,ariaLabel:ca})}),f&&e("span",{className:"vm-group-logs-configurator-button__marker"})]}),g&&e(Ie,{title:ca,onClose:L,children:e("div",{className:"vm-group-logs-configurator",children:[e("div",{className:"vm-group-logs-configurator-item",children:[e($t,{value:r,list:[Os,...p],label:"Group by field",placeholder:"Group by field",onChange:w,searchable:!0}),e(G,{title:"Reset grouping",children:e($,{variant:"text",color:"primary",startIcon:e(rt,{}),onClick:()=>w(xe)})}),e("span",{className:"vm-group-logs-configurator-item__info",children:["Select a field to group logs by (default: ",e("code",{children:xe}),")."]})]}),e("div",{className:"vm-group-logs-configurator-item",children:[e($t,{value:c,list:p,label:"Display fields",placeholder:"Display fields",onChange:T,searchable:!0}),e(G,{title:"Clear fields",children:e($,{variant:"text",color:"primary",startIcon:e(rt,{}),onClick:S})}),e("span",{className:"vm-group-logs-configurator-item__info",children:["Select fields to display instead of the message (default: ",e("code",{children:ua}),")."]})]}),e("div",{className:"vm-group-logs-configurator-item",children:[e(le,{autofocus:!0,label:"Date format",value:l,onChange:A,error:d}),e(G,{title:"Reset format",children:e($,{variant:"text",color:"primary",startIcon:e(rt,{}),onClick:()=>m(Gt)})}),e("span",{className:"vm-group-logs-configurator-item__info vm-group-logs-configurator-item__info_input",children:["Set the date format (e.g., ",e("code",{children:"YYYY-MM-DD HH:mm:ss"}),"). Learn more in ",e(we,{href:"https://day.js.org/docs/en/display/format",children:"this documentation"}),". ",e("br",{}),"Your current date format: ",e("code",{children:q().format(l||Gt)})]})]}),e("div",{className:"vm-group-logs-configurator-item",children:[e(Ce,{value:o,onChange:N,label:"Single-line message"}),e("span",{className:"vm-group-logs-configurator-item__info",children:"Displays message in a single line and truncates it with an ellipsis if it exceeds the available space"})]}),e("div",{className:"vm-group-logs-configurator-item",children:[e(Ce,{value:s,onChange:k,label:"Compact group header"}),e("span",{className:"vm-group-logs-configurator-item__info",children:'Shows group headers in one line with a "+N more" badge for extra fields.'})]})]})})]})},oo=({pair:t,isHide:a})=>{const{isDarkTheme:n}=re(),r=Ue(),[o]=ie(),[s,i]=C(null),c=o.get(Oe.GROUP_BY)||xe,l=m=>async d=>{d.stopPropagation();const u=Hs(m,c);await r(u)&&i(m)};return x(()=>{if(s===null)return;const m=setTimeout(()=>i(null),2e3);return()=>clearTimeout(m)},[s]),e(G,{title:s===t?"Copied":"Copy to clipboard",placement:"top-center",children:e("div",{className:I({"vm-group-logs-section-keys__pair":!0,"vm-group-logs-section-keys__pair_hide":a,"vm-group-logs-section-keys__pair_dark":n}),onClick:l(t),children:t})})},mu=({group:t})=>{const{isDarkTheme:a}=re(),[n]=ie(),r=Y(null),o=Y(null),{value:s,toggle:i,setFalse:c}=oe(!1),[l,m]=C(0),d=n.get(Oe.GROUP_BY)||xe,u=n.get(Oe.COMPACT_GROUP_HEADER)==="true",h=t.pairs,v=h.length-l-1,_=p=>{p.stopPropagation(),i()},f=Z(()=>{if(!u||!r.current){m(0);return}const p=r.current,g=p.getBoundingClientRect(),y=Array.from(p.querySelectorAll(".vm-group-logs-section-keys__pair:not(.vm-group-logs-section-keys__pair_more)"));let w=0;for(const T of y){const{right:S}=T.getBoundingClientRect();S+220>g.width&&w++}m(w)},[u,r]);return x(f,[t.pairs,u,r]),ce("resize",f),e("div",{className:I({"vm-group-logs-section-keys":!0,"vm-group-logs-section-keys_compact":u}),ref:r,children:[e("span",{className:"vm-group-logs-section-keys__title",children:["Group by ",e("code",{children:d}),":"]}),h.map((p,g)=>e(oo,{pair:p,isHide:l?g>v:!1},`${t.keysString}_${p}`)),l>0&&e(V,{children:[e("div",{className:I({"vm-group-logs-section-keys__pair":!0,"vm-group-logs-section-keys__pair_more":!0,"vm-group-logs-section-keys__pair_dark":a}),ref:o,onClick:_,children:["+",l," more"]}),e(Se,{open:s,buttonRef:o,placement:"bottom-left",onClose:c,children:e("div",{className:"vm-group-logs-section-keys vm-group-logs-section-keys_popper",children:h.slice(v+1).map(p=>e(oo,{pair:p},`${t.keysString}_${p}`))})})]}),e("span",{className:"vm-group-logs-section-keys__count",children:[t.values.length," entries"]})]})},uu=({logs:t,settingsRef:a})=>{const[n]=ie(),[r,o]=C([]),s=n.get(Oe.GROUP_BY)||xe,c=(n.get(Oe.DISPLAY_FIELDS)||ua).split(","),l=D(()=>r.every(Boolean),[r]),m=D(()=>os(t,[s]).map(h=>{var p;const v=((p=h.values[0])==null?void 0:p[s])||"",_=zs(v),f=h.values.sort((g,b)=>new Date(b._time).getTime()-new Date(g._time).getTime());return{keys:h.keys,keysString:h.keys.join(""),values:f,pairs:_}}).sort((h,v)=>v.values.length-h.values.length),[t,s]),d=Z(()=>{o(new Array(m.length).fill(!l))},[l,m.length]),u=Z(h=>v=>{o(_=>{const f=[..._];return f[h]=v,f})},[]);return x(()=>{o(new Array(m.length).fill(!0))},[m]),e(V,{children:[e("div",{className:"vm-group-logs",children:m.map((h,v)=>e("div",{className:"vm-group-logs-section",children:e(Oa,{defaultExpanded:r[v],onChange:u(v),title:s!==Os&&e(mu,{group:h}),children:e("div",{className:"vm-group-logs-section-rows",children:h.values.map(_=>e(au,{log:_,displayFields:c},`${_._msg}${_._time}`))})})},h.keysString))}),a.current&&Aa.createPortal(e("div",{className:"vm-group-logs-header",children:[e(G,{title:l?"Collapse All":"Expand All",children:e($,{variant:"text",startIcon:l?e(Vn,{}):e(Hn,{}),onClick:d,ariaLabel:l?"Collapse All":"Expand All"})}),e(du,{logs:t})]}),a.current)]})},hu=[10,25,50,100,250,500,1e3],pu=({limit:t,tooltip:a,onChange:n})=>{const{isMobile:r}=J(),o=a||"Rows per page",s=Y(null),{value:i,toggle:c,setFalse:l}=oe(!1),m=d=>()=>{n(d),l()};return e(V,{children:[e(G,{title:o,children:e("div",{ref:s,children:e($,{variant:"text",endIcon:e(We,{}),onClick:c,children:t})})}),e(Se,{open:i,onClose:l,placement:"bottom-right",buttonRef:s,children:e("div",{className:"vm-select-limits",children:hu.map(d=>e("div",{className:I({"vm-list-item":!0,"vm-list-item_mobile":r,"vm-list-item_active":d===t}),onClick:m(d),children:d},d))})})]})},vu=Aa.memo(Km),gu=Aa.memo(uu),_u=Aa.memo(Ua),fu=[{label:"Group",value:"group",icon:e(zo,{})},{label:"Table",value:"table",icon:e(ra,{})},{label:"JSON",value:"json",icon:e(At,{})}],bu=({data:t,isLoading:a})=>{const{isMobile:n}=J(),{setSearchParamsFromKeys:r}=vt(),o=Y(null),[s,i]=Ne("group","view"),[c,l]=C([]),[m,d]=Ne(1e3,"rows_per_page"),{value:u,toggle:h}=oe(!1),v=D(()=>{if(!(t!=null&&t.length))return[];const p=new Set;for(const g of t)for(const b in g)p.add(b);return Array.from(p)},[t]),_=p=>{i(p),r({view:p})},f=p=>{d(p),r({rows_per_page:p})};return e("div",{className:I({"vm-explore-logs-body":!0,"vm-block":!0,"vm-block_mobile":n}),children:[a&&e(Fa,{}),e("div",{className:I({"vm-explore-logs-body-header":!0,"vm-section-header":!0,"vm-explore-logs-body-header_mobile":n}),children:[e("div",{className:"vm-section-header__tabs",children:[e(Bt,{activeItem:String(s),items:fu,onChange:_}),e("div",{className:"vm-explore-logs-body-header__log-info",children:["Total logs returned: ",e("b",{children:t.length})]})]}),s==="table"&&e("div",{className:"vm-explore-logs-body-header__settings",children:[e(pu,{limit:m,onChange:f}),e(Cr,{columns:v,selectedColumns:c,onChangeColumns:l,tableCompact:u,toggleTableCompact:h})]}),s==="group"&&e("div",{className:"vm-explore-logs-body-header__settings",ref:o})]}),e("div",{className:I({"vm-explore-logs-body__table":!0,"vm-explore-logs-body__table_mobile":n}),children:[!t.length&&e("div",{className:"vm-explore-logs-body__empty",children:"No logs found"}),!!t.length&&e(V,{children:[s==="table"&&e(vu,{logs:t,displayColumns:c,tableCompact:u,columns:v,rowsPerPage:Number(m)}),s==="group"&&e(gu,{logs:t,settingsRef:o}),s==="json"&&e(_u,{data:t})]})]})]})},yu=t=>`${t}/select/logsql/query`,wu=t=>`${t}/select/logsql/hits`,Cu=(t,a,n)=>{const[r]=ie(),[o,s]=C([]),[i,c]=C({}),[l,m]=C(),d=Y(new AbortController),u=D(()=>yu(t),[t]),h=(f,p,g,b)=>({signal:b,method:"POST",headers:{Accept:"application/stream+json",AccountID:r.get("accountID")||"0",ProjectID:r.get("projectID")||"0"},body:new URLSearchParams({query:f.trim(),limit:`${g}`,start:q(p.start*1e3).tz().toISOString(),end:q(p.end*1e3).tz().toISOString()})}),v=f=>{try{return f&&JSON.parse(f)}catch(p){return console.error(`Failed to parse "${f}" to JSON
`,p),null}},_=Z(async f=>{d.current.abort(),d.current=new AbortController;const{signal:p}=d.current,g=Date.now();c(b=>({...b,[g]:!0})),m(void 0);try{const b=h(a,f,n,p),y=await fetch(u,b),w=await y.text();if(!y.ok||!y.body)return m(w),s([]),!1;const T=w.split(`
`,n).map(v).filter(S=>S);return s(T),!0}catch(b){return b instanceof Error&&b.name!=="AbortError"&&(m(String(b)),console.error(b),s([])),!1}finally{c(b=>{const{[g]:y,...w}=b;return w})}},[u,a,n,r]);return{logs:o,isLoading:Object.values(i).some(f=>f),error:l,fetchLogs:_,abortController:d.current}};var wt=(t=>(t.Filter="Filter",t.Pipe="Pipe",t.Operator="Operator",t))(wt||{}),me=(t=>(t.FilterName="FilterName",t.FilterUnknown="FilterUnknown",t.FilterValue="FilterValue",t.PipeName="Pipes",t.PipeValue="PipeValue",t.Unknown="Unknown",t))(me||{});const Nu="https://docs.victoriametrics.com/victorialogs/logsql",ku="vm-link vm-link_colored",Su=t=>{const a=`$1 target="_blank" class="${ku}" $2`,n=`$1 $2${Nu}#`;return t.replace(/(<a) (href=")#/gm,n).replace(/(<a) (href="[^"]+")/gm,a)},Us=[{value:"copy",description:'<a href="#copy-pipe"><code>copy</code></a> copies <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log fields</a>.'},{value:"delete",description:'<a href="#delete-pipe"><code>delete</code></a> deletes <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log fields</a>.'},{value:"drop_empty_fields",description:'<a href="#drop_empty_fields-pipe"><code>drop_empty_fields</code></a> drops <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log fields</a> with empty values.'},{value:"extract",description:'<a href="#extract-pipe"><code>extract</code></a> extracts the specified text into the given log fields.'},{value:"extract_regexp",description:'<a href="#extract_regexp-pipe"><code>extract_regexp</code></a> extracts the specified text into the given log fields via <a href="https://github.com/google/re2/wiki/Syntax" rel="external" target="_blank">RE2 regular expressions</a>.'},{value:"field_names",description:'<a href="#field_names-pipe"><code>field_names</code></a> returns all the names of <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log fields</a>.'},{value:"field_values",description:'<a href="#field_values-pipe"><code>field_values</code></a> returns all the values for the given <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log field</a>.'},{value:"fields",description:'<a href="#fields-pipe"><code>fields</code></a> selects the given set of <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log fields</a>.'},{value:"filter",description:'<a href="#filter-pipe"><code>filter</code></a> applies additional <a href="#filters">filters</a> to results.'},{value:"format",description:'<a href="#format-pipe"><code>format</code></a> formats output field from input <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log fields</a>.'},{value:"limit",description:'<a href="#limit-pipe"><code>limit</code></a> limits the number selected logs.'},{value:"math",description:'<a href="#math-pipe"><code>math</code></a> performs mathematical calculations over <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log fields</a>.'},{value:"offset",description:'<a href="#offset-pipe"><code>offset</code></a> skips the given number of selected logs.'},{value:"pack_json",description:'<a href="#pack_json-pipe"><code>pack_json</code></a> packs <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log fields</a> into JSON object.'},{value:"pack_logfmt",description:'<a href="#pack_logfmt-pipe"><code>pack_logfmt</code></a> packs <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log fields</a> into <a href="https://brandur.org/logfmt" rel="external" target="_blank">logfmt</a> message.'},{value:"rename",description:'<a href="#rename-pipe"><code>rename</code></a> renames <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log fields</a>.'},{value:"replace",description:'<a href="#replace-pipe"><code>replace</code></a> replaces substrings in the specified <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log fields</a>.'},{value:"replace_regexp",description:'<a href="#replace_regexp-pipe"><code>replace_regexp</code></a> updates <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log fields</a> with regular expressions.'},{value:"sort",description:'<a href="#sort-pipe"><code>sort</code></a> sorts logs by the given <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">fields</a>.'},{value:"stats",description:'<a href="#stats-pipe"><code>stats</code></a> calculates various stats over the selected logs.'},{value:"stream_context",description:`<a href="#stream_context-pipe"><code>stream_context</code></a> allows selecting surrounding logs in front and after the matching logs
per each <a href="/victorialogs/keyconcepts/#stream-fields">log stream</a>.`},{value:"top",description:'<a href="#top-pipe"><code>top</code></a> returns top <code>N</code> field sets with the maximum number of matching logs.'},{value:"uniq",description:'<a href="#uniq-pipe"><code>uniq</code></a> returns unique log entires.'},{value:"unpack_json",description:'<a href="#unpack_json-pipe"><code>unpack_json</code></a> unpacks JSON messages from <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log fields</a>.'},{value:"unpack_logfmt",description:'<a href="#unpack_logfmt-pipe"><code>unpack_logfmt</code></a> unpacks <a href="https://brandur.org/logfmt" rel="external" target="_blank">logfmt</a> messages from <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log fields</a>.'},{value:"unpack_syslog",description:'<a href="#unpack_syslog-pipe"><code>unpack_syslog</code></a> unpacks <a href="https://en.wikipedia.org/wiki/Syslog" rel="external" target="_blank">syslog</a> messages from <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log fields</a>.'},{value:"unroll",description:'<a href="#unroll-pipe"><code>unroll</code></a> unrolls JSON arrays from <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log fields</a>.'}].map(t=>({...t,type:me.PipeName,icon:e(Ia,{}),description:Su(t.description)})),Tu=["AND","OR","NOT"],Au=Us.map(t=>t.value),xu=t=>{var v,_;const a=t,n=[];let r="",o=!1;const s=["'",'"',"`"];let i=!1,c="";const l=["(","[","{"],m=[")","]","}"],d=[...l,...m];let u=0,h=0;for(let f=0;f<a.length;f++){const p=a[f];if(s.includes(p)){const g=i&&p===c;i=!g,c=g?"":p}if(!i&&d.includes(p)){const g=l.includes(p)?1:-1;u+=g}if(!i&&!u&&p==="|"){o=!0;const g=((v=r.match(/^ */))==null?void 0:v[0].length)||0,b=((_=r.match(/ *$/))==null?void 0:_[0].length)||0;ln(r,!0,[h+g,f-b-1],n),r="",h=f+1;continue}if(!o&&!i&&!u&&p===" "){const g=a.slice(f).replace(/^\s*/,""),b=a.slice(0,f).replace(/\s*$/,"");if(!g.startsWith(":")&&!b.endsWith(":")){ln(r,!1,[h,f-1],n),r="",h=f+1;continue}}r+=p}return ln(r,o,[h,a.length],n),n},ln=(t,a,n,r)=>{const o=t.trim();if(!o)return;const s=Tu.includes(o.toUpperCase());r.push({id:r.length,value:o,position:n,type:a?wt.Pipe:s?wt.Operator:wt.Filter})},Lu=(t,a)=>{const n=t.value.substring(0,a),r=t.value.substring(a),o={valueBeforeCursor:n,valueAfterCursor:r,valueContext:t.value,contextType:me.Unknown};if(t.type===wt.Filter)if(!n.includes(":")&&!r.includes(":"))o.contextType=me.FilterUnknown;else if(n.includes(":")){const[i,c]=n.split(":");o.contextType=me.FilterValue,o.filterName=i,o.valueContext=c}else o.contextType=me.FilterName;else if(t.type===wt.Pipe){const s=Au.some(i=>t.value.startsWith(i));o.contextType=s?me.PipeValue:me.PipeName}return o.valueContext=o.valueContext.replace(/^["']|["']$/g,""),o},Eu={[me.FilterName]:e(ba,{}),[me.FilterUnknown]:e(ba,{}),[me.FilterValue]:e(ya,{}),[me.PipeName]:e(Ia,{}),[me.PipeValue]:e(Fn,{}),[me.Unknown]:e(ya,{})},Mu=t=>{const[a]=ie(),{serverUrl:n}=re(),{period:{start:r,end:o}}=he(),{autocompleteCache:s}=Wn(),i=Qo(),[c,l]=C(!1),[m,d]=C([]),[u,h]=C([]),v=Y(new AbortController),_=Z(g=>{const b=q(r*1e3).startOf("day").valueOf()/1e3,y=q(o*1e3).endOf("day").valueOf()/1e3;return new URLSearchParams({...g||{},limit:`${Ct.queryLimit}`,start:`${b}`,end:`${y}`})},[r,o]),f=(g,b)=>g.map(y=>({value:y.value,type:`${b}`,icon:Eu[b]})),p=async({urlSuffix:g,setter:b,type:y,params:w})=>{v.current.abort(),v.current=new AbortController;const{signal:T}=v.current,S={AccountID:a.get("accountID")||"0",ProjectID:a.get("projectID")||"0"},N=new URLSearchParams(S).toString(),k=`${g}?${w==null?void 0:w.toString()}&${N}`;l(!0);try{const A=s.get(k);if(A){b(f(A,y)),l(!1);return}const L=await fetch(`${n}/select/logsql/${g}?${w}`,{signal:T,headers:{...S}});if(L.ok){const E=await L.json(),M=(E==null?void 0:E.values)||[];b(M?f(M,y):[]),i({type:"SET_AUTOCOMPLETE_CACHE",payload:{key:k,value:M}})}l(!1)}catch(A){A instanceof Error&&A.name!=="AbortError"&&(i({type:"SET_AUTOCOMPLETE_CACHE",payload:{key:k,value:[]}}),l(!1),console.error(A))}};return x(()=>{const b=![me.FilterName,me.FilterUnknown].includes((t==null?void 0:t.contextType)||me.Unknown);if(!(!n||b))return d([]),p({urlSuffix:"field_names",setter:d,type:me.FilterName,params:_({query:"*"})}),()=>{var y;return(y=v.current)==null?void 0:y.abort()}},[n,t]),x(()=>{const g=(t==null?void 0:t.contextType)!==me.FilterValue;if(!(!n||g||!(t!=null&&t.filterName)))return h([]),p({urlSuffix:"field_values",setter:h,type:me.FilterValue,params:_({query:"*",field:t.filterName})}),()=>{var b;return(b=v.current)==null?void 0:b.abort()}},[n,t]),{fieldNames:m,fieldValues:u,loading:c}},Du=({value:t,anchorEl:a,caretPosition:n,hasHelperText:r,onSelect:o,onFoundOptions:s})=>{const[i,c]=C({top:0,left:0}),l=D(()=>{if(n[0]!==n[1])return{valueBeforeCursor:t,valueAfterCursor:""};const b=t.substring(0,n[0]),y=t.substring(n[1]);return{valueBeforeCursor:b,valueAfterCursor:y}},[t,n]),m=D(()=>xu(t),[t]),d=D(()=>{if(n[0]!==n[1])return;const b=m.find(w=>n[0]>=w.position[0]&&n[0]<=w.position[1]);if(!b)return;const y=n[0]-b.position[0];return{...b,...Lu(b,y)}},[m,n]),{fieldNames:u,fieldValues:h,loading:v}=Mu(d),_=D(()=>{switch(d==null?void 0:d.contextType){case me.FilterName:case me.FilterUnknown:return u;case me.FilterValue:return h;case me.PipeName:return Us;default:return[]}},[d,u,h]),f=(b,y,w)=>y.reduce((T,S)=>{const N=S.id===w?b:S.value,k=S.type===wt.Pipe?" | ":" ";return`${T}${k}${N}`},"").trim(),p=(b,y,w="",T)=>{let S=b;if(T===me.FilterName)S+=":";else if(y===me.FilterValue){const N=w.startsWith("_stream:")?S:`"${S}"`;S=`${(d==null?void 0:d.filterName)||""}:${N}`}return S},g=Z((b,y)=>{const{id:w,contextType:T=me.FilterUnknown,value:S="",position:N=[0,0]}=d||{},k=p(b,T,S,y.type),A=f(k,m,w),L=(N[0]||1)+k.length+(y.type===me.PipeName?1:0);o(A,L)},[d,m]);return x(()=>{if(!a.current){c({top:0,left:0});return}const b=a.current.querySelector("textarea")||a.current,y=window.getComputedStyle(b),w=`${y.getPropertyValue("font-size")}`,T=`${y.getPropertyValue("font-family")}`,S=parseInt(`${y.getPropertyValue("line-height")}`),N=document.createElement("div");N.style.font=`${w} ${T}`,N.style.padding=y.getPropertyValue("padding"),N.style.lineHeight=`${S}px`,N.style.width=`${b.offsetWidth}px`,N.style.maxWidth=`${b.offsetWidth}px`,N.style.whiteSpace=y.getPropertyValue("white-space"),N.style.overflowWrap=y.getPropertyValue("overflow-wrap");const k=document.createElement("span");N.appendChild(document.createTextNode(l.valueBeforeCursor||"")),N.appendChild(k),N.appendChild(document.createTextNode(l.valueAfterCursor||"")),document.body.appendChild(N);const A=N.getBoundingClientRect(),L=k.getBoundingClientRect(),E=L.left-A.left,M=L.bottom-A.bottom-(r?S:0);c({top:M,left:E}),N.remove(),k.remove()},[a,n,r,l]),e(V,{children:e(rr,{loading:v,disabledFullScreen:!0,value:(d==null?void 0:d.valueContext)||"",options:_,anchor:a,minLength:0,offset:i,onSelect:g,onFoundOptions:s,maxDisplayResults:{limit:Ct.displayResults,message:"Please, specify the query more precisely."}})})},Iu=({query:t,limit:a,error:n,isLoading:r,onChange:o,onChangeLimit:s,onRun:i})=>{const{isMobile:c}=J(),{autocomplete:l}=ke(),m=qt(),[d,u]=C(""),[h,v]=C(a),_=p=>{const g=+p;v(g),isNaN(g)||g<0?u("Number must be bigger than zero"):(u(""),s(g))},f=()=>{m({type:"TOGGLE_AUTOCOMPLETE"})};return x(()=>{v(a)},[a]),e("div",{className:I({"vm-explore-logs-header":!0,"vm-block":!0,"vm-block_mobile":c}),children:[e("div",{className:"vm-explore-logs-header-top",children:[e(rs,{value:t,autocomplete:l,autocompleteEl:Du,onArrowUp:()=>null,onArrowDown:()=>null,onEnter:i,onChange:o,label:"Log query",error:n}),e(le,{label:"Limit entries",type:"number",value:h,error:d,onChange:_,onEnter:i})]}),e("div",{className:"vm-explore-logs-header-bottom",children:[e("div",{className:"vm-explore-logs-header-bottom-contols",children:e(Ce,{label:"Autocomplete",value:l,onChange:f,fullWidth:c})}),e("div",{className:"vm-explore-logs-header-bottom-helpful",children:[e("a",{className:"vm-link vm-link_with-icon",target:"_blank",href:"https://docs.victoriametrics.com/victorialogs/logsql/",rel:"help noreferrer",children:[e(Ge,{}),"Query language docs"]}),e("a",{className:"vm-link vm-link_with-icon",target:"_blank",href:"https://docs.victoriametrics.com/victorialogs/",rel:"help noreferrer",children:[e(st,{}),"Documentation"]})]}),e("div",{className:"vm-explore-logs-header-bottom-execute",children:e($,{startIcon:r?e(Un,{}):e(ct,{}),onClick:i,fullWidth:!0,children:[e("span",{className:"vm-explore-logs-header-bottom-execute__text",children:r?"Cancel Query":"Execute Query"}),e("span",{className:"vm-explore-logs-header-bottom-execute__text_hidden",children:"Execute Query"})]})})]})]})},so=t=>q(t*1e3).tz().format(Ke),Pu=({data:t,focusDataIdx:a,uPlotInst:n})=>{const r=Y(null),o=D(()=>{var v,_;const i=(n==null?void 0:n.series)||[],[c,...l]=t.map(f=>f[a]||0),m=t[0][1]-t[0][0],d=c+m,u=l.map((f,p)=>{var T;const g=i[p+1],b=(T=g==null?void 0:g.stroke)==null?void 0:T.call(g),y=g==null?void 0:g.label,w=g==null?void 0:g.show;return{label:y,stroke:b,value:f,show:w}}).filter(f=>f.value>0&&f.show).sort(Vs("value"));return{point:{top:u[0]&&((v=n==null?void 0:n.valToPos)==null?void 0:v.call(n,u[0].value,"y"))||0,left:((_=n==null?void 0:n.valToPos)==null?void 0:_.call(n,c,"x"))||0},values:u,total:u.reduce((f,p)=>f+p.value,0),timestamp:`${so(c)} - ${so(d)}`}},[a,n,t]),s=D(()=>{if(!n||!o.total||!r.current)return;const{top:i,left:c}=o.point,l={left:parseFloat(n.over.style.left),top:parseFloat(n.over.style.top)},{width:m,height:d}=n.over.getBoundingClientRect(),{width:u,height:h}=r.current.getBoundingClientRect(),v=50,_=c+u>=m?u+2*v:0,f=i+h>=d?h+2*v:0,p={top:i+l.top+v-f,left:c+l.left+v-_};return p.left<0&&(p.left=20),p.top<0&&(p.top=20),p},[o,n,r.current]);return e("div",{className:I({"vm-chart-tooltip":!0,"vm-chart-tooltip_hits":!0,"vm-bar-hits-tooltip":!0,"vm-bar-hits-tooltip_visible":a!==-1&&o.values.length}),ref:r,style:s,children:[e("div",{children:o.values.map((i,c)=>e("div",{className:"vm-chart-tooltip-data",children:[e("span",{className:"vm-chart-tooltip-data__marker",style:{background:i.stroke}}),e("p",{className:"vm-bar-hits-tooltip-item",children:[e("span",{className:"vm-bar-hits-tooltip-item__label",children:i.label}),e("span",{children:i.value.toLocaleString("en-US")})]})]},c))}),o.values.length>1&&e("div",{className:"vm-chart-tooltip-data",children:[e("span",{}),e("p",{className:"vm-bar-hits-tooltip-item",children:[e("span",{className:"vm-bar-hits-tooltip-item__label",children:"Total"}),e("span",{children:o.total.toLocaleString("en-US")})]})]}),e("div",{className:"vm-chart-tooltip-header",children:e("div",{className:"vm-chart-tooltip-header__title vm-bar-hits-tooltip__date",children:o.timestamp})})]})},$u=({onChange:t})=>{const[a,n]=ie(),r=Y(null),{value:o,toggle:s,setFalse:i}=oe(!1),[c,l]=Ne(!1,"stacked"),[m,d]=Ne("true","fill"),[u,h]=Ne(!1,"hide_chart"),v=D(()=>({graphStyle:nt.BAR,stacked:c,fill:m==="true",hideChart:u}),[c,m,u]),_=g=>{d(`${g}`),a.set("fill",`${g}`),n(a)},f=g=>{l(g),g?a.set("stacked","true"):a.delete("stacked"),n(a)},p=()=>{h(g=>{const b=!g;return b?a.set("hide_chart","true"):a.delete("hide_chart"),n(a),b})};return x(()=>{t(v)},[v]),e("div",{className:"vm-bar-hits-options",children:[e(G,{title:u?"Show chart and resume hits updates":"Hide chart and pause hits updates",children:e($,{variant:"text",color:"primary",startIcon:u?e($n,{}):e(zt,{}),onClick:p,ariaLabel:"settings"})}),e("div",{ref:r,children:e(G,{title:"Graph settings",children:e($,{variant:"text",color:"primary",startIcon:e(ht,{}),onClick:s,ariaLabel:"settings"})})}),e(Se,{open:o,placement:"bottom-right",onClose:i,buttonRef:r,title:"Graph settings",children:e("div",{className:"vm-bar-hits-options-settings",children:[e("div",{className:"vm-bar-hits-options-settings-item",children:e(Ce,{label:"Stacked",value:c,onChange:f})}),e("div",{className:"vm-bar-hits-options-settings-item",children:e(Ce,{label:"Fill",value:m==="true",onChange:_})})]})})]})};function Ou(t,a){const n=[];let r=[];const o=t[0].length,s=Array(o);for(let i=0;i<o;i++)s[i]=0;for(let i=1;i<t.length;i++)n.push(a(i)?t[i]:t[i].map((c,l)=>s[l]+=+(c??0)));for(let i=1;i<t.length;i++)!a(i)&&r.push({series:[t.findIndex((c,l)=>l>i&&!a(l)),i]});return r=r.filter(i=>i.series[1]>-1),{data:[t[0]].concat(n),bands:r}}const Ru=({legend:t})=>{const a=t.total.toLocaleString("en-US"),n=Math.round(t.total/t.totalHits*100);return e("div",{className:"vm-legend-hits-menu-section",children:e("div",{className:"vm-legend-hits-menu-row",children:e("div",{className:"vm-legend-hits-menu-row__title",children:["Total: ",a," (",n,"%)"]})})})},Ba=({title:t,handler:a,iconStart:n,iconEnd:r,className:o,submenu:s})=>{const i=Y(null),c=Y(null),l=Y(null),[m,d]=C(!1),[u,h]=C(!1),[v,_]=C(!1),f=!!(s!=null&&s.length),p=()=>{h(w=>!w)},g=()=>{h(!1)},b=()=>{a&&a(),f&&p()};x(()=>{c.current&&d(c.current.scrollWidth>c.current.clientWidth)},[t,c]),x(()=>{requestAnimationFrame(()=>{if(!u||!l.current){_(!1);return}const{left:w,width:T}=l.current.getBoundingClientRect();_(w+T>window.innerWidth)})},[l,u]),sa(i,g);const y=e("div",{ref:c,className:"vm-legend-hits-menu-row__title",children:t});return e("div",{ref:i,className:I({"vm-legend-hits-menu-row":!0,"vm-legend-hits-menu-row_interactive":!!a||f,[`${o}`]:o}),onClick:b,children:[n&&e("div",{className:"vm-legend-hits-menu-row__icon",children:n}),m?e(G,{title:t,children:y}):y,r&&!f&&e("div",{className:"vm-legend-hits-menu-row__icon",children:r}),f&&e("div",{className:"vm-legend-hits-menu-row__icon vm-legend-hits-menu-row__icon_drop",children:e(We,{})}),u&&s&&e("div",{ref:l,className:I({"vm-legend-hits-menu":!0,"vm-legend-hits-menu_submenu":!0,"vm-legend-hits-menu_submenu_left":v}),children:e("div",{className:"vm-legend-hits-menu-section",children:s.map(({icon:w,title:T,handler:S})=>e(Ba,{iconStart:w,title:T,handler:S},T))})})]})},zu=({legend:t,onApplyFilter:a,onClose:n})=>{const r=Ue(),o=()=>{a(`${xe}: ${t.label}`),n()},s=()=>{a(`(NOT ${xe}: ${t.label})`),n()},i=async()=>{await r(t.label,`${t.label} has been copied`),n()},c=[{title:`Copy ${xe} name`,icon:e(et,{}),handler:i},{title:`Add ${xe} to filter`,icon:e(qn,{}),handler:o},{title:`Exclude ${xe} to filter`,icon:e(Bn,{}),handler:s}];return e("div",{className:"vm-legend-hits-menu-section",children:c.map(({icon:l,title:m,handler:d})=>e(Ba,{iconStart:l,title:m,handler:d},m))})},Fu=({fields:t,onApplyFilter:a,onClose:n})=>{const r=Ue(),o=m=>async()=>{await r(m,`${m} has been copied`),n()},s=m=>()=>{a(m),n()},i=m=>()=>{a(`-${m}`),n()},c=m=>[{title:"Copy",icon:e(et,{}),handler:o(m)},{title:"Add to filter",icon:e(qn,{}),handler:s(m)},{title:"Exclude to filter",icon:e(Bn,{}),handler:i(m)}],l=D(()=>t.map(m=>{const d=Hs(m);return{title:d,submenu:c(d)}}),[t]);return e("div",{className:"vm-legend-hits-menu-section",children:l==null?void 0:l.map(m=>e(Ba,{...m},m.title))})},Hu=`aggregated results for fields not in the top ${$s}`,Vu=({legend:t,fields:a,onApplyFilter:n,onClose:r})=>e("div",{className:"vm-legend-hits-menu",children:[e("div",{className:"vm-legend-hits-menu-section",children:e(Ba,{className:"vm-legend-hits-menu-row_info",title:t.isOther?Hu:t.label})}),!t.isOther&&e(zu,{legend:t,onApplyFilter:n,onClose:r}),!t.isOther&&e(Fu,{fields:a,onApplyFilter:n,onClose:r}),e(Ru,{legend:t})]}),Uu=({legend:t,series:a,onRedrawGraph:n,onApplyFilter:r})=>{const{value:o,setTrue:s,setFalse:i}=oe(!1),c=Y(null),[l,m]=C(null),d=D(()=>a.find(p=>p.label===t.label),[a]),u=D(()=>zs(t.label),[t.label]),h=u.join(", "),v=wc(t.total),_=p=>{if(d){if(p.metaKey||p.ctrlKey)d.show=!d.show;else{const g=a.every(b=>b===d||!b.show);a.forEach(b=>{b.show=g||b===d})}n()}},f=p=>{p.preventDefault(),m({top:p.clientY,left:p.clientX}),s()};return e("div",{ref:c,className:I({"vm-bar-hits-legend-item":!0,"vm-bar-hits-legend-item_other":t.isOther,"vm-bar-hits-legend-item_hide":!(d!=null&&d.show)}),onClick:_,onContextMenu:f,children:[e("div",{className:"vm-bar-hits-legend-item__marker",style:{backgroundColor:`${t.stroke}`}}),e("div",{className:"vm-bar-hits-legend-item__label",children:h}),e("span",{className:"vm-bar-hits-legend-item__total",children:["(",v,")"]}),e(Se,{placement:"fixed",open:o,buttonRef:c,placementPosition:l,onClose:i,children:e(Vu,{legend:t,fields:u,onApplyFilter:r,onClose:i})})]})},qu=({uPlotInst:t,legendDetails:a,onApplyFilter:n})=>{var l;const[r,o]=C([]),s=((l=a[0])==null?void 0:l.totalHits)||0,i=()=>t.series.filter(m=>m.scale!=="x"),c=()=>{t.redraw(),o(i())};return x(()=>{o(i())},[t]),e("div",{className:"vm-bar-hits-legend",children:[a.map(m=>e(Uu,{legend:m,series:r,onRedrawGraph:c,onApplyFilter:n},m.label)),e("div",{className:"vm-bar-hits-legend-info",children:[e("div",{children:["Total hits: ",e("b",{children:s.toLocaleString("en-US")})]}),e("div",{children:[e("code",{children:"L-Click"})," toggles visibility.",e("code",{children:"R-Click"})," opens menu."]})]})]})},Bu=({logHits:t,data:a,period:n,setPeriod:r,onApplyFilter:o})=>{const[s,i]=ws(),c=Y(null),[l,m]=C(),[d,u]=C({graphStyle:nt.LINE_STEPPED,stacked:!1,fill:!1,hideChart:!1}),{xRange:h,setPlotScale:v}=br({period:n,setPeriod:r}),{onReadyChart:_,isPanning:f}=_r(v);fr({uPlotInst:l,xRange:h,setPlotScale:v});const p=D(()=>a.every(k=>k.length===0),[a]),{data:g,bands:b}=D(()=>d.stacked?Ou(a,()=>!1):{data:a,bands:[]},[d,a]),{options:y,series:w,focusDataIdx:T}=lu({data:g,logHits:t,bands:b,xRange:h,containerSize:i,onReadyChart:_,setPlotScale:v,graphOptions:d}),S=Z((k,A)=>k.map(L=>{var P;const E=Rs(L);return{label:E,isOther:L._isOther,fields:L.fields,total:L.total||0,totalHits:A,stroke:(P=w.find(R=>R.label===E))==null?void 0:P.stroke}}).sort(Vs("total")),[w]),N=D(()=>{const k=cu(t);return S(t,k)},[t,S]);return x(()=>{l&&(pr(l),ps(l,w,!0),fs(l,w),l.redraw())},[w]),x(()=>{if(!c.current)return;const k=new Vt(y,g,c.current);return m(k),()=>k.destroy()},[c.current,y]),x(()=>{l&&(l.scales.x.range=()=>[h.min,h.max],l.redraw())},[h]),x(()=>{l&&(l.setSize(i),l.redraw())},[i]),x(()=>{l&&(l.setData(g),l.redraw())},[g]),e("div",{className:I({"vm-bar-hits-chart__wrapper":!0,"vm-bar-hits-chart__wrapper_hidden":d.hideChart}),children:[!d.hideChart&&e("div",{className:I({"vm-bar-hits-chart":!0,"vm-bar-hits-chart_panning":f}),ref:s,children:[e("div",{className:"vm-line-chart__u-plot",ref:c}),e(Pu,{uPlotInst:l,data:a,focusDataIdx:T})]}),e($u,{onChange:u}),l&&!p&&!d.hideChart&&e(qu,{uPlotInst:l,onApplyFilter:o,legendDetails:N})]})},ju=({logHits:t,period:a,error:n,isLoading:r,onApplyFilter:o})=>{const{isMobile:s}=J(),i=Fe(),[c]=ie(),l=D(()=>c.get("hide_chart"),[c]),m=(_,f)=>_.map(p=>{const g=new Map;return p.timestamps.forEach((b,y)=>{const w=q(b).unix();g.set(w,p.values[y]||null)}),f.map(b=>g.get(b)||null)}),d=Z(_=>{const f=[],{start:p,end:g,step:b}=Fs(a),y=Math.ceil(p.diff(_,"milliseconds")/b);let w=_.add(y*b,"milliseconds");w.isBefore(p)&&(w=p.clone());const T=Math.floor(g.diff(w,"milliseconds")/b);for(let S=0;S<=T;S++)f.push(w.add(S*b,"milliseconds").unix());return f},[a]),u=D(()=>{if(!t.length)return[[],[]];const _=d(q(t[0].timestamps[0])),f=m(t,_);return[_,...f]},[t]),h=D(()=>{const _=u.every(g=>g.length===0),f=u[0].length===0,p=u[1].length===0;return l?"Chart hidden. Hits updates paused.":_?`No logs volume available
No volume information available for the current queries and time range.`:f?"No timestamp information available for the current queries and time range.":p?"No value information available for the current queries and time range.":""},[u,l]),v=({from:_,to:f})=>{i({type:"SET_PERIOD",payload:{from:_,to:f}})};return e("section",{className:I({"vm-explore-logs-chart":!0,"vm-block":!0,"vm-block_mobile":s}),children:[r&&e(Fa,{}),!n&&h&&e("div",{className:"vm-explore-logs-chart__empty",children:e(se,{variant:"info",children:h})}),n&&h&&e("div",{className:"vm-explore-logs-chart__empty",children:e(se,{variant:"error",children:n})}),u&&e(Bu,{logHits:t,data:u,period:a,setPeriod:v,onApplyFilter:o})]})},Qu=(t,a)=>{const[n]=ie(),[r,o]=C([]),[s,i]=C([]),[c,l]=C(),m=Y(new AbortController),d=D(()=>wu(t),[t]),u=(v,_,f)=>{const{start:p,end:g,step:b}=Fs(_);return{signal:f,method:"POST",headers:{AccountID:n.get("accountID")||"0",ProjectID:n.get("projectID")||"0"},body:new URLSearchParams({query:v.trim(),step:`${b}ms`,start:p.toISOString(),end:g.toISOString(),fields_limit:`${$s}`,field:xe})}},h=Z(async v=>{m.current.abort(),m.current=new AbortController;const{signal:_}=m.current,f=Date.now();i(p=>({...p,[f]:!0})),l(void 0);try{const p=u(a,v,_),g=await fetch(d,p);if(!g.ok||!g.body){const w=await g.text();l(w),o([]),i(T=>({...T,[f]:!1}));return}const b=await g.json(),y=b==null?void 0:b.hits;y||l("Error: No 'hits' field in response"),o(y.map(Yu).sort(Gu))}catch(p){p instanceof Error&&p.name!=="AbortError"&&(l(String(p)),console.error(p),o([]))}i(p=>({...p,[f]:!1}))},[d,a,n]);return{logHits:r,isLoading:Object.values(s).some(v=>v),error:c,fetchLogHits:h,abortController:m.current}},Yu=t=>({...t,_isOther:wd(t.fields)}),Gu=(t,a)=>t._isOther!==a._isOther?t._isOther?-1:1:a.total-t.total,io=Number(ze("LOGS_LIMIT")),Wu=isNaN(io)?Zm:io,Ju=()=>{const{serverUrl:t}=re(),{duration:a,relativeTime:n,period:r}=he(),{setSearchParamsFromKeys:o}=vt(),[s]=ie(),i=D(()=>s.get("hide_chart"),[s]),[c,l]=Ne(Wu,"limit"),[m,d]=Ne("*","query"),[u,h]=C(!1),[v,_]=C(r),[f,p]=C(""),{logs:g,isLoading:b,error:y,fetchLogs:w,abortController:T}=Cu(t,m,c),{fetchLogHits:S,...N}=Qu(t,m),k=Z(()=>{const P=Jt.find(H=>H.id===n);if(!P)return r;const{duration:R,until:Q}=P;return _t(R,Q())},[r,n]),A=()=>{if(!m){p(be.validQuery);return}p("");const P=k();_(P),w(P).then(R=>{R&&!i&&S(P)}).catch(R=>R),o({query:m,"g0.range_input":a,"g0.end_input":P.date,"g0.relative_time":n||"none"})},L=P=>{l(P),o({limit:P}),Le("LOGS_LIMIT",`${P}`)},E=P=>{d(R=>`${P} AND (${R})`),h(!0)},M=()=>{b||N.isLoading?(T.abort&&T.abort(),N.abortController.abort&&N.abortController.abort()):A()};return x(()=>{m&&A()},[r]),x(()=>{u&&(A(),h(!1))},[m,u]),x(()=>{!i&&S(v)},[i]),e("div",{className:"vm-explore-logs",children:[e(Iu,{query:m,error:f,limit:c,onChange:d,onChangeLimit:L,onRun:M,isLoading:b||N.isLoading}),y&&e(se,{variant:"error",children:y}),!y&&e(ju,{...N,query:m,period:v,onApplyFilter:E}),e(bu,{data:g,isLoading:b})]})},Ku=()=>{const t=ye(),{isMobile:a}=J(),n=Fe(),[r,o]=ie(),[s,i]=Ne("0","accountID"),[c,l]=Ne("0","projectID"),m=`${s}:${c}`,d=Y(null),{value:u,toggle:h,setFalse:v}=oe(!1),_=()=>{r.set("accountID",s),r.set("projectID",c),o(r),v(),n({type:"RUN_QUERY"})},f=()=>{i(r.get("accountID")||"0"),l(r.get("projectID")||"0")};return x(()=>{u||f()},[u]),e("div",{className:"vm-tenant-input",children:[e(G,{title:"Define Tenant ID if you need request to another storage",children:e("div",{ref:d,children:a?e("div",{className:"vm-mobile-option",onClick:h,children:[e("span",{className:"vm-mobile-option__icon",children:e(Nt,{})}),e("div",{className:"vm-mobile-option-text",children:[e("span",{className:"vm-mobile-option-text__label",children:"Tenant ID"}),e("span",{className:"vm-mobile-option-text__value",children:m})]}),e("span",{className:"vm-mobile-option__arrow",children:e(ge,{})})]}):e($,{className:t?"":"vm-header-button",variant:"contained",color:"primary",fullWidth:!0,startIcon:e(Nt,{}),endIcon:e("div",{className:I({"vm-execution-controls-buttons__arrow":!0,"vm-execution-controls-buttons__arrow_open":u}),children:e(ge,{})}),onClick:h,children:m})})}),e(Se,{open:u,placement:"bottom-right",onClose:v,buttonRef:d,title:a?"Define Tenant ID":void 0,children:e("div",{className:I({"vm-list vm-tenant-input-list":!0,"vm-list vm-tenant-input-list_mobile":a,"vm-tenant-input-list_inline":!0}),children:[e(le,{autofocus:!0,label:"accountID",value:s,onChange:i,type:"number"}),e(le,{autofocus:!0,label:"projectID",value:c,onChange:l,type:"number"}),e("div",{className:"vm-tenant-input-list__buttons",children:[e(G,{title:"Multitenancy in VictoriaLogs documentation",children:e("a",{href:"https://docs.victoriametrics.com/victorialogs/#multitenancy",target:"_blank",rel:"help noreferrer",children:e($,{variant:"text",color:"gray",startIcon:e(Rn,{})})})}),e($,{variant:"contained",color:"primary",onClick:_,children:"Apply"})]})]})})]})},Zu=({isMobile:t})=>e("div",{className:I({"vm-header-controls":!0,"vm-header-controls_mobile":t}),children:[e(Ku,{}),e(er,{}),e(tr,{}),e(ar,{})]}),Xu=()=>{const t=ye(),{isMobile:a}=J(),{pathname:n}=it();return nr(),x(()=>{var i;const o="vmui for VictoriaLogs",s=(i=lt[K.logs])==null?void 0:i.title;document.title=`${s} - ${o}`},[n]),e("section",{className:"vm-container",children:[e(Zn,{controlsComponent:Zu}),e("div",{className:I({"vm-container-body":!0,"vm-container-body_mobile":a,"vm-container-body_app":t}),children:e(bn,{})}),!t&&e(Xn,{links:bl})]})},eh={100:"",1234:"",grinning:"",smiley:"",smile:"",grin:"",laughing:"",satisfied:"",sweat_smile:"",rofl:"",joy:"",slightly_smiling_face:"",upside_down_face:"",melting_face:"",wink:"",blush:"",innocent:"",smiling_face_with_three_hearts:"",heart_eyes:"",star_struck:"",kissing_heart:"",kissing:"",relaxed:"",kissing_closed_eyes:"",kissing_smiling_eyes:"",smiling_face_with_tear:"",yum:"",stuck_out_tongue:"",stuck_out_tongue_winking_eye:"",zany_face:"",stuck_out_tongue_closed_eyes:"",money_mouth_face:"",hugs:"",hand_over_mouth:"",face_with_open_eyes_and_hand_over_mouth:"",face_with_peeking_eye:"",shushing_face:"",thinking:"",saluting_face:"",zipper_mouth_face:"",raised_eyebrow:"",neutral_face:"",expressionless:"",no_mouth:"",dotted_line_face:"",face_in_clouds:"",smirk:"",unamused:"",roll_eyes:"",grimacing:"",face_exhaling:"",lying_face:"",shaking_face:"",relieved:"",pensive:"",sleepy:"",drooling_face:"",sleeping:"",mask:"",face_with_thermometer:"",face_with_head_bandage:"",nauseated_face:"",vomiting_face:"",sneezing_face:"",hot_face:"",cold_face:"",woozy_face:"",dizzy_face:"",face_with_spiral_eyes:"",exploding_head:"",cowboy_hat_face:"",partying_face:"",disguised_face:"",sunglasses:"",nerd_face:"",monocle_face:"",confused:"",face_with_diagonal_mouth:"",worried:"",slightly_frowning_face:"",frowning_face:"",open_mouth:"",hushed:"",astonished:"",flushed:"",pleading_face:"",face_holding_back_tears:"",frowning:"",anguished:"",fearful:"",cold_sweat:"",disappointed_relieved:"",cry:"",sob:"",scream:"",confounded:"",persevere:"",disappointed:"",sweat:"",weary:"",tired_face:"",yawning_face:"",triumph:"",rage:"",pout:"",angry:"",cursing_face:"",smiling_imp:"",imp:"",skull:"",skull_and_crossbones:"",hankey:"",poop:"",shit:"",clown_face:"",japanese_ogre:"",japanese_goblin:"",ghost:"",alien:"",space_invader:"",robot:"",smiley_cat:"",smile_cat:"",joy_cat:"",heart_eyes_cat:"",smirk_cat:"",kissing_cat:"",scream_cat:"",crying_cat_face:"",pouting_cat:"",see_no_evil:"",hear_no_evil:"",speak_no_evil:"",love_letter:"",cupid:"",gift_heart:"",sparkling_heart:"",heartpulse:"",heartbeat:"",revolving_hearts:"",two_hearts:"",heart_decoration:"",heavy_heart_exclamation:"",broken_heart:"",heart_on_fire:"",mending_heart:"",heart:"",pink_heart:"",orange_heart:"",yellow_heart:"",green_heart:"",blue_heart:"",light_blue_heart:"",purple_heart:"",brown_heart:"",black_heart:"",grey_heart:"",white_heart:"",kiss:"",anger:"",boom:"",collision:"",dizzy:"",sweat_drops:"",dash:"",hole:"",speech_balloon:"",eye_speech_bubble:"",left_speech_bubble:"",right_anger_bubble:"",thought_balloon:"",zzz:"",wave:"",raised_back_of_hand:"",raised_hand_with_fingers_splayed:"",hand:"",raised_hand:"",vulcan_salute:"",rightwards_hand:"",leftwards_hand:"",palm_down_hand:"",palm_up_hand:"",leftwards_pushing_hand:"",rightwards_pushing_hand:"",ok_hand:"",pinched_fingers:"",pinching_hand:"",v:"",crossed_fingers:"",hand_with_index_finger_and_thumb_crossed:"",love_you_gesture:"",metal:"",call_me_hand:"",point_left:"",point_right:"",point_up_2:"",middle_finger:"",fu:"",point_down:"",point_up:"",index_pointing_at_the_viewer:"","+1":"",thumbsup:"","-1":"",thumbsdown:"",fist_raised:"",fist:"",fist_oncoming:"",facepunch:"",punch:"",fist_left:"",fist_right:"",clap:"",raised_hands:"",heart_hands:"",open_hands:"",palms_up_together:"",handshake:"",pray:"",writing_hand:"",nail_care:"",selfie:"",muscle:"",mechanical_arm:"",mechanical_leg:"",leg:"",foot:"",ear:"",ear_with_hearing_aid:"",nose:"",brain:"",anatomical_heart:"",lungs:"",tooth:"",bone:"",eyes:"",eye:"",tongue:"",lips:"",biting_lip:"",baby:"",child:"",boy:"",girl:"",adult:"",blond_haired_person:"",man:"",bearded_person:"",man_beard:"",woman_beard:"",red_haired_man:"",curly_haired_man:"",white_haired_man:"",bald_man:"",woman:"",red_haired_woman:"",person_red_hair:"",curly_haired_woman:"",person_curly_hair:"",white_haired_woman:"",person_white_hair:"",bald_woman:"",person_bald:"",blond_haired_woman:"",blonde_woman:"",blond_haired_man:"",older_adult:"",older_man:"",older_woman:"",frowning_person:"",frowning_man:"",frowning_woman:"",pouting_face:"",pouting_man:"",pouting_woman:"",no_good:"",no_good_man:"",ng_man:"",no_good_woman:"",ng_woman:"",ok_person:"",ok_man:"",ok_woman:"",tipping_hand_person:"",information_desk_person:"",tipping_hand_man:"",sassy_man:"",tipping_hand_woman:"",sassy_woman:"",raising_hand:"",raising_hand_man:"",raising_hand_woman:"",deaf_person:"",deaf_man:"",deaf_woman:"",bow:"",bowing_man:"",bowing_woman:"",facepalm:"",man_facepalming:"",woman_facepalming:"",shrug:"",man_shrugging:"",woman_shrugging:"",health_worker:"",man_health_worker:"",woman_health_worker:"",student:"",man_student:"",woman_student:"",teacher:"",man_teacher:"",woman_teacher:"",judge:"",man_judge:"",woman_judge:"",farmer:"",man_farmer:"",woman_farmer:"",cook:"",man_cook:"",woman_cook:"",mechanic:"",man_mechanic:"",woman_mechanic:"",factory_worker:"",man_factory_worker:"",woman_factory_worker:"",office_worker:"",man_office_worker:"",woman_office_worker:"",scientist:"",man_scientist:"",woman_scientist:"",technologist:"",man_technologist:"",woman_technologist:"",singer:"",man_singer:"",woman_singer:"",artist:"",man_artist:"",woman_artist:"",pilot:"",man_pilot:"",woman_pilot:"",astronaut:"",man_astronaut:"",woman_astronaut:"",firefighter:"",man_firefighter:"",woman_firefighter:"",police_officer:"",cop:"",policeman:"",policewoman:"",detective:"",male_detective:"",female_detective:"",guard:"",guardsman:"",guardswoman:"",ninja:"",construction_worker:"",construction_worker_man:"",construction_worker_woman:"",person_with_crown:"",prince:"",princess:"",person_with_turban:"",man_with_turban:"",woman_with_turban:"",man_with_gua_pi_mao:"",woman_with_headscarf:"",person_in_tuxedo:"",man_in_tuxedo:"",woman_in_tuxedo:"",person_with_veil:"",man_with_veil:"",woman_with_veil:"",bride_with_veil:"",pregnant_woman:"",pregnant_man:"",pregnant_person:"",breast_feeding:"",woman_feeding_baby:"",man_feeding_baby:"",person_feeding_baby:"",angel:"",santa:"",mrs_claus:"",mx_claus:"",superhero:"",superhero_man:"",superhero_woman:"",supervillain:"",supervillain_man:"",supervillain_woman:"",mage:"",mage_man:"",mage_woman:"",fairy:"",fairy_man:"",fairy_woman:"",vampire:"",vampire_man:"",vampire_woman:"",merperson:"",merman:"",mermaid:"",elf:"",elf_man:"",elf_woman:"",genie:"",genie_man:"",genie_woman:"",zombie:"",zombie_man:"",zombie_woman:"",troll:"",massage:"",massage_man:"",massage_woman:"",haircut:"",haircut_man:"",haircut_woman:"",walking:"",walking_man:"",walking_woman:"",standing_person:"",standing_man:"",standing_woman:"",kneeling_person:"",kneeling_man:"",kneeling_woman:"",person_with_probing_cane:"",man_with_probing_cane:"",woman_with_probing_cane:"",person_in_motorized_wheelchair:"",man_in_motorized_wheelchair:"",woman_in_motorized_wheelchair:"",person_in_manual_wheelchair:"",man_in_manual_wheelchair:"",woman_in_manual_wheelchair:"",runner:"",running:"",running_man:"",running_woman:"",woman_dancing:"",dancer:"",man_dancing:"",business_suit_levitating:"",dancers:"",dancing_men:"",dancing_women:"",sauna_person:"",sauna_man:"",sauna_woman:"",climbing:"",climbing_man:"",climbing_woman:"",person_fencing:"",horse_racing:"",skier:"",snowboarder:"",golfing:"",golfing_man:"",golfing_woman:"",surfer:"",surfing_man:"",surfing_woman:"",rowboat:"",rowing_man:"",rowing_woman:"",swimmer:"",swimming_man:"",swimming_woman:"",bouncing_ball_person:"",bouncing_ball_man:"",basketball_man:"",bouncing_ball_woman:"",basketball_woman:"",weight_lifting:"",weight_lifting_man:"",weight_lifting_woman:"",bicyclist:"",biking_man:"",biking_woman:"",mountain_bicyclist:"",mountain_biking_man:"",mountain_biking_woman:"",cartwheeling:"",man_cartwheeling:"",woman_cartwheeling:"",wrestling:"",men_wrestling:"",women_wrestling:"",water_polo:"",man_playing_water_polo:"",woman_playing_water_polo:"",handball_person:"",man_playing_handball:"",woman_playing_handball:"",juggling_person:"",man_juggling:"",woman_juggling:"",lotus_position:"",lotus_position_man:"",lotus_position_woman:"",bath:"",sleeping_bed:"",people_holding_hands:"",two_women_holding_hands:"",couple:"",two_men_holding_hands:"",couplekiss:"",couplekiss_man_woman:"",couplekiss_man_man:"",couplekiss_woman_woman:"",couple_with_heart:"",couple_with_heart_woman_man:"",couple_with_heart_man_man:"",couple_with_heart_woman_woman:"",family:"",family_man_woman_boy:"",family_man_woman_girl:"",family_man_woman_girl_boy:"",family_man_woman_boy_boy:"",family_man_woman_girl_girl:"",family_man_man_boy:"",family_man_man_girl:"",family_man_man_girl_boy:"",family_man_man_boy_boy:"",family_man_man_girl_girl:"",family_woman_woman_boy:"",family_woman_woman_girl:"",family_woman_woman_girl_boy:"",family_woman_woman_boy_boy:"",family_woman_woman_girl_girl:"",family_man_boy:"",family_man_boy_boy:"",family_man_girl:"",family_man_girl_boy:"",family_man_girl_girl:"",family_woman_boy:"",family_woman_boy_boy:"",family_woman_girl:"",family_woman_girl_boy:"",family_woman_girl_girl:"",speaking_head:"",bust_in_silhouette:"",busts_in_silhouette:"",people_hugging:"",footprints:"",monkey_face:"",monkey:"",gorilla:"",orangutan:"",dog:"",dog2:"",guide_dog:"",service_dog:"",poodle:"",wolf:"",fox_face:"",raccoon:"",cat:"",cat2:"",black_cat:"",lion:"",tiger:"",tiger2:"",leopard:"",horse:"",moose:"",donkey:"",racehorse:"",unicorn:"",zebra:"",deer:"",bison:"",cow:"",ox:"",water_buffalo:"",cow2:"",pig:"",pig2:"",boar:"",pig_nose:"",ram:"",sheep:"",goat:"",dromedary_camel:"",camel:"",llama:"",giraffe:"",elephant:"",mammoth:"",rhinoceros:"",hippopotamus:"",mouse:"",mouse2:"",rat:"",hamster:"",rabbit:"",rabbit2:"",chipmunk:"",beaver:"",hedgehog:"",bat:"",bear:"",polar_bear:"",koala:"",panda_face:"",sloth:"",otter:"",skunk:"",kangaroo:"",badger:"",feet:"",paw_prints:"",turkey:"",chicken:"",rooster:"",hatching_chick:"",baby_chick:"",hatched_chick:"",bird:"",penguin:"",dove:"",eagle:"",duck:"",swan:"",owl:"",dodo:"",feather:"",flamingo:"",peacock:"",parrot:"",wing:"",black_bird:"",goose:"",frog:"",crocodile:"",turtle:"",lizard:"",snake:"",dragon_face:"",dragon:"",sauropod:"","t-rex":"",whale:"",whale2:"",dolphin:"",flipper:"",seal:"",fish:"",tropical_fish:"",blowfish:"",shark:"",octopus:"",shell:"",coral:"",jellyfish:"",snail:"",butterfly:"",bug:"",ant:"",bee:"",honeybee:"",beetle:"",lady_beetle:"",cricket:"",cockroach:"",spider:"",spider_web:"",scorpion:"",mosquito:"",fly:"",worm:"",microbe:"",bouquet:"",cherry_blossom:"",white_flower:"",lotus:"",rosette:"",rose:"",wilted_flower:"",hibiscus:"",sunflower:"",blossom:"",tulip:"",hyacinth:"",seedling:"",potted_plant:"",evergreen_tree:"",deciduous_tree:"",palm_tree:"",cactus:"",ear_of_rice:"",herb:"",shamrock:"",four_leaf_clover:"",maple_leaf:"",fallen_leaf:"",leaves:"",empty_nest:"",nest_with_eggs:"",mushroom:"",grapes:"",melon:"",watermelon:"",tangerine:"",orange:"",mandarin:"",lemon:"",banana:"",pineapple:"",mango:"",apple:"",green_apple:"",pear:"",peach:"",cherries:"",strawberry:"",blueberries:"",kiwi_fruit:"",tomato:"",olive:"",coconut:"",avocado:"",eggplant:"",potato:"",carrot:"",corn:"",hot_pepper:"",bell_pepper:"",cucumber:"",leafy_green:"",broccoli:"",garlic:"",onion:"",peanuts:"",beans:"",chestnut:"",ginger_root:"",pea_pod:"",bread:"",croissant:"",baguette_bread:"",flatbread:"",pretzel:"",bagel:"",pancakes:"",waffle:"",cheese:"",meat_on_bone:"",poultry_leg:"",cut_of_meat:"",bacon:"",hamburger:"",fries:"",pizza:"",hotdog:"",sandwich:"",taco:"",burrito:"",tamale:"",stuffed_flatbread:"",falafel:"",egg:"",fried_egg:"",shallow_pan_of_food:"",stew:"",fondue:"",bowl_with_spoon:"",green_salad:"",popcorn:"",butter:"",salt:"",canned_food:"",bento:"",rice_cracker:"",rice_ball:"",rice:"",curry:"",ramen:"",spaghetti:"",sweet_potato:"",oden:"",sushi:"",fried_shrimp:"",fish_cake:"",moon_cake:"",dango:"",dumpling:"",fortune_cookie:"",takeout_box:"",crab:"",lobster:"",shrimp:"",squid:"",oyster:"",icecream:"",shaved_ice:"",ice_cream:"",doughnut:"",cookie:"",birthday:"",cake:"",cupcake:"",pie:"",chocolate_bar:"",candy:"",lollipop:"",custard:"",honey_pot:"",baby_bottle:"",milk_glass:"",coffee:"",teapot:"",tea:"",sake:"",champagne:"",wine_glass:"",cocktail:"",tropical_drink:"",beer:"",beers:"",clinking_glasses:"",tumbler_glass:"",pouring_liquid:"",cup_with_straw:"",bubble_tea:"",beverage_box:"",mate:"",ice_cube:"",chopsticks:"",plate_with_cutlery:"",fork_and_knife:"",spoon:"",hocho:"",knife:"",jar:"",amphora:"",earth_africa:"",earth_americas:"",earth_asia:"",globe_with_meridians:"",world_map:"",japan:"",compass:"",mountain_snow:"",mountain:"",volcano:"",mount_fuji:"",camping:"",beach_umbrella:"",desert:"",desert_island:"",national_park:"",stadium:"",classical_building:"",building_construction:"",bricks:"",rock:"",wood:"",hut:"",houses:"",derelict_house:"",house:"",house_with_garden:"",office:"",post_office:"",european_post_office:"",hospital:"",bank:"",hotel:"",love_hotel:"",convenience_store:"",school:"",department_store:"",factory:"",japanese_castle:"",european_castle:"",wedding:"",tokyo_tower:"",statue_of_liberty:"",church:"",mosque:"",hindu_temple:"",synagogue:"",shinto_shrine:"",kaaba:"",fountain:"",tent:"",foggy:"",night_with_stars:"",cityscape:"",sunrise_over_mountains:"",sunrise:"",city_sunset:"",city_sunrise:"",bridge_at_night:"",hotsprings:"",carousel_horse:"",playground_slide:"",ferris_wheel:"",roller_coaster:"",barber:"",circus_tent:"",steam_locomotive:"",railway_car:"",bullettrain_side:"",bullettrain_front:"",train2:"",metro:"",light_rail:"",station:"",tram:"",monorail:"",mountain_railway:"",train:"",bus:"",oncoming_bus:"",trolleybus:"",minibus:"",ambulance:"",fire_engine:"",police_car:"",oncoming_police_car:"",taxi:"",oncoming_taxi:"",car:"",red_car:"",oncoming_automobile:"",blue_car:"",pickup_truck:"",truck:"",articulated_lorry:"",tractor:"",racing_car:"",motorcycle:"",motor_scooter:"",manual_wheelchair:"",motorized_wheelchair:"",auto_rickshaw:"",bike:"",kick_scooter:"",skateboard:"",roller_skate:"",busstop:"",motorway:"",railway_track:"",oil_drum:"",fuelpump:"",wheel:"",rotating_light:"",traffic_light:"",vertical_traffic_light:"",stop_sign:"",construction:"",anchor:"",ring_buoy:"",boat:"",sailboat:"",canoe:"",speedboat:"",passenger_ship:"",ferry:"",motor_boat:"",ship:"",airplane:"",small_airplane:"",flight_departure:"",flight_arrival:"",parachute:"",seat:"",helicopter:"",suspension_railway:"",mountain_cableway:"",aerial_tramway:"",artificial_satellite:"",rocket:"",flying_saucer:"",bellhop_bell:"",luggage:"",hourglass:"",hourglass_flowing_sand:"",watch:"",alarm_clock:"",stopwatch:"",timer_clock:"",mantelpiece_clock:"",clock12:"",clock1230:"",clock1:"",clock130:"",clock2:"",clock230:"",clock3:"",clock330:"",clock4:"",clock430:"",clock5:"",clock530:"",clock6:"",clock630:"",clock7:"",clock730:"",clock8:"",clock830:"",clock9:"",clock930:"",clock10:"",clock1030:"",clock11:"",clock1130:"",new_moon:"",waxing_crescent_moon:"",first_quarter_moon:"",moon:"",waxing_gibbous_moon:"",full_moon:"",waning_gibbous_moon:"",last_quarter_moon:"",waning_crescent_moon:"",crescent_moon:"",new_moon_with_face:"",first_quarter_moon_with_face:"",last_quarter_moon_with_face:"",thermometer:"",sunny:"",full_moon_with_face:"",sun_with_face:"",ringed_planet:"",star:"",star2:"",stars:"",milky_way:"",cloud:"",partly_sunny:"",cloud_with_lightning_and_rain:"",sun_behind_small_cloud:"",sun_behind_large_cloud:"",sun_behind_rain_cloud:"",cloud_with_rain:"",cloud_with_snow:"",cloud_with_lightning:"",tornado:"",fog:"",wind_face:"",cyclone:"",rainbow:"",closed_umbrella:"",open_umbrella:"",umbrella:"",parasol_on_ground:"",zap:"",snowflake:"",snowman_with_snow:"",snowman:"",comet:"",fire:"",droplet:"",ocean:"",jack_o_lantern:"",christmas_tree:"",fireworks:"",sparkler:"",firecracker:"",sparkles:"",balloon:"",tada:"",confetti_ball:"",tanabata_tree:"",bamboo:"",dolls:"",flags:"",wind_chime:"",rice_scene:"",red_envelope:"",ribbon:"",gift:"",reminder_ribbon:"",tickets:"",ticket:"",medal_military:"",trophy:"",medal_sports:"","1st_place_medal":"","2nd_place_medal":"","3rd_place_medal":"",soccer:"",baseball:"",softball:"",basketball:"",volleyball:"",football:"",rugby_football:"",tennis:"",flying_disc:"",bowling:"",cricket_game:"",field_hockey:"",ice_hockey:"",lacrosse:"",ping_pong:"",badminton:"",boxing_glove:"",martial_arts_uniform:"",goal_net:"",golf:"",ice_skate:"",fishing_pole_and_fish:"",diving_mask:"",running_shirt_with_sash:"",ski:"",sled:"",curling_stone:"",dart:"",yo_yo:"",kite:"",gun:"","8ball":"",crystal_ball:"",magic_wand:"",video_game:"",joystick:"",slot_machine:"",game_die:"",jigsaw:"",teddy_bear:"",pinata:"",mirror_ball:"",nesting_dolls:"",spades:"",hearts:"",diamonds:"",clubs:"",chess_pawn:"",black_joker:"",mahjong:"",flower_playing_cards:"",performing_arts:"",framed_picture:"",art:"",thread:"",sewing_needle:"",yarn:"",knot:"",eyeglasses:"",dark_sunglasses:"",goggles:"",lab_coat:"",safety_vest:"",necktie:"",shirt:"",tshirt:"",jeans:"",scarf:"",gloves:"",coat:"",socks:"",dress:"",kimono:"",sari:"",one_piece_swimsuit:"",swim_brief:"",shorts:"",bikini:"",womans_clothes:"",folding_hand_fan:"",purse:"",handbag:"",pouch:"",shopping:"",school_satchel:"",thong_sandal:"",mans_shoe:"",shoe:"",athletic_shoe:"",hiking_boot:"",flat_shoe:"",high_heel:"",sandal:"",ballet_shoes:"",boot:"",hair_pick:"",crown:"",womans_hat:"",tophat:"",mortar_board:"",billed_cap:"",military_helmet:"",rescue_worker_helmet:"",prayer_beads:"",lipstick:"",ring:"",gem:"",mute:"",speaker:"",sound:"",loud_sound:"",loudspeaker:"",mega:"",postal_horn:"",bell:"",no_bell:"",musical_score:"",musical_note:"",notes:"",studio_microphone:"",level_slider:"",control_knobs:"",microphone:"",headphones:"",radio:"",saxophone:"",accordion:"",guitar:"",musical_keyboard:"",trumpet:"",violin:"",banjo:"",drum:"",long_drum:"",maracas:"",flute:"",iphone:"",calling:"",phone:"",telephone:"",telephone_receiver:"",pager:"",fax:"",battery:"",low_battery:"",electric_plug:"",computer:"",desktop_computer:"",printer:"",keyboard:"",computer_mouse:"",trackball:"",minidisc:"",floppy_disk:"",cd:"",dvd:"",abacus:"",movie_camera:"",film_strip:"",film_projector:"",clapper:"",tv:"",camera:"",camera_flash:"",video_camera:"",vhs:"",mag:"",mag_right:"",candle:"",bulb:"",flashlight:"",izakaya_lantern:"",lantern:"",diya_lamp:"",notebook_with_decorative_cover:"",closed_book:"",book:"",open_book:"",green_book:"",blue_book:"",orange_book:"",books:"",notebook:"",ledger:"",page_with_curl:"",scroll:"",page_facing_up:"",newspaper:"",newspaper_roll:"",bookmark_tabs:"",bookmark:"",label:"",moneybag:"",coin:"",yen:"",dollar:"",euro:"",pound:"",money_with_wings:"",credit_card:"",receipt:"",chart:"",envelope:"",email:"","e-mail":"",incoming_envelope:"",envelope_with_arrow:"",outbox_tray:"",inbox_tray:"",package:"",mailbox:"",mailbox_closed:"",mailbox_with_mail:"",mailbox_with_no_mail:"",postbox:"",ballot_box:"",pencil2:"",black_nib:"",fountain_pen:"",pen:"",paintbrush:"",crayon:"",memo:"",pencil:"",briefcase:"",file_folder:"",open_file_folder:"",card_index_dividers:"",date:"",calendar:"",spiral_notepad:"",spiral_calendar:"",card_index:"",chart_with_upwards_trend:"",chart_with_downwards_trend:"",bar_chart:"",clipboard:"",pushpin:"",round_pushpin:"",paperclip:"",paperclips:"",straight_ruler:"",triangular_ruler:"",scissors:"",card_file_box:"",file_cabinet:"",wastebasket:"",lock:"",unlock:"",lock_with_ink_pen:"",closed_lock_with_key:"",key:"",old_key:"",hammer:"",axe:"",pick:"",hammer_and_pick:"",hammer_and_wrench:"",dagger:"",crossed_swords:"",bomb:"",boomerang:"",bow_and_arrow:"",shield:"",carpentry_saw:"",wrench:"",screwdriver:"",nut_and_bolt:"",gear:"",clamp:"",balance_scale:"",probing_cane:"",link:"",chains:"",hook:"",toolbox:"",magnet:"",ladder:"",alembic:"",test_tube:"",petri_dish:"",dna:"",microscope:"",telescope:"",satellite:"",syringe:"",drop_of_blood:"",pill:"",adhesive_bandage:"",crutch:"",stethoscope:"",x_ray:"",door:"",elevator:"",mirror:"",window:"",bed:"",couch_and_lamp:"",chair:"",toilet:"",plunger:"",shower:"",bathtub:"",mouse_trap:"",razor:"",lotion_bottle:"",safety_pin:"",broom:"",basket:"",roll_of_paper:"",bucket:"",soap:"",bubbles:"",toothbrush:"",sponge:"",fire_extinguisher:"",shopping_cart:"",smoking:"",coffin:"",headstone:"",funeral_urn:"",nazar_amulet:"",hamsa:"",moyai:"",placard:"",identification_card:"",atm:"",put_litter_in_its_place:"",potable_water:"",wheelchair:"",mens:"",womens:"",restroom:"",baby_symbol:"",wc:"",passport_control:"",customs:"",baggage_claim:"",left_luggage:"",warning:"",children_crossing:"",no_entry:"",no_entry_sign:"",no_bicycles:"",no_smoking:"",do_not_litter:"","non-potable_water":"",no_pedestrians:"",no_mobile_phones:"",underage:"",radioactive:"",biohazard:"",arrow_up:"",arrow_upper_right:"",arrow_right:"",arrow_lower_right:"",arrow_down:"",arrow_lower_left:"",arrow_left:"",arrow_upper_left:"",arrow_up_down:"",left_right_arrow:"",leftwards_arrow_with_hook:"",arrow_right_hook:"",arrow_heading_up:"",arrow_heading_down:"",arrows_clockwise:"",arrows_counterclockwise:"",back:"",end:"",on:"",soon:"",top:"",place_of_worship:"",atom_symbol:"",om:"",star_of_david:"",wheel_of_dharma:"",yin_yang:"",latin_cross:"",orthodox_cross:"",star_and_crescent:"",peace_symbol:"",menorah:"",six_pointed_star:"",khanda:"",aries:"",taurus:"",gemini:"",cancer:"",leo:"",virgo:"",libra:"",scorpius:"",sagittarius:"",capricorn:"",aquarius:"",pisces:"",ophiuchus:"",twisted_rightwards_arrows:"",repeat:"",repeat_one:"",arrow_forward:"",fast_forward:"",next_track_button:"",play_or_pause_button:"",arrow_backward:"",rewind:"",previous_track_button:"",arrow_up_small:"",arrow_double_up:"",arrow_down_small:"",arrow_double_down:"",pause_button:"",stop_button:"",record_button:"",eject_button:"",cinema:"",low_brightness:"",high_brightness:"",signal_strength:"",wireless:"",vibration_mode:"",mobile_phone_off:"",female_sign:"",male_sign:"",transgender_symbol:"",heavy_multiplication_x:"",heavy_plus_sign:"",heavy_minus_sign:"",heavy_division_sign:"",heavy_equals_sign:"",infinity:"",bangbang:"",interrobang:"",question:"",grey_question:"",grey_exclamation:"",exclamation:"",heavy_exclamation_mark:"",wavy_dash:"",currency_exchange:"",heavy_dollar_sign:"",medical_symbol:"",recycle:"",fleur_de_lis:"",trident:"",name_badge:"",beginner:"",o:"",white_check_mark:"",ballot_box_with_check:"",heavy_check_mark:"",x:"",negative_squared_cross_mark:"",curly_loop:"",loop:"",part_alternation_mark:"",eight_spoked_asterisk:"",eight_pointed_black_star:"",sparkle:"",copyright:"",registered:"",tm:"",hash:"#",asterisk:"*",zero:"0",one:"1",two:"2",three:"3",four:"4",five:"5",six:"6",seven:"7",eight:"8",nine:"9",keycap_ten:"",capital_abcd:"",abcd:"",symbols:"",abc:"",a:"",ab:"",b:"",cl:"",cool:"",free:"",information_source:"",id:"",m:"",new:"",ng:"",o2:"",ok:"",parking:"",sos:"",up:"",vs:"",koko:"",sa:"",u6708:"",u6709:"",u6307:"",ideograph_advantage:"",u5272:"",u7121:"",u7981:"",accept:"",u7533:"",u5408:"",u7a7a:"",congratulations:"",secret:"",u55b6:"",u6e80:"",red_circle:"",orange_circle:"",yellow_circle:"",green_circle:"",large_blue_circle:"",purple_circle:"",brown_circle:"",black_circle:"",white_circle:"",red_square:"",orange_square:"",yellow_square:"",green_square:"",blue_square:"",purple_square:"",brown_square:"",black_large_square:"",white_large_square:"",black_medium_square:"",white_medium_square:"",black_medium_small_square:"",white_medium_small_square:"",black_small_square:"",white_small_square:"",large_orange_diamond:"",large_blue_diamond:"",small_orange_diamond:"",small_blue_diamond:"",small_red_triangle:"",small_red_triangle_down:"",diamond_shape_with_a_dot_inside:"",radio_button:"",white_square_button:"",black_square_button:"",checkered_flag:"",triangular_flag_on_post:"",crossed_flags:"",black_flag:"",white_flag:"",rainbow_flag:"",transgender_flag:"",pirate_flag:"",ascension_island:"",andorra:"",united_arab_emirates:"",afghanistan:"",antigua_barbuda:"",anguilla:"",albania:"",armenia:"",angola:"",antarctica:"",argentina:"",american_samoa:"",austria:"",australia:"",aruba:"",aland_islands:"",azerbaijan:"",bosnia_herzegovina:"",barbados:"",bangladesh:"",belgium:"",burkina_faso:"",bulgaria:"",bahrain:"",burundi:"",benin:"",st_barthelemy:"",bermuda:"",brunei:"",bolivia:"",caribbean_netherlands:"",brazil:"",bahamas:"",bhutan:"",bouvet_island:"",botswana:"",belarus:"",belize:"",canada:"",cocos_islands:"",congo_kinshasa:"",central_african_republic:"",congo_brazzaville:"",switzerland:"",cote_divoire:"",cook_islands:"",chile:"",cameroon:"",cn:"",colombia:"",clipperton_island:"",costa_rica:"",cuba:"",cape_verde:"",curacao:"",christmas_island:"",cyprus:"",czech_republic:"",de:"",diego_garcia:"",djibouti:"",denmark:"",dominica:"",dominican_republic:"",algeria:"",ceuta_melilla:"",ecuador:"",estonia:"",egypt:"",western_sahara:"",eritrea:"",es:"",ethiopia:"",eu:"",european_union:"",finland:"",fiji:"",falkland_islands:"",micronesia:"",faroe_islands:"",fr:"",gabon:"",gb:"",uk:"",grenada:"",georgia:"",french_guiana:"",guernsey:"",ghana:"",gibraltar:"",greenland:"",gambia:"",guinea:"",guadeloupe:"",equatorial_guinea:"",greece:"",south_georgia_south_sandwich_islands:"",guatemala:"",guam:"",guinea_bissau:"",guyana:"",hong_kong:"",heard_mcdonald_islands:"",honduras:"",croatia:"",haiti:"",hungary:"",canary_islands:"",indonesia:"",ireland:"",israel:"",isle_of_man:"",india:"",british_indian_ocean_territory:"",iraq:"",iran:"",iceland:"",it:"",jersey:"",jamaica:"",jordan:"",jp:"",kenya:"",kyrgyzstan:"",cambodia:"",kiribati:"",comoros:"",st_kitts_nevis:"",north_korea:"",kr:"",kuwait:"",cayman_islands:"",kazakhstan:"",laos:"",lebanon:"",st_lucia:"",liechtenstein:"",sri_lanka:"",liberia:"",lesotho:"",lithuania:"",luxembourg:"",latvia:"",libya:"",morocco:"",monaco:"",moldova:"",montenegro:"",st_martin:"",madagascar:"",marshall_islands:"",macedonia:"",mali:"",myanmar:"",mongolia:"",macau:"",northern_mariana_islands:"",martinique:"",mauritania:"",montserrat:"",malta:"",mauritius:"",maldives:"",malawi:"",mexico:"",malaysia:"",mozambique:"",namibia:"",new_caledonia:"",niger:"",norfolk_island:"",nigeria:"",nicaragua:"",netherlands:"",norway:"",nepal:"",nauru:"",niue:"",new_zealand:"",oman:"",panama:"",peru:"",french_polynesia:"",papua_new_guinea:"",philippines:"",pakistan:"",poland:"",st_pierre_miquelon:"",pitcairn_islands:"",puerto_rico:"",palestinian_territories:"",portugal:"",palau:"",paraguay:"",qatar:"",reunion:"",romania:"",serbia:"",ru:"",rwanda:"",saudi_arabia:"",solomon_islands:"",seychelles:"",sudan:"",sweden:"",singapore:"",st_helena:"",slovenia:"",svalbard_jan_mayen:"",slovakia:"",sierra_leone:"",san_marino:"",senegal:"",somalia:"",suriname:"",south_sudan:"",sao_tome_principe:"",el_salvador:"",sint_maarten:"",syria:"",swaziland:"",tristan_da_cunha:"",turks_caicos_islands:"",chad:"",french_southern_territories:"",togo:"",thailand:"",tajikistan:"",tokelau:"",timor_leste:"",turkmenistan:"",tunisia:"",tonga:"",tr:"",trinidad_tobago:"",tuvalu:"",taiwan:"",tanzania:"",ukraine:"",uganda:"",us_outlying_islands:"",united_nations:"",us:"",uruguay:"",uzbekistan:"",vatican_city:"",st_vincent_grenadines:"",venezuela:"",british_virgin_islands:"",us_virgin_islands:"",vietnam:"",vanuatu:"",wallis_futuna:"",samoa:"",kosovo:"",yemen:"",mayotte:"",south_africa:"",zambia:"",zimbabwe:"",england:"",scotland:"",wales:""};Ht.use(Ks({emojis:eh,renderer:t=>t.emoji}));const th=()=>{const[t,a]=C(!1);return e(V,{children:e(yn,{children:e(Jn,{children:e(V,{children:[e(Sr,{onLoaded:a}),t&&e(wn,{children:e(ve,{path:"/",element:e(Xu,{}),children:e(ve,{path:"/",element:e(Ju,{})})})})]})})})})},ah=({displaySidebar:t,isMobile:a,headerSetup:n,accountIds:r})=>e("div",{className:I({"vm-header-controls":!0,"vm-header-controls_mobile":a}),children:[(n==null?void 0:n.tenant)&&e(es,{accountIds:r||[]}),(n==null?void 0:n.stepControl)&&e(ts,{}),(n==null?void 0:n.timeSelector)&&e(er,{}),(n==null?void 0:n.cardinalityDatePicker)&&e(ns,{}),(n==null?void 0:n.executionControls)&&e(tr,{}),e(ar,{}),!t&&e(Zo,{})]}),nh=()=>{const t=ye(),{isMobile:a}=J(),{pathname:n}=it(),[r,o]=ie();nr();const s=()=>{var m;const c="vmui for vmanomaly",l=(m=lt[n])==null?void 0:m.title;document.title=l?`${l} - ${c}`:c},i=()=>{const{search:c,href:l}=window.location;if(c){const d=gn.parse(c,{ignoreQueryPrefix:!0});Object.entries(d).forEach(([u,h])=>r.set(u,h)),o(r),window.location.search=""}const m=l.replace(/\/\?#\//,"/#/");m!==l&&window.location.replace(m)};return x(s,[n]),x(i,[]),e("section",{className:"vm-container",children:[e(Zn,{controlsComponent:ah}),e("div",{className:I({"vm-container-body":!0,"vm-container-body_mobile":a,"vm-container-body_app":t}),children:e(bn,{})}),!t&&e(Xn,{})]})},rh=1,oh=()=>{ir();const{isMobile:t}=J(),{query:a}=ke(),{customStep:n}=Ve(),r=Y(null),[o]=C([]),[s,i]=C(!a[0]),[c,l]=C(!1),{isLoading:m,graphData:d,error:u,queryErrors:h,setQueryErrors:v,queryStats:_,warning:f}=za({visible:!0,customStep:n,hideQuery:o,showAllSeries:c}),p=D(()=>{if(!d)return[];const b=d.map(N=>({...us(N.metric),...N})),y=b.filter(N=>N.value===ae.actual),w=b.filter(N=>N.value===ae.anomaly),T=y.map(N=>{const k=hn(N.metric),A=w.find(L=>hn(L.metric)===k);return{group:1,metric:{...N.metric,__name__:ae.anomaly},values:N.values.filter(([L])=>{if(!A)return!1;const E=A.values.find(([M])=>M===L);return E&&ea(E[1])>rh})}});return b.filter(N=>N.value!==ae.anomaly&&N.value).concat(T)},[d]),g=()=>{i(!1)};return e("div",{className:I({"vm-custom-panel":!0,"vm-custom-panel_mobile":t}),children:[e(or,{queryErrors:s?[]:h,setQueryErrors:v,setHideError:i,stats:_,onRunQuery:g,hideButtons:{addQuery:!0,prettify:!1,autocomplete:!1,traceQuery:!0,anomalyConfig:!0,reduceMemUsage:!0}}),m&&e(qe,{}),!s&&u&&e(se,{variant:"error",children:u}),f&&e(Ha,{warning:f,query:a,onChange:l}),e("div",{className:I({"vm-custom-panel-body":!0,"vm-custom-panel-body_mobile":t,"vm-block":!0,"vm-block_mobile":t}),children:[e("div",{className:"vm-custom-panel-body-header",ref:r,children:e("div",{})}),p&&e(Ns,{graphData:p,isHistogram:!1,controlsRef:r,isAnomalyView:!0})]})]})},sh=()=>{const[t,a]=C(!1);return e(V,{children:e(yn,{children:e(Jn,{children:e(V,{children:[e(Sr,{onLoaded:a}),t&&e(wn,{children:e(ve,{path:"/",element:e(nh,{}),children:[e(ve,{path:"/",element:e(oh,{})}),e(ve,{path:K.query,element:e(Es,{})})]})})]})})})})},ih=()=>{switch(Ut){case ot.victorialogs:return e(th,{});case ot.vmanomaly:return e(sh,{});default:return e(Ym,{})}},lo=document.getElementById("root");lo&&Zs(ih(),lo);
