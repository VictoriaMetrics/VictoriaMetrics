var zi=Object.defineProperty;var Hi=(t,n,r)=>n in t?zi(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r;var we=(t,n,r)=>Hi(t,typeof n!="symbol"?n+"":n,r);import{d as U,t as Vi,a as qi,u as Ui,r as Bi,q as Fr,g as st,K as yt,h as Et,T as M,b as e,x as $e,N as Yo,c as I,A as q,y as A,e as N,k as V,f as W,i as qn,j as ht,$ as pt,M as zr,D as Un,I as ji,l as oe,F as Hr,O as Vr,m as ln,n as Bt,o as jt,_ as Qi,L as Bn,H as qr,R as Ur,p as fe,s as jn,v as Yi,w as Gi,z as Wi,B as Ji}from"./vendor-V4vnRsM-.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function r(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(o){if(o.ep)return;o.ep=!0;const s=r(o);fetch(o.href,s)}})();U.extend(Vi);U.extend(qi);U.extend(Ui);U.extend(Bi);var dt=(t=>(t.victoriametrics="victoriametrics",t.victorialogs="victorialogs",t.vmanomaly="vmanomaly",t))(dt||{});const Qt="victorialogs",Ki=Qt==="victorialogs",Zi=Qt==="vmanomaly",Z={home:"/",metrics:"/metrics",dashboards:"/dashboards",cardinality:"/cardinality",topQueries:"/top-queries",trace:"/trace",withTemplate:"/expand-with-exprs",relabel:"/relabeling",logs:"/logs",activeQueries:"/active-queries",queryAnalyzer:"/query-analyzer",icons:"/icons",anomaly:"/anomaly",query:"/query",rawQuery:"/raw-query",downsamplingDebug:"/downsampling-filters-debug",retentionDebug:"/retention-filters-debug"},Kt={header:{tenant:!0,stepControl:!1,timeSelector:!1,executionControls:!1}},gt={[Z.home]:{title:"Query",...Kt},[Z.rawQuery]:{title:"Raw query",...Kt},[Z.metrics]:{title:"Explore Prometheus metrics",header:{tenant:!0,stepControl:!0,timeSelector:!0}},[Z.cardinality]:{title:"Explore cardinality",header:{tenant:!0,cardinalityDatePicker:!0}},[Z.topQueries]:{title:"Top queries",header:{tenant:!0}},[Z.trace]:{title:"Trace analyzer",header:{}},[Z.queryAnalyzer]:{title:"Query analyzer",header:{}},[Z.dashboards]:{title:"Dashboards",...Kt},[Z.withTemplate]:{title:"WITH templates",header:{}},[Z.relabel]:{title:"Metric relabel debug",header:{}},[Z.logs]:{title:"Logs Explorer",header:{}},[Z.activeQueries]:{title:"Active Queries",header:{}},[Z.icons]:{title:"Icons",header:{}},[Z.anomaly]:{title:"Anomaly exploration",...Kt},[Z.query]:{title:"Query",...Kt},[Z.downsamplingDebug]:{title:"Downsampling filters debug",header:{}},[Z.retentionDebug]:{title:"Retention filters debug",header:{}}},cn=()=>{var n;const t=((n=document.getElementById("root"))==null?void 0:n.dataset.params)||"{}";try{return JSON.parse(t)}catch(r){return console.error(r),{}}},Ee=()=>!!Object.keys(cn()).length,Go=/(\/select\/)(\d+|\d.+)(\/)(.+)/,Wo=(t,n)=>t.replace(Go,`$1${n}/$4`),dn=t=>{var n;return((n=t.match(Go))==null?void 0:n[2])||""},Le=(t,n)=>{n?window.localStorage.setItem(t,JSON.stringify({value:n})):Br([t]),window.dispatchEvent(new Event("storage"))},Ae=t=>{var r;const n=window.localStorage.getItem(t);if(n!==null)try{return(r=JSON.parse(n))==null?void 0:r.value}catch{return n}},Br=t=>t.forEach(n=>window.localStorage.removeItem(n)),Xi=t=>{const{serverURL:n}=cn(),r=Ae("SERVER_URL"),a=window.location.href.replace(/(\/(select\/)?vmui\/.*|\/#\/.*)/,""),o=`${window.location.origin}${window.location.pathname.replace(/^\/vmui/,"")}`,s=window.location.href.replace(/\/(?:prometheus\/)?(?:graph|vmui)\/.*/,"/prometheus"),i=n||r||s;switch(Qt){case dt.victorialogs:return a;case dt.vmanomaly:return r||o;default:return t?Wo(i,t):i}},In=10,Jo=25,Ko={table:100,chart:20,code:1e3},Pn=[{id:"small",isDefault:!0,height:()=>window.innerHeight*.2},{id:"medium",height:()=>window.innerHeight*.4},{id:"large",height:()=>window.innerHeight*.8}],jr=["min","median","max"],ze=(t,n)=>{const r=window.location.hash.split("?")[1],a=Fr.parse(r,{ignoreQueryPrefix:!0});return st(a,t,n||"")},Zo=()=>{var r;const n=((r=(window.location.hash.split("?")[1]||"").match(/g\d+\.expr/g))==null?void 0:r.length)||1;return new Array(n>In?In:n).fill(1).map((a,o)=>ze(`g${o}.expr`,""))};var ne=(t=>(t.yhat="yhat",t.yhatUpper="yhat_upper",t.yhatLower="yhat_lower",t.anomaly="vmui_anomalies_points",t.training="vmui_training_data",t.actual="actual",t.anomalyScore="anomaly_score",t))(ne||{}),Ne=(t=>(t.table="table",t.chart="chart",t.code="code",t))(Ne||{}),Ce=(t=>(t.emptyServer="Please enter Server URL",t.validServer="Please provide a valid Server URL",t.validQuery="Please enter a valid Query and execute it",t.traceNotFound="Not found the tracing information",t.emptyTitle="Please enter title",t.positiveNumber="Please enter positive number",t.validStep="Please enter a valid step",t.unknownType="Unknown server response format: must have 'errorType'",t))(Ce||{}),Ge=(t=>(t.system="system",t.light="light",t.dark="dark",t))(Ge||{}),Oe=(t=>(t.empty="empty",t.metricsql="metricsql",t.label="label",t.labelValue="labelValue",t))(Oe||{});const tt=t=>getComputedStyle(document.documentElement).getPropertyValue(`--${t}`),Rt=(t,n)=>{document.documentElement.style.setProperty(`--${t}`,n)},Dn=()=>window.matchMedia("(prefers-color-scheme: dark)").matches,el=t=>t===Ge.system&&Dn()||t===Ge.dark,Qr=t=>{let n;try{n=new URL(t)}catch{return!1}return n.protocol==="http:"||n.protocol==="https:"},Xo=t=>t.replace(/\/$/,""),tl=(t,n)=>{if(Array.from(t.entries()).length!==Array.from(n.entries()).length)return!1;for(const[r,a]of t)if(n.get(r)!==a)return!1;return!0},nl=t=>{try{const n=t.match(/\/api\/v1\/[^?]+/);return n?n[0]:null}catch(n){return console.error("Invalid URL:",n),null}},to=ze("g0.tenantID",""),rl={serverUrl:Xo(Xi(to)),tenantId:to,theme:Ae("THEME")||Ge.system,isDarkTheme:null,flags:{},appConfig:{}};function al(t,n){switch(n.type){case"SET_SERVER":return{...t,serverUrl:Xo(n.payload)};case"SET_TENANT_ID":return{...t,tenantId:n.payload};case"SET_THEME":return Le("THEME",n.payload),{...t,theme:n.payload};case"SET_DARK_THEME":return{...t,isDarkTheme:el(t.theme)};case"SET_FLAGS":return{...t,flags:n.payload};case"SET_APP_CONFIG":return{...t,appConfig:n.payload};default:throw new Error}}const Yr=yt({}),se=()=>$e(Yr).state,xt=()=>$e(Yr).dispatch,ol=Object.entries(rl).reduce((t,[n,r])=>({...t,[n]:ze(n)||r}),{}),sl=({children:t})=>{const[n,r]=Et(al,ol),a=M(()=>({state:n,dispatch:r}),[n,r]);return e(Yr.Provider,{value:a,children:t})},kt="YYYY-MM-DD",qe="YYYY-MM-DD HH:mm:ss",On="YYYY-MM-DD HH:mm:ss:SSS (Z)",Gr="YYYY-MM-DD[T]HH:mm:ss",Wr="YYYY-MM-DD_HHmmss",il=["Africa/Abidjan","Africa/Accra","Africa/Addis_Ababa","Africa/Algiers","Africa/Asmera","Africa/Bamako","Africa/Bangui","Africa/Banjul","Africa/Bissau","Africa/Blantyre","Africa/Brazzaville","Africa/Bujumbura","Africa/Cairo","Africa/Casablanca","Africa/Ceuta","Africa/Conakry","Africa/Dakar","Africa/Dar_es_Salaam","Africa/Djibouti","Africa/Douala","Africa/El_Aaiun","Africa/Freetown","Africa/Gaborone","Africa/Harare","Africa/Johannesburg","Africa/Juba","Africa/Kampala","Africa/Khartoum","Africa/Kigali","Africa/Kinshasa","Africa/Lagos","Africa/Libreville","Africa/Lome","Africa/Luanda","Africa/Lubumbashi","Africa/Lusaka","Africa/Malabo","Africa/Maputo","Africa/Maseru","Africa/Mbabane","Africa/Mogadishu","Africa/Monrovia","Africa/Nairobi","Africa/Ndjamena","Africa/Niamey","Africa/Nouakchott","Africa/Ouagadougou","Africa/Porto-Novo","Africa/Sao_Tome","Africa/Tripoli","Africa/Tunis","Africa/Windhoek","America/Adak","America/Anchorage","America/Anguilla","America/Antigua","America/Araguaina","America/Argentina/La_Rioja","America/Argentina/Rio_Gallegos","America/Argentina/Salta","America/Argentina/San_Juan","America/Argentina/San_Luis","America/Argentina/Tucuman","America/Argentina/Ushuaia","America/Aruba","America/Asuncion","America/Bahia","America/Bahia_Banderas","America/Barbados","America/Belem","America/Belize","America/Blanc-Sablon","America/Boa_Vista","America/Bogota","America/Boise","America/Buenos_Aires","America/Cambridge_Bay","America/Campo_Grande","America/Cancun","America/Caracas","America/Catamarca","America/Cayenne","America/Cayman","America/Chicago","America/Chihuahua","America/Coral_Harbour","America/Cordoba","America/Costa_Rica","America/Creston","America/Cuiaba","America/Curacao","America/Danmarkshavn","America/Dawson","America/Dawson_Creek","America/Denver","America/Detroit","America/Dominica","America/Edmonton","America/Eirunepe","America/El_Salvador","America/Fort_Nelson","America/Fortaleza","America/Glace_Bay","America/Godthab","America/Goose_Bay","America/Grand_Turk","America/Grenada","America/Guadeloupe","America/Guatemala","America/Guayaquil","America/Guyana","America/Halifax","America/Havana","America/Hermosillo","America/Indiana/Knox","America/Indiana/Marengo","America/Indiana/Petersburg","America/Indiana/Tell_City","America/Indiana/Vevay","America/Indiana/Vincennes","America/Indiana/Winamac","America/Indianapolis","America/Inuvik","America/Iqaluit","America/Jamaica","America/Jujuy","America/Juneau","America/Kentucky/Monticello","America/Kralendijk","America/La_Paz","America/Lima","America/Los_Angeles","America/Louisville","America/Lower_Princes","America/Maceio","America/Managua","America/Manaus","America/Marigot","America/Martinique","America/Matamoros","America/Mazatlan","America/Mendoza","America/Menominee","America/Merida","America/Metlakatla","America/Mexico_City","America/Miquelon","America/Moncton","America/Monterrey","America/Montevideo","America/Montreal","America/Montserrat","America/Nassau","America/New_York","America/Nipigon","America/Nome","America/Noronha","America/North_Dakota/Beulah","America/North_Dakota/Center","America/North_Dakota/New_Salem","America/Ojinaga","America/Panama","America/Pangnirtung","America/Paramaribo","America/Phoenix","America/Port-au-Prince","America/Port_of_Spain","America/Porto_Velho","America/Puerto_Rico","America/Punta_Arenas","America/Rainy_River","America/Rankin_Inlet","America/Recife","America/Regina","America/Resolute","America/Rio_Branco","America/Santa_Isabel","America/Santarem","America/Santiago","America/Santo_Domingo","America/Sao_Paulo","America/Scoresbysund","America/Sitka","America/St_Barthelemy","America/St_Johns","America/St_Kitts","America/St_Lucia","America/St_Thomas","America/St_Vincent","America/Swift_Current","America/Tegucigalpa","America/Thule","America/Thunder_Bay","America/Tijuana","America/Toronto","America/Tortola","America/Vancouver","America/Whitehorse","America/Winnipeg","America/Yakutat","America/Yellowknife","Antarctica/Casey","Antarctica/Davis","Antarctica/DumontDUrville","Antarctica/Macquarie","Antarctica/Mawson","Antarctica/McMurdo","Antarctica/Palmer","Antarctica/Rothera","Antarctica/Syowa","Antarctica/Troll","Antarctica/Vostok","Arctic/Longyearbyen","Asia/Aden","Asia/Almaty","Asia/Amman","Asia/Anadyr","Asia/Aqtau","Asia/Aqtobe","Asia/Ashgabat","Asia/Atyrau","Asia/Baghdad","Asia/Bahrain","Asia/Baku","Asia/Bangkok","Asia/Barnaul","Asia/Beirut","Asia/Bishkek","Asia/Brunei","Asia/Calcutta","Asia/Chita","Asia/Choibalsan","Asia/Colombo","Asia/Damascus","Asia/Dhaka","Asia/Dili","Asia/Dubai","Asia/Dushanbe","Asia/Famagusta","Asia/Gaza","Asia/Hebron","Asia/Hong_Kong","Asia/Hovd","Asia/Irkutsk","Asia/Jakarta","Asia/Jayapura","Asia/Jerusalem","Asia/Kabul","Asia/Kamchatka","Asia/Karachi","Asia/Katmandu","Asia/Khandyga","Asia/Krasnoyarsk","Asia/Kuala_Lumpur","Asia/Kuching","Asia/Kuwait","Asia/Macau","Asia/Magadan","Asia/Makassar","Asia/Manila","Asia/Muscat","Asia/Nicosia","Asia/Novokuznetsk","Asia/Novosibirsk","Asia/Omsk","Asia/Oral","Asia/Phnom_Penh","Asia/Pontianak","Asia/Pyongyang","Asia/Qatar","Asia/Qostanay","Asia/Qyzylorda","Asia/Rangoon","Asia/Riyadh","Asia/Saigon","Asia/Sakhalin","Asia/Samarkand","Asia/Seoul","Asia/Shanghai","Asia/Singapore","Asia/Srednekolymsk","Asia/Taipei","Asia/Tashkent","Asia/Tbilisi","Asia/Tehran","Asia/Thimphu","Asia/Tokyo","Asia/Tomsk","Asia/Ulaanbaatar","Asia/Urumqi","Asia/Ust-Nera","Asia/Vientiane","Asia/Vladivostok","Asia/Yakutsk","Asia/Yekaterinburg","Asia/Yerevan","Atlantic/Azores","Atlantic/Bermuda","Atlantic/Canary","Atlantic/Cape_Verde","Atlantic/Faeroe","Atlantic/Madeira","Atlantic/Reykjavik","Atlantic/South_Georgia","Atlantic/St_Helena","Atlantic/Stanley","Australia/Adelaide","Australia/Brisbane","Australia/Broken_Hill","Australia/Currie","Australia/Darwin","Australia/Eucla","Australia/Hobart","Australia/Lindeman","Australia/Lord_Howe","Australia/Melbourne","Australia/Perth","Australia/Sydney","Europe/Amsterdam","Europe/Andorra","Europe/Astrakhan","Europe/Athens","Europe/Belgrade","Europe/Berlin","Europe/Bratislava","Europe/Brussels","Europe/Bucharest","Europe/Budapest","Europe/Busingen","Europe/Chisinau","Europe/Copenhagen","Europe/Dublin","Europe/Gibraltar","Europe/Guernsey","Europe/Helsinki","Europe/Isle_of_Man","Europe/Istanbul","Europe/Jersey","Europe/Kaliningrad","Europe/Kiev","Europe/Kirov","Europe/Lisbon","Europe/Ljubljana","Europe/London","Europe/Luxembourg","Europe/Madrid","Europe/Malta","Europe/Mariehamn","Europe/Minsk","Europe/Monaco","Europe/Moscow","Europe/Oslo","Europe/Paris","Europe/Podgorica","Europe/Prague","Europe/Riga","Europe/Rome","Europe/Samara","Europe/San_Marino","Europe/Sarajevo","Europe/Saratov","Europe/Simferopol","Europe/Skopje","Europe/Sofia","Europe/Stockholm","Europe/Tallinn","Europe/Tirane","Europe/Ulyanovsk","Europe/Uzhgorod","Europe/Vaduz","Europe/Vatican","Europe/Vienna","Europe/Vilnius","Europe/Volgograd","Europe/Warsaw","Europe/Zagreb","Europe/Zaporozhye","Europe/Zurich","Indian/Antananarivo","Indian/Chagos","Indian/Christmas","Indian/Cocos","Indian/Comoro","Indian/Kerguelen","Indian/Mahe","Indian/Maldives","Indian/Mauritius","Indian/Mayotte","Indian/Reunion","Pacific/Apia","Pacific/Auckland","Pacific/Bougainville","Pacific/Chatham","Pacific/Easter","Pacific/Efate","Pacific/Enderbury","Pacific/Fakaofo","Pacific/Fiji","Pacific/Funafuti","Pacific/Galapagos","Pacific/Gambier","Pacific/Guadalcanal","Pacific/Guam","Pacific/Honolulu","Pacific/Johnston","Pacific/Kiritimati","Pacific/Kosrae","Pacific/Kwajalein","Pacific/Majuro","Pacific/Marquesas","Pacific/Midway","Pacific/Nauru","Pacific/Niue","Pacific/Norfolk","Pacific/Noumea","Pacific/Pago_Pago","Pacific/Palau","Pacific/Pitcairn","Pacific/Ponape","Pacific/Port_Moresby","Pacific/Rarotonga","Pacific/Saipan","Pacific/Tahiti","Pacific/Tarawa","Pacific/Tongatapu","Pacific/Truk","Pacific/Wake","Pacific/Wallis"],ll=window.innerWidth/4,cl=window.innerWidth/40,no={min:1,max:1578e8},ro=Intl.supportedValuesOf,dl=ro?ro("timeZone"):il,Jr=[{long:"years",short:"y",possible:"year"},{long:"weeks",short:"w",possible:"week"},{long:"days",short:"d",possible:"day"},{long:"hours",short:"h",possible:"hour"},{long:"minutes",short:"m",possible:"min"},{long:"seconds",short:"s",possible:"sec"},{long:"milliseconds",short:"ms",possible:"millisecond"}],ml=Jr.map(t=>t.short),xn=t=>Math.round(t*1e3)/1e3,Kr=t=>Qn(U.duration(t,"seconds").asMilliseconds()),Er=t=>{let n=xn(t);const r=Math.round(t);return t>=100&&(n=r-r%10),t<100&&t>=10&&(n=r-r%5),t<10&&t>=1&&(n=r),t<1&&t>.01&&(n=Math.round(t*40)/40),Kr(n||.001).replace(/\s/g,"")},es=t=>{const n=t.match(/\d+/g),r=t.match(/[a-zA-Z]+/g);if(r&&n&&ml.includes(r[0]))return{[r[0]]:n[0]}},Zr=t=>{const n=Jr.map(s=>s.short).join("|"),r=new RegExp(`\\d+(\\.\\d+)?[${n}]+`,"g"),o=(t.match(r)||[]).reduce((s,i)=>{const l=es(i);return l?{...s,...l}:{...s}},{});return U.duration(o).asSeconds()},ul=[Ne.table,Ne.code],mn=(t,n,r)=>r&&ul.includes(r)?Er(t):Er(t/(n?cl:ll)),Nt=(t,n)=>{const r=(n||U().toDate()).valueOf()/1e3,a=Zr(t);return{start:r-a,end:r,step:mn(a),date:ts(n||U().toDate())}},hl=t=>U(t).utcOffset(0,!0).toDate(),ts=t=>U.tz(t).utc().format(Gr),Ft=t=>U.tz(t).format(Gr),pl=()=>U().utc().format(Gr),Qn=t=>{const n=Math.floor(t%1e3),r=Math.floor(t/1e3%60),a=Math.floor(t/1e3/60%60),o=Math.floor(t/1e3/3600%24),s=Math.floor(t/(1e3*60*60*24)),i=["d","h","m","s","ms"];return[s,o,a,r,n].map((c,d)=>c?`${c}${i[d]}`:"").filter(c=>c).join("")},gl=t=>{const n=t.to.valueOf()-t.from.valueOf();return Qn(n)},We=t=>{const n=U(t*1e3);return n.isValid()?n.toDate():new Date},vl=()=>U().tz().subtract(1,"day").endOf("day").toDate(),fl=()=>U().tz().endOf("day").toDate(),nn=[{title:"Last 5 minutes",duration:"5m",isDefault:Ki},{title:"Last 15 minutes",duration:"15m"},{title:"Last 30 minutes",duration:"30m",isDefault:!1},{title:"Last 1 hour",duration:"1h"},{title:"Last 3 hours",duration:"3h"},{title:"Last 6 hours",duration:"6h"},{title:"Last 12 hours",duration:"12h"},{title:"Last 24 hours",duration:"24h"},{title:"Last 2 days",duration:"2d"},{title:"Last 7 days",duration:"7d"},{title:"Last 30 days",duration:"30d"},{title:"Last 90 days",duration:"90d"},{title:"Last 180 days",duration:"180d"},{title:"Last 1 year",duration:"1y"},{title:"Yesterday",duration:"1d",until:vl},{title:"Today",duration:"1d",until:fl}].map(t=>({id:t.title.replace(/\s/g,"_").toLocaleLowerCase(),until:t.until?t.until:()=>U().tz().toDate(),...t})),Xr=({relativeTimeId:t,defaultDuration:n,defaultEndInput:r})=>{var i;const a=(i=nn.find(l=>l.isDefault))==null?void 0:i.id,o=t||ze("g0.relative_time",a),s=nn.find(l=>l.id===o);return{relativeTimeId:s?o:"none",duration:s?s.duration:n,endInput:s?s.until():r}},en=t=>`UTC${U().tz(t).format("Z")}`,ao=(t="")=>{const n=new RegExp(t,"i");return dl.reduce((r,a)=>{const o=(a.match(/^(.*?)\//)||[])[1]||"unknown",s=en(a),i=s.replace(/UTC|0/,""),l=a.replace(/[/_]/g," "),c={region:a,utc:s,search:`${a} ${s} ${l} ${i}`},d=!t||t&&n.test(c.search);return d&&r[o]?r[o].push(c):d&&(r[o]=[c]),r},{})},ns=t=>{U.tz.setDefault(t)},_l=t=>{try{return U().tz(t),!0}catch{return!1}},rs=()=>{const t=U.tz.guess(),n=_l(t);return{isValid:n,title:n?`Browser Time (${t})`:"Browser timezone (UTC)",region:n?t:"UTC"}},oo=t=>{if(!t)return 0n;const n=U(t).valueOf();if(!t.includes("."))return BigInt(n)*1000000n;const r=t.match(/\.(\d+)Z/);if(!r)return BigInt(n)*1000000n;let a=r[1];a=a.padEnd(9,"0");const o=parseInt(a.slice(3),10);return BigInt(n)*1000000n+BigInt(o)},as=Ae("TIMEZONE")||rs().region;ns(as);const os=()=>{const t=ze("g0.range_input"),{duration:n,endInput:r,relativeTimeId:a}=Xr({defaultDuration:t||"1h",defaultEndInput:hl(ze("g0.end_input",pl())),relativeTimeId:t?ze("g0.relative_time","none"):void 0});return{duration:n,period:Nt(n,r),relativeTime:a}},bl={...os(),timezone:as};function yl(t,n){switch(n.type){case"SET_TIME_STATE":return{...t,...n.payload};case"SET_DURATION":return{...t,duration:n.payload,period:Nt(n.payload,We(t.period.end)),relativeTime:"none"};case"SET_RELATIVE_TIME":return{...t,duration:n.payload.duration,period:Nt(n.payload.duration,n.payload.until),relativeTime:n.payload.id};case"SET_PERIOD":const r=gl(n.payload);return{...t,duration:r,period:Nt(r,n.payload.to),relativeTime:"none"};case"RUN_QUERY":const{duration:a,endInput:o}=Xr({relativeTimeId:t.relativeTime,defaultDuration:t.duration,defaultEndInput:We(t.period.end)});return{...t,period:Nt(a,o)};case"RUN_QUERY_TO_NOW":return{...t,period:Nt(t.duration)};case"SET_TIMEZONE":return ns(n.payload),Le("TIMEZONE",n.payload),t.defaultTimezone&&Le("DISABLED_DEFAULT_TIMEZONE",n.payload!==t.defaultTimezone),{...t,timezone:n.payload};case"SET_DEFAULT_TIMEZONE":return{...t,defaultTimezone:n.payload};default:throw new Error}}const ea=yt({}),ge=()=>$e(ea).state,Be=()=>$e(ea).dispatch,wl=({children:t})=>{const[n,r]=Et(yl,bl),a=M(()=>({state:n,dispatch:r}),[n,r]);return e(ea.Provider,{value:a,children:t})},Yn=t=>{const n=Ae(t);return n?JSON.parse(n):{}},ss=(t,n,r)=>{const a=Yn(t);Le(t,JSON.stringify({...a,[n]:r}))},Zt=(t,n)=>Yn(t)[n]||[],Cl=(t,n)=>{const r=n.map(c=>c.values[c.index]),a=Yn(t),o=a.QUERY_HISTORY||[];o[0]||(o[0]=[]);const s=o[0],i=Jo*In;r.forEach(c=>{!s.includes(c)&&c&&s.unshift(c),s.length>i&&s.pop()});const l={...a,QUERY_HISTORY:[s]};Le(t,JSON.stringify(l))},Nl=(t,n)=>{ss(t,"QUERY_FAVORITES",n)},Sl=(t,n)=>{const r=Yn(t);Le(t,JSON.stringify({...r,[n]:[]}))},is=(t,n)=>{const r=n||{values:[]},a=t===r.values[r.values.length-1],o=!a&&t?[...r.values,t]:r.values;return o.length>Jo&&o.shift(),{index:r.values.length-Number(a),values:o}},kl=()=>{const t=n=>{const r=Ae(n);if(r){const a=JSON.parse(r);ss("METRICS_QUERY_HISTORY",n,a),Br([n])}};t("QUERY_HISTORY"),t("QUERY_FAVORITES")};kl();const Tt={displayResults:50,queryLimit:1e3,cacheLimit:1e3};class Tl{constructor(){we(this,"maxSize");we(this,"map");this.maxSize=Tt.cacheLimit,this.map=new Map}get(n){for(const[r,a]of this.map){const o=JSON.parse(r),s=o.start===n.start&&o.end===n.end,i=o.type===n.type,l=n.value&&o.value&&n.value.includes(o.value),c=o.match===n.match||l,d=a.length<Tt.queryLimit;if(c&&s&&i&&d)return a}return this.map.get(JSON.stringify(n))}put(n,r){if(this.map.size>=this.maxSize){const a=this.map.keys().next().value;a&&this.map.delete(a)}this.map.set(JSON.stringify(n),r)}}const so=Zo(),Ll={query:so,queryHistory:so.map(t=>({index:0,values:[t]})),autocomplete:Ae("AUTOCOMPLETE")||!1,autocompleteQuick:!1,autocompleteCache:new Tl,metricsQLFunctions:[]};function Al(t,n){switch(n.type){case"SET_QUERY":return{...t,query:n.payload.map(r=>r)};case"SET_QUERY_HISTORY":return Cl(n.payload.key,n.payload.history),{...t,queryHistory:n.payload.history};case"SET_QUERY_HISTORY_BY_INDEX":return t.queryHistory.splice(n.payload.queryNumber,1,n.payload.value),{...t,queryHistory:t.queryHistory};case"TOGGLE_AUTOCOMPLETE":return Le("AUTOCOMPLETE",!t.autocomplete),{...t,autocomplete:!t.autocomplete};case"SET_AUTOCOMPLETE_QUICK":return{...t,autocompleteQuick:n.payload};case"SET_AUTOCOMPLETE_CACHE":return t.autocompleteCache.put(n.payload.key,n.payload.value),{...t};case"SET_METRICSQL_FUNCTIONS":return{...t,metricsQLFunctions:n.payload};default:throw new Error}}const ta=yt({}),xe=()=>$e(ta).state,Mt=()=>$e(ta).dispatch,El=({children:t})=>{const[n,r]=Et(Al,Ll),a=M(()=>({state:n,dispatch:r}),[n,r]);return e(ta.Provider,{value:a,children:t})},ls=()=>e("svg",{viewBox:"0 0 74 24",fill:"currentColor",children:e("path",{d:"M6.12 10.48c.36.28.8.43 1.26.43h.05c.48 0 .96-.19 1.25-.44 1.5-1.28 5.88-5.29 5.88-5.29C15.73 4.1 12.46 3.01 7.43 3h-.06C2.33 3-.93 4.1.24 5.18c0 0 4.37 4 5.88 5.3Zm2.56 2.16c-.36.28-.8.44-1.26.45h-.04c-.46 0-.9-.17-1.26-.45-1.04-.88-4.74-4.22-6.12-5.5v1.94c0 .21.08.5.22.63l.07.06c1.05.96 4.55 4.16 5.83 5.25.36.28.8.43 1.26.44h.04c.49-.02.96-.2 1.26-.44 1.3-1.11 4.94-4.45 5.88-5.31.15-.14.23-.42.23-.63V7.15a454.94 454.94 0 0 1-6.11 5.5Zm-1.26 4.99c.46 0 .9-.16 1.26-.44a454.4 454.4 0 0 0 6.1-5.5v1.94c0 .2-.07.48-.22.62-.94.87-4.57 4.2-5.88 5.3-.3.26-.77.44-1.26.45h-.04c-.46 0-.9-.16-1.26-.44-1.2-1.02-4.38-3.92-5.62-5.06l-.28-.25c-.14-.14-.22-.42-.22-.62v-1.94c1.38 1.26 5.08 4.6 6.12 5.5.36.28.8.43 1.26.44h.04ZM35 5l-5.84 14.46h-2.43L20.89 5h2.16a.9.9 0 0 1 .9.61l3.41 8.82a18.8 18.8 0 0 1 .62 2.02 19.44 19.44 0 0 1 .57-2.02l3.39-8.82c.05-.15.16-.3.31-.42a.9.9 0 0 1 .58-.19H35Zm17.18 0v14.46H49.8v-9.34c0-.37.02-.78.06-1.21l-4.37 8.21c-.21.4-.53.59-.95.59h-.38c-.43 0-.75-.2-.95-.59L38.8 8.88a22.96 22.96 0 0 1 .07 1.24v9.34H36.5V5h2.03l.3.01c.1 0 .17.02.24.05.07.03.13.07.19.13a1 1 0 0 1 .17.24l4.33 8.03a16.97 16.97 0 0 1 .6 1.36 14.34 14.34 0 0 1 .6-1.38l4.28-8.01c.05-.1.1-.18.17-.24.06-.06.12-.1.19-.13a.9.9 0 0 1 .24-.05l.3-.01h2.04Zm8.88 13.73a4.5 4.5 0 0 0 1.82-.35 3.96 3.96 0 0 0 2.22-2.47c.2-.57.3-1.19.3-1.85V5.31h1.02v8.75c0 .78-.12 1.51-.37 2.19a4.88 4.88 0 0 1-2.76 2.95c-.66.29-1.4.43-2.23.43-.82 0-1.57-.14-2.24-.43a5.01 5.01 0 0 1-2.75-2.95 6.37 6.37 0 0 1-.37-2.19V5.31h1.03v8.74c0 .66.1 1.28.3 1.85a3.98 3.98 0 0 0 2.21 2.47c.53.24 1.14.36 1.82.36Zm10.38.73h-1.03V5.31h1.03v14.15Z"})}),cs=()=>e("svg",{viewBox:"0 0 85 38",fill:"currentColor",children:[e("path",{d:"M11.12 10.48c.36.28.8.43 1.26.43h.05c.48 0 .96-.19 1.25-.44 1.5-1.28 5.88-5.29 5.88-5.29 1.17-1.09-2.1-2.17-7.13-2.18h-.06c-5.04 0-8.3 1.1-7.13 2.18 0 0 4.37 4 5.88 5.3Zm2.56 2.16c-.36.28-.8.44-1.26.45h-.04c-.46 0-.9-.17-1.26-.45-1.04-.88-4.74-4.22-6.12-5.5v1.94c0 .21.08.5.22.63l.07.06c1.05.96 4.55 4.16 5.83 5.25.36.28.8.43 1.26.44h.04c.49-.02.96-.2 1.26-.44 1.3-1.11 4.94-4.45 5.88-5.31.15-.14.23-.42.23-.63V7.15a455.13 455.13 0 0 1-6.11 5.5Zm-1.26 4.99c.46 0 .9-.16 1.26-.44 2.05-1.82 4.09-3.65 6.1-5.5v1.94c0 .2-.07.48-.22.62-.94.87-4.57 4.2-5.88 5.3-.3.26-.77.44-1.26.45h-.04c-.46 0-.9-.16-1.26-.44-1.2-1.02-4.38-3.92-5.62-5.06l-.28-.25c-.14-.14-.22-.42-.22-.62v-1.94c1.38 1.26 5.08 4.6 6.12 5.5.36.28.8.43 1.26.44h.04ZM40 5l-5.84 14.46h-2.43L25.89 5h2.16a.9.9 0 0 1 .9.61l3.41 8.82a18.8 18.8 0 0 1 .62 2.02 19.44 19.44 0 0 1 .57-2.02l3.39-8.82c.05-.15.16-.3.31-.42a.9.9 0 0 1 .58-.19H40Zm17.18 0v14.46H54.8v-9.34c0-.37.02-.78.06-1.21l-4.37 8.21c-.21.4-.53.59-.95.59h-.38c-.43 0-.75-.2-.95-.59L43.8 8.88a22.96 22.96 0 0 1 .07 1.24v9.34H41.5V5h2.03l.3.01c.1 0 .17.02.24.05.07.03.13.07.19.13a1 1 0 0 1 .17.24l4.33 8.03a16.97 16.97 0 0 1 .6 1.36 14.34 14.34 0 0 1 .6-1.38l4.28-8.01c.05-.1.1-.18.17-.24.06-.06.12-.1.19-.13a.9.9 0 0 1 .24-.05l.3-.01h2.04Zm8.88 13.73a4.5 4.5 0 0 0 1.82-.35 3.96 3.96 0 0 0 2.22-2.47c.2-.57.3-1.19.3-1.85V5.31h1.02v8.75c0 .78-.12 1.51-.37 2.19a4.88 4.88 0 0 1-2.76 2.95c-.66.29-1.4.43-2.23.43-.82 0-1.57-.14-2.24-.43a5.01 5.01 0 0 1-2.75-2.95 6.37 6.37 0 0 1-.37-2.19V5.31h1.03v8.74c0 .66.1 1.28.3 1.85a3.98 3.98 0 0 0 2.21 2.47c.53.24 1.14.36 1.82.36Zm10.38.73h-1.03V5.31h1.03v14.15ZM1.73 36v-5.17l-.67-.07a.6.6 0 0 1-.21-.1.23.23 0 0 1-.08-.18v-.44h.96v-.59c0-.34.05-.65.14-.92a1.79 1.79 0 0 1 1.08-1.11 2.45 2.45 0 0 1 1.62-.02l-.03.53c0 .1-.06.15-.16.16H4c-.18 0-.35.03-.5.08a.95.95 0 0 0-.39.23c-.1.11-.19.25-.25.43-.05.18-.08.4-.08.65v.56h1.75v.78H2.8V36H1.73Zm6.17-6.17c.45 0 .85.07 1.2.22a2.57 2.57 0 0 1 1.5 1.62c.13.38.2.81.2 1.29s-.07.91-.2 1.3a2.57 2.57 0 0 1-1.49 1.61c-.36.14-.76.21-1.2.21-.45 0-.86-.07-1.22-.21a2.57 2.57 0 0 1-1.5-1.62c-.12-.38-.19-.81-.19-1.3 0-.47.07-.9.2-1.28a2.57 2.57 0 0 1 1.5-1.62c.35-.15.76-.22 1.2-.22Zm0 5.42c.6 0 1.05-.2 1.35-.6.3-.4.44-.97.44-1.69s-.15-1.28-.44-1.69c-.3-.4-.75-.6-1.35-.6-.3 0-.57.05-.8.15-.22.1-.4.26-.56.45-.15.2-.26.44-.33.73-.08.28-.11.6-.11.96 0 .72.15 1.29.44 1.69.3.4.76.6 1.36.6Zm5.26-4.11c.2-.42.43-.74.71-.97.28-.24.62-.36 1.03-.36.13 0 .25.02.36.05.12.02.23.07.32.13l-.08.8c-.02.1-.08.15-.18.15l-.24-.04a1.7 1.7 0 0 0-.88.05c-.15.05-.29.14-.4.25-.12.1-.23.24-.32.4-.1.17-.18.35-.26.56V36h-1.07v-6.08h.61c.12 0 .2.02.24.07.05.04.08.12.1.23l.06.92Zm13.73-3.82L23.39 36h-1.46l-3.5-8.68h1.29a.54.54 0 0 1 .54.37l2.04 5.3a11.31 11.31 0 0 1 .37 1.21 11.65 11.65 0 0 1 .35-1.22l2.03-5.29c.03-.1.1-.18.19-.25.1-.08.21-.12.35-.12h1.3Zm2.2 2.52V36H27.6v-6.16h1.49Zm.2-1.79c0 .13-.02.25-.08.36a1 1 0 0 1-.51.5.96.96 0 0 1-.73 0 1.02 1.02 0 0 1-.5-.5.96.96 0 0 1 0-.73.93.93 0 0 1 .86-.58.9.9 0 0 1 .37.08c.12.05.22.11.3.2a.94.94 0 0 1 .3.67Zm5.72 3.1a.68.68 0 0 1-.13.13c-.04.03-.1.05-.18.05a.42.42 0 0 1-.22-.07 3.95 3.95 0 0 0-.62-.31c-.14-.05-.3-.07-.51-.07-.26 0-.5.04-.69.14-.2.1-.36.23-.49.4-.13.18-.22.4-.29.64-.06.25-.1.53-.1.85 0 .33.04.62.1.88.08.25.18.47.32.64.13.18.29.3.48.4.18.09.4.13.63.13a1.6 1.6 0 0 0 .94-.27l.26-.2a.4.4 0 0 1 .25-.09.3.3 0 0 1 .27.14l.43.54a2.76 2.76 0 0 1-1.77.96c-.22.03-.43.05-.65.05a2.57 2.57 0 0 1-1.96-.83c-.25-.28-.45-.6-.6-1-.14-.4-.21-.85-.21-1.35 0-.45.06-.87.2-1.25a2.61 2.61 0 0 1 1.51-1.67c.37-.16.8-.24 1.28-.24.46 0 .86.07 1.2.22.35.15.66.36.94.64l-.4.54Zm3.43 4.95c-.54 0-.95-.15-1.24-.45-.28-.3-.42-.73-.42-1.26v-3.44h-.63a.29.29 0 0 1-.2-.07c-.06-.06-.09-.13-.09-.24v-.59l.99-.16.31-1.68a.33.33 0 0 1 .12-.18.34.34 0 0 1 .21-.07h.77v1.94h1.64v1.05h-1.64v3.34c0 .2.05.34.14.45.1.1.22.16.39.16a.73.73 0 0 0 .39-.1l.12-.07a.2.2 0 0 1 .11-.03c.05 0 .08.01.11.03l.09.1.44.72c-.21.18-.46.32-.74.4-.28.1-.57.15-.87.15Zm5.09-6.35c.46 0 .87.07 1.24.22a2.7 2.7 0 0 1 1.58 1.63c.14.39.22.83.22 1.31 0 .49-.08.93-.22 1.32-.14.4-.35.73-.62 1-.26.28-.58.49-.96.64-.37.15-.78.22-1.24.22a3.4 3.4 0 0 1-1.25-.22 2.71 2.71 0 0 1-1.59-1.64 3.8 3.8 0 0 1-.21-1.32c0-.48.07-.92.21-1.31a2.75 2.75 0 0 1 1.58-1.63c.38-.15.8-.22 1.26-.22Zm0 5.2c.51 0 .89-.17 1.13-.52.25-.34.38-.84.38-1.5a2.6 2.6 0 0 0-.38-1.53c-.24-.34-.62-.52-1.13-.52-.52 0-.9.18-1.16.53-.25.35-.37.85-.37 1.51s.12 1.17.37 1.51c.25.35.64.52 1.16.52Zm5.56-4.04c.2-.37.42-.65.69-.86.26-.21.57-.32.94-.32.28 0 .5.06.68.19l-.1 1.1a.3.3 0 0 1-.09.16.24.24 0 0 1-.15.04 1.8 1.8 0 0 1-.27-.03 2.01 2.01 0 0 0-.34-.03c-.16 0-.3.03-.44.08a1.1 1.1 0 0 0-.34.2c-.1.1-.2.2-.27.33-.08.13-.15.27-.22.44V36H47.7v-6.16h.87c.15 0 .26.03.31.09.06.05.1.15.13.29l.09.7Zm4.62-1.07V36h-1.49v-6.16h1.49Zm.2-1.79c0 .13-.02.25-.07.36a1 1 0 0 1-.51.5.96.96 0 0 1-.74 0 1.02 1.02 0 0 1-.5-.5.96.96 0 0 1 0-.73.93.93 0 0 1 .86-.58.9.9 0 0 1 .38.08c.11.05.21.11.3.2a.94.94 0 0 1 .28.67Zm4.56 5.32a7.8 7.8 0 0 0-1.08.12c-.29.05-.52.12-.7.2a.92.92 0 0 0-.38.3.64.64 0 0 0-.11.36c0 .26.07.45.23.56.15.11.35.17.6.17.3 0 .57-.06.79-.17.22-.1.44-.28.65-.5v-1.04Zm-3.4-2.67c.71-.65 1.57-.97 2.56-.97.36 0 .68.06.97.18a1.99 1.99 0 0 1 1.16 1.24c.1.3.16.61.16.96V36h-.67a.7.7 0 0 1-.33-.06c-.07-.04-.13-.13-.18-.26l-.13-.44c-.16.14-.3.26-.46.37a2.8 2.8 0 0 1-.97.43 2.77 2.77 0 0 1-1.32-.05 1.62 1.62 0 0 1-.57-.31 1.41 1.41 0 0 1-.38-.53 1.85 1.85 0 0 1-.05-1.18c.05-.16.14-.3.25-.45.12-.14.28-.27.46-.4a3 3 0 0 1 .7-.32 9.19 9.19 0 0 1 2.2-.33v-.36c0-.41-.09-.71-.26-.91-.18-.2-.43-.3-.76-.3a1.84 1.84 0 0 0-1.02.28l-.33.18c-.1.06-.2.09-.32.09-.1 0-.2-.03-.27-.08a.72.72 0 0 1-.17-.2l-.26-.47Zm11.49 4.32V36h-4.88v-8.6h1.16v7.62h3.72Zm3.16-5.2c.44 0 .84.08 1.2.23a2.57 2.57 0 0 1 1.49 1.62c.13.38.2.81.2 1.29s-.07.91-.2 1.3a2.57 2.57 0 0 1-1.49 1.61c-.36.14-.76.21-1.2.21-.45 0-.85-.07-1.21-.21a2.57 2.57 0 0 1-1.5-1.62c-.13-.38-.2-.81-.2-1.3 0-.47.07-.9.2-1.28.14-.39.33-.72.59-1 .25-.26.55-.47.9-.62.37-.15.77-.22 1.22-.22Zm0 5.43c.6 0 1.05-.2 1.34-.6.3-.4.45-.97.45-1.69s-.15-1.28-.45-1.69c-.3-.4-.74-.6-1.34-.6-.3 0-.57.05-.8.15-.22.1-.4.26-.56.45-.15.2-.26.44-.34.73-.07.28-.1.6-.1.96 0 .72.14 1.29.44 1.69.3.4.75.6 1.36.6Zm6.33-2.22c.22 0 .4-.03.57-.09.16-.06.3-.14.41-.25.12-.11.2-.24.26-.39.05-.15.08-.31.08-.5 0-.37-.11-.66-.34-.88-.23-.22-.55-.33-.98-.33-.43 0-.76.1-.99.33-.22.22-.34.51-.34.89 0 .18.03.34.09.5a1.1 1.1 0 0 0 .67.63c.16.06.35.09.57.09Zm1.93 3.3a.51.51 0 0 0-.13-.36.84.84 0 0 0-.34-.22 8.57 8.57 0 0 0-1.73-.2 7.5 7.5 0 0 1-.62-.05c-.23.1-.41.23-.56.4a.8.8 0 0 0-.1.92c.07.12.18.22.32.3.14.1.32.16.54.21a3.5 3.5 0 0 0 1.55 0c.23-.05.42-.12.57-.22.16-.1.29-.21.37-.34a.8.8 0 0 0 .13-.44Zm1.08-6.17v.4c0 .13-.08.21-.25.25l-.69.09c.14.26.2.56.2.88a1.86 1.86 0 0 1-1.36 1.82 3.07 3.07 0 0 1-1.72.04c-.12.08-.22.16-.29.25a.44.44 0 0 0-.1.27c0 .15.06.26.17.33.12.08.28.13.47.16a5 5 0 0 0 .66.06 16.56 16.56 0 0 1 1.5.13c.26.05.48.12.67.22.19.1.34.24.46.41.12.18.18.4.18.69 0 .26-.07.5-.2.75s-.31.46-.56.65c-.24.2-.54.34-.9.46a4.57 4.57 0 0 1-2.36.04c-.33-.09-.6-.2-.82-.36a1.56 1.56 0 0 1-.5-.51c-.1-.2-.16-.4-.16-.6 0-.3.1-.56.28-.77.19-.2.45-.37.77-.5a1.15 1.15 0 0 1-.43-.32.88.88 0 0 1-.15-.54c0-.09.01-.18.04-.27.04-.1.08-.2.15-.28a1.55 1.55 0 0 1 .58-.5c-.3-.16-.53-.39-.7-.66-.17-.28-.25-.6-.25-.97 0-.3.05-.57.16-.8.12-.25.28-.46.48-.63.2-.17.45-.3.73-.4a3 3 0 0 1 2.3.21h1.64Zm4.65.76a.24.24 0 0 1-.23.14.42.42 0 0 1-.2-.07 3.59 3.59 0 0 0-.67-.3 1.8 1.8 0 0 0-1.03 0c-.14.05-.27.11-.37.2a.87.87 0 0 0-.23.27.75.75 0 0 0-.08.35c0 .15.04.28.13.39.1.1.21.19.36.27.15.07.32.14.5.2a13.63 13.63 0 0 1 1.16.4c.2.08.36.18.5.3a1.33 1.33 0 0 1 .5 1.07 2 2 0 0 1-.15.78c-.1.24-.25.44-.45.62-.2.17-.43.3-.72.4a3.1 3.1 0 0 1-2.14-.05 2.97 2.97 0 0 1-.87-.53l.25-.41c.04-.05.07-.1.12-.12a.3.3 0 0 1 .17-.04.4.4 0 0 1 .22.08l.3.19a1.91 1.91 0 0 0 1.03.27c.2 0 .38-.03.54-.08.16-.06.29-.13.4-.22a.96.96 0 0 0 .3-.7c0-.17-.05-.31-.14-.42-.09-.11-.2-.2-.36-.28a2.6 2.6 0 0 0-.5-.2l-.59-.19c-.2-.06-.39-.14-.58-.22a2.14 2.14 0 0 1-.5-.3 1.45 1.45 0 0 1-.36-.46c-.1-.19-.14-.41-.14-.67a1.6 1.6 0 0 1 .57-1.23c.18-.16.4-.3.68-.39.26-.1.57-.14.91-.14a2.84 2.84 0 0 1 1.9.7l-.23.4Z"}),e("defs",{children:e("path",{d:"M0 0h85v38H0z"})})]}),ds=()=>e("svg",{viewBox:"0 0 85 38",fill:"currentColor",children:e("path",{d:"M11.118 10.476c.36.28.801.433 1.257.436h.052c.48-.007.961-.192 1.25-.444 1.509-1.279 5.88-5.287 5.88-5.287 1.168-1.087-2.093-2.174-7.13-2.181h-.06c-5.036.007-8.298 1.094-7.13 2.181 0 0 4.372 4.008 5.88 5.295zm2.559 2.166c-.359.283-.801.439-1.258.444h-.044a2.071 2.071 0 0 1-1.257-.444C10.082 11.755 6.384 8.42 5 7.148v1.93c0 .215.081.496.222.629l.07.064c1.045.955 4.546 4.154 5.825 5.245.358.283.8.438 1.257.444h.044c.489-.015.962-.2 1.258-.444 1.309-1.11 4.948-4.444 5.887-5.31.148-.132.222-.413.222-.628v-1.93a455.127 455.127 0 0 1-6.11 5.494zm-1.258 4.984a2.071 2.071 0 0 0 1.258-.436c2.053-1.815 4.09-3.65 6.11-5.502v1.938c0 .207-.075.488-.223.621-.94.873-4.578 4.2-5.887 5.31-.296.25-.77.436-1.258.443h-.044a2.071 2.071 0 0 1-1.257-.436c-1.204-1.027-4.376-3.928-5.616-5.062l-.28-.255c-.14-.133-.221-.414-.221-.621v-1.938c1.383 1.265 5.081 4.607 6.117 5.495.358.282.8.438 1.257.443h.044zM40 5l-5.84 14.46h-2.43L25.89 5h2.16c.233 0 .423.057.57.17.146.113.256.26.33.44l3.41 8.82c.113.287.22.603.32.95.106.34.206.697.3 1.07.08-.373.166-.73.26-1.07a8.84 8.84 0 0 1 .31-.95l3.39-8.82a.959.959 0 0 1 .31-.42.906.906 0 0 1 .58-.19H40zm17.176 0v14.46h-2.37v-9.34c0-.373.02-.777.06-1.21l-4.37 8.21c-.206.393-.523.59-.95.59h-.38c-.426 0-.743-.197-.95-.59l-4.42-8.24c.02.22.037.437.05.65.014.213.02.41.02.59v9.34h-2.37V5h2.03c.12 0 .224.003.31.01a.778.778 0 0 1 .23.05c.074.027.137.07.19.13.06.06.117.14.17.24l4.33 8.03c.114.213.217.433.31.66.1.227.197.46.29.7.094-.247.19-.483.29-.71.1-.233.207-.457.32-.67l4.27-8.01c.054-.1.11-.18.17-.24a.57.57 0 0 1 .19-.13.903.903 0 0 1 .24-.05c.087-.007.19-.01.31-.01h2.03zm8.887 13.73c.68 0 1.286-.117 1.82-.35.54-.24.996-.57 1.37-.99a4.28 4.28 0 0 0 .85-1.48c.2-.573.3-1.19.3-1.85V5.31h1.02v8.75c0 .78-.124 1.51-.37 2.19a5.248 5.248 0 0 1-1.07 1.77c-.46.5-1.024.893-1.69 1.18-.66.287-1.404.43-2.23.43-.827 0-1.574-.143-2.24-.43a5.012 5.012 0 0 1-1.69-1.18 5.33 5.33 0 0 1-1.06-1.77 6.373 6.373 0 0 1-.37-2.19V5.31h1.03v8.74c0 .66.096 1.277.29 1.85.2.567.483 1.06.85 1.48.373.42.826.75 1.36.99.54.24 1.15.36 1.83.36zm10.38.73h-1.03V5.31h1.03v14.15zM4.242 35v-5.166l-.672-.078a.595.595 0 0 1-.21-.09.23.23 0 0 1-.078-.186v-.438h.96v-.588c0-.348.048-.656.144-.924.1-.272.24-.5.42-.684a1.79 1.79 0 0 1 .66-.426c.256-.096.544-.144.864-.144.272 0 .522.04.75.12l-.024.534c-.008.096-.062.148-.162.156a4.947 4.947 0 0 1-.39.012c-.184 0-.352.024-.504.072a.949.949 0 0 0-.384.234c-.108.108-.192.25-.252.426a2.184 2.184 0 0 0-.084.654v.558h1.752v.774H5.316V35H4.242zM10.416 28.826a3.1 3.1 0 0 1 1.2.222c.356.148.66.358.912.63s.444.602.576.99c.136.384.204.814.204 1.29 0 .48-.068.912-.204 1.296a2.735 2.735 0 0 1-.576.984 2.572 2.572 0 0 1-.912.63 3.175 3.175 0 0 1-1.2.216c-.448 0-.852-.072-1.212-.216a2.572 2.572 0 0 1-.912-.63 2.805 2.805 0 0 1-.582-.984 3.972 3.972 0 0 1-.198-1.296c0-.476.066-.906.198-1.29.136-.388.33-.718.582-.99.252-.272.556-.482.912-.63.36-.148.764-.222 1.212-.222zm0 5.424c.6 0 1.048-.2 1.344-.6.296-.404.444-.966.444-1.686 0-.724-.148-1.288-.444-1.692-.296-.404-.744-.606-1.344-.606-.304 0-.57.052-.798.156a1.507 1.507 0 0 0-.564.45c-.148.196-.26.438-.336.726a3.941 3.941 0 0 0-.108.966c0 .72.148 1.282.444 1.686.3.4.754.6 1.362.6zM15.677 30.14c.192-.416.428-.74.708-.972.28-.236.622-.354 1.026-.354.128 0 .25.014.366.042.12.028.226.072.318.132l-.078.798c-.024.1-.084.15-.18.15-.056 0-.138-.012-.246-.036a1.694 1.694 0 0 0-.366-.036c-.192 0-.364.028-.516.084-.148.056-.282.14-.402.252a1.782 1.782 0 0 0-.318.408c-.092.16-.176.344-.252.552V35h-1.074v-6.078h.612c.116 0 .196.022.24.066.044.044.074.12.09.228l.072.924zM26.761 28.922 24.283 35h-.96l-2.478-6.078h.87a.33.33 0 0 1 .33.222l1.542 3.912c.048.148.09.292.126.432.036.14.07.28.102.42.032-.14.066-.28.102-.42.036-.14.08-.284.132-.432l1.56-3.912a.33.33 0 0 1 .12-.156.311.311 0 0 1 .198-.066h.834zM27.74 35v-6.078h.643c.152 0 .246.074.282.222l.078.624c.224-.276.476-.502.756-.678.28-.176.604-.264.972-.264.408 0 .738.114.99.342.256.228.44.536.552.924.088-.22.2-.41.336-.57a1.987 1.987 0 0 1 1.014-.624c.196-.048.394-.072.594-.072.32 0 .604.052.852.156.252.1.464.248.636.444.176.196.31.438.402.726.092.284.138.61.138.978V35H34.91v-3.87c0-.476-.104-.836-.312-1.08-.208-.248-.508-.372-.9-.372-.176 0-.344.032-.504.096-.156.06-.294.15-.414.27-.12.12-.216.272-.288.456-.068.18-.102.39-.102.63V35h-1.074v-3.87c0-.488-.098-.852-.294-1.092-.196-.24-.482-.36-.858-.36-.264 0-.508.072-.732.216a2.38 2.38 0 0 0-.618.576V35H27.74zM40.746 32.372c-.428.02-.788.058-1.08.114-.292.052-.526.12-.702.204a.923.923 0 0 0-.378.294.639.639 0 0 0-.114.366c0 .26.076.446.228.558.156.112.358.168.606.168.304 0 .566-.054.786-.162.224-.112.442-.28.654-.504v-1.038zm-3.396-2.67c.708-.648 1.56-.972 2.556-.972.36 0 .682.06.966.18.284.116.524.28.72.492.196.208.344.458.444.75.104.292.156.612.156.96V35h-.672a.708.708 0 0 1-.324-.06c-.076-.044-.136-.13-.18-.258l-.132-.444c-.156.14-.308.264-.456.372a2.804 2.804 0 0 1-.462.264c-.16.072-.332.126-.516.162-.18.04-.38.06-.6.06-.26 0-.5-.034-.72-.102a1.618 1.618 0 0 1-.57-.318 1.414 1.414 0 0 1-.372-.522 1.852 1.852 0 0 1-.132-.726 1.419 1.419 0 0 1 .33-.906c.12-.14.274-.272.462-.396s.418-.232.69-.324c.276-.092.596-.166.96-.222.364-.06.78-.096 1.248-.108v-.36c0-.412-.088-.716-.264-.912-.176-.2-.43-.3-.762-.3-.24 0-.44.028-.6.084-.156.056-.294.12-.414.192l-.33.186a.631.631 0 0 1-.324.084.439.439 0 0 1-.264-.078.716.716 0 0 1-.174-.192l-.264-.474zM44.974 29.6c.124-.124.254-.238.39-.342a2.395 2.395 0 0 1 .936-.444c.176-.044.368-.066.576-.066.336 0 .634.058.894.174.26.112.476.272.648.48.176.204.308.45.396.738.092.284.138.598.138.942V35H47.47v-3.918c0-.376-.086-.666-.258-.87-.172-.208-.434-.312-.786-.312-.256 0-.496.058-.72.174a2.58 2.58 0 0 0-.636.474V35h-1.482v-6.156h.906c.192 0 .318.09.378.27l.102.486zM53.085 28.748c.456 0 .87.074 1.242.222a2.692 2.692 0 0 1 1.578 1.626c.144.392.216.83.216 1.314 0 .488-.072.928-.216 1.32-.144.392-.35.726-.618 1.002a2.653 2.653 0 0 1-.96.636 3.333 3.333 0 0 1-1.242.222c-.46 0-.878-.074-1.254-.222a2.712 2.712 0 0 1-.966-.636 2.922 2.922 0 0 1-.618-1.002 3.807 3.807 0 0 1-.216-1.32c0-.484.072-.922.216-1.314.148-.392.354-.724.618-.996.268-.272.59-.482.966-.63a3.397 3.397 0 0 1 1.254-.222zm0 5.202c.512 0 .89-.172 1.134-.516.248-.344.372-.848.372-1.512s-.124-1.17-.372-1.518c-.244-.348-.622-.522-1.134-.522-.52 0-.906.176-1.158.528-.248.348-.372.852-.372 1.512s.124 1.164.372 1.512c.252.344.638.516 1.158.516zM57.252 35v-6.156h.906c.192 0 .318.09.378.27l.096.456c.108-.12.22-.23.336-.33a2.017 2.017 0 0 1 1.32-.492c.388 0 .706.106.954.318.252.208.44.486.564.834a1.93 1.93 0 0 1 .834-.882c.172-.092.354-.16.546-.204.196-.044.392-.066.588-.066.34 0 .642.052.906.156.264.104.486.256.666.456.18.2.316.444.408.732.096.288.144.618.144.99V35h-1.482v-3.918c0-.392-.086-.686-.258-.882-.172-.2-.424-.3-.756-.3-.152 0-.294.026-.426.078a1.026 1.026 0 0 0-.342.228 1.019 1.019 0 0 0-.228.366 1.435 1.435 0 0 0-.084.51V35h-1.488v-3.918c0-.412-.084-.712-.252-.9-.164-.188-.406-.282-.726-.282-.216 0-.418.054-.606.162a1.979 1.979 0 0 0-.516.432V35h-1.482zM70.558 32.372c-.428.02-.788.058-1.08.114-.292.052-.526.12-.702.204a.923.923 0 0 0-.378.294.639.639 0 0 0-.114.366c0 .26.076.446.228.558.156.112.358.168.606.168.304 0 .566-.054.786-.162.224-.112.442-.28.654-.504v-1.038zm-3.396-2.67c.708-.648 1.56-.972 2.556-.972.36 0 .682.06.966.18.284.116.524.28.72.492.196.208.344.458.444.75.104.292.156.612.156.96V35h-.672a.708.708 0 0 1-.324-.06c-.076-.044-.136-.13-.18-.258l-.132-.444c-.156.14-.308.264-.456.372a2.804 2.804 0 0 1-.462.264c-.16.072-.332.126-.516.162-.18.04-.38.06-.6.06-.26 0-.5-.034-.72-.102a1.618 1.618 0 0 1-.57-.318 1.414 1.414 0 0 1-.372-.522 1.852 1.852 0 0 1-.132-.726 1.419 1.419 0 0 1 .33-.906c.12-.14.274-.272.462-.396s.418-.232.69-.324c.276-.092.596-.166.96-.222.364-.06.78-.096 1.248-.108v-.36c0-.412-.088-.716-.264-.912-.176-.2-.43-.3-.762-.3-.24 0-.44.028-.6.084-.156.056-.294.12-.414.192l-.33.186a.631.631 0 0 1-.324.084.439.439 0 0 1-.264-.078.716.716 0 0 1-.174-.192l-.264-.474zM74.9 26.084V35h-1.482v-8.916H74.9zM81.969 28.844l-3.354 7.848a.538.538 0 0 1-.174.234c-.068.056-.174.084-.318.084h-1.104l1.152-2.472-2.49-5.694h1.302c.116 0 .206.028.27.084.068.056.118.12.15.192l1.308 3.192c.044.108.08.216.108.324.032.108.062.218.09.33a32.3 32.3 0 0 1 .108-.33c.036-.112.076-.222.12-.33l1.236-3.186a.437.437 0 0 1 .408-.276h1.188z"})}),ms=()=>e("svg",{viewBox:"0 0 15 17",fill:"currentColor",children:e("path",{d:"M6.11767 7.47586C6.47736 7.75563 6.91931 7.90898 7.37503 7.91213H7.42681C7.90756 7.90474 8.38832 7.71987 8.67677 7.46846C10.1856 6.18921 14.5568 2.18138 14.5568 2.18138C15.7254 1.09438 12.4637 0.00739 7.42681 0H7.36764C2.3308 0.00739 -0.930935 1.09438 0.237669 2.18138C0.237669 2.18138 4.60884 6.18921 6.11767 7.47586ZM8.67677 9.64243C8.31803 9.92483 7.87599 10.0808 7.41941 10.0861H7.37503C6.91845 10.0808 6.47641 9.92483 6.11767 9.64243C5.0822 8.75513 1.38409 5.42018 0.000989555 4.14832V6.07829C0.000989555 6.29273 0.0823481 6.57372 0.222877 6.70682L0.293316 6.7712L0.293344 6.77122C1.33784 7.72579 4.83903 10.9255 6.11767 12.0161C6.47641 12.2985 6.91845 12.4545 7.37503 12.4597H7.41941C7.90756 12.4449 8.38092 12.2601 8.67677 12.0161C9.9859 10.9069 13.6249 7.57198 14.5642 6.70682C14.7121 6.57372 14.7861 6.29273 14.7861 6.07829V4.14832C12.7662 5.99804 10.7297 7.82949 8.67677 9.64243ZM7.41941 14.6263C7.87513 14.6232 8.31708 14.4698 8.67677 14.19C10.7298 12.3746 12.7663 10.5407 14.7861 8.68853V10.6259C14.7861 10.8329 14.7121 11.1139 14.5642 11.247C13.6249 12.1196 9.9859 15.4471 8.67677 16.5563C8.38092 16.8077 7.90756 16.9926 7.41941 17H7.37503C6.91931 16.9968 6.47736 16.8435 6.11767 16.5637C4.91427 15.5373 1.74219 12.6364 0.502294 11.5025C0.393358 11.4029 0.299337 11.3169 0.222877 11.247C0.0823481 11.1139 0.000989555 10.8329 0.000989555 10.6259V8.68853C1.38409 9.95303 5.0822 13.2953 6.11767 14.1827C6.47641 14.4651 6.91845 14.6211 7.37503 14.6263H7.41941Z"})}),Ze=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"})}),Ue=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})}),ct=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M12 5V2L8 6l4 4V7c3.31 0 6 2.69 6 6 0 2.97-2.17 5.43-5 5.91v2.02c3.95-.49 7-3.85 7-7.93 0-4.42-3.58-8-8-8zm-6 8c0-1.65.67-3.15 1.76-4.24L6.34 7.34C4.9 8.79 4 10.79 4 13c0 4.08 3.05 7.44 7 7.93v-2.02c-2.83-.48-5-2.94-5-5.91z"})}),mt=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"})}),un=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M11 7h2v2h-2zm0 4h2v6h-2zm1-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8"})}),na=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"})}),ra=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"})}),us=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"})}),Gn=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M12 6v3l4-4-4-4v3c-4.42 0-8 3.58-8 8 0 1.57.46 3.03 1.24 4.26L6.7 14.8c-.45-.83-.7-1.79-.7-2.8 0-3.31 2.69-6 6-6zm6.76 1.74L17.3 9.2c.44.84.7 1.79.7 2.8 0 3.31-2.69 6-6 6v-3l-4 4 4 4v-3c4.42 0 8-3.58 8-8 0-1.57-.46-3.03-1.24-4.26z"})}),be=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M7.41 8.59 12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"})}),Je=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"m7 10 5 5 5-5z"})}),rn=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:[e("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),e("path",{d:"M12.5 7H11v6l5.25 3.15.75-1.23-4.5-2.67z"})]}),Rn=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M20 3h-1V1h-2v2H7V1H5v2H4c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 18H4V8h16v13z"})}),hs=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"m22 5.72-4.6-3.86-1.29 1.53 4.6 3.86L22 5.72zM7.88 3.39 6.6 1.86 2 5.71l1.29 1.53 4.59-3.85zM12.5 8H11v6l4.75 2.85.75-1.23-4-2.37V8zM12 4c-4.97 0-9 4.03-9 9s4.02 9 9 9c4.97 0 9-4.03 9-9s-4.03-9-9-9zm0 16c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"})}),ps=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M20 5H4c-1.1 0-1.99.9-1.99 2L2 17c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm-9 3h2v2h-2V8zm0 3h2v2h-2v-2zM8 8h2v2H8V8zm0 3h2v2H8v-2zm-1 2H5v-2h2v2zm0-3H5V8h2v2zm9 7H8v-2h8v2zm0-4h-2v-2h2v2zm0-3h-2V8h2v2zm3 3h-2v-2h2v2zm0-3h-2V8h2v2z"})}),nt=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M8 5v14l11-7z"})}),hn=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"m10 16.5 6-4.5-6-4.5v9zM12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"})}),aa=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"m3.5 18.49 6-6.01 4 4L22 6.92l-1.41-1.41-7.09 7.97-4-4L2 16.99z"})}),pn=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M10 10.02h5V21h-5zM17 21h3c1.1 0 2-.9 2-2v-9h-5v11zm3-18H5c-1.1 0-2 .9-2 2v3h19V5c0-1.1-.9-2-2-2zM3 19c0 1.1.9 2 2 2h3V10H3v9z"})}),It=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M9.4 16.6 4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0 4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z"})}),gn=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"})}),oa=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"})}),gs=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M19 13H5v-2h14v2z"})}),Wn=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M8.9999 14.7854L18.8928 4.8925C19.0803 4.70497 19.3347 4.59961 19.5999 4.59961C19.8651 4.59961 20.1195 4.70497 20.307 4.8925L21.707 6.2925C22.0975 6.68303 22.0975 7.31619 21.707 7.70672L9.70701 19.7067C9.31648 20.0972 8.68332 20.0972 8.2928 19.7067L2.6928 14.1067C2.50526 13.9192 2.3999 13.6648 2.3999 13.3996C2.3999 13.1344 2.50526 12.88 2.6928 12.6925L4.0928 11.2925C4.48332 10.902 5.11648 10.902 5.50701 11.2925L8.9999 14.7854Z"})}),Vt=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"})}),sa=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7zM2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3 2 4.27zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2zm4.31-.78 3.15 3.15.02-.16c0-1.66-1.34-3-3-3l-.17.01z"})}),vs=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M19 9l1.25-2.75L23 5l-2.75-1.25L19 1l-1.25 2.75L15 5l2.75 1.25L19 9zm-7.5.5L9 4 6.5 9.5 1 12l5.5 2.5L9 20l2.5-5.5L17 12l-5.5-2.5zM19 15l-1.25 2.75L15 19l2.75 1.25L19 23l1.25-2.75L23 19l-2.75-1.25L19 15z"})}),Xe=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"})}),ia=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M20 9H4v2h16V9zM4 15h16v-2H4v2z"})}),$n=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M23 8c0 1.1-.9 2-2 2-.18 0-.35-.02-.51-.07l-3.56 3.55c.05.16.07.34.07.52 0 1.1-.9 2-2 2s-2-.9-2-2c0-.18.02-.36.07-.52l-2.55-2.55c-.16.05-.34.07-.52.07s-.36-.02-.52-.07l-4.55 4.56c.05.16.07.33.07.51 0 1.1-.9 2-2 2s-2-.9-2-2 .9-2 2-2c.18 0 .35.02.51.07l4.56-4.55C8.02 9.36 8 9.18 8 9c0-1.1.9-2 2-2s2 .9 2 2c0 .18-.02.36-.07.52l2.55 2.55c.16-.05.34-.07.52-.07s.36.02.52.07l3.55-3.56C19.02 8.35 19 8.18 19 8c0-1.1.9-2 2-2s2 .9 2 2z"})}),ut=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:[e("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M21 5C19.89 4.65 18.67 4.5 17.5 4.5C15.55 4.5 13.45 4.9 12 6C10.55 4.9 8.45 4.5 6.5 4.5C5.33 4.5 4.11 4.65 3 5C2.25 5.25 1.6 5.55 1 6V20.6C1 20.85 1.25 21.1 1.5 21.1C1.6 21.1 1.65 21.1 1.75 21.05C3.15 20.3 4.85 20 6.5 20C8.2 20 10.65 20.65 12 21.5C13.35 20.65 15.8 20 17.5 20C19.15 20 20.85 20.3 22.25 21.05C22.35 21.1 22.4 21.1 22.5 21.1C22.75 21.1 23 20.85 23 20.6V6C22.4 5.55 21.75 5.25 21 5ZM21 18.5C19.9 18.15 18.7 18 17.5 18C15.8 18 13.35 18.65 12 19.5C10.65 18.65 8.2 18 6.5 18C5.3 18 4.1 18.15 3 18.5V7C4.1 6.65 5.3 6.5 6.5 6.5C8.2 6.5 10.65 7.15 12 8C13.35 7.15 15.8 6.5 17.5 6.5C18.7 6.5 19.9 6.65 21 7V18.5Z"}),e("path",{d:"M17.5 10.5C18.38 10.5 19.23 10.59 20 10.76V9.24C19.21 9.09 18.36 9 17.5 9C15.8 9 14.26 9.29 13 9.83V11.49C14.13 10.85 15.7 10.5 17.5 10.5ZM13 12.49V14.15C14.13 13.51 15.7 13.16 17.5 13.16C18.38 13.16 19.23 13.25 20 13.42V11.9C19.21 11.75 18.36 11.66 17.5 11.66C15.8 11.66 14.26 11.96 13 12.49ZM17.5 14.33C15.8 14.33 14.26 14.62 13 15.16V16.82C14.13 16.18 15.7 15.83 17.5 15.83C18.38 15.83 19.23 15.92 20 16.09V14.57C19.21 14.41 18.36 14.33 17.5 14.33Z"}),e("path",{d:"M6.5 10.5C5.62 10.5 4.77 10.59 4 10.76V9.24C4.79 9.09 5.64 9 6.5 9C8.2 9 9.74 9.29 11 9.83V11.49C9.87 10.85 8.3 10.5 6.5 10.5ZM11 12.49V14.15C9.87 13.51 8.3 13.16 6.5 13.16C5.62 13.16 4.77 13.25 4 13.42V11.9C4.79 11.75 5.64 11.66 6.5 11.66C8.2 11.66 9.74 11.96 11 12.49ZM6.5 14.33C8.2 14.33 9.74 14.62 11 15.16V16.82C9.87 16.18 8.3 15.83 6.5 15.83C5.62 15.83 4.77 15.92 4 16.09V14.57C4.79 14.41 5.64 14.33 6.5 14.33Z"})]}),fs=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M12 2C6.49 2 2 6.49 2 12s4.49 10 10 10 10-4.49 10-10S17.51 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm3-8c0 1.66-1.34 3-3 3s-3-1.34-3-3 1.34-3 3-3 3 1.34 3 3z"})}),la=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2ZM12 6C9.79 6 8 7.79 8 10H10C10 8.9 10.9 8 12 8C13.1 8 14 8.9 14 10C14 10.8792 13.4202 11.3236 12.7704 11.8217C11.9421 12.4566 11 13.1787 11 15H13C13 13.9046 13.711 13.2833 14.4408 12.6455C15.21 11.9733 16 11.2829 16 10C16 7.79 14.21 6 12 6ZM13 16V18H11V16H13Z"})}),Lt=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M4 20h16c1.1 0 2-.9 2-2s-.9-2-2-2H4c-1.1 0-2 .9-2 2s.9 2 2 2zm0-3h2v2H4v-2zM2 6c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2s-.9-2-2-2H4c-1.1 0-2 .9-2 2zm4 1H4V5h2v2zm-2 7h16c1.1 0 2-.9 2-2s-.9-2-2-2H4c-1.1 0-2 .9-2 2s.9 2 2 2zm0-3h2v2H4v-2z"})}),ca=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"})}),_s=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M3 17v2h6v-2H3zM3 5v2h10V5H3zm10 16v-2h8v-2h-8v-2h-2v6h2zM7 9v2H3v2h4v2h2V9H7zm14 4v-2H11v2h10zm-6-4h2V7h4V5h-4V3h-2v6z"})}),vn=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M7 20h4c0 1.1-.9 2-2 2s-2-.9-2-2zm-2-1h8v-2H5v2zm11.5-9.5c0 3.82-2.66 5.86-3.77 6.5H5.27c-1.11-.64-3.77-2.68-3.77-6.5C1.5 5.36 4.86 2 9 2s7.5 3.36 7.5 7.5zm4.87-2.13L20 8l1.37.63L22 10l.63-1.37L24 8l-1.37-.63L22 6l-.63 1.37zM19 6l.94-2.06L22 3l-2.06-.94L19 0l-.94 2.06L16 3l2.06.94L19 6z"})}),bs=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M3 14h4v-4H3v4zm0 5h4v-4H3v4zM3 9h4V5H3v4zm5 5h13v-4H8v4zm0 5h13v-4H8v4zM8 5v4h13V5H8z"})}),ys=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"m22 9.24-7.19-.62L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21 12 17.27 18.18 21l-1.63-7.03L22 9.24zM12 15.4l-3.76 2.27 1-4.28-3.32-2.88 4.38-.38L12 6.1l1.71 4.04 4.38.38-3.32 2.88 1 4.28L12 15.4z"})}),ws=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M12 17.27 18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"})}),Fn=()=>e("svg",{viewBox:"0 0 16 16",fill:tt("color-error"),children:e("path",{d:"M13.5095 4L8.50952 1H7.50952L2.50952 4L2.01953 4.85999V10.86L2.50952 11.71L7.50952 14.71H8.50952L13.5095 11.71L13.9995 10.86V4.85999L13.5095 4ZM7.50952 13.5601L3.00952 10.86V5.69995L7.50952 8.15002V13.5601ZM3.26953 4.69995L8.00952 1.85999L12.7495 4.69995L8.00952 7.29004L3.26953 4.69995ZM13.0095 10.86L8.50952 13.5601V8.15002L13.0095 5.69995V10.86Z"})}),an=()=>e("svg",{viewBox:"0 0 16 16",fill:tt("color-primary"),children:e("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2 5H4V4H1.5L1 4.5V12.5L1.5 13H4V12H2V5ZM14.5 4H12V5H14V12H12V13H14.5L15 12.5V4.5L14.5 4ZM11.76 6.56995L12 7V9.51001L11.7 9.95996L7.19995 11.96H6.73999L4.23999 10.46L4 10.03V7.53003L4.30005 7.06995L8.80005 5.06995H9.26001L11.76 6.56995ZM5 9.70996L6.5 10.61V9.28003L5 8.38V9.70996ZM5.57996 7.56006L7.03003 8.43005L10.42 6.93005L8.96997 6.06006L5.57996 7.56006ZM7.53003 10.73L11.03 9.17004V7.77002L7.53003 9.31995V10.73Z"})}),da=()=>e("svg",{viewBox:"0 0 16 16",fill:tt("color-warning"),children:e("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14 2H8L7 3V6H8V3H14V8H10V9H14L15 8V3L14 2ZM9 6H13V7H9.41L9 6.59V6ZM7 7H2L1 8V13L2 14H8L9 13V8L8 7H7ZM8 13H2V8H8V9V13ZM3 9H7V10H3V9ZM3 11H7V12H3V11ZM9 4H13V5H9V4Z"})}),zn=()=>e("svg",{viewBox:"0 0 16 16",fill:tt("color-primary"),children:e("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7 3L8 2H14L15 3V8L14 9H10V8H14V3H8V6H7V3ZM9 9V8L8 7H7H2L1 8V13L2 14H8L9 13V9ZM8 8V9V13H2V8H7H8ZM9.41421 7L9 6.58579V6H13V7H9.41421ZM9 4H13V5H9V4ZM7 10H3V11H7V10Z"})}),fn=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"})}),ma=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M12 5.83 15.17 9l1.41-1.41L12 3 7.41 7.59 8.83 9zm0 12.34L8.83 15l-1.41 1.41L12 21l4.59-4.59L15.17 15z"})}),ua=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M7.41 18.59 8.83 20 12 16.83 15.17 20l1.41-1.41L12 14zm9.18-13.18L15.17 4 12 7.17 8.83 4 7.41 5.41 12 10z"})}),Cs=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"})}),ha=()=>e("svg",{viewBox:"0 0 24 24",children:e("path",{fill:"currentColor",d:"M12,4a8,8,0,0,1,7.89,6.7A1.53,1.53,0,0,0,21.38,12h0a1.5,1.5,0,0,0,1.48-1.75,11,11,0,0,0-21.72,0A1.5,1.5,0,0,0,2.62,12h0a1.53,1.53,0,0,0,1.49-1.3A8,8,0,0,1,12,4Z",children:e("animateTransform",{attributeName:"transform",dur:"0.75s",repeatCount:"indefinite",type:"rotate",values:"0 12 12;360 12 12"})})}),Ns=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M21.99 4c0-1.1-.89-2-1.99-2H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h14l4 4zM18 14H6v-2h12zm0-3H6V9h12zm0-3H6V6h12z"})}),pa=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M4.25 5.61C6.27 8.2 10 13 10 13v6c0 .55.45 1 1 1h2c.55 0 1-.45 1-1v-6s3.72-4.8 5.74-7.39c.51-.66.04-1.61-.79-1.61H5.04c-.83 0-1.3.95-.79 1.61"})}),ga=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M19.79 5.61C20.3 4.95 19.83 4 19 4H6.83l7.97 7.97zM2.81 2.81 1.39 4.22 10 13v6c0 .55.45 1 1 1h2c.55 0 1-.45 1-1v-2.17l5.78 5.78 1.41-1.41z"})}),xl=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M19 19H5V5h7V3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2v-7h-2zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3z"})}),Ml=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M19 4H5c-1.11 0-2 .9-2 2v12c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.89-2-2-2m0 14H5V8h14z"})}),Ss=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M6 19h4V5H6v14zm8-14v14h4V5h-4z"})}),ks=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M8 12l4-4 4 4m-4-4v12",strokeWidth:"2",stroke:"currentColor",fill:"none"})}),Ts=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:[e("path",{d:"M4 3 L4 15 L1.5 15 L5.5 21 L9.5 15 L7 15 L7 3 Z"}),e("path",{d:"M13 21 L13 9 L10.5 9 L14.5 3 L18.5 9 L16 9 L16 21 Z"})]}),Ls=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M10.5 3 L10.5 15 L8 15 L12 21 L16 15 L13.5 15 L13.5 3 Z"})}),As=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M10.5 21 L10.5 9 L8 9 L12 3 L16 9 L13.5 9 L13.5 21 Z"})}),Il=Object.freeze(Object.defineProperty({__proto__:null,AlarmIcon:hs,ArrowDownIcon:be,ArrowDropDownIcon:Je,CalendarIcon:Rn,ChartIcon:aa,ClockIcon:rn,CloseIcon:Ue,CodeIcon:It,CollapseIcon:ua,CommentIcon:Ns,CopyIcon:Xe,DeleteIcon:gn,DoneIcon:Wn,DownloadIcon:fn,DragIcon:ia,ErrorIcon:ra,ExpandIcon:ma,FilterIcon:pa,FilterOffIcon:ga,FunctionIcon:an,InfoIcon:mt,InfoOutlinedIcon:un,IssueIcon:fs,KeyboardIcon:ps,LabelIcon:da,ListIcon:bs,LogoAnomalyIcon:ds,LogoIcon:ls,LogoLogsIcon:cs,LogoShortIcon:ms,MetricIcon:Fn,MinusIcon:gs,ModalIcon:Ml,MoreIcon:ca,OpenNewIcon:xl,PauseIcon:Ss,PlayCircleOutlineIcon:hn,PlayIcon:nt,PlusIcon:oa,Prettify:vs,QuestionIcon:la,RefreshIcon:Gn,RestartIcon:ct,ScrollToTopIcon:ks,SearchIcon:Cs,SettingsIcon:Ze,SortArrowDownIcon:Ls,SortArrowUpIcon:As,SortIcon:Ts,SpinnerIcon:ha,StarBorderIcon:ys,StarIcon:ws,StorageIcon:Lt,SuccessIcon:us,TableIcon:pn,TimelineIcon:$n,TipIcon:vn,TuneIcon:_s,ValueIcon:zn,VisibilityIcon:Vt,VisibilityOffIcon:sa,WarningIcon:na,WikiIcon:ut},Symbol.toStringTag,{value:"Module"})),Pl=({to:t,isNavLink:n,children:r,...a})=>n?e(Yo,{to:t,...a,children:r}):e("div",{...a,children:r}),Dl=({activeItem:t,item:n,color:r=tt("color-primary"),activeNavRef:a,onChange:o,isNavLink:s})=>{const i=l=>()=>{o&&o(l)};return e(Pl,{className:I({"vm-tabs-item":!0,"vm-tabs-item_active":t===n.value,[n.className||""]:n.className}),isNavLink:s,to:n.value,style:{color:r},onClick:i(n.value),ref:t===n.value?a:void 0,children:[n.icon&&e("div",{className:I({"vm-tabs-item__icon":!0,"vm-tabs-item__icon_single":!n.label}),children:n.icon}),n.label]})};function me(t,n,r,a){const o=q(n);A(()=>{o.current=n},[n]),A(()=>{const s=(r==null?void 0:r.current)??window;if(!(s&&s.addEventListener))return;const i=l=>o.current(l);return s.addEventListener(t,i,a),()=>{s.removeEventListener(t,i,a)}},[t,r,a])}const Pt=()=>{const[t,n]=N({width:0,height:0}),r=()=>{n({width:window.innerWidth,height:window.innerHeight})};return me("resize",r),A(r,[]),t},Yt=({activeItem:t,items:n,color:r=tt("color-primary"),onChange:a,indicatorPlacement:o="bottom",isNavLink:s})=>{const i=Pt(),l=q(null),[c,d]=N({left:0,width:0,bottom:0});return A(()=>{var m;if(((m=l.current)==null?void 0:m.base)instanceof HTMLElement){const{offsetLeft:u,offsetWidth:h,offsetHeight:p}=l.current.base;d({left:u,width:h,bottom:o==="top"?p-2:0})}},[i,t,l,n]),e("div",{className:"vm-tabs",children:[n.map(m=>e(Dl,{activeItem:t,item:m,onChange:a,color:r,activeNavRef:l,isNavLink:s},m.value)),e("div",{className:"vm-tabs__indicator",style:{...c,borderColor:r}})]})},zt=[{value:Ne.chart,icon:e(aa,{}),label:"Graph",prometheusCode:0},{value:Ne.code,icon:e(It,{}),label:"JSON",prometheusCode:3},{value:Ne.table,icon:e(pn,{}),label:"Table",prometheusCode:1}],Es=({tabFilter:t})=>{const{displayType:n}=je(),r=Gt(),a=s=>{r({type:"SET_DISPLAY_TYPE",payload:s??n})},o=zt.filter(t??(()=>!0));return e(Yt,{activeItem:n,items:o,onChange:a})},xs=()=>{const t=ze("g0.tab",0),n=zt.find(r=>r.prometheusCode===+t||r.value===t);return(n==null?void 0:n.value)||Ne.chart},io=Ae("SERIES_LIMITS"),Ol={displayType:xs(),nocache:!1,isTracingEnabled:!1,seriesLimits:io?JSON.parse(io):Ko,tableCompact:Ae("TABLE_COMPACT")||!1,reduceMemUsage:!1};function Rl(t,n){switch(n.type){case"SET_DISPLAY_TYPE":return{...t,displayType:n.payload};case"SET_SERIES_LIMITS":return Le("SERIES_LIMITS",JSON.stringify(n.payload)),{...t,seriesLimits:n.payload};case"TOGGLE_QUERY_TRACING":return{...t,isTracingEnabled:!t.isTracingEnabled};case"TOGGLE_NO_CACHE":return{...t,nocache:!t.nocache};case"TOGGLE_TABLE_COMPACT":return Le("TABLE_COMPACT",!t.tableCompact),{...t,tableCompact:!t.tableCompact};case"TOGGLE_REDUCE_MEM_USAGE":return Le("TABLE_COMPACT",!t.reduceMemUsage),{...t,reduceMemUsage:!t.reduceMemUsage};default:throw new Error}}const va=yt({}),je=()=>$e(va).state,Gt=()=>$e(va).dispatch,$l=({children:t})=>{const[n,r]=Et(Rl,Ol),a=M(()=>({state:n,dispatch:r}),[n,r]);return e(va.Provider,{value:a,children:t})},Fl={customStep:ze("g0.step_input",""),yaxis:{limits:{enable:!1,range:{1:[0,0]}}},isHistogram:!1,isEmptyHistogram:!1,spanGaps:!1,openSettings:!1};function zl(t,n){switch(n.type){case"TOGGLE_ENABLE_YAXIS_LIMITS":return{...t,yaxis:{...t.yaxis,limits:{...t.yaxis.limits,enable:!t.yaxis.limits.enable}}};case"SET_CUSTOM_STEP":return{...t,customStep:n.payload};case"SET_YAXIS_LIMITS":return{...t,yaxis:{...t.yaxis,limits:{...t.yaxis.limits,range:n.payload}}};case"SET_IS_HISTOGRAM":return{...t,isHistogram:n.payload};case"SET_IS_EMPTY_HISTOGRAM":return{...t,isEmptyHistogram:n.payload};case"SET_SPAN_GAPS":return{...t,spanGaps:n.payload};case"SET_OPEN_SETTINGS":return{...t,openSettings:n.payload};default:throw new Error}}const fa=yt({}),He=()=>$e(fa).state,vt=()=>$e(fa).dispatch,Hl=({children:t})=>{const[n,r]=Et(zl,Fl),a=M(()=>({state:n,dispatch:r}),[n,r]);return e(fa.Provider,{value:a,children:t})},Vl={dashboardsSettings:[],dashboardsLoading:!1,dashboardsError:""};function ql(t,n){switch(n.type){case"SET_DASHBOARDS_SETTINGS":return{...t,dashboardsSettings:n.payload};case"SET_DASHBOARDS_LOADING":return{...t,dashboardsLoading:n.payload};case"SET_DASHBOARDS_ERROR":return{...t,dashboardsError:n.payload};default:throw new Error}}const _a=yt({}),Ms=()=>$e(_a).state,Ul=()=>$e(_a).dispatch,Bl=({children:t})=>{const[n,r]=Et(ql,Vl),a=M(()=>({state:n,dispatch:r}),[n,r]);return e(_a.Provider,{value:a,children:t})},jl={markdownParsing:Ae("LOGS_MARKDOWN")==="true",ansiParsing:Ae("LOGS_ANSI")==="true",autocompleteCache:new Map};function Ql(t,n){switch(n.type){case"SET_MARKDOWN_PARSING":return Le("LOGS_MARKDOWN",`${n.payload}`),{...t,markdownParsing:n.payload};case"SET_ANSI_PARSING":return Le("LOGS_ANSI",`${n.payload}`),{...t,ansiParsing:n.payload};case"SET_AUTOCOMPLETE_CACHE":{if(t.autocompleteCache.size>=Tt.cacheLimit){const r=t.autocompleteCache.keys().next().value;r&&t.autocompleteCache.delete(r)}return t.autocompleteCache.set(n.payload.key,n.payload.value),{...t,autocompleteCache:t.autocompleteCache}}default:throw new Error}}const ba=yt({}),ya=()=>$e(ba).state,Is=()=>$e(ba).dispatch,Yl=({children:t})=>{const[n,r]=Et(Ql,jl),a=M(()=>({state:n,dispatch:r}),[n,r]);return e(ba.Provider,{value:a,children:t})},Ps={windows:"Windows",mac:"Mac OS",linux:"Linux"},Gl=()=>Object.values(Ps).find(t=>navigator.userAgent.indexOf(t)>=0)||"unknown",Jn=()=>Gl()===Ps.mac,Wl=()=>["Android","webOS","iPhone","iPad","iPod","BlackBerry","Windows Phone"].map(r=>navigator.userAgent.match(new RegExp(r,"i"))).some(r=>r);function J(){const t=Pt(),n=()=>{const o=Wl(),s=window.innerWidth<500;return o||s},[r,a]=N(n());return A(()=>{a(n())},[t]),{isMobile:r}}const Jl={success:e(us,{}),error:e(ra,{}),warning:e(na,{}),info:e(mt,{})},le=({variant:t,children:n})=>{const{isDarkTheme:r}=se(),{isMobile:a}=J();return e("div",{className:I({"vm-alert":!0,[`vm-alert_${t}`]:t,"vm-alert_dark":r,"vm-alert_mobile":a}),children:[e("div",{className:"vm-alert__icon",children:Jl[t||"info"]}),e("div",{className:"vm-alert__content",children:n})]})},Ds=yt({showInfoMessage:()=>{}}),Kl=()=>$e(Ds),Zl=({children:t})=>{const{isMobile:n}=J(),[r,a]=N({text:"",type:"info"}),[o,s]=N(!1),[i,l]=N(null);A(()=>{if(!i)return;a({...i,key:Date.now()}),s(!0);const d=setTimeout(c,i.timeout||4e3);return()=>clearTimeout(d)},[i]);const c=()=>{l(null),s(!1)};return e(Ds.Provider,{value:{showInfoMessage:l},children:[o&&e("div",{className:I({"vm-snackbar":!0,"vm-snackbar_mobile":n}),children:e(le,{variant:r.type,children:e("div",{className:"vm-snackbar-content",children:[e("span",{children:r.text}),e("div",{className:"vm-snackbar-content__close",onClick:c,children:e(Ue,{})})]})})}),t]})},Xl=(...t)=>t.reduce((n,r)=>({children:a})=>e(n,{children:e(r,{children:a})}),({children:n})=>e(V,{children:n})),ec=[sl,wl,El,$l,Hl,Zl,Bl,Yl],wa=Xl(...ec);var on=(t=>(t[t.internalLink=0]="internalLink",t[t.externalLink=1]="externalLink",t))(on||{});const tc=(t,n)=>({label:"Alerts",value:!!dn(t)?`${t}/vmalert`:t.replace(/\/prometheus$/,"/vmalert"),type:1,hide:!n}),nc=t=>[{value:Z.trace},{value:Z.queryAnalyzer},{value:Z.withTemplate},{value:Z.relabel},{value:Z.downsamplingDebug,hide:!t},{value:Z.retentionDebug,hide:!t}],rc=()=>[{value:Z.metrics},{value:Z.cardinality},{value:Z.topQueries},{value:Z.activeQueries}],ac=({serverUrl:t,isEnterpriseLicense:n,showPredefinedDashboards:r,showAlertLink:a})=>[{value:Z.home},{value:Z.rawQuery},{label:"Explore",submenu:rc()},{label:"Tools",submenu:nc(n)},{value:Z.dashboards,hide:!r},tc(t,a)],oc=()=>[{label:gt[Z.logs].title,value:Z.home}],sc=()=>[{label:gt[Z.anomaly].title,value:Z.home}],xr=({activeMenu:t,label:n,value:r,type:a,color:o})=>a===on.externalLink?e("a",{className:I({"vm-header-nav-item":!0,"vm-header-nav-item_active":t===r}),style:{color:o},href:r,target:"_blank",rel:"noreferrer",children:n}):e(Yo,{className:I({"vm-header-nav-item":!0,"vm-header-nav-item_active":t===r}),style:{color:o},to:r,children:n}),_n=(t,n,r)=>{const a=W(o=>{const s=t==null?void 0:t.current,i=o.target,l=(r==null?void 0:r.current)&&r.current.contains(i);!s||s.contains((o==null?void 0:o.target)||null)||l||n(o)},[t,n]);me("mouseup",a),me("touchstart",a)},D=({variant:t="contained",color:n="primary",size:r="medium",ariaLabel:a,children:o,endIcon:s,startIcon:i,fullWidth:l=!1,className:c,disabled:d,onClick:m,onMouseDown:u,"data-id":h})=>{const p=I({"vm-button":!0,[`vm-button_${t}_${n}`]:!0,[`vm-button_${r}`]:r,"vm-button_icon_only":(i||s)&&!o,"vm-button_full-width":l,"vm-button_with-icons":i||s,[c||""]:c});return e("button",{className:p,disabled:d,"aria-label":a,onClick:m,onMouseDown:u,"data-id":h,children:[i,o,s]})},Ie=({children:t,buttonRef:n,placement:r="bottom-left",placementPosition:a,open:o=!1,onClose:s,offset:i={top:6,left:0},clickOutside:l=!0,fullWidth:c,title:d,disabledFullScreen:m,variant:u})=>{const{isMobile:h}=J(),p=qn(),v=ht(),[b,f]=N({width:0,height:0}),[g,_]=N(!1),y=q(null);A(()=>(_(o),!o&&s&&s(),o&&h&&!m&&(document.body.style.overflow="hidden"),()=>{document.body.style.overflow="auto"}),[o]),A(()=>{var L,x;f({width:((L=y==null?void 0:y.current)==null?void 0:L.clientWidth)||0,height:((x=y==null?void 0:y.current)==null?void 0:x.clientHeight)||0}),_(!1)},[y]);const S=M(()=>{const L=n.current;if(!L||!g)return{};const x=L.getBoundingClientRect(),E={top:0,left:0,width:"auto"},P=r==="bottom-right"||r==="top-right",F=r==null?void 0:r.includes("top"),O=(i==null?void 0:i.top)||0,H=(i==null?void 0:i.left)||0;if(E.left=E.left=x.left+H,E.top=x.height+x.top+O,P&&(E.left=x.right-b.width),F&&(E.top=x.top-b.height-O),r==="fixed"&&a)return E.top=Math.max(a.top+i.top,0),E.left=Math.max(a.left+i.left,0),E;const{innerWidth:z,innerHeight:Y}=window,G=E.top+b.height>Y,K=E.top<0,re=E.left+b.width>z,Q=E.left<0;return G&&(E.top=x.top-b.height-O),K&&(E.top=x.height+x.top+O),re&&(E.left=x.right-b.width-H),Q&&(E.left=x.left+H),c&&(E.width=`${x.width}px`),E.top<0&&(E.top=0),E.left<0&&(E.left=0),E},[n,r,g,t,c]),T=L=>{L.stopPropagation(),s()},w=()=>{_(!1),s()},C=()=>{l&&w()};A(()=>{if(!y.current||!g||h&&!m)return;const{right:L,width:x}=y.current.getBoundingClientRect();if(L>window.innerWidth){const E=window.innerWidth-x;y.current.style.left=`${E}px`}},[g,y,a]);const k=W(()=>{g&&h&&!m&&(p(v,{replace:!0}),s())},[g,h,m,v,s]);return me("scroll",w),me("popstate",k),_n(y,C,n),e(V,{children:(g||!b.width)&&pt(e("div",{className:I({"vm-popper":!0,[`vm-popper_${u}`]:u,"vm-popper_mobile":h&&!m,"vm-popper_open":(h||Object.keys(S).length)&&g}),ref:y,style:h&&!m?{}:S,children:[(d||h&&!m)&&e("div",{className:"vm-popper-header",children:[e("p",{className:"vm-popper-header__title",children:d}),e(D,{variant:"text",color:u==="dark"?"white":"primary",size:"small",onClick:T,ariaLabel:"close",children:e(Ue,{})})]}),t]}),document.body)})},ae=t=>{const[n,r]=N(!!t),a=W(()=>r(!0),[]),o=W(()=>r(!1),[]),s=W(()=>r(i=>!i),[]);return{value:n,setValue:r,setTrue:a,setFalse:o,toggle:s}},ic=({activeMenu:t,label:n,color:r,background:a,submenu:o,direction:s})=>{const{pathname:i}=ht(),[l,c]=N(null),d=q(null),{value:m,setFalse:u,setTrue:h}=ae(!1),p=()=>{h(),l&&clearTimeout(l)},v=()=>{l&&clearTimeout(l);const f=setTimeout(u,300);c(f)},b=()=>{l&&clearTimeout(l)};return A(()=>{u()},[i]),s==="column"?e(V,{children:o.map(f=>e(xr,{activeMenu:t,value:f.value||"",label:f.label||"",type:f.type||on.internalLink},f.value))}):e("div",{className:I({"vm-header-nav-item":!0,"vm-header-nav-item_sub":!0,"vm-header-nav-item_open":m,"vm-header-nav-item_active":o.find(f=>f.value===t)}),style:{color:r},onMouseEnter:p,onMouseLeave:v,ref:d,children:[n,e(Je,{}),e(Ie,{open:m,placement:"bottom-left",offset:{top:12,left:0},onClose:u,buttonRef:d,children:e("div",{className:"vm-header-nav-item-submenu",style:{background:a},onMouseLeave:v,onMouseEnter:b,children:o.map(f=>e(xr,{activeMenu:t,value:f.value||"",label:f.label||"",color:r,type:f.type||on.internalLink},f.value))})})]})},lc=t=>{try{return t.replace(/^\/+/,"").replace(/-/g," ").trim().replace(/^\w/,n=>n.toUpperCase())}catch{return t}},Os=t=>t.filter(n=>!n.hide).map(n=>{var a;const r={...n};return r.value&&!r.label&&(r.label=((a=gt[r.value])==null?void 0:a.title)||lc(r.value)),r.submenu&&r.submenu.length>0&&(r.submenu=Os(r.submenu)),r}),cc=()=>{var m;const t=Ee(),{dashboardsSettings:n}=Ms(),{serverUrl:r,flags:a,appConfig:o}=se(),s=((m=o.license)==null?void 0:m.type)==="enterprise",i=!!a["vmalert.proxyURL"],l=!!(!t&&n.length),c=M(()=>({serverUrl:r,isEnterpriseLicense:s,showAlertLink:i,showPredefinedDashboards:l}),[r,s,i,l]),d=M(()=>{switch(Qt){case dt.victorialogs:return oc();case dt.vmanomaly:return sc();default:return ac(c)}},[c]);return Os(d)},Rs=({color:t,background:n,direction:r})=>{const{pathname:a}=ht(),[o,s]=N(a),i=cc();return A(()=>{s(a)},[a]),e("nav",{className:I({"vm-header-nav":!0,[`vm-header-nav_${r}`]:r}),children:i.map(l=>l.submenu?e(ic,{activeMenu:o,label:l.label||"",submenu:l.submenu,color:t,background:n,direction:r},l.label):e(xr,{activeMenu:o,value:l.value||"",label:l.label||"",color:t,type:l.type||on.internalLink},l.value))})},Me=({title:t,children:n,onClose:r,className:a,isOpen:o=!0})=>{const{isMobile:s}=J(),i=qn(),l=ht(),c=W(h=>{o&&h.key==="Escape"&&r()},[o]),d=h=>{h.stopPropagation()},m=W(()=>{o&&(i(l,{replace:!0}),r())},[o,l,r]);return A(()=>{if(o)return document.body.style.overflow="hidden",()=>{document.body.style.overflow="auto"}},[o]),me("popstate",m),me("keyup",c),pt(e("div",{className:I({"vm-modal":!0,"vm-modal_mobile":s,[`${a}`]:a}),onMouseDown:r,children:e("div",{className:"vm-modal-content",onMouseDown:d,children:[e("div",{className:"vm-modal-content-header",children:[t&&e("div",{className:"vm-modal-content-header__title",children:t}),e("div",{className:"vm-modal-header__close",children:e(D,{variant:"text",size:"small",onClick:r,ariaLabel:"close",children:e(Ue,{})})})]}),e("div",{className:"vm-modal-content-body",tabIndex:0,children:n})]})}),document.body)},j=({children:t,title:n,open:r,placement:a="bottom-center",offset:o={top:6,left:0}})=>{const{isMobile:s}=J(),[i,l]=N(!1),[c,d]=N({width:0,height:0}),m=q(null),u=q(null),h=()=>l(!1);A(()=>{if(!(!u.current||!i))return d({width:u.current.clientWidth,height:u.current.clientHeight}),window.addEventListener("scroll",h),()=>{window.removeEventListener("scroll",h)}},[i,n]);const p=M(()=>{var H;const f=(H=m==null?void 0:m.current)==null?void 0:H.base;if(!f||!i)return{};const g=f.getBoundingClientRect(),_={top:0,left:0},y=a==="bottom-right"||a==="top-right",S=a==="bottom-left"||a==="top-left",T=a==null?void 0:a.includes("top"),w=(o==null?void 0:o.top)||0,C=(o==null?void 0:o.left)||0;_.left=g.left-(c.width-g.width)/2+C,_.top=g.height+g.top+w,y&&(_.left=g.right-c.width),S&&(_.left=g.left+C),T&&(_.top=g.top-c.height-w);const{innerWidth:k,innerHeight:L}=window,x=20,E=_.top+c.height+x>L,P=_.top-x<0,F=_.left+c.width+x>k,O=_.left-x<0;return E&&(_.top=g.top-c.height-w),P&&(_.top=g.height+g.top+w),F&&(_.left=g.right-c.width-C),O&&(_.left=g.left+C),_.top<0&&(_.top=20),_.left<0&&(_.left=20),_},[m,a,i,c]),v=()=>{typeof r!="boolean"&&l(!0)},b=()=>{l(!1)};return A(()=>{typeof r=="boolean"&&l(r)},[r]),A(()=>{var g;const f=(g=m==null?void 0:m.current)==null?void 0:g.base;if(f)return f.addEventListener("mouseenter",v),f.addEventListener("mouseleave",b),()=>{f.removeEventListener("mouseenter",v),f.removeEventListener("mouseleave",b)}},[m]),e(V,{children:[e(V,{ref:m,children:t}),!s&&i&&pt(e("div",{className:"vm-tooltip",ref:u,style:p,children:n}),document.body)]})},Mn=e("code",{children:Jn()?"Cmd":"Ctrl"}),dc=[{title:"Zoom in",description:e(V,{children:["To zoom in, hold down the ",Mn," + ",e("code",{children:"scroll up"}),", or press the ",e("code",{children:"+"}),". Also, you can zoom in on a range on the graph by holding down your mouse button and selecting the range."]})},{title:"Zoom out",description:e(V,{children:["To zoom out, hold down the ",Mn," + ",e("code",{children:"scroll down"}),", or press the ",e("code",{children:"-"}),"."]})},{title:"Move horizontal axis",description:e(V,{children:["To move the graph, hold down the ",Mn," + ",e("code",{children:"drag"})," the graph to the right or left."]})},{title:"Fixing a tooltip",description:e(V,{children:["To fix the tooltip, ",e("code",{children:"click"})," mouse when it's open. Then, you can drag the fixed tooltip by ",e("code",{children:"clicking"})," and ",e("code",{children:"dragging"})," on the ",e(ia,{})," icon."]})},{title:"Set a custom range for the vertical axis",description:e(V,{children:["To set a custom range for the vertical axis, click on the ",e(Ze,{})," icon located in the upper right corner of the graph, activate the toggle, and set the values."]})}],mc=[{title:"Show/hide a legend item",description:e(V,{children:[e("code",{children:"click"})," on a legend item to isolate it on the graph.",Mn," + ",e("code",{children:"click"})," on a legend item to remove it from the graph. To revert to the previous state, click again."]})},{title:"Copy label key-value pairs",description:e(V,{children:[e("code",{children:"click"})," on a label key-value pair to save it to the clipboard."]})},{title:"Collapse/Expand the legend group",description:e(V,{children:[e("code",{children:"click"})," on the group name (e.g. ",e("b",{children:'Query 1: {__name__!=""}'}),") to collapse or expand the legend."]})}],uc=dc.concat(mc),Ca=()=>{const{value:t,setFalse:n,setTrue:r}=ae(!1);return e(V,{children:[e(j,{title:"Show tips on working with the graph",children:e(D,{variant:"text",color:"gray",startIcon:e(vn,{}),onClick:r,ariaLabel:"open the tips"})}),t&&e(Me,{title:"Tips on working with the graph and the legend",onClose:n,children:e("div",{className:"fc-graph-tips",children:uc.map(({title:a,description:o})=>e("div",{className:"fc-graph-tips-item",children:[e("h4",{className:"fc-graph-tips-item__action",children:a}),e("p",{className:"fc-graph-tips-item__description",children:o})]},a))})})]})},Ct=e("code",{children:Jn()?"Cmd":"Ctrl"}),$s=e(V,{children:[e("code",{children:Jn()?"Option":"Ctrl"})," + ",e("code",{children:"Space"})]}),hc=[{title:"Query",list:[{keys:e("code",{children:"Enter"}),description:"Run"},{keys:e(V,{children:[e("code",{children:"Shift"})," + ",e("code",{children:"Enter"})]}),description:"Multi-line queries"},{keys:e(V,{children:[Ct," + ",e("code",{children:"Arrow Up"})]}),description:"Previous command from the Query history"},{keys:e(V,{children:[Ct," + ",e("code",{children:"Arrow Down"})]}),description:"Next command from the Query history"},{keys:e(V,{children:[Ct," + ",e("code",{children:"click"})," by ",e(Vt,{})]}),description:"Toggle multiple queries"},{keys:$s,description:"Show quick autocomplete tips"}]},{title:"Graph",readMore:e(Ca,{}),list:[{keys:e(V,{children:[Ct," + ",e("code",{children:"scroll Up"})," or ",e("code",{children:"+"})]}),description:"Zoom in"},{keys:e(V,{children:[Ct," + ",e("code",{children:"scroll Down"})," or ",e("code",{children:"-"})]}),description:"Zoom out"},{keys:e(V,{children:[Ct," + ",e("code",{children:"drag"})]}),description:"Move the graph left/right"},{keys:e(V,{children:e("code",{children:"click"})}),description:"Select the series in the legend"},{keys:e(V,{children:[Ct," + ",e("code",{children:"click"})]}),description:"Toggle multiple series in the legend"}]}],pr="Shortcut keys",Mr=Jn(),pc=Mr?"Cmd + /":"F1",Fs=({showTitle:t})=>{const n=Ee(),{value:r,setTrue:a,setFalse:o}=ae(!1),s=W(i=>{const l=Mr&&i.key==="/"&&i.metaKey,c=!Mr&&i.key==="F1"&&!i.metaKey;(l||c)&&a()},[a]);return me("keydown",s),e(V,{children:[e(j,{open:t===!0?!1:void 0,title:`${pr} (${pc})`,placement:"bottom-center",children:e(D,{className:n?"":"vm-header-button",variant:"contained",color:"primary",startIcon:e(ps,{}),onClick:a,ariaLabel:pr,children:t&&pr})}),r&&e(Me,{title:"Shortcut keys",onClose:o,children:e("div",{className:"vm-shortcuts",children:hc.map(i=>e("div",{className:"vm-shortcuts-section",children:[i.readMore&&e("div",{className:"vm-shortcuts-section__read-more",children:i.readMore}),e("h3",{className:"vm-shortcuts-section__title",children:i.title}),e("div",{className:"vm-shortcuts-section-list",children:i.list.map((l,c)=>e("div",{className:"vm-shortcuts-section-list-item",children:[e("div",{className:"vm-shortcuts-section-list-item__key",children:l.keys}),e("p",{className:"vm-shortcuts-section-list-item__description",children:l.description})]},`${i.title}_${c}`))})]},i.title))})})]})},gc=({open:t})=>e("button",{className:I({"vm-menu-burger":!0,"vm-menu-burger_opened":t}),"aria-label":"menu",children:e("span",{})}),vc=({background:t,color:n})=>{const{pathname:r}=ht(),{isMobile:a}=J(),o=q(null),{value:s,toggle:i,setFalse:l}=ae(!1);return A(l,[r]),_n(o,l),e("div",{className:"vm-header-sidebar",ref:o,children:[e("div",{className:I({"vm-header-sidebar-button":!0,"vm-header-sidebar-button_open":s}),onClick:i,children:e(gc,{open:s})}),e("div",{className:I({"vm-header-sidebar-menu":!0,"vm-header-sidebar-menu_open":s}),children:[e("div",{children:e(Rs,{color:n,background:t,direction:"column"})}),e("div",{className:"vm-header-sidebar-menu-settings",children:!a&&!1})]})]})},fc=t=>`${t.replace(/^(.+)(\/select.+)/,"$1")}/admin/tenants`,_c=()=>{const{useTenantID:t}=cn(),n=Ee(),{serverUrl:r}=se(),[a,o]=N(!1),[s,i]=N(),[l,c]=N([]),d=M(()=>fc(r),[r]),m=M(()=>!!dn(r),[r]),u=n?!t:!m;return A(()=>{if(u)return;(async()=>{o(!0);try{const p=await fetch(d),v=await p.json(),b=v.data||[];c(b.sort((f,g)=>f.localeCompare(g))),p.ok?i(void 0):i(`${v.errorType}\r
${v==null?void 0:v.error}`)}catch(p){p instanceof Error&&i(`${p.name}: ${p.message}`)}o(!1)})().catch(console.error)},[d]),{accountIds:l,isLoading:a,error:s}},bc=({controlsComponent:t,isMobile:n,...r})=>{const a=Ee(),{pathname:o}=ht(),{accountIds:s}=_c(),{value:i,toggle:l,setFalse:c}=ae(!1),d=M(()=>(gt[o]||{}).header||{},[o]),m=e(t,{...r,isMobile:n,accountIds:s,headerSetup:d});return n?e(V,{children:[e("div",{children:e(D,{className:I({"vm-header-button":!a}),startIcon:e(ca,{}),onClick:l,ariaLabel:"controls"})}),e(Me,{title:"Controls",onClose:c,isOpen:i,className:I({"vm-header-controls-modal":!0,"vm-header-controls-modal_open":i}),children:m})]}):m},lo=()=>{switch(Qt){case dt.victorialogs:return e(cs,{});case dt.vmanomaly:return e(ds,{});default:return e(ls,{})}},Na=({controlsComponent:t})=>{const{isMobile:n}=J(),r=Pt(),a=M(()=>window.innerWidth<1e3,[r]),{isDarkTheme:o}=se(),s=Ee(),i=M(()=>tt(o?"color-background-block":"color-primary"),[o]),{background:l,color:c}=M(()=>{const{headerStyles:{background:u=s?"#FFF":i,color:h=s?i:"#FFF"}={}}=cn();return{background:u,color:h}},[i]),d=qn(),m=()=>{d({pathname:Z.home}),window.location.reload()};return e("header",{className:I({"vm-header":!0,"vm-header_app":s,"vm-header_dark":o,"vm-header_sidebar":a,"vm-header_mobile":n}),style:{background:l,color:c},children:[a?e(vc,{background:l,color:c}):e(V,{children:[!s&&e("div",{className:"vm-header-logo",onClick:m,style:{color:c},children:e(lo,{})}),e(Rs,{color:c,background:l})]}),a&&e("div",{className:I({"vm-header-logo":!0,"vm-header-logo_mobile":!0}),onClick:m,style:{color:c},children:e(lo,{})}),e(bc,{controlsComponent:t,displaySidebar:a,isMobile:n})]})},zs={href:"https://github.com/VictoriaMetrics/VictoriaMetrics/issues/new/choose",Icon:fs,title:"Create an issue"},yc=[{href:"https://docs.victoriametrics.com/victoriametrics/metricsql/",Icon:It,title:"MetricsQL"},{href:"https://docs.victoriametrics.com/victoriametrics/single-server-victoriametrics/#vmui",Icon:ut,title:"Documentation"},zs],wc=[{href:"https://docs.victoriametrics.com/victorialogs/logsql/",Icon:It,title:"LogsQL"},{href:"https://docs.victoriametrics.com/victorialogs/",Icon:ut,title:"Documentation"},zs],Sa=zr(({links:t=yc})=>{const n=`2019-${new Date().getFullYear()}`;return e("footer",{className:"vm-footer",children:[e("a",{className:"vm-link vm-footer__website",target:"_blank",href:"https://victoriametrics.com/",rel:"me noreferrer",children:[e(ms,{}),"victoriametrics.com"]}),t.map(({href:r,Icon:a,title:o})=>e("a",{className:"vm-link vm-footer__link",target:"_blank",href:r,rel:"help noreferrer",children:[e(a,{}),o]},`${r}-${o}`)),e("div",{className:"vm-footer__copyright",children:[" ",n," VictoriaMetrics"]})]})}),Cc=()=>{const t=Ee(),{serverUrl:n}=se(),r=Ul(),[a,o]=N(!1),[s,i]=N(""),[l,c]=N([]),d=async()=>{};return A(()=>{t||(c([]),d())},[n]),A(()=>{r({type:"SET_DASHBOARDS_SETTINGS",payload:l})},[l]),A(()=>{r({type:"SET_DASHBOARDS_LOADING",payload:a})},[a]),A(()=>{r({type:"SET_DASHBOARDS_ERROR",payload:s})},[s]),{dashboardsSettings:l,isLoading:a,error:s}},Nc=({error:t,warning:n,info:r})=>{const a=q(null),[o,s]=N(!1),[i,l]=N(!1),d=`${M(()=>t?"ERROR: ":n?"WARNING: ":"",[t,n])}${t||n||r}`,m=()=>{const h=a.current;if(h){const{offsetWidth:p,scrollWidth:v,offsetHeight:b,scrollHeight:f}=h,g=p+1<v||b+1<f;s(g)}else s(!1)},u=()=>{o&&(l(!0),s(!1))};return A(()=>{l(!1),m()},[a,d]),me("resize",m),!t&&!n&&!r?null:e("span",{className:I({"vm-text-field__error":!0,"vm-text-field__warning":n&&!t,"vm-text-field__helper-text":!n&&!t,"vm-text-field__error_overflowed":o,"vm-text-field__error_full":i}),"data-show":!!d,ref:a,onClick:u,children:d})},ce=({label:t,value:n,type:r="text",error:a="",warning:o="",helperText:s="",placeholder:i,endIcon:l,startIcon:c,disabled:d=!1,autofocus:m=!1,inputmode:u="text",caretPosition:h,onChange:p,onEnter:v,onKeyDown:b,onFocus:f,onBlur:g,onChangeCaret:_})=>{const{isDarkTheme:y}=se(),{isMobile:S}=J(),T=q(null),w=q(null),C=M(()=>r==="textarea"?w:T,[r]),k=I({"vm-text-field__input":!0,"vm-text-field__input_error":a,"vm-text-field__input_warning":!a&&o,"vm-text-field__input_icon-start":c,"vm-text-field__input_disabled":d,"vm-text-field__input_textarea":r==="textarea"}),L=Y=>{if(!_)return;const{selectionStart:G,selectionEnd:K}=Y;_&&_([G||0,K||0])},x=Y=>{L(Y.currentTarget)},E=Y=>{b&&b(Y);const{key:G,ctrlKey:K,metaKey:re}=Y,Q=G==="Enter";(r!=="textarea"?Q:Q&&(re||K))&&v&&(Y.preventDefault(),v())},P=Y=>{L(Y.currentTarget)},F=Y=>{d||(p&&p(Y.currentTarget.value),L(Y.currentTarget))},O=()=>{f&&f()},H=()=>{g&&g()},z=Y=>{try{C.current&&C.current.setSelectionRange(Y[0],Y[1])}catch(G){return G}};return A(()=>{var Y;!m||S||(Y=C==null?void 0:C.current)!=null&&Y.focus&&C.current.focus()},[C,m]),A(()=>{h&&z(h)},[h]),e("label",{className:I({"vm-text-field":!0,"vm-text-field_textarea":r==="textarea","vm-text-field_dark":y}),"data-replicated-value":n,children:[c&&e("div",{className:"vm-text-field__icon-start",children:c}),l&&e("div",{className:"vm-text-field__icon-end",children:l}),r==="textarea"?e("textarea",{className:k,disabled:d,ref:w,value:n,rows:1,inputMode:u,placeholder:i,autoCapitalize:"none",onInput:F,onKeyDown:E,onKeyUp:P,onFocus:O,onBlur:H,onMouseUp:x}):e("input",{className:k,disabled:d,ref:T,value:n,type:r,placeholder:i,inputMode:u,autoCapitalize:"none",onInput:F,onKeyDown:E,onKeyUp:P,onFocus:O,onBlur:H,onMouseUp:x}),t&&e("span",{className:"vm-text-field__label",children:t}),e(Nc,{error:a,warning:o,info:s})]})},Hs=({accountIds:t})=>{const n=Ee(),{isMobile:r}=J(),{tenantId:a,serverUrl:o}=se(),s=xt(),i=Be(),[l,c]=N(""),d=q(null),{value:m,toggle:u,setFalse:h}=ae(!1),p=M(()=>{if(!l)return t;try{const f=new RegExp(l,"i");return t.filter(_=>f.test(_)).sort((_,y)=>{var S,T;return(((S=_.match(f))==null?void 0:S.index)||0)-(((T=y.match(f))==null?void 0:T.index)||0)})}catch{return[]}},[l,t]),v=M(()=>t.length>1,[t]),b=f=>()=>{const g=f;if(s({type:"SET_TENANT_ID",payload:g}),o){const _=Wo(o,g);if(_===o)return;s({type:"SET_SERVER",payload:_}),i({type:"RUN_QUERY"})}h()};return A(()=>{const f=dn(o);a&&a!==f?b(a)():b(f)()},[o]),v?e("div",{className:"vm-tenant-input",children:[e(j,{title:"Define Tenant ID if you need request to another storage",children:e("div",{ref:d,children:r?e("div",{className:"vm-mobile-option",onClick:u,children:[e("span",{className:"vm-mobile-option__icon",children:e(Lt,{})}),e("div",{className:"vm-mobile-option-text",children:[e("span",{className:"vm-mobile-option-text__label",children:"Tenant ID"}),e("span",{className:"vm-mobile-option-text__value",children:a})]}),e("span",{className:"vm-mobile-option__arrow",children:e(be,{})})]}):e(D,{className:n?"":"vm-header-button",variant:"contained",color:"primary",fullWidth:!0,startIcon:e(Lt,{}),endIcon:e("div",{className:I({"vm-execution-controls-buttons__arrow":!0,"vm-execution-controls-buttons__arrow_open":m}),children:e(be,{})}),onClick:u,children:a})})}),e(Ie,{open:m,placement:"bottom-right",onClose:h,buttonRef:d,title:r?"Define Tenant ID":void 0,children:e("div",{className:I({"vm-list vm-tenant-input-list":!0,"vm-list vm-tenant-input-list_mobile":r}),children:[e("div",{className:"vm-tenant-input-list__search",children:e(ce,{autofocus:!0,label:"Search",value:l,onChange:c,type:"search"})}),p.map(f=>e("div",{className:I({"vm-list-item":!0,"vm-list-item_mobile":r,"vm-list-item_active":f===a}),onClick:b(f),children:f},f))]})})]}):null};function qt(t){const n=q();return A(()=>{n.current=t},[t]),n.current}const Te=({text:t,href:n,children:r,colored:a=!0,underlined:o=!1,withIcon:s=!1})=>e("a",{href:n,className:I({"vm-link":!0,"vm-link_colored":a,"vm-link_underlined":o,"vm-link_with-icon":s}),target:"_blank",rel:"noreferrer",children:t||r}),Vs=()=>{const t=Ee(),{isMobile:n}=J(),{customStep:r,isHistogram:a}=He(),{period:{step:o,end:s,start:i}}=ge(),l=vt(),{displayType:c}=je(),d=qt(s-i),m=M(()=>mn(s-i,a,c),[s,i,a,c]),u=qt(m),[h,p]=N(r||m),[v,b]=N(""),f=r===m,{value:g,toggle:_,setFalse:y}=ae(!1),S=q(null),T=E=>{const P=E||h||m||"1s",O=(P.match(/[a-zA-Z]+/g)||[]).length?P:`${P}s`;l({type:"SET_CUSTOM_STEP",payload:O}),p(O),b("")},w=()=>{T(),y()},C=()=>{document.activeElement instanceof HTMLInputElement&&document.activeElement.select()},k=()=>{T(),w()},L=E=>{const P=E.match(/[-+]?([0-9]*\.[0-9]+|[0-9]+)/g)||[],F=E.match(/[a-zA-Z]+/g)||[],O=P.length&&P.every(Y=>parseFloat(Y)>0),H=F.every(Y=>Jr.find(G=>G.short===Y)),z=O&&H;p(E),b(z?"":Ce.validStep)},x=()=>{const E=m||"1s";L(E),T(E)};return A(()=>{r&&T(r)},[r]),A(()=>{!r&&m&&T(m)},[m]),A(()=>{s-i===d||!d||r!==u||m&&T(m)},[d,m]),A(()=>{(o===r||o===m)&&T(m)},[a,c]),e("div",{className:"vm-step-control",ref:S,children:[n?e("div",{className:"vm-mobile-option",onClick:_,children:[e("span",{className:"vm-mobile-option__icon",children:e($n,{})}),e("div",{className:"vm-mobile-option-text",children:[e("span",{className:"vm-mobile-option-text__label",children:"Step"}),e("span",{className:"vm-mobile-option-text__value",children:h})]}),e("span",{className:"vm-mobile-option__arrow",children:e(be,{})})]}):e(D,{className:t?"":"vm-header-button",variant:"contained",color:"primary",startIcon:e($n,{}),onClick:_,children:["Step: ",f?`auto (${h})`:h]}),e(Ie,{open:g,placement:"bottom-right",onClose:w,buttonRef:S,title:n?"Query resolution step width":void 0,children:e("div",{className:I({"vm-step-control-popper":!0,"vm-step-control-popper_mobile":n}),children:[e(ce,{autofocus:!0,label:"Step value",value:h,error:v,onChange:L,onEnter:k,onFocus:C,onBlur:T,endIcon:e(j,{title:`Reset to auto step (${m})`,children:e(D,{size:"small",variant:"text",color:"primary",startIcon:e(ct,{}),onClick:x,ariaLabel:"reset step"})})}),e("div",{className:"vm-step-control-popper-info",children:[e("p",{children:[e("code",{children:"step"})," - the ",e(Te,{href:"https://prometheus.io/docs/prometheus/latest/querying/basics/#time-durations",text:"interval"})," between datapoints, which must be returned from the range query. The ",e("code",{children:"query"})," is executed at ",e("code",{children:"start"}),", ",e("code",{children:"start+step"}),", ",e("code",{children:"start+2*step"}),", , ",e("code",{children:"end"})," timestamps."]}),e("p",{children:["Read more about ",e(Te,{href:"https://docs.victoriametrics.com/victoriametrics/keyconcepts/#range-query",text:"Range"})," and ",e(Te,{href:"https://docs.victoriametrics.com/victoriametrics/keyconcepts/#instant-query",text:"Instant"})," queries."]})]})]})})]})},Sc=({relativeTime:t,setDuration:n})=>{const{isMobile:r}=J(),a=o=>()=>{n(o)};return e("div",{className:I({"vm-time-duration":!0,"vm-time-duration_mobile":r}),children:nn.map(({id:o,duration:s,until:i,title:l})=>e("div",{className:I({"vm-list-item":!0,"vm-list-item_mobile":r,"vm-list-item_active":o===t}),onClick:a({duration:s,until:i(),id:o}),children:l||s},o))})},kc=({viewDate:t,showArrowNav:n,onChangeViewDate:r,toggleDisplayYears:a})=>{const o=()=>{r(t.subtract(1,"month"))},s=()=>{r(t.add(1,"month"))};return e("div",{className:"vm-calendar-header",children:[e("div",{className:"vm-calendar-header-left",onClick:a,children:[e("span",{className:"vm-calendar-header-left__date",children:t.format("MMMM YYYY")}),e("div",{className:"vm-calendar-header-left__select-year",children:e(Je,{})})]}),n&&e("div",{className:"vm-calendar-header-right",children:[e("div",{className:"vm-calendar-header-right__prev",onClick:o,children:e(be,{})}),e("div",{className:"vm-calendar-header-right__next",onClick:s,children:e(be,{})})]})]})},Tc=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],Lc=({viewDate:t,selectDate:n,onChangeSelectDate:r})=>{const a="YYYY-MM-DD",o=U.tz(),s=U(t.format(a)),i=M(()=>{const c=new Array(42).fill(null),d=s.startOf("month"),u=s.endOf("month").diff(d,"day")+1,h=new Array(u).fill(d).map((v,b)=>v.add(b,"day")),p=d.day();return c.splice(p,u,...h),c},[s]),l=c=>()=>{c&&r(c)};return e("div",{className:"vm-calendar-body",children:[Tc.map(c=>e(j,{title:c,children:e("div",{className:"vm-calendar-body-cell vm-calendar-body-cell_weekday",children:c[0]})},c)),i.map((c,d)=>e("div",{className:I({"vm-calendar-body-cell":!0,"vm-calendar-body-cell_day":!0,"vm-calendar-body-cell_day_empty":!c,"vm-calendar-body-cell_day_active":(c&&c.format(a))===n.format(a),"vm-calendar-body-cell_day_today":(c&&c.format(a))===o.format(a)}),onClick:l(c),children:c&&c.format("D")},c?c.format(a):d))]})},Ac=({viewDate:t,onChangeViewDate:n})=>{const r=U().format("YYYY"),a=M(()=>t.format("YYYY"),[t]),o=M(()=>{const c=U().subtract(18/2,"year");return new Array(18).fill(c).map((d,m)=>d.add(m,"year"))},[t]);A(()=>{const i=document.getElementById(`vm-calendar-year-${a}`);i&&i.scrollIntoView({block:"center"})},[]);const s=i=>()=>{n(i)};return e("div",{className:"vm-calendar-years",children:o.map(i=>e("div",{className:I({"vm-calendar-years__year":!0,"vm-calendar-years__year_selected":i.format("YYYY")===a,"vm-calendar-years__year_today":i.format("YYYY")===r}),id:`vm-calendar-year-${i.format("YYYY")}`,onClick:s(i),children:i.format("YYYY")},i.format("YYYY")))})},Ec=({viewDate:t,selectDate:n,onChangeViewDate:r})=>{const a=U().format("MM"),o=M(()=>n.format("MM"),[n]),s=M(()=>new Array(12).fill("").map((l,c)=>U(t).month(c)),[t]);A(()=>{const l=document.getElementById(`vm-calendar-year-${o}`);l&&l.scrollIntoView({block:"center"})},[]);const i=l=>()=>{r(l)};return e("div",{className:"vm-calendar-years",children:s.map(l=>e("div",{className:I({"vm-calendar-years__year":!0,"vm-calendar-years__year_selected":l.format("MM")===o,"vm-calendar-years__year_today":l.format("MM")===a}),id:`vm-calendar-year-${l.format("MM")}`,onClick:i(l),children:l.format("MMMM")},l.format("MM")))})},xc=({date:t,format:n=qe,onChange:r})=>{const[a,o]=N(0),[s,i]=N(U.tz(t)),[l,c]=N(U.tz(t)),d=U.tz(),m=d.format(kt)===s.format(kt),{isMobile:u}=J(),h=()=>{o(f=>f===2?0:2)},p=f=>{i(f),o(g=>g===2?1:0)},v=f=>{c(f)},b=()=>{i(d)};return A(()=>{l.format()!==U.tz(t).format()&&r(l.format(n))},[l]),A(()=>{const f=U.tz(t);i(f),c(f)},[t]),e("div",{className:I({"vm-calendar":!0,"vm-calendar_mobile":u}),children:[e(kc,{viewDate:s,onChangeViewDate:p,toggleDisplayYears:h,showArrowNav:a===0}),a===0&&e(Lc,{viewDate:s,selectDate:l,onChangeSelectDate:v}),a===2&&e(Ac,{viewDate:s,onChangeViewDate:p}),a===1&&e(Ec,{selectDate:l,viewDate:s,onChangeViewDate:p}),!m&&a===0&&e("div",{className:"vm-calendar-footer",children:e(D,{variant:"text",size:"small",onClick:b,children:"show today"})})]})},qs=Un(({date:t,targetRef:n,format:r=qe,onChange:a,label:o},s)=>{const i=M(()=>U(t).isValid()?U.tz(t):U().tz(),[t]),{isMobile:l}=J(),{value:c,toggle:d,setFalse:m}=ae(!1),u=p=>{a(p),m()},h=p=>{(p.key==="Escape"||p.key==="Enter")&&m()};return me("click",d,n),me("keyup",h),e(V,{children:e(Ie,{open:c,buttonRef:n,placement:"bottom-right",onClose:m,title:l?o:void 0,children:e("div",{ref:s,children:e(xc,{date:i,format:r,onChange:u})})})})}),co=t=>U(t).isValid()?U.tz(t).format(qe):t,mo=({value:t="",label:n,pickerLabel:r,pickerRef:a,onChange:o,onEnter:s})=>{const i=q(null),[l,c]=N(null),[d,m]=N(co(t)),[u,h]=N(!1),[p,v]=N(!1),b=U(d).isValid()?"":"Invalid date format",f=S=>{m(S.currentTarget.value)},g=()=>{o(d)},_=S=>{S.key==="Enter"&&(o(d),v(!0))},y=S=>{m(S),h(!0)};return A(()=>{const S=co(t);S!==d&&m(S),p&&(s(),v(!1))},[t]),A(()=>{u&&l&&(l.focus(),l.setSelectionRange(11,11),h(!1))},[u]),e("div",{className:I({"vm-date-time-input":!0,"vm-date-time-input_error":b}),children:[e("label",{children:n}),e(ji,{tabIndex:1,inputRef:c,mask:"9999-99-99 99:99:99",placeholder:"YYYY-MM-DD HH:mm:ss",value:d,autoCapitalize:"none",inputMode:"numeric",maskChar:null,onChange:f,onBlur:g,onKeyUp:_}),b&&e("span",{className:"vm-date-time-input__error-text",children:b}),e("div",{className:"vm-date-time-input__icon",ref:i,children:e(D,{variant:"text",color:"gray",size:"small",startIcon:e(Rn,{}),ariaLabel:"calendar"})}),e(qs,{label:r,ref:a,date:d,onChange:y,targetRef:i})]})},ka=()=>{const{isMobile:t}=J(),{isDarkTheme:n}=se(),r=q(null),a=Pt(),o=M(()=>a.width>1120,[a]),[s,i]=N(),[l,c]=N(),{period:{end:d,start:m},relativeTime:u,timezone:h,duration:p}=ge(),v=Be(),b=Ee(),f=qt(h),{value:g,toggle:_,setFalse:y}=ae(!1),S=M(()=>({region:h,utc:en(h)}),[h]);A(()=>{i(Ft(We(d)))},[h,d]),A(()=>{c(Ft(We(m)))},[h,m]);const T=({duration:O,until:H,id:z})=>{v({type:"SET_RELATIVE_TIME",payload:{duration:O,until:H,id:z}}),y()},w=M(()=>{const O=U.tz(We(m)).format(qe),H=U.tz(We(d)).format(qe);return{start:O,end:H}},[m,d,h]),C=M(()=>u&&u!=="none"?u.replace(/_/g," "):`${w.start} - ${w.end}`,[u,w]),k=q(null),L=q(null),x=q(null),E=()=>{l&&s&&v({type:"SET_PERIOD",payload:{from:U.tz(l).toDate(),to:U.tz(s).toDate()}}),y()},P=()=>v({type:"RUN_QUERY_TO_NOW"}),F=()=>{i(Ft(We(d))),c(Ft(We(m))),y()};return A(()=>{const O=Xr({relativeTimeId:u,defaultDuration:p,defaultEndInput:We(d)});f&&h!==f&&T({id:O.relativeTimeId,duration:O.duration,until:O.endInput})},[h,f]),_n(r,O=>{var G,K;if(t)return;const H=O.target,z=(k==null?void 0:k.current)&&((G=k==null?void 0:k.current)==null?void 0:G.contains(H)),Y=(L==null?void 0:L.current)&&((K=L==null?void 0:L.current)==null?void 0:K.contains(H));z||Y||y()}),e(V,{children:[e("div",{ref:x,children:t?e("div",{className:"vm-mobile-option",onClick:_,children:[e("span",{className:"vm-mobile-option__icon",children:e(rn,{})}),e("div",{className:"vm-mobile-option-text",children:[e("span",{className:"vm-mobile-option-text__label",children:"Time range"}),e("span",{className:"vm-mobile-option-text__value",children:C})]}),e("span",{className:"vm-mobile-option__arrow",children:e(be,{})})]}):e(j,{title:o?"Time range controls":C,children:e(D,{className:b?"":"vm-header-button",variant:"contained",color:"primary",startIcon:e(rn,{}),onClick:_,ariaLabel:"time range controls",children:o&&e("span",{children:C})})})}),e(Ie,{open:g,buttonRef:x,placement:"bottom-right",onClose:y,clickOutside:!1,title:t?"Time range controls":"",children:e("div",{className:I({"vm-time-selector":!0,"vm-time-selector_mobile":t}),ref:r,children:[e("div",{className:"vm-time-selector-left",children:[e("div",{className:I({"vm-time-selector-left-inputs":!0,"vm-time-selector-left-inputs_dark":n}),children:[e(mo,{value:l,label:"From:",pickerLabel:"Date From",pickerRef:k,onChange:c,onEnter:E}),e(mo,{value:s,label:"To:",pickerLabel:"Date To",pickerRef:L,onChange:i,onEnter:E})]}),e("div",{className:"vm-time-selector-left-timezone",children:[e("div",{className:"vm-time-selector-left-timezone__title",children:S.region}),e("div",{className:"vm-time-selector-left-timezone__utc",children:S.utc})]}),e(D,{variant:"text",startIcon:e(hs,{}),onClick:P,children:"switch to now"}),e("div",{className:"vm-time-selector-left__controls",children:[e(D,{color:"error",variant:"outlined",onClick:F,children:"Cancel"}),e(D,{color:"primary",onClick:E,children:"Apply"})]})]}),e(Sc,{relativeTime:u||"",setDuration:T})]})})]})},rt=()=>{const t=qn(),[n,r]=oe();return{setSearchParamsFromKeys:W(o=>{const s=!!Array.from(n.values()).length;let i=!1;Object.entries(o).forEach(([l,c])=>{n.get(l)!==`${c}`&&(n.set(l,`${c}`),i=!0)}),i&&(s?r(n):t(`?${n.toString()}`,{replace:!0}))},[n,t])}},Us=()=>{const{isMobile:t}=J(),n=Ee(),r=q(null),[a]=oe(),{setSearchParamsFromKeys:o}=rt(),s=a.get("date")||U().tz().format(kt),i=M(()=>U.tz(s).format(kt),[s]),l=c=>{o({date:c})};return A(()=>{l(s)},[]),e("div",{children:[e("div",{ref:r,children:t?e("div",{className:"vm-mobile-option",children:[e("span",{className:"vm-mobile-option__icon",children:e(Rn,{})}),e("div",{className:"vm-mobile-option-text",children:[e("span",{className:"vm-mobile-option-text__label",children:"Date control"}),e("span",{className:"vm-mobile-option-text__value",children:i})]}),e("span",{className:"vm-mobile-option__arrow",children:e(be,{})})]}):e(j,{title:"Date control",children:e(D,{className:n?"":"vm-header-button",variant:"contained",color:"primary",startIcon:e(Rn,{}),children:i})})}),e(qs,{label:"Date control",date:s||"",format:kt,onChange:l,targetRef:r})]})},gr=[{seconds:0,title:"Off"},{seconds:1,title:"1s"},{seconds:2,title:"2s"},{seconds:5,title:"5s"},{seconds:10,title:"10s"},{seconds:30,title:"30s"},{seconds:60,title:"1m"},{seconds:300,title:"5m"},{seconds:900,title:"15m"},{seconds:1800,title:"30m"},{seconds:3600,title:"1h"},{seconds:7200,title:"2h"}],Ta=()=>{const{isMobile:t}=J(),n=Be(),r=Ee(),[a,o]=N(!1),[s,i]=N(gr[0]),{value:l,toggle:c,setFalse:d}=ae(!1),m=q(null),u=v=>{(a&&!v.seconds||!a&&v.seconds)&&o(b=>!b),i(v),d()},h=()=>{n({type:"RUN_QUERY"})};A(()=>{const v=s.seconds;let b;return a?b=setInterval(()=>{n({type:"RUN_QUERY"})},v*1e3):i(gr[0]),()=>{b&&clearInterval(b)}},[s,a]);const p=v=>()=>{u(v)};return e(V,{children:[e("div",{className:"vm-execution-controls",children:e("div",{className:I({"vm-execution-controls-buttons":!0,"vm-execution-controls-buttons_mobile":t,"vm-header-button":!r}),children:[!t&&e(j,{title:"Refresh dashboard",children:e(D,{variant:"contained",color:"primary",onClick:h,startIcon:e(Gn,{}),ariaLabel:"refresh dashboard"})}),t?e("div",{className:"vm-mobile-option",onClick:c,children:[e("span",{className:"vm-mobile-option__icon",children:e(ct,{})}),e("div",{className:"vm-mobile-option-text",children:[e("span",{className:"vm-mobile-option-text__label",children:"Auto-refresh"}),e("span",{className:"vm-mobile-option-text__value",children:s.title})]}),e("span",{className:"vm-mobile-option__arrow",children:e(be,{})})]}):e(j,{title:"Auto-refresh control",children:e("div",{ref:m,children:e(D,{variant:"contained",color:"primary",fullWidth:!0,endIcon:e("div",{className:I({"vm-execution-controls-buttons__arrow":!0,"vm-execution-controls-buttons__arrow_open":l}),children:e(be,{})}),onClick:c,children:s.title})})})]})}),e(Ie,{open:l,placement:"bottom-right",onClose:d,buttonRef:m,title:t?"Auto-refresh duration":void 0,children:e("div",{className:I({"vm-execution-controls-list":!0,"vm-execution-controls-list_mobile":t}),children:gr.map(v=>e("div",{className:I({"vm-list-item":!0,"vm-list-item_mobile":t,"vm-list-item_active":v.seconds===s.seconds}),onClick:p(v),children:v.title},v.seconds))})})]})},uo={enable:"Enable to save the modified server URL to local storage, preventing reset upon page refresh.",disable:"Disable to stop saving the server URL to local storage, reverting to the default URL on page refresh."},Mc=Un(({onClose:t},n)=>{const{serverUrl:r}=se(),a=xt(),{value:o,toggle:s}=ae(!!Ae("SERVER_URL")),[i,l]=N(r),[c,d]=N(""),m=h=>{l(h||""),d("")},u=W(()=>{const h=dn(i);h!==""&&a({type:"SET_TENANT_ID",payload:h}),a({type:"SET_SERVER",payload:i}),t()},[i]);return A(()=>{r||d(Ce.emptyServer),Qr(r)||d(Ce.validServer)},[r]),A(()=>{o?Le("SERVER_URL",i):Br(["SERVER_URL"])},[o]),A(()=>{o&&Le("SERVER_URL",i)},[i]),A(()=>{r!==i&&l(r)},[r]),Hr(n,()=>({handleApply:u}),[u]),e("div",{children:[e("div",{className:"vm-server-configurator__title",children:"Server URL"}),e("div",{className:"vm-server-configurator-url",children:[e(ce,{autofocus:!0,value:i,error:c,onChange:m,onEnter:u,inputmode:"url"}),e(j,{title:o?uo.disable:uo.enable,children:e(D,{className:"vm-server-configurator-url__button",variant:"text",color:o?"primary":"gray",onClick:s,startIcon:e(Lt,{})})})]})]})}),Ic=[{label:"Graph",type:Ne.chart},{label:"JSON",type:Ne.code},{label:"Table",type:Ne.table}],Pc=Un(({onClose:t},n)=>{const{isMobile:r}=J(),{seriesLimits:a}=je(),o=Gt(),[s,i]=N(a),[l,c]=N({table:"",chart:"",code:""}),d=()=>{i(Ko)},m=h=>p=>{const v=p||"";c(b=>({...b,[h]:+v<0?Ce.positiveNumber:""})),i({...s,[h]:v||1/0})},u=W(()=>{o({type:"SET_SERIES_LIMITS",payload:s}),t()},[s]);return Hr(n,()=>({handleApply:u}),[u]),e("div",{className:"vm-limits-configurator",children:[e("div",{className:"vm-server-configurator__title",children:["Series limits by tabs",e(j,{title:"Set to 0 to disable the limit",children:e(D,{variant:"text",color:"primary",size:"small",startIcon:e(mt,{})})}),e("div",{className:"vm-limits-configurator-title__reset",children:e(D,{variant:"text",color:"primary",size:"small",startIcon:e(ct,{}),onClick:d,children:"Reset limits"})})]}),e("div",{className:I({"vm-limits-configurator__inputs":!0,"vm-limits-configurator__inputs_mobile":r}),children:Ic.map(h=>e("div",{children:e(ce,{label:h.label,value:s[h.type],error:l[h.type],onChange:m(h.type),onEnter:u,type:"number"})},h.type))})]})}),Kn=({defaultExpanded:t=!1,onChange:n,title:r,children:a})=>{const[o,s]=N(t),i=()=>{const l=window.getSelection();l&&l.toString()||s(c=>{const d=!c;return n&&n(d),d})};return A(()=>{s(t)},[t]),e(V,{children:[e("header",{className:`vm-accordion-header ${o&&"vm-accordion-header_open"}`,onClick:i,children:[r,e("div",{className:`vm-accordion-header__arrow ${o&&"vm-accordion-header__arrow_open"}`,children:e(be,{})})]}),o&&e("section",{className:"vm-accordion-section",children:a},"content")]})},Dc="Browser timezone is not recognized, supported, or could not be determined.",Oc=()=>e(j,{title:Dc,children:e(na,{})}),Cn=rs(),Rc=Un((t,n)=>{const{isMobile:r}=J(),a=ao(),{timezone:o,defaultTimezone:s}=ge(),i=Be(),[l,c]=N(o),[d,m]=N(""),u=q(null),{value:h,toggle:p,setFalse:v}=ae(!1),b=M(()=>[{title:`Default time (${s})`,region:s,utc:s?en(s):"UTC"},{title:Cn.title,region:Cn.region,utc:en(Cn.region),isInvalid:!Cn.isValid},{title:"UTC (Coordinated Universal Time)",region:"UTC",utc:"UTC"}].filter(w=>w.region),[s]),f=M(()=>{if(!d)return a;try{return ao(d)}catch{return{}}},[d,a]),g=M(()=>Object.keys(f),[f]),_=M(()=>({region:l,utc:en(l)}),[l]),y=w=>{m(w)},S=w=>{c(w.region),m(""),v()},T=w=>()=>{S(w)};return A(()=>{c(o)},[o]),Hr(n,()=>({handleApply:()=>{i({type:"SET_TIMEZONE",payload:l})}}),[l]),e("div",{className:"vm-timezones",children:[e("div",{className:"vm-server-configurator__title",children:"Time zone"}),e("div",{className:"vm-timezones-item vm-timezones-item_selected",onClick:p,ref:u,children:[e("div",{className:"vm-timezones-item__title",children:_.region}),e("div",{className:"vm-timezones-item__utc",children:_.utc}),e("div",{className:I({"vm-timezones-item__icon":!0,"vm-timezones-item__icon_open":h}),children:e(Je,{})})]}),e(Ie,{open:h,buttonRef:u,placement:"bottom-left",onClose:v,fullWidth:!0,title:r?"Time zone":void 0,children:e("div",{className:I({"vm-timezones-list":!0,"vm-timezones-list_mobile":r}),children:[e("div",{className:"vm-timezones-list-header",children:[e("div",{className:"vm-timezones-list-header__search",children:e(ce,{autofocus:!0,label:"Search",value:d,onChange:y})}),b.map((w,C)=>w&&e("div",{className:"vm-timezones-item vm-timezones-list-group-options__item",onClick:T(w),children:[e("div",{className:"vm-timezones-item__title",children:[w.title,w.isInvalid&&e(Oc,{})]}),e("div",{className:"vm-timezones-item__utc",children:w.utc})]},`${C}_${w.region}`))]}),g.map(w=>e("div",{className:"vm-timezones-list-group",children:e(Kn,{defaultExpanded:!0,title:e("div",{className:"vm-timezones-list-group__title",children:w}),children:e("div",{className:"vm-timezones-list-group-options",children:f[w]&&f[w].map(C=>e("div",{className:"vm-timezones-item vm-timezones-list-group-options__item",onClick:T(C),children:[e("div",{className:"vm-timezones-item__title",children:C.region}),e("div",{className:"vm-timezones-item__utc",children:C.utc})]},C.search))})})},w))]})})]})}),$c=({options:t,value:n,label:r,onChange:a})=>{const o=q(null),[s,i]=N({width:"0px",left:"0px",borderRadius:"0px"}),l=c=>()=>{a(c)};return A(()=>{if(!o.current){i({width:"0px",left:"0px",borderRadius:"0px"});return}const c=t.findIndex(p=>p.value===n),{width:d}=o.current.getBoundingClientRect();let m=d,u=c*m,h="0";c===0&&(h="16px 0 0 16px"),c===t.length-1&&(h="10px",u-=1,h="0 16px 16px 0"),c!==0&&c!==t.length-1&&(m+=1,u-=1),i({width:`${m}px`,left:`${u}px`,borderRadius:h})},[o,n,t]),e("div",{className:"vm-toggles",children:[r&&e("label",{className:"vm-toggles__label",children:r}),e("div",{className:"vm-toggles-group",style:{gridTemplateColumns:`repeat(${t.length}, 1fr)`},children:[s.borderRadius&&e("div",{className:"vm-toggles-group__highlight",style:s}),t.map((c,d)=>e("div",{className:I({"vm-toggles-group-item":!0,"vm-toggles-group-item_first":d===0,"vm-toggles-group-item_active":c.value===n,"vm-toggles-group-item_icon":c.icon&&c.title}),onClick:l(c.value),ref:c.value===n?o:null,children:[c.icon,c.title]},c.value))]})]})},Fc=Object.values(Ge).map(t=>({title:t,value:t})),zc=()=>{const{isMobile:t}=J(),n=xt(),{theme:r}=se(),a=o=>{n({type:"SET_THEME",payload:o})};return e("div",{className:I({"vm-theme-control":!0,"vm-theme-control_mobile":t}),children:[e("div",{className:"vm-server-configurator__title",children:"Theme preferences"}),e("div",{className:"vm-theme-control__toggle",children:e($c,{options:Fc,value:r,onChange:a})},`${t}`)]})},vr="Settings",La=()=>{const{isMobile:t}=J(),n=Ee(),r=q(null),a=q(null),o=q(null),{value:s,setTrue:i,setFalse:l}=ae(!1),c=()=>{r.current&&r.current.handleApply(),a.current&&a.current.handleApply(),o.current&&o.current.handleApply(),l()},d=[{show:!n&&!1,component:e(Mc,{ref:r,onClose:l})},{show:!1,component:e(Pc,{ref:a,onClose:l})},{show:!0,component:e(Rc,{ref:o})},{show:!n,component:e(zc,{})}].filter(m=>m.show);return e(V,{children:[t?e("div",{className:"vm-mobile-option",onClick:i,children:[e("span",{className:"vm-mobile-option__icon",children:e(Ze,{})}),e("div",{className:"vm-mobile-option-text",children:e("span",{className:"vm-mobile-option-text__label",children:vr})}),e("span",{className:"vm-mobile-option__arrow",children:e(be,{})})]}):e(j,{title:vr,children:e(D,{className:I({"vm-header-button":!n}),variant:"contained",color:"primary",startIcon:e(Ze,{}),onClick:i,ariaLabel:"settings"})}),s&&e(Me,{title:vr,onClose:l,children:e("div",{className:I({"vm-server-configurator":!0,"vm-server-configurator_mobile":t}),children:[d.map((m,u)=>e("div",{className:"vm-server-configurator__input",children:m.component},u)),e("div",{className:"vm-server-configurator-footer",children:[e(D,{color:"error",variant:"outlined",onClick:l,children:"Cancel"}),e(D,{color:"primary",variant:"contained",onClick:c,children:"Apply"})]})]})})]})},Hc=({displaySidebar:t,isMobile:n,headerSetup:r,accountIds:a})=>e("div",{className:I({"vm-header-controls":!0,"vm-header-controls_mobile":n}),children:[(r==null?void 0:r.tenant)&&e(Hs,{accountIds:a||[]}),(r==null?void 0:r.stepControl)&&e(Vs,{}),(r==null?void 0:r.timeSelector)&&e(ka,{}),(r==null?void 0:r.cardinalityDatePicker)&&e(Us,{}),(r==null?void 0:r.executionControls)&&e(Ta,{}),e(La,{}),!t&&e(Fs,{})]});Ae("DISABLED_DEFAULT_TIMEZONE");const Aa=()=>{const{serverUrl:t}=se();Be();const[n,r]=N(!1),[a,o]=N(""),s=async()=>{};return A(()=>{s()},[t]),{isLoading:n,error:a}},Vc=()=>{const{serverUrl:t}=se();xt();const[n,r]=N(!1),[a,o]=N("");return A(()=>{(async()=>{})()},[t]),{isLoading:n,error:a}},qc=()=>{xt();const[t,n]=N(!1),[r,a]=N("");return A(()=>{(async()=>{})()},[]),{isLoading:t,error:r}},Uc=()=>{const t=Ee(),{isMobile:n}=J(),{pathname:r}=ht(),[a,o]=oe();Cc(),Aa(),qc(),Vc();const s=()=>{var d;const l="vmui",c=(d=gt[r])==null?void 0:d.title;document.title=c?`${c} - ${l}`:l},i=()=>{const{search:l,href:c}=window.location;if(l){const m=Fr.parse(l,{ignoreQueryPrefix:!0});Object.entries(m).forEach(([u,h])=>a.set(u,h)),o(a),window.location.search=""}const d=c.replace(/\/\?#\//,"/#/");d!==c&&window.location.replace(d)};return A(s,[r]),A(i,[]),e("section",{className:"vm-container",children:[e(Na,{controlsComponent:Hc}),e("div",{className:I({"vm-container-body":!0,"vm-container-body_mobile":n,"vm-container-body_app":t}),children:e(Vr,{})}),!t&&e(Sa,{})]})},Bc=`No match! 
This query hasn't selected any time series from database.
Either the requested metrics are missing in the database,
or there is a typo in series selector.`,jc=`The shown results are marked as PARTIAL.
The result is marked as partial if one or more vmstorage nodes failed to respond to the query.`,Bs=({value:t,onChange:n,onEnter:r,onArrowUp:a,onArrowDown:o,autocomplete:s,autocompleteEl:i,error:l,stats:c,label:d,disabled:m=!1,includeFunctions:u=!0})=>{const{autocompleteQuick:h}=xe(),{isMobile:p}=J(),[v,b]=N(!1),[f,g]=N([0,0]),[_,y]=N([0,0]),S=q(null),[T,w]=N(!!i),C=q(ln(w,500)).current,k=[{show:(c==null?void 0:c.seriesFetched)==="0"&&!c.resultLength,text:Bc},{show:c==null?void 0:c.isPartial,text:jc}].filter(F=>F.show).map(F=>F.text).join("");c&&(d=`${d} (${c.executionTimeMsec||0}ms)`);const L=(F,O)=>{n(F),y([O,O])},x=F=>{const{key:O,ctrlKey:H,metaKey:z,shiftKey:Y}=F,K=(F.target.value||"").split(`
`).length>1,re=H||z,Q=O==="ArrowUp",ie=O==="ArrowDown",X=O==="Enter";Q&&re&&(F.preventDefault(),a()),ie&&re&&(F.preventDefault(),o()),X&&v&&F.preventDefault(),X&&!Y&&(!K||re)&&!v&&(F.preventDefault(),r())},E=F=>{b(!!F.length)},P=F=>{g(O=>O[0]===F[0]&&O[1]===F[1]?O:F)};return A(()=>{b(!!i&&h)},[h]),A(()=>{w(!1),C(!0)},[f]),e("div",{className:"vm-query-editor",ref:S,children:[e(ce,{value:t,label:d,type:"textarea",autofocus:!p,error:l,warning:k,onKeyDown:x,onChange:n,onChangeCaret:P,disabled:m,inputmode:"search",caretPosition:_}),T&&s&&i&&e(i,{value:t,anchorEl:S,caretPosition:f,hasHelperText:!!(k||l),includeFunctions:u,onSelect:L,onFoundOptions:E})]})},_e=({value:t=!1,disabled:n=!1,label:r,color:a="secondary",fullWidth:o,onChange:s})=>{const i=()=>{n||s(!t)},l=I({"vm-switch":!0,"vm-switch_full-width":o,"vm-switch_disabled":n,"vm-switch_active":t,[`vm-switch_${a}_active`]:t,[`vm-switch_${a}`]:a});return e("div",{className:l,onClick:i,children:[e("div",{className:"vm-switch-track",children:e("div",{className:"vm-switch-track__thumb"})}),r&&e("span",{className:"vm-switch__label",children:r})]})},ho=({isMobile:t,hideButtons:n})=>{const{autocomplete:r}=xe(),a=Mt(),{nocache:o,isTracingEnabled:s,reduceMemUsage:i}=je(),l=Gt(),c=()=>{l({type:"TOGGLE_NO_CACHE"})},d=()=>{l({type:"TOGGLE_REDUCE_MEM_USAGE"})},m=()=>{l({type:"TOGGLE_QUERY_TRACING"})},u=()=>{a({type:"TOGGLE_AUTOCOMPLETE"})},h=()=>{a({type:"SET_AUTOCOMPLETE_QUICK",payload:!0})};return me("keydown",v=>{const{code:b,ctrlKey:f,altKey:g}=v;b==="Space"&&(f||g)&&(v.preventDefault(),h())}),e("div",{className:I({"vm-additional-settings":!0,"vm-additional-settings_mobile":t}),children:[!(n!=null&&n.autocomplete)&&e(j,{title:e(V,{children:["Quick tip: ",$s]}),children:e(_e,{label:"Autocomplete",value:r,onChange:u,fullWidth:t})}),!(n!=null&&n.disableCache)&&e(_e,{label:"Disable cache",value:o,onChange:c,fullWidth:t}),!(n!=null&&n.reduceMemUsage)&&e(_e,{label:"Disable deduplication",value:i,onChange:d,fullWidth:t}),!(n!=null&&n.traceQuery)&&e(_e,{label:"Trace query",value:s,onChange:m,fullWidth:t})]})},Qc=t=>{const{isMobile:n}=J(),r=q(null),{value:a,toggle:o,setFalse:s}=ae(!1);return n?e(V,{children:[e("div",{ref:r,children:e(D,{variant:"outlined",startIcon:e(_s,{}),onClick:o,ariaLabel:"additional the query settings"})}),e(Ie,{open:a,buttonRef:r,placement:"bottom-left",onClose:s,title:"Query settings",children:e(ho,{isMobile:n,...t})})]}):e(ho,{...t})},Zn=(t,n)=>t.length===n.length&&t.every((r,a)=>r===n[a]);function js(t,n){const r=t.reduce((a,o)=>{const s=n.map(i=>`${String(i)}: ${o[i]||"-"}`).join("|");return(a[s]=a[s]||[]).push(o),a},{});return Object.entries(r).map(([a,o])=>({keys:a.split("|"),values:o}))}const Yc=t=>t.length<2?!1:t.every((n,r)=>r===0||n<t[r-1]),Gc=()=>{const{serverUrl:t}=se();return async r=>{try{const a=encodeURIComponent(r),o=`${t}/prettify-query?query=${a}`,s=await fetch(o);if(s.status!=200)return{query:r,error:"Error requesting /prettify-query, status: "+s.status};const i=await s.json();return i.status!="success"?{query:r,error:String(i.msg)}:{query:String(i.query),error:""}}catch(a){return console.error(a),a instanceof Error&&a.name!=="AbortError"?{query:r,error:`${a.name}: ${a.message}`}:{query:r,error:String(a)}}}},Fe=()=>{const{showInfoMessage:t}=Kl();return async(n,r)=>{if(!(navigator!=null&&navigator.clipboard))return t({text:e(Wc,{}),type:"error",timeout:2e4}),!1;try{return await navigator.clipboard.writeText(n),r&&t({text:r,type:"success"}),!0}catch(a){return a instanceof Error&&t({text:`${a.name}: ${a.message}`,type:"error"}),console.warn("Copy failed",a),!1}}},Wc=()=>e("div",{className:"vm-snackbar-details",children:[e("p",{className:"vm-snackbar-details__title",children:"Clipboard not supported"}),window.isSecureContext?e("p",{className:"vm-snackbar-details__msg",children:[e("p",{children:"Common reasons:"}),e("ul",{children:[e("li",{children:"Browser restrictions"}),e("li",{children:"Insecure connection (HTTP)"}),e("li",{children:"Permissions not granted"})]}),e("p",{children:["For detailed information, visit the ",e("a",{className:"vm-link vm-link_underlined vm-link_colored",href:"https://developer.mozilla.org/en-US/docs/Web/API/Clipboard_API#security_considerations",target:"_blank",rel:"noopener noreferrer",children:"Clipboard API documentation"})]})]}):e("p",{className:"vm-snackbar-details__msg",children:[e("p",{children:"This page is not running in a secure context (HTTPS)."}),e("p",{children:"Clipboard operations require a secure context."}),e("a",{className:"vm-link vm-link_underlined vm-link_colored",href:"https://developer.mozilla.org/en-US/docs/Web/Security/Secure_Contexts",target:"_blank",rel:"noopener noreferrer",children:"Learn more about secure contexts"})]})]}),Jc=({query:t,favorites:n,onRun:r,onToggleFavorite:a})=>{const o=Fe(),s=M(()=>n.includes(t),[t,n]);return e("div",{className:"vm-query-history-item",children:[e("span",{className:"vm-query-history-item__value",children:t}),e("div",{className:"vm-query-history-item__buttons",children:[e(j,{title:"Execute query",children:e(D,{size:"small",variant:"text",onClick:()=>{r(t)},startIcon:e(hn,{})})}),e(j,{title:"Copy query",children:e(D,{size:"small",variant:"text",onClick:async()=>{await o(t,"Query has been copied")},startIcon:e(Xe,{})})}),e(j,{title:s?"Remove Favorite":"Add to Favorites",children:e(D,{size:"small",variant:"text",color:s?"warning":"primary",onClick:()=>{a(t,s)},startIcon:s?e(ws,{}):e(ys,{})})})]})]})},St={session:"session",storage:"saved",favorite:"favorite"},po=[{label:"Session history",value:St.session},{label:"Saved history",value:St.storage},{label:"Favorite queries",value:St.favorite}],Qs=({handleSelectQuery:t,historyKey:n})=>{const{queryHistory:r}=xe(),{isMobile:a}=J(),{value:o,setTrue:s,setFalse:i}=ae(!1),[l,c]=N(po[0].value),[d,m]=N(Zt(n,"QUERY_HISTORY")),[u,h]=N(Zt(n,"QUERY_FAVORITES")),p=M(()=>r.map(T=>T.values.filter(w=>w).reverse()),[r]),v=M(()=>{switch(l){case St.favorite:return u;case St.storage:return d;default:return p}},[l,u,d,p]),b=v==null?void 0:v.every(T=>!T.length),f=M(()=>{switch(l){case St.favorite:return`Favorites queries are empty.
To see your favorites, mark a query as a favorite.`;default:return`Query history is empty.
To see the history, please make a query.`}},[l]),g=T=>w=>{t(w,T),i()},_=(T,w)=>{h(C=>{const k=C[0]||[];return w?[k.filter(L=>L!==T)]:!w&&!k.includes(T)?[[...k,T]]:C})},y=()=>{m(Zt(n,"QUERY_HISTORY")),h(Zt(n,"QUERY_FAVORITES"))},S=()=>{Sl(n,"QUERY_HISTORY")};return A(()=>{const T=u[0]||[],w=Zt(n,"QUERY_FAVORITES")[0]||[];Zn(T,w)||Nl(n,u)},[u]),me("storage",y),e(V,{children:[e(j,{title:"Show history",children:e(D,{color:"primary",variant:"text",onClick:s,startIcon:e(rn,{}),ariaLabel:"Show history"})}),o&&e(Me,{title:"Query history",onClose:i,children:e("div",{className:I({"vm-query-history":!0,"vm-query-history_mobile":a}),children:[e("div",{className:I({"vm-query-history__tabs":!0,"vm-section-header__tabs":!0,"vm-query-history__tabs_mobile":a}),children:e(Yt,{activeItem:l,items:po,onChange:c})}),e("div",{className:"vm-query-history-list",children:[b&&e("div",{className:"vm-query-history-list__no-data",children:f}),v.map((T,w)=>e("div",{children:[v.length>1&&e("div",{className:I({"vm-query-history-list__group-title":!0,"vm-query-history-list__group-title_first":w===0}),children:["Query ",w+1]}),T.map((C,k)=>e(Jc,{query:C,favorites:u.flat(),onRun:g(w),onToggleFavorite:_},k))]},w)),l===St.storage&&!b&&e("div",{className:"vm-query-history-footer",children:e(D,{color:"error",variant:"outlined",size:"small",startIcon:e(gn,{}),onClick:S,children:"clear history"})})]})]})})]})},Qe=({containerStyles:t,message:n})=>{const{isDarkTheme:r}=se();return e("div",{className:I({"vm-spinner":!0,"vm-spinner_dark":r}),style:t,children:[e("div",{className:"half-circle-spinner",children:[e("div",{className:"circle circle-1"}),e("div",{className:"circle circle-2"})]}),n&&e("div",{className:"vm-spinner__message",children:n})]})},Kc=()=>{const{serverUrl:t}=se(),{isMobile:n}=J(),{value:r,setTrue:a,setFalse:o}=ae(!1),{query:s}=xe(),{period:i}=ge(),[l,c]=N(!1),[d,m]=N(""),[u,h]=N(""),[p,v]=N(""),b=async()=>{c(!0);try{const g=encodeURIComponent(s[0]||""),_=encodeURIComponent(i.step||mn(i.end-i.start,!1)),y=`${t}/api/vmanomaly/config.yaml?query=${g}&step=${_}`,S=await fetch(y),T=S.headers.get("Content-Type");if(S.ok)if(T=="application/yaml"){const w=await S.blob(),C=await w.text();m(C),h(URL.createObjectURL(w))}else v("Response Content-Type is not YAML, does `Server URL` point to VMAnomaly server?");else{const w=await S.text();v(` ${S.status} ${S.statusText}: ${w}`)}}catch(g){console.error(g),v(String(g))}c(!1)};return e(V,{children:[e(D,{color:"secondary",variant:"outlined",onClick:()=>(a(),v(""),URL.revokeObjectURL(u),m(""),h(""),b()),children:"Open Config"}),r&&e(Me,{title:"Download config",onClose:o,children:e("div",{className:I({"vm-anomaly-config":!0,"vm-anomaly-config_mobile":n}),children:[l&&e(Qe,{containerStyles:{position:"relative"},message:"Loading config..."}),!l&&p&&e("div",{className:"vm-anomaly-config-error",children:[e("div",{className:"vm-anomaly-config-error__icon",children:e(ra,{})}),e("h3",{className:"vm-anomaly-config-error__title",children:"Cannot download config"}),e("p",{className:"vm-anomaly-config-error__text",children:p})]}),!l&&d&&e(ce,{value:d,label:"config.yaml",type:"textarea",disabled:!0}),e("div",{className:"vm-anomaly-config-footer",children:u&&e("a",{href:u,download:"config.yaml",children:e(D,{variant:"contained",startIcon:e(fn,{}),children:"download"})})})]})})]})},Ea=({value:t,options:n,anchor:r,disabled:a,minLength:o=2,fullWidth:s,selected:i,noOptionsText:l,label:c,disabledFullScreen:d,offset:m,maxDisplayResults:u,loading:h,onSelect:p,onOpenAutocomplete:v,onFoundOptions:b,onChangeWrapperRef:f})=>{var re;const{isMobile:g}=J(),_=q(null),[y,S]=N({index:-1}),[T,w]=N(""),[C,k]=N(0),{value:L,setValue:x,setFalse:E}=ae(!1),P=M(()=>{if(!L)return[];try{const Q=new RegExp(String(t.trim()),"i"),X=n.filter(R=>Q.test(R.value)).sort((R,$)=>{var B,ee;return R.value.toLowerCase()===t.trim().toLowerCase()?-1:$.value.toLowerCase()===t.trim().toLowerCase()?1:(((B=R.value.match(Q))==null?void 0:B.index)||0)-(((ee=$.value.match(Q))==null?void 0:ee.index)||0)});return k(X.length),w(X.length>Number(u==null?void 0:u.limit)&&(u==null?void 0:u.message)||""),u!=null&&u.limit?X.slice(0,u.limit):X}catch{return[]}},[L,n,t]),F=M(()=>{var Q;return P.length===1&&((Q=P[0])==null?void 0:Q.value)===t},[P]),O=M(()=>l&&!P.length,[l,P]),H=Q=>()=>{a||(p(Q.value,Q),i||E())},z=Q=>()=>{S({index:Q,type:0})},Y=()=>{S({index:-1})},G=()=>{if(!_.current||y.type===0)return;const Q=_.current.childNodes[y.index];Q!=null&&Q.scrollIntoView&&Q.scrollIntoView({block:"center"})},K=W(Q=>{const{key:ie,ctrlKey:X,metaKey:R,shiftKey:$}=Q,B=X||R||$,ee=P.length&&!F;if(ie==="ArrowUp"&&!B&&ee&&(Q.preventDefault(),S(({index:te})=>({index:te<=0?0:te-1,type:1}))),ie==="ArrowDown"&&!B&&ee){Q.preventDefault();const te=P.length-1;S(({index:ue})=>({index:ue>=te?te:ue+1,type:1}))}if(ie==="Enter"){const te=P[y.index];te&&p(te.value,te),i||E()}ie==="Escape"&&E()},[y,P,F,E,p,i]);return A(()=>{x(t.length>=o)},[t,n]),me("keydown",K),A(G,[y,P]),A(()=>{S({index:-1})},[P]),A(()=>{v&&v(L)},[L]),A(()=>{b&&b(F?[]:P)},[P,F]),A(()=>{f&&f(_)},[_]),e(Ie,{open:L,buttonRef:r,placement:"bottom-left",onClose:E,fullWidth:s,title:g?c:void 0,disabledFullScreen:d,offset:m,children:[e("div",{className:I({"vm-autocomplete":!0,"vm-autocomplete_mobile":g&&!d}),ref:_,children:[h&&e("div",{className:"vm-autocomplete__loader",children:[e(Gn,{}),e("span",{children:"Loading..."})]}),O&&e("div",{className:"vm-autocomplete__no-options",children:l}),!F&&P.map((Q,ie)=>e("div",{className:I({"vm-list-item":!0,"vm-list-item_mobile":g,"vm-list-item_active":ie===y.index,"vm-list-item_multiselect":i,"vm-list-item_multiselect_selected":i==null?void 0:i.includes(Q.value),"vm-list-item_with-icon":Q.icon}),id:`$autocomplete$${Q.value}`,onClick:H(Q),onMouseEnter:z(ie),onMouseLeave:Y,children:[(i==null?void 0:i.includes(Q.value))&&e(Wn,{}),e(V,{children:Q.icon}),e("span",{children:Q.value})]},`${ie}${Q.value}`))]}),T&&e("div",{className:"vm-autocomplete-message",children:["Shown ",u==null?void 0:u.limit," results out of ",C,". ",T]}),((re=P[y.index])==null?void 0:re.description)&&e("div",{className:"vm-autocomplete-info",children:[e("div",{className:"vm-autocomplete-info__type",children:P[y.index].type}),e("div",{className:"vm-autocomplete-info__description",dangerouslySetInnerHTML:{__html:P[y.index].description||""}})]})]})},Hn=t=>t.replace(/[/\-\\^$*+?.()|[\]{}]/g,"\\$&"),Nn=t=>JSON.stringify(t).slice(1,-1),Ys=t=>{const n=t.match(/["`']/g);return n?n.length%2!==0:!1},Zc={metric:e(Fn,{}),label:e(da,{}),labelValue:e(zn,{})},Xc=({valueByContext:t,metric:n,label:r,context:a})=>{const{serverUrl:o}=se(),{period:{start:s,end:i}}=ge(),{autocompleteCache:l}=xe(),c=Mt(),[d,m]=N(!1),[u,h]=N(t),p=ln(h,500);A(()=>(p(t),p.cancel),[t,p]);const[v,b]=N([]),[f,g]=N([]),[_,y]=N([]),S=q(new AbortController),T=W(k=>{const L=U(s*1e3).startOf("day").valueOf()/1e3,x=U(i*1e3).endOf("day").valueOf()/1e3;return new URLSearchParams({...k||{},limit:`${Tt.queryLimit}`,start:`${L}`,end:`${x}`})},[s,i]),w=(k,L)=>k.map(x=>({value:x,type:`${L}`,icon:Zc[L]})),C=async({value:k,urlSuffix:L,setter:x,type:E,params:P})=>{if(!k&&E==="metric")return;S.current.abort(),S.current=new AbortController;const{signal:F}=S.current,O={type:E,value:k,start:(P==null?void 0:P.get("start"))||"",end:(P==null?void 0:P.get("end"))||"",match:(P==null?void 0:P.get("match[]"))||""};m(!0);try{const H=l.get(O);if(H){x(w(H,E)),m(!1);return}const z=await fetch(`${o}/api/v1/${L}?${P}`,{signal:F});if(z.ok){const{data:Y}=await z.json();x(w(Y,E)),c({type:"SET_AUTOCOMPLETE_CACHE",payload:{key:O,value:Y}})}m(!1)}catch(H){H instanceof Error&&H.name!=="AbortError"&&(c({type:"SET_AUTOCOMPLETE_CACHE",payload:{key:O,value:[]}}),m(!1),console.error(H))}};return A(()=>{const k=a!==Oe.metricsql&&a!==Oe.empty;if(!o||!n||k)return;b([]);const L=Nn(Hn(n));return C({value:u,urlSuffix:"label/__name__/values",setter:b,type:"metric",params:T({"match[]":`{__name__=~".*${L}.*"}`})}),()=>{var x;return(x=S.current)==null?void 0:x.abort()}},[o,u,a,n]),A(()=>{if(!o||a!==Oe.label)return;g([]);const k=Nn(n);return C({value:u,urlSuffix:"labels",setter:g,type:"label",params:T(n?{"match[]":`{__name__="${k}"}`}:void 0)}),()=>{var L;return(L=S.current)==null?void 0:L.abort()}},[o,u,a,n]),A(()=>{if(!o||!r||a!==Oe.labelValue)return;y([]);const k=Nn(n),L=Nn(Hn(u)),x=n?`__name__="${k}"`:"",E=`${r}=~".*${L}.*"`,P=[x,E].filter(Boolean).join(",");return C({value:u,urlSuffix:`label/${r}/values`,setter:y,type:"labelValue",params:T({"match[]":`{${P}}`})}),()=>{var F;return(F=S.current)==null?void 0:F.abort()}},[o,u,a,n,r]),{metrics:v,labels:f,labelValues:_,loading:d}},ed=""+new URL("MetricsQL-Ckl-MH95.md",import.meta.url).href,Gs="h3",td="h4",nd="p",rd="https://docs.victoriametrics.com/victoriametrics/metricsql/",ad="vm-link vm-link_colored",od=t=>{const n=`$1 target="_blank" class="${ad}" $2${rd}#`;return t.replace(/(<a) (href=")#/gm,n)},sd=t=>{const n=[];let r=t.nextElementSibling;for(;r&&r.tagName.toLowerCase()===nd;)r&&n.push(r),r=r.nextElementSibling;return n},id=(t,n)=>{const r=n.textContent??"",o=sd(n).map(s=>s.outerHTML??"").join(`
`);return{type:t,value:r,description:od(o),icon:e(an,{})}},ld=t=>{let n="";return Array.from(t).map(r=>{const a=r.tagName.toLowerCase()===Gs;return n=a?r.textContent??"":n,a?null:id(n,r)}).filter(Boolean)},cd=t=>{const{metricsQLFunctions:n}=xe(),r=Mt(),a=o=>{const s=document.createElement("div");s.innerHTML=Bt(o);const i=s.querySelectorAll(`${Gs}, ${td}`);return ld(i)};return A(()=>{if(!t||n.length)return;(async()=>{try{const i=await(await fetch(ed)).text(),l=a(i);r({type:"SET_METRICSQL_FUNCTIONS",payload:l})}catch(s){console.error("Error fetching or processing the MetricsQL.md file:",s)}})()},[]),t?n:[]};function dd(t){const n=/\s(or|and|unless|default|ifnot|if|group_left|group_right)\s|}|\+|\|-|\*|\/|\^/i,r=t.split(n),a=r[r.length-1].trim(),o=/.*\(([^)]*)$/,s=a.match(o);if(s&&s[1]){const i=s[1];if(i.lastIndexOf("{")>i.lastIndexOf("}")){const c=i.match(/([\w_.:]+)\{[^}]*$/);return c?c[0]:a}const l=i.lastIndexOf(",");return l!==-1?i.substring(l+1).trim():i}return a}function md(t){const n=t.match(/([\w_.:]+(?![},]))$/);return n?n[0]:""}function ud(t){const n=/([{(),+\-*/^]|\b(?:or|and|unless|default|ifnot|if|group_left|group_right|by|without|on|ignoring)\b)/i,r=t.split(/\s+/),a=r.length,o=r[a-1],s=r[a-2],i=!o&&Ys(t),l=(!o||r.length>1)&&!n.test(s);return i||l}function hd(t,n="",r=""){const a=t.trim(),o=["}",")"].some(d=>a.endsWith(d)),s=!Ys(a)&&["`","'",'"'].some(d=>a.endsWith(d));if(!a||o||s||ud(a))return Oe.empty;const i=/(?:by|without|on|ignoring)\s*\(\s*[^)]*$|\{[^}]*$/i,l=`(${Hn(n)})?{?.+${Hn(r)}(=|!=|=~|!~)"?([^"]*)$`,c=new RegExp(l,"g");switch(!0){case c.test(a):return Oe.labelValue;case i.test(a):return Oe.label;default:return Oe.metricsql}}const pd=({value:t,anchorEl:n,caretPosition:r,hasHelperText:a,includeFunctions:o,onSelect:s,onFoundOptions:i})=>{const[l,c]=N({top:0,left:0}),d=cd(o),m=M(()=>{if(r[0]!==r[1])return{beforeCursor:t,afterCursor:""};const w=t.substring(0,r[0]),C=t.substring(r[1]);return{beforeCursor:w,afterCursor:C}},[t,r]),u=M(()=>dd(m.beforeCursor),[m]),h=M(()=>{const w=/\w+\((?<metricName>[^)]+)\)\s+(by|without|on|ignoring)\s*\(\w*/gi,C=[...u.matchAll(w)];if(C.length>0&&C[0].groups&&C[0].groups.metricName)return C[0].groups.metricName;const k=/^\s*\b(?<metricName>[^{}(),\s]+)(?={|$)/g,L=[...u.matchAll(k)];return L.length>0&&L[0].groups&&L[0].groups.metricName?L[0].groups.metricName:""},[u]),p=M(()=>{const w=/[a-z_:-][\w\-.:/]*\b(?=\s*(=|!=|=~|!~))/g,C=u.match(w);return C?C[C.length-1]:""},[u]),v=M(()=>hd(m.beforeCursor,h,p),[m,h,p]),b=M(()=>md(m.beforeCursor),[m.beforeCursor]),{metrics:f,labels:g,labelValues:_,loading:y}=Xc({valueByContext:b,metric:h,label:p,context:v}),S=M(()=>{switch(v){case Oe.metricsql:return[...f,...d];case Oe.label:return g;case Oe.labelValue:return _;default:return[]}},[v,f,g,_]),T=W(w=>{const C=m.beforeCursor;let k=m.afterCursor;const L=C.lastIndexOf(b,r[0]),x=L+b.length,E=C.substring(0,L),P=C.substring(x);if(v===Oe.labelValue){const O='"';k=k.replace(/^[^\s"|},]*/,"");const H=/(?:=|!=|=~|!~)$/.test(E),z=k.trim()[0]!=='"';w=`${H?O:""}${w}${z?O:""}`}v===Oe.label&&(k=k.replace(/^[^\s=!,{}()"|+\-/*^]*/,"")),v===Oe.metricsql&&(k=k.replace(/^[^\s[\]{}()"|+\-/*^]*/,""));const F=`${E}${w}${P}${k}`;s(F,E.length+w.length)},[m]);return A(()=>{if(!n.current){c({top:0,left:0});return}const w=n.current.querySelector("textarea")||n.current,C=window.getComputedStyle(w),k=`${C.getPropertyValue("font-size")}`,L=`${C.getPropertyValue("font-family")}`,x=parseInt(`${C.getPropertyValue("line-height")}`),E=document.createElement("div");E.style.font=`${k} ${L}`,E.style.padding=C.getPropertyValue("padding"),E.style.lineHeight=`${x}px`,E.style.width=`${w.offsetWidth}px`,E.style.maxWidth=`${w.offsetWidth}px`,E.style.whiteSpace=C.getPropertyValue("white-space"),E.style.overflowWrap=C.getPropertyValue("overflow-wrap");const P=document.createElement("span");E.appendChild(document.createTextNode(m.beforeCursor)),E.appendChild(P),E.appendChild(document.createTextNode(m.afterCursor)),document.body.appendChild(E);const F=E.getBoundingClientRect(),O=P.getBoundingClientRect(),H=O.left-F.left,z=O.bottom-F.bottom-(a?x:0);c({top:z,left:H}),E.remove(),P.remove()},[n,r,a]),e(V,{children:e(Ea,{loading:y,disabledFullScreen:!0,value:b,options:S,anchor:n,minLength:0,offset:l,onSelect:T,onFoundOptions:i,maxDisplayResults:{limit:Tt.displayResults,message:"Please, specify the query more precisely."}})})},xa=({queryErrors:t,setQueryErrors:n,setHideError:r,stats:a,label:o,isLoading:s,includeFunctions:i=!0,onHideQuery:l,onRunQuery:c,abortFetch:d,hideButtons:m})=>{const{isMobile:u}=J(),{query:h,queryHistory:p,autocomplete:v,autocompleteQuick:b}=xe(),f=Mt(),g=Be(),[_,y]=N(h||[]),[S,T]=N([]),[w,C]=N(!1),k=qt(_),L=Gc(),x=()=>{f({type:"SET_QUERY_HISTORY",payload:{key:"METRICS_QUERY_HISTORY",history:_.map((X,R)=>is(X,p[R]))}})},E=()=>{if(s){d&&d();return}x(),f({type:"SET_QUERY",payload:_}),g({type:"RUN_QUERY"}),c()},P=()=>{y(X=>[...X,""])},F=X=>{y(R=>R.filter(($,B)=>B!==X))},O=(X,R)=>{const{ctrlKey:$,metaKey:B}=X;if($||B){const te=_.map((ue,he)=>he).filter(ue=>ue!==R);T(ue=>Zn(te,ue)?[]:te)}else T(te=>te.includes(R)?te.filter(ue=>ue!==R):[...te,R])},H=(X,R)=>{y($=>$.map((B,ee)=>ee===R?X:B))},z=(X,R)=>{H(X,R),C(!0)},Y=(X,R)=>{const{index:$,values:B}=p[R],ee=$+X;ee<0||ee>=B.length||(H(B[ee]||"",R),f({type:"SET_QUERY_HISTORY_BY_INDEX",payload:{value:{values:B,index:ee},queryNumber:R}}))},G=(X,R)=>()=>{Y(X,R)},K=X=>R=>{H(R,X),f({type:"SET_AUTOCOMPLETE_QUICK",payload:!1})},re=X=>()=>{F(X),T(R=>R.includes(X)?R.filter($=>$!==X):R.map($=>$>X?$-1:$))},Q=X=>R=>{O(R,X)},ie=async X=>{const R=await L(_[X]);r(!1),H(R.query,X),n($=>($[X]=R.error,[...$]))};return A(()=>{k&&_.length<k.length&&E()},[_]),A(()=>{l&&l(S)},[S]),A(()=>{w&&(E(),C(!1))},[_,w]),A(()=>{y(h||[])},[h]),e("div",{className:I({"vm-query-configurator":!0,"vm-block":!0,"vm-block_mobile":u}),children:[e("div",{className:"vm-query-configurator-list",children:_.map((X,R)=>e("div",{className:I({"vm-query-configurator-list-row":!0,"vm-query-configurator-list-row_disabled":S.includes(R),"vm-query-configurator-list-row_mobile":u}),children:[e(Bs,{value:_[R],autocomplete:!(m!=null&&m.autocomplete)&&(v||b),autocompleteEl:pd,error:t[R],stats:a[R],onArrowUp:G(-1,R),onArrowDown:G(1,R),onEnter:E,onChange:K(R),label:`${o||"Query"} ${_.length>1?R+1:""}`,disabled:S.includes(R),includeFunctions:i}),l&&e(j,{title:S.includes(R)?"Enable query":"Disable query",children:e("div",{className:"vm-query-configurator-list-row__button",children:e(D,{variant:"text",color:"gray",startIcon:S.includes(R)?e(sa,{}):e(Vt,{}),onClick:Q(R),ariaLabel:"visibility query"})})}),!(m!=null&&m.prettify)&&e(j,{title:"Prettify query",children:e("div",{className:"vm-query-configurator-list-row__button",children:e(D,{variant:"text",color:"gray",startIcon:e(vs,{}),onClick:async()=>await ie(R),className:"prettify",ariaLabel:"prettify the query"})})}),_.length>1&&e(j,{title:"Remove Query",children:e("div",{className:"vm-query-configurator-list-row__button",children:e(D,{variant:"text",color:"error",startIcon:e(gn,{}),onClick:re(R),ariaLabel:"remove query"})})})]},R))}),e("div",{className:"vm-query-configurator-settings",children:[e(Qc,{hideButtons:m}),e("div",{className:"vm-query-configurator-settings__buttons",children:[e(Qs,{handleSelectQuery:z,historyKey:"METRICS_QUERY_HISTORY"}),(m==null?void 0:m.anomalyConfig)&&e(Kc,{}),!(m!=null&&m.addQuery)&&_.length<In&&e(D,{variant:"outlined",onClick:P,startIcon:e(oa,{}),children:"Add Query"}),e(D,{variant:"contained",onClick:E,startIcon:s?e(ha,{}):e(nt,{}),children:`${s?"Cancel":"Execute"} ${u?"":"Query"}`})]})]})]})},gd=(t,n,r,a,o)=>`${t}/api/v1/query_range?query=${encodeURIComponent(n)}&start=${r.start}&end=${r.end}&step=${r.step}${a?"&nocache=1":""}${o?"&trace=1":""}`,vd=(t,n,r,a,o)=>`${t}/api/v1/query?query=${encodeURIComponent(n)}&time=${r.end}&step=${r.step}${a?"&nocache=1":""}${o?"&trace=1":""}`,fd=(t,n,r,a)=>{const o=new URLSearchParams({"match[]":n,start:r.start.toString(),end:r.end.toString()});return a&&o.set("reduce_mem_usage","1"),`${t}/api/v1/export?${o}`};let _d=0;class At{constructor(n,r){we(this,"tracing");we(this,"query");we(this,"tracingChildren");we(this,"originalTracing");we(this,"id");this.tracing=n,this.originalTracing=JSON.parse(JSON.stringify(n)),this.query=r,this.id=_d++;const a=n.children||[];this.tracingChildren=a.map(o=>new At(o,r))}get queryValue(){return this.query}get idValue(){return this.id}get children(){return this.tracingChildren}get message(){return this.tracing.message}get duration(){return this.tracing.duration_msec}get JSON(){return JSON.stringify(this.tracing,null,2)}get originalJSON(){return JSON.stringify(this.originalTracing,null,2)}setTracing(n){this.tracing=n;const r=n.children||[];this.tracingChildren=r.map(a=>new At(a,this.query))}setQuery(n){this.query=n}resetTracing(){this.tracing=this.originalTracing}}const Ir=(t,n,r=!0)=>{const{__name__:a,...o}=t.metric,s=r?`[Query ${t.group}] `:"";if(n)return Ws(t.metric,n);const i=`${s}${a||""}`;if(Object.keys(o).length===0)return i||"value";const l=Object.entries(o).map(([c,d])=>`${c}=${JSON.stringify(d)}`).join(", ");return`${i}{${l}}`},Ws=(t,n)=>n.replace(/\{\{(\w+)}}/g,(r,a)=>t[a]||""),sn=t=>{switch(t){case"NaN":return NaN;case"Inf":case"+Inf":return 1/0;case"-Inf":return-1/0;default:return parseFloat(t)}},Ma=t=>{if(t.length<2)return!1;const n=["le","vmrange"],r=Object.keys(t[0].metric).filter(o=>!n.includes(o));return t.every(o=>{const s=Object.keys(o.metric).filter(i=>!n.includes(i));return r.length===s.length&&s.every(i=>o.metric[i]===t[0].metric[i])})&&t.every(o=>n.some(s=>s in o.metric))},Xn=({predefinedQuery:t,visible:n,display:r,customStep:a,hideQuery:o,showAllSeries:s})=>{const{query:i}=xe(),{period:l}=ge(),{displayType:c,nocache:d,isTracingEnabled:m,seriesLimits:u}=je(),{serverUrl:h}=se(),{isHistogram:p}=He(),[v,b]=N(!1),[f,g]=N(),[_,y]=N(),[S,T]=N(),[w,C]=N(),[k,L]=N([]),[x,E]=N([]),[P,F]=N(),[O,H]=N([]),[z,Y]=N(!1),G=M(()=>{const{end:$,start:B}=l;return mn($-B,p,c)},[l,p,c]),re=W(ln(async({fetchUrl:$,fetchQueue:B,displayType:ee,query:te,stateSeriesLimits:ue,showAllSeries:he,hideQuery:Ye})=>{const ye=new AbortController;H([...B,ye]);try{const Pe=ee===Ne.chart,De=he?1/0:+ue[ee]||1/0;let Ve=De;const pe=[],Dt=[];let at=1,wt=0,Jt=!1;for await(const ft of $){if(Ye==null?void 0:Ye.includes(at-1)){L(_t=>[..._t,""]),E(_t=>[..._t,{}]),at++;continue}const ur=new URL(ft),eo=await fetch(`${ur.origin}${ur.pathname}`,{signal:ye.signal,method:"POST",body:ur.searchParams}),ve=await eo.json();if(eo.ok){if(E(et=>[...et,{...ve==null?void 0:ve.stats,isPartial:ve==null?void 0:ve.isPartial,resultLength:ve.data.result.length}]),L(et=>[...et,""]),ve.trace){const et=new At(ve.trace,te[at-1]);Dt.push(et)}const _t=!!ze("display_mode",null);Jt=!Zi&&Pe&&!_t&&Ma(ve.data.result),Ve=Jt?1/0:De;const hr=Ve-pe.length;ve.data.result.slice(0,hr).forEach(et=>{et.group=at,pe.push(et)}),wt+=ve.data.result.length}else{pe.push({metric:{},values:[],group:at});const _t=ve.errorType||Ce.unknownType,hr=(ve==null?void 0:ve.error)||(ve==null?void 0:ve.message)||"see console for more details",et=[_t,hr].join(`,\r
`);L(Fi=>[...Fi,`${et}`]),console.error(`Fetch query error: ${_t}`,ve)}at++}const Ot=`Showing ${pe.length} series out of ${wt} series due to performance reasons. Please narrow down the query, so it returns less series`;F(wt>Ve?Ot:""),Pe?g(pe):y(pe),T(Dt),Y(ft=>wt?Jt:ft)}catch(Pe){const De=Pe;if(De.name==="AbortError"){b(!1);return}let pe=`Error executing query: ${De.message}. Please check your serverURL settings and confirm server availability.`;De.message==="Unexpected end of JSON input"&&(pe+=`
Additionally, this error can occur if the server response is too large to process. Apply more specific filters to reduce the data volume.`),C(pe)}b(!1)},300),[]),Q=M(()=>{C(""),L([]),E([]);const $=t??i,B=(r||c)===Ne.chart;if(l)if(!h)C(Ce.emptyServer);else if($.every(ee=>!ee.trim()))L($.map(()=>Ce.validQuery));else if(Qr(h)){const ee={...l};return ee.step=a,$.map(te=>B?gd(h,te,ee,d,m):vd(h,te,ee,d,m))}else C(Ce.validServer)},[h,l,c,a,o]),ie=W(()=>{O.map($=>$.abort()),H([]),g([]),y([])},[O]),[X,R]=N([]);return A(()=>{const $=Q===X&&!!t;if(!n||!(Q!=null&&Q.length)||$)return;b(!0),re({fetchUrl:Q,fetchQueue:O,displayType:r||c,query:t??i,stateSeriesLimits:u,showAllSeries:s,hideQuery:o}),R(Q)},[Q,n,u,s]),A(()=>{const $=O.slice(0,-1);$.length&&($.map(B=>B.abort()),H(O.filter(B=>!B.signal.aborted)))},[O]),A(()=>{G===a&&g([])},[z]),{fetchUrl:Q,isLoading:v,graphData:f,liveData:_,error:w,queryErrors:k,setQueryErrors:L,queryStats:x,warning:P,traces:S,isHistogram:z,abortFetch:ie}},er=()=>e("div",{className:"vm-line-loader",children:[e("div",{className:"vm-line-loader__background"}),e("div",{className:"vm-line-loader__line"})]}),Ia=()=>{const{tenantId:t}=se(),{displayType:n}=je(),{query:r}=xe(),{duration:a,relativeTime:o,period:{date:s,step:i}}=ge(),{customStep:l}=He(),[c,d]=oe(),m=xt(),u=Be(),h=vt(),p=Mt(),v=Gt(),[b,f]=N(!1),g=W(()=>{if(b){f(!1);return}const _=new URLSearchParams(c);r.forEach((S,T)=>{var L;const w=`g${T}`;c.get(`${w}.expr`)!==S&&S&&_.set(`${w}.expr`,S),c.get(`${w}.range_input`)!==a&&_.set(`${w}.range_input`,a),c.get(`${w}.end_input`)!==s&&_.set(`${w}.end_input`,s),c.get(`${w}.relative_time`)!==o&&_.set(`${w}.relative_time`,o||"none");const C=c.get(`${w}.step_input`)||i;C&&C!==l&&_.set(`${w}.step_input`,l);const k=`${((L=zt.find(x=>x.value===n))==null?void 0:L.prometheusCode)||0}`;c.get(`${w}.tab`)!==k&&_.set(`${w}.tab`,`${k}`),c.get(`${w}.tenantID`)!==t&&t&&_.set(`${w}.tenantID`,t)});const y=r.length-1;Array.from(_.keys()).forEach(S=>{const T=S.match(/^g(\d+)\./);T&&parseInt(T[1],10)>y&&_.delete(S)}),!(tl(_,c)||!_.size)&&d(_)},[t,n,r,a,o,s,i,l]);A(()=>{const _=setTimeout(g,200);return()=>clearTimeout(_)},[g]),A(()=>{if(!b)return;const _=os(),y=_.duration!==a,S=_.relativeTime!==o,T=_.relativeTime==="none"&&_.period.date!==s;(y||S||T)&&u({type:"SET_TIME_STATE",payload:_});const C=xs();C!==n&&v({type:"SET_DISPLAY_TYPE",payload:C});const k=c.get("g0.tenantID")||"";k!==t&&m({type:"SET_TENANT_ID",payload:k});const L=Zo();Zn(L,r)||(p({type:"SET_QUERY",payload:L}),u({type:"RUN_QUERY"}));const x=setTimeout(()=>{const E=c.get("g0.step_input")||i;E&&E!==l&&h({type:"SET_CUSTOM_STEP",payload:E})},50);return()=>clearTimeout(x)},[c,b]),me("popstate",()=>{f(!0)})},bd=e(Te,{text:"last_over_time",href:"https://docs.victoriametrics.com/victoriametrics/metricsql/#last_over_time",underlined:!0}),yd=e(Te,{text:"instant query",href:"https://docs.victoriametrics.com/victoriametrics/keyconcepts/#instant-query",underlined:!0}),wd=()=>{const{customStep:t}=He();return e("div",{children:[e("p",{children:["This tab shows ",yd," results for the last ",t||"5m"," (defined by the ",e("code",{children:"step"}),") ending at the selected time range."]}),e("p",{children:["Please wrap the query into ",bd," if you need results over arbitrary lookbehind interval."]})]})},Js=({value:t,hideValue:n})=>e("div",{className:"vm-line-progress",children:[e("div",{className:"vm-line-progress-track",children:e("div",{className:"vm-line-progress-track__thumb",style:{width:`${t}%`}})}),!n&&e("span",{children:[t.toFixed(2),"%"]})]}),Ks=({isRoot:t,trace:n,totalMsec:r,isExpandedAll:a})=>{const{isDarkTheme:o}=se(),{isMobile:s}=J(),[i,l]=N({}),c=q(null),[d,m]=N(!1),[u,h]=N(!1),p=Kr(n.duration/1e3)||`${n.duration}ms`;A(()=>{if(!c.current)return;const y=c.current,S=c.current.children[0],{height:T}=S.getBoundingClientRect();m(T>y.clientHeight)},[n]);const v=y=>{y.stopPropagation(),h(S=>!S)},b=n.children&&!!n.children.length,f=n.duration/r*100,g=y=>()=>{b&&l(S=>({...S,[y]:!S[y]}))},_=y=>{var T;const S=[y.idValue];return(T=y==null?void 0:y.children)==null||T.forEach(w=>{S.push(..._(w))}),S};return A(()=>{if(!a){l([]);return}const y=_(n),S={};y.forEach(T=>{S[T]=!0}),l(S)},[a]),e("div",{className:I({"vm-nested-nav":!0,"vm-nested-nav_root":t,"vm-nested-nav_dark":o,"vm-nested-nav_mobile":s}),children:[e("div",{className:I({"vm-nested-nav-header":!0,"vm-nested-nav-header_open":i[n.idValue]}),onClick:g(n.idValue),children:[b&&e("div",{className:I({"vm-nested-nav-header__icon":!0,"vm-nested-nav-header__icon_open":i[n.idValue]}),children:e(be,{})}),e("div",{className:"vm-nested-nav-header__progress",children:e(Js,{value:f})}),e("div",{className:I({"vm-nested-nav-header__message":!0,"vm-nested-nav-header__message_show-full":u}),ref:c,children:[e("span",{className:"vm-nested-nav-header__message_duration",children:p}),":",e("span",{children:n.message})]}),e("div",{className:"vm-nested-nav-header-bottom",children:(d||u)&&e(D,{variant:"text",size:"small",onClick:v,children:u?"Hide":"Show full query"})})]}),i[n.idValue]&&e("div",{className:"vm-nested-nav__childrens",children:b&&n.children.map(y=>e(Ks,{trace:y,totalMsec:r,isExpandedAll:a},y.duration))})]})},Zs=({editable:t=!1,defaultTile:n="JSON",displayTitle:r=!0,defaultJson:a="",resetValue:o="",onClose:s,onUpload:i})=>{const l=Fe(),{isMobile:c}=J(),[d,m]=N(a),[u,h]=N(n),[p,v]=N(""),[b,f]=N(""),g=M(()=>{try{const C=JSON.parse(d),k=C.trace||C;return k.duration_msec?(new At(k,""),""):Ce.traceNotFound}catch(C){return C instanceof Error?C.message:"Unknown error"}},[d]),_=C=>{h(C)},y=C=>{f(""),m(C)},S=async()=>{await l(d,"Formatted JSON has been copied")},T=()=>{m(o)},w=()=>{f(g),u.trim()||v(Ce.emptyTitle),!(g||p)&&(i(d,u),s())};return e("div",{className:I({"vm-json-form":!0,"vm-json-form_one-field":!r,"vm-json-form_one-field_mobile":!r&&c,"vm-json-form_mobile":c}),children:[r&&e(ce,{value:u,label:"Title",error:p,onEnter:w,onChange:_}),e(ce,{value:d,label:"JSON",type:"textarea",error:b,autofocus:!0,onChange:y,onEnter:w,disabled:!t}),e("div",{className:"vm-json-form-footer",children:[e("div",{className:"vm-json-form-footer__controls",children:[e(D,{variant:"outlined",startIcon:e(Xe,{}),onClick:S,children:"Copy JSON"}),o&&e(D,{variant:"text",startIcon:e(ct,{}),onClick:T,children:"Reset JSON"})]}),e("div",{className:"vm-json-form-footer__controls vm-json-form-footer__controls_right",children:[e(D,{variant:"outlined",color:"error",onClick:s,children:"Cancel"}),e(D,{variant:"contained",onClick:w,children:"apply"})]})]})]})},Xs=(t,n)=>{const r=document.createElement("a"),a=URL.createObjectURL(t);r.setAttribute("href",a),r.setAttribute("download",n),document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(a)},Cd=(t,n)=>{const r=l=>{const c=l.reduce((d,m)=>(Object.keys(m).forEach(u=>{u&&!d[u]&&(d[u]=!0)}),d),{});return Object.keys(c)},a=l=>l.includes(",")||l.includes(`
`)||l.includes('"')?'"'+l.replace(/"/g,'""')+'"':l,s=(l=>{const c=r(l),d=l.map(m=>c.map(u=>m[u]?a(m[u]):"").join(","));return[c.map(a).join(","),...d].join(`\r
`)})(t),i=new Blob([s],{type:"text/csv;charset=utf-8;"});Xs(i,n)},Pa=(t,n)=>{const r=new Blob([t],{type:"application/json"});Xs(r,n)},Da=({traces:t,jsonEditor:n=!1,onDeleteClick:r})=>{const{isMobile:a}=J(),[o,s]=N(null),[i,l]=N([]),c=()=>{s(null)},d=(v,b)=>{if(!(!n||!o))try{o.setTracing(JSON.parse(v)),o.setQuery(b),s(null)}catch(f){console.error(f)}};if(!t.length)return e(le,{variant:"info",children:"Please re-run the query to see results of the tracing"});const m=v=>()=>{r(v)},u=v=>()=>{s(v)},h=v=>()=>{Pa(v.originalJSON,`vmui_trace_${v.queryValue}.json`)},p=v=>()=>{l(b=>b.includes(v.idValue)?b.filter(f=>f!==v.idValue):[...b,v.idValue])};return e(V,{children:[e("div",{className:"vm-tracings-view",children:t.map(v=>e("div",{className:"vm-tracings-view-trace vm-block vm-block_empty-padding",children:[e("div",{className:"vm-tracings-view-trace-header",children:[e("h3",{className:"vm-tracings-view-trace-header-title",children:["Trace for ",e("b",{className:"vm-tracings-view-trace-header-title__query",children:v.queryValue})]}),e(j,{title:i.includes(v.idValue)?"Collapse All":"Expand All",children:e(D,{variant:"text",startIcon:i.includes(v.idValue)?e(ua,{}):e(ma,{}),onClick:p(v),ariaLabel:i.includes(v.idValue)?"Collapse All":"Expand All"})}),e(j,{title:"Save Trace to JSON",children:e(D,{variant:"text",startIcon:e(fn,{}),onClick:h(v),ariaLabel:"Save trace to JSON"})}),e(j,{title:"Open JSON",children:e(D,{variant:"text",startIcon:e(It,{}),onClick:u(v),ariaLabel:"open JSON"})}),e(j,{title:"Remove trace",children:e(D,{variant:"text",color:"error",startIcon:e(gn,{}),onClick:m(v),ariaLabel:"remove trace"})})]}),e("nav",{className:I({"vm-tracings-view-trace__nav":!0,"vm-tracings-view-trace__nav_mobile":a}),children:e(Ks,{isRoot:!0,trace:v,totalMsec:v.duration,isExpandedAll:i.includes(v.idValue)})})]},v.idValue))}),o&&e(Me,{title:o.queryValue,onClose:c,children:e(Zs,{editable:n,displayTitle:n,defaultTile:o.queryValue,defaultJson:o.JSON,resetValue:o.originalJSON,onClose:c,onUpload:d})})]})},Nd=({traces:t,displayType:n})=>{const{isTracingEnabled:r}=je(),[a,o]=N([]),s=i=>{const l=a.filter(c=>c.idValue!==i.idValue);o([...l])};return A(()=>{t&&o([...a,...t])},[t]),A(()=>{o([])},[n]),e(V,{children:r&&e("div",{className:"vm-custom-panel__trace",children:e(Da,{traces:a,onDeleteClick:s})})})},tr=({warning:t,query:n,onChange:r})=>{const{isMobile:a}=J(),{value:o,setTrue:s,setFalse:i}=ae(!1);return A(i,[n]),A(()=>{r(o)},[o]),e(le,{variant:"warning",children:e("div",{className:I({"vm-custom-panel__warning":!0,"vm-custom-panel__warning_mobile":a}),children:[e("p",{children:t}),e(D,{color:"warning",variant:"outlined",onClick:s,children:"Show all"})]})})},nr=t=>{let n=t.length,r=-1/0;for(;n--;){const a=t[n];Number.isFinite(a)&&a>r&&(r=a)}return Number.isFinite(r)?r:null},Oa=t=>{let n=t.length,r=1/0;for(;n--;){const a=t[n];Number.isFinite(a)&&a<r&&(r=a)}return Number.isFinite(r)?r:null},Sd=t=>{let n=t[0],r=1;for(let a=1;a<t.length;a++){const o=t[a];Number.isFinite(o)&&(n=n*(r-1)/r+o/r,r++)}return n},kd=t=>{let n=t.length;const r=[];for(;n--;){const a=t[n];Number.isFinite(a)&&r.push(a)}return r.sort(),r[r.length>>1]},Td=t=>{let n=t.length;for(;n--;){const r=t[n];if(Number.isFinite(r))return r}},Ld=t=>t>=1e9?(t/1e9).toFixed(1).replace(/\.0$/,"")+"B":t>=1e6?(t/1e6).toFixed(1).replace(/\.0$/,"")+"M":t>=1e3?(t/1e3).toFixed(1).replace(/\.0$/,"")+"K":t.toString(),Ad=(t,n,r="")=>{const a=n[0],o=n[n.length-1];return r?n.map(s=>`${bt(s,a,o)} ${r}`):n.map(s=>bt(s,a,o))},bt=(t,n,r)=>{if(t==null)return"";r=r||0,n=n||0;const a=Math.abs(r-n);if(isNaN(a)||a==0)return Math.abs(t)>=1e3?t.toLocaleString("en-US"):t.toString();let o=3+Math.floor(1+Math.log10(Math.max(Math.abs(n),Math.abs(r)))-Math.log10(a));return(isNaN(o)||o>20)&&(o=20),t.toLocaleString("en-US",{minimumSignificantDigits:1,maximumSignificantDigits:o})},Ed=(t,n)=>{const r=document.createElement("span");r.innerText=t,r.style.cssText=`position: absolute; z-index: -1; pointer-events: none; opacity: 0; font: ${n}`,document.body.appendChild(r);const a=r.offsetWidth;return r.remove(),a},xd=(t,n)=>{if(n!=null&&n.hasAlias&&(n!=null&&n.label))return n.label;const r=(t==null?void 0:t.metric)||{},o=Object.keys(r).filter(i=>i!="__name__").map(i=>`${i}=${JSON.stringify(r[i])}`);let s=r.__name__||"";return o.length>0&&(s+="{"+o.join(",")+"}"),s},Md=[[3600*24*365,"{YYYY}",null,null,null,null,null,null,1],[3600*24*28,"{MMM}",`
{YYYY}`,null,null,null,null,null,1],[3600*24,"{MM}-{DD}",`
{YYYY}`,null,null,null,null,null,1],[3600,"{HH}:{mm}",`
{YYYY}-{MM}-{DD}`,null,`
{MM}-{DD}`,null,null,null,1],[60,"{HH}:{mm}",`
{YYYY}-{MM}-{DD}`,null,`
{MM}-{DD}`,null,null,null,1],[1,"{HH}:{mm}:{ss}",`
{YYYY}-{MM}-{DD}`,null,`
{MM}-{DD} {HH}:{mm}`,null,null,null,1],[.001,":{ss}.{fff}",`
{YYYY}-{MM}-{DD} {HH}:{mm}`,null,`
{MM}-{DD} {HH}:{mm}`,null,`
{HH}:{mm}`,null,1]],Ra=(t,n)=>Array.from(new Set(t.map(r=>r.scale))).map(r=>{const a="10px Arial",o=tt("color-text"),s={scale:r,show:!0,size:ei,stroke:o,font:a,values:(i,l)=>Ad(i,l,n)};return r?!(Number(r)%2)&&r!=="y"?{...s,side:1}:s:{space:80,values:Md,stroke:o,font:a}}),Id=(t,n,r)=>{const a=Zr(n)||1,o=Array.from(new Set(t)).sort((d,m)=>d-m);let s=r.start;const i=xn(r.end+a);let l=0;const c=[];for(;s<=i;){for(;l<o.length&&o[l]<=s;)s=o[l],l++,c.push(s);s=xn(s+a),(l>=o.length||o[l]>s)&&c.push(s)}for(;c.length<2;)c.push(s),s=xn(s+a);return c},rr=(t,n)=>{if(t==null||n==null)return[-1,1];const a=.02*(Math.abs(n-t)||Math.abs(t)||1);return[t-a,n+a]},Pd=(t,n)=>{const r={},a=Object.values(t).flat(),o="1",s=Oa(a)||0,i=nr(a)||1;return r[o]=n?rr(s,i):[s,i],r},ei=(t,n,r,a)=>{var l;const o=t.axes[r];if(a>1)return o._size||60;let s=6+(((l=o==null?void 0:o.ticks)==null?void 0:l.size)||0)+(o.gap||0);const i=(n??[]).reduce((c,d)=>(d==null?void 0:d.length)>c.length?d:c,"");return i!=""&&(s+=Ed(i,"10px Arial")),Math.ceil(s)},go=["#e54040","#32a9dc","#2ee329","#7126a1","#e38f0f","#3d811a","#ffea00","#2d2d2d","#da42a6","#a44e0c"],ti=t=>{if(t.length!=7)return"0, 0, 0";const n=parseInt(t.slice(1,3),16),r=parseInt(t.slice(3,5),16),a=parseInt(t.slice(5,7),16);return`${n}, ${r}, ${a}`},Ht={[ne.yhatUpper]:"#7126a1",[ne.yhatLower]:"#7126a1",[ne.yhat]:"#da42a6",[ne.anomaly]:"#da4242",[ne.anomalyScore]:"#7126a1",[ne.actual]:"#203ea9",[ne.training]:`rgba(${ti("#203ea9")}, 0.2)`},vo=t=>{let a=1,o=0,s=1;if(t.length>0)for(let l=0;l<t.length;l++)t[l].charCodeAt(0)>o&&(o=t[l].charCodeAt(0)),s=parseInt(String(16777215/o)),a=(a+t[l].charCodeAt(0)*s*49979693)%16777215;let i=(a*t.length%16777215).toString(16);return i=i.padEnd(6,i),`#${i}`},Dd=t=>{let n=t.replace("#","").trim();if(n.length===3&&(n=n[0]+n[0]+n[1]+n[1]+n[2]+n[2]),n.length!==6)throw new Error("Invalid HEX color.");const r=parseInt(n.slice(0,2),16),a=parseInt(n.slice(2,4),16),o=parseInt(n.slice(4,6),16);return(r*299+a*587+o*114)/1e3>=128?"#000000":"#FFFFFF"},Od=(t,n,r)=>{const a=[];for(let o=0;o<r;o++){const s=o/(r-1),i=t[0]+(n[0]-t[0])*s,l=t[1]+(n[1]-t[1])*s,c=t[2]+(n[2]-t[2])*s;a.push([i,l,c].map(d=>Math.round(d)).join(", "))}return a.map(o=>`rgb(${o})`)},$a=Od([246,226,219],[127,39,4],16),Rd=(t,n)=>{const r=t.data[n][2],a=$a,o=0;let s=1/0,i=-1/0;for(let m=0;m<r.length;m++)r[m]>o&&(s=Math.min(s,r[m]),i=Math.max(i,r[m]));const l=i-s,c=a.length,d=Array(r.length);for(let m=0;m<r.length;m++)d[m]=r[m]===0?-1:Math.min(c-1,Math.floor(c*(r[m]-s)/l));return d},$d=()=>(t,n)=>{const r=Math.round(devicePixelRatio);jt.orient(t,n,(a,o,s,i,l,c,d,m,u,h,p,v,b,f)=>{const[g,_,y]=t.data[n],S=g.length,T=Rd(t,n),w=$a??[...Array.from(new Set(T))],C=w.map(()=>new Path2D),k=S-_.lastIndexOf(_[0]),L=S/k,x=_[1]-_[0],E=g[k]-g[0],P=c(E,i,h,m)-c(0,i,h,m)-r,F=d(x,l,p,u)-d(0,l,p,u)+r,O=_.slice(0,k).map(z=>Math.round(d(z,l,p,u)-F/2)),H=Array.from({length:L},(z,Y)=>Math.round(c(g[Y*k],i,h,m)-P));for(let z=0;z<S;z++)if(y[z]>0&&g[z]>=(i.min||-1/0)&&g[z]<=(i.max||1/0)&&_[z]>=(l.min||-1/0)&&_[z]<=(l.max||1/0)){const Y=H[~~(z/k)],G=O[z%k],K=C[T[z]];f(K,Y,G,P,F)}t.ctx.save(),t.ctx.rect(t.bbox.left,t.bbox.top,t.bbox.width,t.bbox.height),t.ctx.clip(),C.forEach((z,Y)=>{t.ctx.fillStyle=w[Y],t.ctx.fill(z)}),t.ctx.restore()})},Fd=t=>{var s,i;if(!t.every(l=>l.metric.le))return t;const n=t.sort((l,c)=>parseFloat(l.metric.le)-parseFloat(c.metric.le)),r=((s=t[0])==null?void 0:s.group)||1;let a={metric:{le:""},values:[]};const o=[];for(const l of n){const c=[a.metric.le,l.metric.le].filter(m=>m).join("..."),d=[];for(const[m,u]of l.values){const h=((i=a.values.find(v=>v[0]===m))==null?void 0:i[1])||0,p=+u-+h;d.push([m,`${p}`])}o.push({metric:{vmrange:c},values:d,group:r}),a=l}return o},fo=t=>{const n=(t.metric.vmrange||t.metric.le||"").split("...");return sn(n[n.length-1])},zd=(t,n)=>fo(t)-fo(n),Hd=(t,n)=>{if(!n)return t;const r=t.sort(zd),a=Fd(r),o={};return a.forEach(i=>i.values.forEach(([l,c])=>{const d=Number(c),m=isNaN(d)?0:d,u=o[l]||0;o[l]=u+m})),a.map(i=>{const l=i.values.map(([c,d])=>{const m=o[c];return[c,`${Math.round(+d/m*100)}`]});return{...i,values:l}}).filter(i=>!i.values.every(l=>l[1]==="0"))},Vd=t=>{Object.keys(t.hooks).forEach(n=>{t.hooks[n]=[]})},Pr=t=>{const n=["__name__","for"];return Object.entries(t).filter(([r])=>!n.includes(r)).map(([r,a])=>`${r}: ${a}`).join(",")},ni=t=>{const n=(t==null?void 0:t.__name__)||"",r=new RegExp(`(${Object.values(ne).join("|")})$`),a=n.match(r),o=a&&a[0];return{value:/(?:^|[^a-zA-Z0-9_])y(?:$|[^a-zA-Z0-9_])/.test(n)?ne.actual:o,group:Pr(t)}},qd=(t,n,r,a)=>{const o={},s=a?0:Math.min(t.length,go.length);for(let i=0;i<s;i++){const l=Ir(t[i],r[t[i].group-1]);o[l]=go[i]}return(i,l)=>{const c=a?ni(t[l].metric):null,d=r[i.group-1],m=a?(c==null?void 0:c.group)||"":Ir(i,d);return{label:m,hasAlias:!!d,dash:jd(c),width:Qd(c),stroke:Wd({metricInfo:c,label:m,isAnomalyUI:a,colorState:o}),points:Yd(c),spanGaps:!1,forecast:c==null?void 0:c.value,forecastGroup:c==null?void 0:c.group,freeFormFields:i.metric,show:!ri(m,n),scale:"1",...Ud(i)}}},Ud=t=>{const n=t.values.map(i=>sn(i[1])),{min:r,max:a,median:o,last:s}={min:Oa(n),max:nr(n),median:kd(n),last:Td(n)};return{median:o,statsFormatted:{min:bt(r,r,a),max:bt(a,r,a),median:bt(o,r,a),last:bt(s,r,a)}}},_o=(t,n)=>({group:n,label:t.label||"",color:t.stroke,checked:t.show||!1,freeFormFields:t.freeFormFields,statsFormatted:t.statsFormatted,median:t.median,hasAlias:t.hasAlias||!1}),Bd=({hideSeries:t,legend:n,metaKey:r,series:a,isAnomalyView:o})=>{const{label:s}=n,i=ri(s,t),l=a.map(c=>c.label||"");return o?l.filter(c=>c!==s):r?i?t.filter(c=>c!==s):[...t,s]:t.length?i?[...l.filter(c=>c!==s)]:[]:[...l.filter(c=>c!==s)]},ri=(t,n)=>n.includes(`${t}`),Fa=t=>{for(let n=t.series.length-1;n>=0;n--)n&&t.delSeries(n)},ai=(t,n,r=!1)=>{n.forEach((a,o)=>{a.label&&(a.spanGaps=r),o&&t.addSeries(a)})},jd=t=>{const n=(t==null?void 0:t.value)===ne.yhatLower,r=(t==null?void 0:t.value)===ne.yhatUpper,a=(t==null?void 0:t.value)===ne.yhat;return n||r?[10,5]:a?[10,2]:[]},Qd=t=>{const n=(t==null?void 0:t.value)===ne.yhatLower,r=(t==null?void 0:t.value)===ne.yhatUpper,a=(t==null?void 0:t.value)===ne.yhat,o=(t==null?void 0:t.value)===ne.anomaly;return r||n?.7:a?1:o?0:1.4},Yd=t=>(t==null?void 0:t.value)===ne.anomaly?{size:8,width:4,space:0}:{size:4,width:0,show:!0,filter:Gd},Gd=(t,n)=>{const r=t.data[n],a=[];for(let o=0;o<r.length;o++){const s=r[o-1],i=r[o+1];s===null&&i===null&&a.push(o)}return a},Wd=({metricInfo:t,label:n,isAnomalyUI:r,colorState:a})=>{const o=a[n]||vo(n),s=(t==null?void 0:t.value)===ne.anomaly;return r&&s?Ht[ne.anomaly]:r&&!s&&!(t!=null&&t.value)?Ht[ne.actual]:t!=null&&t.value?t!=null&&t.value?Ht[t==null?void 0:t.value]:o:a[n]||vo(n)},oi=({width:t=400,height:n=500})=>({width:t,height:n,series:[],tzDate:r=>U(Ft(We(r))).local().toDate(),legend:{show:!1},cursor:{drag:{x:!0,y:!1},focus:{prox:30},points:{size:5.6,width:1.4},bind:{click:()=>null,dblclick:()=>null}}}),za=t=>{Fa(t),Vd(t),t.setData([])},si=({min:t,max:n})=>[t,n],ii=(t,n=0,r=1,a,o)=>o.limits.enable?o.limits.range[a]:rr(n,r),Jd=(t,n)=>{const r={x:{range:()=>si(n)}},a=Object.keys(t.limits.range);return(a.length?a:["1"]).forEach(o=>{r[o]={range:(s,i=0,l=1)=>ii(s,i,l,o,t)}}),r},Ha=t=>n=>{const r=n.posToVal(n.select.left,"x"),a=n.posToVal(n.select.left+n.select.width,"x");t({min:r,max:a})},li=(t,n)=>{if(t.delBand(),n.length<2)return;const r=n.map((i,l)=>({...i,index:l})),a=r.filter(i=>i.forecast===ne.yhatUpper),o=r.filter(i=>i.forecast===ne.yhatLower),s=a.map(i=>{const l=o.find(c=>c.forecastGroup===i.forecastGroup);return l?{series:[i.index,l.index],fill:Kd(ne.yhatUpper)}:null}).filter(i=>i!==null);s.length&&s.forEach(i=>{t.addBand(i)})};function Kd(t){return`rgba(${ti(Ht[t])}, 0.05)`}const Zd=t=>t instanceof MouseEvent,bo=t=>Zd(t)?t.clientX:t.touches[0].clientX,Xd=({dragSpeed:t=.85,setPanning:n,setPlotScale:r})=>{const a=q({leftStart:0,xUnitsPerPx:0,scXMin:0,scXMax:0}),o=l=>{l.preventDefault();const c=bo(l),{leftStart:d,xUnitsPerPx:m,scXMin:u,scXMax:h}=a.current,p=m*((c-d)*t);r({min:u-p,max:h-p})},s=()=>{n(!1),document.removeEventListener("mousemove",o),document.removeEventListener("mouseup",s),document.removeEventListener("touchmove",o),document.removeEventListener("touchend",s)},i=()=>{document.addEventListener("mousemove",o),document.addEventListener("mouseup",s),document.addEventListener("touchmove",o),document.addEventListener("touchend",s)};return({e:l,u:c})=>{l.preventDefault(),n(!0),a.current={leftStart:bo(l),xUnitsPerPx:c.posToVal(1,"x")-c.posToVal(0,"x"),scXMin:c.scales.x.min||0,scXMax:c.scales.x.max||0},i()}},em=t=>{const{ctrlKey:n,metaKey:r,button:a}=t;return a===0&&(n||r)},fr=.9,Va=t=>{const[n,r]=N(!1),a=Xd({dragSpeed:fr,setPanning:r,setPlotScale:t});return{onReadyChart:s=>{const i=c=>{const d=c instanceof MouseEvent&&em(c),m=window.TouchEvent&&c instanceof TouchEvent&&c.touches.length>1;(d||m)&&a({u:s,e:c})},l=c=>{if(!c.ctrlKey&&!c.metaKey)return;c.preventDefault();const{width:d}=s.over.getBoundingClientRect(),m=s.cursor.left&&s.cursor.left>0?s.cursor.left:0,u=s.posToVal(m,"x"),h=(s.scales.x.max||0)-(s.scales.x.min||0),p=c.deltaY<0?h*fr:h/fr,v=u-m/d*p,b=v+p;s.batch(()=>t({min:v,max:b}))};s.over.addEventListener("mousedown",i),s.over.addEventListener("touchstart",i),s.over.addEventListener("wheel",l)},isPanning:n}},yo=t=>{const n=t[0].clientX-t[1].clientX,r=t[0].clientY-t[1].clientY;return Math.sqrt(n*n+r*r)},qa=({uPlotInst:t,xRange:n,setPlotScale:r})=>{const[a,o]=N(0),s=W(c=>{const{target:d,ctrlKey:m,metaKey:u,key:h}=c,p=d instanceof HTMLInputElement||d instanceof HTMLTextAreaElement;if(!t||p)return;const v=h==="+"||h==="=";if((h==="-"||v)&&!(m||u)){c.preventDefault();const g=(n.max-n.min)/10*(v?1:-1);r({min:n.min+g,max:n.max-g})}},[t,n]),i=c=>{c.touches.length===2&&(c.preventDefault(),o(yo(c.touches)))},l=W(c=>{if(!t||c.touches.length!==2)return;c.preventDefault();const d=yo(c.touches),m=a-d,u=t.scales.x.max||n.max,h=t.scales.x.min||n.min,p=u-h,v=m>0?-1:1,b=p/50*v;t.batch(()=>r({min:h+b,max:u-b}))},[t,a,n]);return me("keydown",s),me("touchmove",l),me("touchstart",i),null},Ua=({period:t,setPeriod:n})=>{const[r,a]=N({min:t.start,max:t.end}),o=({min:s,max:i})=>{const l=(i-s)*1e3;l<no.min||l>no.max||n({from:U(s*1e3).toDate(),to:U(i*1e3).toDate()})};return A(()=>{a({min:t.start,max:t.end})},[t]),{xRange:r,setPlotScale:o}},tm=({u:t,metrics:n,series:r,unit:a,isAnomalyView:o})=>{const[s,i]=N(!1),[l,c]=N({seriesIdx:-1,dataIdx:-1}),[d,m]=N([]),u=()=>{m([]),c({seriesIdx:-1,dataIdx:-1})},h=g=>{const _=g.cursor.idx??-1;c(y=>({...y,dataIdx:_}))},p=(g,_)=>{const y=_??-1;c(S=>({...S,seriesIdx:y}))},v=W(()=>{const{seriesIdx:g,dataIdx:_}=l,y=n[g-1],S=r[g],T=new Set(n.map(P=>P.group)),w=(y==null?void 0:y.group)||0,C=st(t,["data",g,_],0),k=st(t,["scales","1","min"],0),L=st(t,["scales","1","max"],1),x=st(t,["data",0,_],0),E={top:t?t.valToPos(C||0,(S==null?void 0:S.scale)||"1"):0,left:t?t.valToPos(x,"x"):0};return{unit:a,point:E,u:t,id:`${g}_${_}`,title:T.size>1&&!o?`Query ${w}`:"",dates:[x?U(x*1e3).tz().format(On):"-"],value:bt(C,k,L),info:xd(y,S),statsFormatted:S==null?void 0:S.statsFormatted,marker:`${S==null?void 0:S.stroke}`}},[t,l,n,r,a,o]),b=W(()=>{if(!s)return;const g=v();d.find(_=>_.id===g.id)||m(_=>[..._,g])},[v,d,s]),f=g=>{m(_=>_.filter(y=>y.id!==g))};return A(()=>{i(l.dataIdx!==-1&&l.seriesIdx!==-1)},[l]),me("click",b),{showTooltip:s,stickyTooltips:d,handleUnStick:f,getTooltipProps:v,seriesFocus:p,setCursor:h,resetTooltips:u}},wo=({u:t,id:n,title:r,dates:a,value:o,point:s,unit:i="",info:l,statsFormatted:c,isSticky:d,marker:m,onClose:u})=>{const h=q(null),[p,v]=N({top:-999,left:-999}),[b,f]=N(!1),[g,_]=N(!1),y=()=>{u&&u(n)},S=k=>{_(!0),f(!0);const{clientX:L,clientY:x}=k;v({top:x,left:L})},T=W(k=>{if(!b)return;const{clientX:L,clientY:x}=k;v({top:x,left:L})},[b]),w=()=>{f(!1)};return A(()=>{if(!h.current||!t)return;const{top:k,left:L}=s,x={left:parseFloat(t.over.style.left),top:parseFloat(t.over.style.top)},{width:E,height:P}=t.over.getBoundingClientRect(),{width:F,height:O}=h.current.getBoundingClientRect(),H=10,z=L+F>=E?F+2*H:0,Y=k+O>=P?O+2*H:0,G={top:k+x.top+H-Y,left:L+x.left+H-z};G.left<0&&(G.left=20),G.top<0&&(G.top=20),v(G)},[t,o,s,h]),me("mousemove",T),me("mouseup",w),t?pt(e("div",{className:I({"vm-chart-tooltip":!0,"vm-chart-tooltip_sticky":d,"vm-chart-tooltip_moved":g}),ref:h,style:p,children:[e("div",{className:"vm-chart-tooltip-header",children:[r&&e("div",{className:"vm-chart-tooltip-header__title",children:r}),e("div",{className:"vm-chart-tooltip-header__date",children:a.map((k,L)=>e("span",{children:k},L))}),d&&e(V,{children:[e(D,{className:"vm-chart-tooltip-header__drag",variant:"text",size:"small",startIcon:e(ia,{}),onMouseDown:S,ariaLabel:"drag the tooltip"}),e(D,{className:"vm-chart-tooltip-header__close",variant:"text",size:"small",startIcon:e(Ue,{}),onClick:y,ariaLabel:"close the tooltip"})]})]}),e("div",{className:"vm-chart-tooltip-data",children:[m&&e("span",{className:"vm-chart-tooltip-data__marker",style:{background:m}}),e("p",{className:"vm-chart-tooltip-data__value",children:[e("b",{children:o}),i]})]}),c&&e("table",{className:"vm-chart-tooltip-stats",children:jr.map((k,L)=>e("div",{className:"vm-chart-tooltip-stats-row",children:[e("span",{className:"vm-chart-tooltip-stats-row__key",children:[k,":"]}),e("span",{className:"vm-chart-tooltip-stats-row__value",children:c[k]})]},L))}),l&&e("p",{className:"vm-chart-tooltip__info",children:l})]}),t.root):null},ci=({showTooltip:t,tooltipProps:n,stickyTooltips:r,handleUnStick:a})=>e(V,{children:[t&&n&&e(wo,{...n}),r.map(o=>Qi(wo,{...o,isSticky:!0,key:o.id,onClose:a}))]}),nm=({data:t,series:n,metrics:r=[],period:a,yaxis:o,unit:s,setPeriod:i,layoutSize:l,height:c,isAnomalyView:d,spanGaps:m=!1})=>{const{isDarkTheme:u}=se(),h=q(null),[p,v]=N(),{xRange:b,setPlotScale:f}=Ua({period:a,setPeriod:i}),{onReadyChart:g,isPanning:_}=Va(f);qa({uPlotInst:p,xRange:b,setPlotScale:f});const{showTooltip:y,stickyTooltips:S,handleUnStick:T,getTooltipProps:w,seriesFocus:C,setCursor:k,resetTooltips:L}=tm({u:p,metrics:r,series:n,unit:s,isAnomalyView:d}),x={...oi({width:l.width,height:c}),series:n,axes:Ra([{},{scale:"1"}],s),scales:Jd(o,b),hooks:{ready:[g],setSeries:[C],setCursor:[k],setSelect:[Ha(f)],destroy:[za]},bands:[]};return A(()=>{if(L(),!h.current)return;p&&p.destroy();const E=new jt(x,t,h.current);return v(E),E.destroy},[h,u]),A(()=>{p&&(p.setData(t),p.redraw())},[t]),A(()=>{p&&(Fa(p),ai(p,n,m),li(p,n),p.redraw())},[n,m]),A(()=>{p&&(Object.keys(o.limits.range).forEach(E=>{p.scales[E]&&(p.scales[E].range=(P,F=0,O=1)=>ii(P,F,O,E,o))}),p.redraw())},[o]),A(()=>{p&&(p.scales.x.range=()=>si(b),p.redraw())},[b]),A(()=>{p&&(p.setSize({width:l.width||400,height:c||500}),p.redraw())},[c,l]),e("div",{className:I({"vm-line-chart":!0,"vm-line-chart_panning":_}),style:{minWidth:`${l.width||400}px`,minHeight:`${c||500}px`},children:[e("div",{className:"vm-line-chart__u-plot",ref:h}),e(ci,{showTooltip:y,tooltipProps:w(),stickyTooltips:S,handleUnStick:T})]})};var Wt=(t=>(t.view="legend_view",t.hideDuplicates="legend_hide_duplicates",t.hideStats="legend_hide_stats",t.format="legend_format",t.group="legend_group",t))(Wt||{}),Dr=(t=>(t.table="table",t.lines="lines",t))(Dr||{});const Sn=Wt.view,di=()=>{const[t,n]=oe(),r=t.get(Sn),[a,o]=N(r||"lines"),s=i=>{i==="table"?t.set(Sn,i):t.delete(Sn),o(i),n(t)};return A(()=>{const i=t.get(Sn);i!==a&&o(i)},[t]),{view:a,isLinesView:a==="lines",isTableView:a==="table",onChange:s}},rm=t=>Object.keys(t.freeFormFields).filter(r=>r!=="__name__").map(r=>{const a=`${r}=${JSON.stringify(t.freeFormFields[r])}`;return{id:`${t.label}.${a}`,freeField:a,key:r}}),kn=Wt.hideStats,Ba=()=>{const[t,n]=oe(),r=t.get(kn)==="true",[a,o]=N(r),s=i=>{i?t.set(kn,"true"):t.delete(kn),o(i),n(t)};return A(()=>{const i=t.get(kn)==="true";i!==a&&o(i)},[t]),{hideStats:a,onChange:s}},Tn=Wt.format,mi=()=>{const[t,n]=oe(),r=t.get(Tn)||"",[a,o]=N(r),s=l=>{o(l)},i=()=>{a?t.set(Tn,a):t.delete(Tn),n(t)};return A(()=>{const l=t.get(Tn);l!==a&&o(l||"")},[t]),{format:a,onChange:s,onApply:i}},am=({legend:t,onChange:n,duplicateFields:r,isAnomalyView:a})=>{const o=Fe(),{hideStats:s}=Ba(),{format:i}=mi(),l=Ws(t.freeFormFields,i),c=M(()=>{const p=rm(t);return r!=null&&r.length?p.filter(v=>!r.includes(v.key)):p},[t,r]),d=t.statsFormatted,m=Object.values(d).some(p=>p),u=p=>v=>{n&&n(p,v.ctrlKey||v.metaKey)},h=p=>async v=>{v.stopPropagation(),await o(p,`${p} has been copied`)};return e("div",{className:I({"vm-legend-item":!0,"vm-legend-row":!0,"vm-legend-item_hide":!t.checked}),onClick:u(t),children:[!a&&e("div",{className:"vm-legend-item__marker",style:{backgroundColor:t.color}}),e("div",{className:"vm-legend-item-info",children:e("span",{className:"vm-legend-item-info__label",children:[t.hasAlias&&t.label,!t.hasAlias&&i&&l,!t.hasAlias&&!i&&e(V,{children:[t.freeFormFields.__name__,!!c.length&&e(V,{children:" {"}),c.map((p,v)=>e("span",{className:"vm-legend-item-info__free-fields",onClick:h(p.freeField),title:"copy to clipboard",children:[p.freeField,v+1<c.length&&","]},p.key)),!!c.length&&e(V,{children:"}"})]})]})}),!s&&m&&e("div",{className:"vm-legend-item-stats",children:jr.map((p,v)=>e("div",{className:"vm-legend-item-stats-row",children:[e("span",{className:"vm-legend-item-stats-row__key",children:[p,":"]}),e("span",{className:"vm-legend-item-stats-row__value",children:d[p]})]},v))})]})},om=({labels:t,isAnomalyView:n,duplicateFields:r,onChange:a})=>e("div",{className:"vm-legend-item-container",children:t.map(o=>e(am,{legend:o,isAnomalyView:n,duplicateFields:r,onChange:a},o.label))}),sm=jr.map(t=>({key:`statsFormatted.${t}`,title:t})),im=({labels:t,duplicateFields:n,onChange:r})=>{const{hideStats:a}=Ba(),o=a?[]:sm,i=M(()=>{const c=[...new Set(t.flatMap(d=>Object.keys(d.freeFormFields)))].map(d=>({key:`freeFormFields.${d}`,title:d}));return n!=null&&n.length?c.filter(d=>!n.includes(d.title)):c},[t,n]).concat(o),l=c=>d=>{r&&r(c,d.ctrlKey||d.metaKey)};return e("div",{className:"vm-legend-table__wrapper",children:e("table",{className:"vm-legend-table",children:[e("thead",{className:"vm-legend-table-thead",children:e("tr",{className:"vm-legend-table-row vm-legend-table_thead",children:[e("th",{className:"vm-legend-table-col vm-legend-table-col_marker vm-legend-table-col_thead"}),i.map(c=>e("th",{className:"vm-legend-table-col vm-legend-table-col_thead",children:c.title},c.key))]})}),e("tbody",{className:"vm-legend-table-tbody",children:t.map(c=>e("tr",{className:I({"vm-legend-table-row":!0,"vm-legend-table-row_tbody":!0,"vm-legend-table-row_exclude":!c.checked}),onClick:l(c),children:[e("td",{className:"vm-legend-table-col vm-legend-table-col_marker",children:e("div",{className:"vm-legend-item__marker",style:{backgroundColor:c.color}})}),i.map(d=>e("td",{className:"vm-legend-table-col",children:e("span",{className:"vm-legend-table-col__content",children:st(c,d.key)})},`${d.key}_${c.label}`))]},c.label))})]})})},Ln=Wt.hideDuplicates,ui=t=>{const[n,r]=oe(),a=n.get(Ln)==="true",[o,s]=N(a),i=c=>{c?n.set(Ln,"true"):n.delete(Ln),s(c),r(n)};A(()=>{const c=n.get(Ln)==="true";c!==o&&s(c)},[n]);const l=M(()=>!o||!(t!=null&&t.length)||(t==null?void 0:t.length)<2?[]:[...new Set(t.flatMap(d=>Object.keys(d.freeFormFields||{})))].filter(d=>{var u;const m=(u=t.find(h=>h.freeFormFields[d]))==null?void 0:u.freeFormFields[d];return t.every(h=>h.freeFormFields[d]===m)}),[t,o]);return{hideDuplicates:o,onChange:i,duplicateFields:l}},lm=50,hi=100,pi=5,Ut="Ungrouped",Re="_stream",tn="_msg",$t=`${qe}.SSS`,ke={GROUP_BY:"groupBy",DISPLAY_FIELDS:"displayFields",NO_WRAP_LINES:"noWrapLines",COMPACT_GROUP_HEADER:"compactGroupHeader",DATE_FORMAT:"dateFormat",ROWS_PER_PAGE:"rows_per_page"},An=Wt.group,ja=()=>{const[t,n]=oe(),r=t.get(An)||"",[a,o]=N(r),s=i=>{i&&i!==Ut?t.set(An,i):t.delete(An),o(i),n(t)};return A(()=>{const i=t.get(An);i!==a&&o(i||"")},[t]),{groupByLabel:a,onChange:s}},cm=({labels:t,group:n,isAnomalyView:r,onChange:a})=>{const{isTableView:o}=di(),{groupByLabel:s}=ja(),i=Fe(),{duplicateFields:l}=ui(t),c=M(()=>t.sort((u,h)=>(h.median||0)-(u.median||0)),[t]),d=u=>async h=>{h.stopPropagation(),await i(u,`${u} has been copied`)},m=o?im:om;return e("div",{className:"vm-legend-group",children:e(Kn,{defaultExpanded:!0,title:e("div",{className:"vm-legend-group-header",children:[e("div",{className:"vm-legend-group-header-title",children:["Group by",s?"":" query",": ",e("b",{children:n})]}),!!l.length&&e("div",{className:"vm-legend-group-header-labels",children:["common labels: {",l.map(u=>e("div",{onClick:d(`${u}="${t[0].freeFormFields[u]}"`),className:"vm-legend-group-header-labels__item",children:`${u}="${t[0].freeFormFields[u]}"`},u)),"}"]})]}),children:e(m,{labels:c,isAnomalyView:r,duplicateFields:l,onChange:a})})},n)},dm=({labels:t,query:n,groupByLabel:r})=>M(()=>mm(t,n,r),[t,n,r]),mm=(t,n,r)=>{const a=new Map;for(const o of t){const s=r?`${r}="${o.freeFormFields[r]??""}"`:`${n[o.group-1]}`;a.has(s)||a.set(s,{group:String(s),items:[]});const i=a.get(s);i.items.some(c=>c.label===o.label)||i.items.push(o)}return Array.from(a.values())},um=({values:t,onRemoveItem:n})=>{const{isMobile:r}=J(),a=o=>s=>{n(o),s.stopPropagation()};return r?e("span",{className:"vm-select-input-content__counter",children:["selected ",t.length]}):e(V,{children:t.map(o=>e("div",{className:"vm-select-input-content__selected",children:[e("span",{children:o}),e("div",{onClick:a(o),children:e(Ue,{})})]},o))})},it=({value:t,list:n,label:r,placeholder:a,noOptionsText:o,clearable:s=!1,searchable:i=!1,autofocus:l,disabled:c,onChange:d})=>{const{isDarkTheme:m}=se(),{isMobile:u}=J(),[h,p]=N(""),v=q(null),[b,f]=N(null),[g,_]=N(!1),y=q(null),S=Array.isArray(t),T=Array.isArray(t)?t:void 0,w=u&&S&&!!(T!=null&&T.length),C=M(()=>g?h:Array.isArray(t)?"":t,[t,h,g,S]),k=M(()=>g?h||"(.+)":"",[h,g]),L=()=>{y.current&&y.current.blur()},x=()=>{_(!1),L()},E=()=>{c||_(!0)},P=()=>{n.includes(h)&&d(h)},F=G=>{G.target instanceof HTMLInputElement||c||_(K=>!K)},O=G=>{p(""),d(G),S||x(),S&&y.current&&y.current.focus()},H=G=>{p(G.target.value)},z=G=>K=>{O(G),K.stopPropagation()},Y=G=>{y.current!==G.target&&_(!1)};return A(()=>{p(""),g&&y.current&&y.current.focus(),g||L()},[g,y]),A(()=>{!l||!y.current||u||y.current.focus()},[l,y]),me("keyup",Y),_n(v,x,b),e("div",{className:I({"vm-select":!0,"vm-select_dark":m,"vm-select_disabled":c}),children:[e("div",{className:"vm-select-input",onClick:F,ref:v,children:[e("div",{className:"vm-select-input-content",children:[!!(T!=null&&T.length)&&e(um,{values:T,onRemoveItem:O}),!w&&e("input",{value:C,type:"text",placeholder:a,onInput:H,onFocus:E,onBlur:P,ref:y,readOnly:u||!i})]}),r&&e("span",{className:"vm-text-field__label",children:r}),s&&t&&e("div",{className:"vm-select-input__icon",onClick:z(""),children:e(Ue,{})}),e("div",{className:I({"vm-select-input__icon":!0,"vm-select-input__icon_open":g}),children:e(Je,{})})]}),e(Ea,{label:r,value:k,options:n.map(G=>({value:G})),anchor:v,selected:T,minLength:1,fullWidth:!0,noOptionsText:o,onSelect:O,onOpenAutocomplete:_,onChangeWrapperRef:f})]})},gi=({data:t,isCompact:n})=>{const{isTableView:r,onChange:a}=di(),{hideDuplicates:o,onChange:s}=ui(),{hideStats:i,onChange:l}=Ba(),{format:c,onChange:d,onApply:m}=mi(),{groupByLabel:u,onChange:h}=ja(),p=vt(),v=M(()=>{if(!t||!t.length)return[];const y=t.flatMap(S=>Object.keys(S.metric));return Array.from(new Set(y))},[t]),b=y=>{const S=y?Dr.table:Dr.lines;a(S)},f=()=>{p({type:"SET_OPEN_SETTINGS",payload:!0})},g=[{label:"Table View",value:r,onChange:b,info:"If enabled, the legend will be displayed in a table format."},{label:"Hide Common Labels",value:o,onChange:s,info:"If enabled, hides labels that are the same for all series."},{label:"Hide Statistics",value:i,onChange:l,info:"If enabled, hides the display of min, median, and max values."}],_=n?j:V;return e("div",{className:I({"vm-legend-configs":!0,"vm-legend-configs_compact":n}),children:[g.map(({label:y,value:S,onChange:T,info:w})=>e(_,{title:w,children:e("div",{className:"vm-legend-configs-item vm-legend-configs-item_switch",children:[e("span",{className:"vm-legend-configs-item__label",children:y}),e(_e,{label:`${n?y:S?"Enabled":"Disabled"}`,value:S,onChange:T}),e("span",{className:"vm-legend-configs-item__info",children:w})]})},y)),n&&e(D,{size:"small",variant:"text",startIcon:e(Ze,{}),onClick:f,children:"Settings"}),!n&&e(V,{children:[e("div",{className:"vm-legend-configs-item",children:[e(ce,{label:"Custom Legend Format",placeholder:"{{label_name}}",value:c,onChange:d,onBlur:m,onEnter:m}),e("span",{className:"vm-legend-configs-item__info vm-legend-configs-item__info_input",children:"Customize legend labels with text and {{label_name}} placeholders."})]}),e("div",{className:"vm-legend-configs-item",children:[e(it,{label:"Group Legend By",value:u,list:[Ut,...v],placeholder:Ut,onChange:h,searchable:!0}),e("span",{className:"vm-legend-configs-item__info",children:"Choose a label to group the legend. By default, legends are grouped by query."})]})]})]})},hm=({labels:t,query:n,isAnomalyView:r,isPredefinedPanel:a,onChange:o})=>{const{groupByLabel:s}=ja(),i=dm({labels:t,query:n,groupByLabel:s});return e("div",{className:"vm-legend",children:[!a&&e(gi,{isCompact:!0}),e("div",{children:i.map(({group:l,items:c})=>e(cm,{labels:c,group:l,isAnomalyView:r,onChange:o},l))})]})},pm=({min:t,max:n,legendValue:r})=>{const[a,o]=N(0),[s,i]=N(""),[l,c]=N(""),[d,m]=N(""),u=M(()=>parseFloat(String((r==null?void 0:r.value)||0).replace("%","")),[r]);return A(()=>{o(u?(u-t)/(n-t)*100:0),i(u?`${u}%`:""),c(`${t}%`),m(`${n}%`)},[u,t,n]),e("div",{className:"vm-legend-heatmap__wrapper",children:e("div",{className:"vm-legend-heatmap",children:[e("div",{className:"vm-legend-heatmap-gradient",style:{background:`linear-gradient(to right, ${$a.join(", ")})`},children:!!u&&e("div",{className:"vm-legend-heatmap-gradient__value",style:{left:`${a}%`},children:e("span",{children:s})})}),e("div",{className:"vm-legend-heatmap__value",children:l}),e("div",{className:"vm-legend-heatmap__value",children:d})]})})},gm=({u:t,metrics:n,unit:r})=>{const[a,o]=N({left:0,top:0}),[s,i]=N([]),l=()=>{i([]),o({left:0,top:0})},c=h=>{const p=h.cursor.left||0,v=h.cursor.top||0;o({left:p,top:v})},d=W(()=>{var x;const{left:h,top:p}=a,v=st(t,["data",1,0],[])||[],b=t?t.posToVal(h,"x"):0,f=t?t.posToVal(p,"y"):0,g=v.findIndex((E,P)=>b>=E&&b<v[P+1])||-1,_=v[g+1],y=n[Math.round(f)]||{values:[]},[S=0,T=""]=y.values.find(E=>E[0]===_)||[],w=v[g],C=U(w*1e3).tz().format(On),k=U(S*1e3).tz().format(On),L=((x=y==null?void 0:y.metric)==null?void 0:x.vmrange)||"";return{unit:r,point:a,u:t,id:`${L}_${C}`,dates:[C,k],value:`${T}%`,info:L,show:+T>0}},[t,a,n,r]),m=W(()=>{const h=d();h.show&&(s.find(p=>p.id===h.id)||i(p=>[...p,h]))},[d,s]),u=h=>{i(p=>p.filter(v=>v.id!==h))};return me("click",m),{stickyTooltips:s,handleUnStick:u,getTooltipProps:d,setCursor:c,resetTooltips:l}},vm=({data:t,metrics:n=[],period:r,unit:a,setPeriod:o,layoutSize:s,height:i,onChangeLegend:l})=>{const{isDarkTheme:c}=se(),d=q(null),[m,u]=N(),{xRange:h,setPlotScale:p}=Ua({period:r,setPeriod:o}),{onReadyChart:v,isPanning:b}=Va(p);qa({uPlotInst:m,xRange:h,setPlotScale:p});const{stickyTooltips:f,handleUnStick:g,getTooltipProps:_,setCursor:y,resetTooltips:S}=gm({u:m,metrics:n,unit:a}),T=M(()=>_(),[_]),w=()=>{const k=Ra([{}],a);return[...k,{scale:"y",stroke:k[0].stroke,font:k[0].font,size:ei,splits:n.map((L,x)=>x),values:n.map(L=>L.metric.vmrange)}]},C={...oi({width:s.width,height:i}),mode:2,series:[{},{paths:$d(),facets:[{scale:"x",auto:!0,sorted:1},{scale:"y",auto:!0}]}],axes:w(),scales:{x:{time:!0},y:{log:2,time:!1,range:(k,L,x)=>[L-1,x+1]}},hooks:{ready:[v],setCursor:[y],setSelect:[Ha(p)],destroy:[za]}};return A(()=>{S();const k=t[0]===null&&Array.isArray(t[1]);if(!d.current||!k)return;const L=new jt(C,t,d.current);return u(L),L.destroy},[d,t,c]),A(()=>{m&&(m.setSize({width:s.width||400,height:i||500}),m.redraw())},[i,s]),A(()=>{l(T)},[T]),e("div",{className:I({"vm-line-chart":!0,"vm-line-chart_panning":b}),style:{minWidth:`${s.width||400}px`,minHeight:`${i||500}px`},children:[e("div",{className:"vm-line-chart__u-plot",ref:d}),e(ci,{showTooltip:!!T.show,tooltipProps:T,stickyTooltips:f,handleUnStick:g})]})},vi=()=>{const[t,n]=N(null),[r,a]=N({width:0,height:0}),o=W(()=>{a({width:(t==null?void 0:t.offsetWidth)||0,height:(t==null?void 0:t.offsetHeight)||0})},[t==null?void 0:t.offsetHeight,t==null?void 0:t.offsetWidth]);return me("resize",o),A(o,[t==null?void 0:t.offsetHeight,t==null?void 0:t.offsetWidth]),[n,r]},fm={[ne.yhat]:"yhat",[ne.yhatLower]:"yhat_upper - yhat_lower",[ne.yhatUpper]:"yhat_upper - yhat_lower",[ne.anomaly]:"anomalies",[ne.training]:"training data",[ne.actual]:"y"},_m=({series:t})=>{const n=M(()=>{const r=t.reduce((o,s)=>{const i=Object.prototype.hasOwnProperty.call(s,"forecast"),l=s.forecast!==ne.yhatUpper,c=!o.find(d=>d.forecast===s.forecast);return i&&c&&l&&o.push(s),o},[]),a={...r[0],forecast:ne.training,color:Ht[ne.training]};return r.splice(1,0,a),r.map(o=>({...o,color:typeof o.stroke=="string"?o.stroke:Ht[o.forecast||ne.actual]}))},[t]);return e(V,{children:e("div",{className:"vm-legend-anomaly",children:n.filter(r=>r.forecast!==ne.training).map((r,a)=>{var o;return e("div",{className:"vm-legend-anomaly-item",children:[e("svg",{children:r.forecast===ne.anomaly?e("circle",{cx:"15",cy:"7",r:"4",fill:r.color,stroke:r.color,strokeWidth:"1.4"}):e("line",{x1:"0",y1:"7",x2:"30",y2:"7",stroke:r.color,strokeWidth:r.width||1,strokeDasharray:(o=r.dash)==null?void 0:o.join(",")})}),e("div",{className:"vm-legend-anomaly-item__title",children:fm[r.forecast||ne.actual]})]},`${a}_${r.forecast}`)})})})},ar=({data:t=[],period:n,customStep:r,query:a,yaxis:o,unit:s,showLegend:i=!0,setYaxisLimits:l,setPeriod:c,alias:d=[],fullWidth:m=!0,height:u,isHistogram:h,isAnomalyView:p,isPredefinedPanel:v,spanGaps:b})=>{var X;const f=vt(),{isMobile:g}=J(),{timezone:_}=ge(),y=M(()=>r||n.step||"1s",[n.step,r]),S=M(()=>Hd(t,h),[h,t]),[T,w]=N([[]]),[C,k]=N([]),[L,x]=N([]),[E,P]=N([]),[F,O]=N(null),H=M(()=>qd(S,E,d,p),[S,E,d,p]),z=R=>{const $=Pd(R,!h);l($)},Y=(R,$)=>{P(Bd({hideSeries:E,legend:R,metaKey:$,series:C,isAnomalyView:p}))},G=R=>{const $=R.slice(1,R.length),B=[],ee=[];$.forEach((ue,he)=>{ue.forEach((Ye,ye)=>{const Pe=ye*$.length+he;ee[Pe]=Ye})}),R[0].forEach(ue=>{const he=new Array($.length).fill(ue);B.push(...he)});const te=new Array(B.length).fill(0).map((ue,he)=>he%$.length);return[null,[B,te,ee]]},K=R=>p?js(R,["group","label"]).map(B=>{const ee=B.values[0];return{...ee,freeFormFields:{...ee.freeFormFields,__name__:""}}}):R;A(()=>{const R=[],$={},B=[],ee=[{}];S==null||S.forEach((ye,Pe)=>{const De=H(ye,Pe);ee.push(De),B.push(_o(De,ye.group));const Ve=$[ye.group]||[];for(const pe of ye.values)R.push(pe[0]),Ve.push(sn(pe[1]));$[ye.group]=Ve});const te=Id(R,y,n),ue=S.map(ye=>{const Pe=[],De=ye.values,Ve=De.length;let pe=0;for(const Ot of te){for(;pe<Ve&&De[pe][0]<Ot;)pe++;let ft=null;pe<Ve&&De[pe][0]==Ot&&(ft=sn(De[pe][1]),Number.isFinite(ft)||(ft=null)),Pe.push(ft)}const Dt=Pe.filter(Ot=>Ot!==null),at=Math.abs(Sd(Dt)),wt=rr(Oa(Dt),nr(Dt)),Jt=Math.abs(wt[1]-wt[0]);return at>Jt*1e10&&!p?Pe.map(()=>at):Pe});ue.unshift(te),z($);const he=h?G(ue):ue;w(he),k(ee);const Ye=K(B);x(Ye),p&&P(Ye.map(ye=>ye.label||"").slice(1))},[S,_,h,y]),A(()=>{const R=[],$=[{}];S==null||S.forEach((B,ee)=>{const te=H(B,ee);$.push(te),R.push(_o(te,B.group))}),k($),x(K(R))},[E]);const[re,Q]=vi(),ie=((X=T[0])==null?void 0:X.length)>0;return A(()=>{const $=(()=>{var B;if(!h||!S[1])return!1;try{return(((B=T==null?void 0:T[1])==null?void 0:B[2])||[]).every(te=>te===null)}catch{return!1}})();f({type:"SET_IS_EMPTY_HISTOGRAM",payload:$})},[T,h]),e("div",{className:I({"vm-graph-view":!0,"vm-graph-view_full-width":m,"vm-graph-view_full-width_mobile":m&&g}),ref:re,children:[!h&&ie&&e(nm,{data:T,series:C,metrics:S,period:n,yaxis:o,unit:s,setPeriod:c,layoutSize:Q,height:u,isAnomalyView:p,spanGaps:b}),h&&e(vm,{data:T,metrics:S,period:n,unit:s,setPeriod:c,layoutSize:Q,height:u,onChangeLegend:O}),p&&i&&e(_m,{series:C}),!h&&i&&e(hm,{labels:L,query:a,isAnomalyView:p,onChange:Y,isPredefinedPanel:v}),h&&i&&e(pm,{min:o.limits.range[1][0]||0,max:o.limits.range[1][1]||0,legendValue:F})]})},bm=({yaxis:t,setYaxisLimits:n,toggleEnableLimits:r})=>{const{isMobile:a}=J(),o=M(()=>Object.keys(t.limits.range),[t.limits.range]),i=W(ln((c,d,m)=>{const u=t.limits.range;u[d][m]=+c,!(u[d][0]===u[d][1]||u[d][0]>u[d][1])&&n(u)},500),[t.limits.range]),l=(c,d)=>m=>{i(m,c,d)};return e("div",{className:I({"vm-axes-limits":!0,"vm-axes-limits_mobile":a}),children:[e("div",{className:"vm-graph-settings-row",children:[e("span",{className:"vm-graph-settings-row__label",children:"Fixed Y-axis limits"}),e(_e,{value:t.limits.enable,onChange:r,label:t.limits.enable?"Enabled":"Disabled",fullWidth:a})]}),e("span",{className:"vm-legend-configs-item__info",children:"Enables manual setting of min and max values for the y-axis."}),t.limits.enable&&e("div",{className:"vm-axes-limits-list",children:o.map(c=>e("div",{className:"vm-axes-limits-list__inputs",children:[e(ce,{label:`Min ${c}`,type:"number",disabled:!t.limits.enable,value:t.limits.range[c][0],onChange:l(c,0)}),e(ce,{label:`Max ${c}`,type:"number",disabled:!t.limits.enable,value:t.limits.range[c][1],onChange:l(c,1)})]},c))})]})},ym=({spanGaps:t,onChange:n})=>{const{isMobile:r}=J();return e("div",{className:"vm-graph-settings-row",children:[e("span",{className:"vm-graph-settings-row__label",children:"Connect null values"}),e(_e,{value:t,onChange:n,label:t?"Enabled":"Disabled",fullWidth:r}),e("span",{className:"vm-legend-configs-item__info",children:"Connects data points by skipping null values instead of creating gaps."})]})},fi=()=>{const[t,n]=oe(),r=Be();return{handleChange:(o,s)=>{o?t.delete("display_mode"):t.set("display_mode","lines"),n(t),r({type:"RUN_QUERY"}),s&&s()}}},wm=({onChange:t})=>{const{isMobile:n}=J(),{handleChange:r}=fi(),[a]=oe(),o=!a.get("display_mode");return e("div",{className:"vm-graph-settings-row",children:[e("span",{className:"vm-graph-settings-row__label",children:"Histogram mode"}),e(_e,{value:o,onChange:i=>{r(i,t)},label:o?"Enabled":"Disabled",fullWidth:n})]})},Co="Graph & Legend Settings",Qa=({data:t,yaxis:n,setYaxisLimits:r,toggleEnableLimits:a,spanGaps:o})=>{const{openSettings:s}=He(),i=vt(),l=q(null),c=q(null),d=Ma(t),{value:m,setTrue:u,setFalse:h}=ae(!1);return A(()=>{s&&(u(),i({type:"SET_OPEN_SETTINGS",payload:!1}))},[s]),e("div",{className:"vm-graph-settings",children:[e(j,{title:Co,children:e("div",{ref:c,children:e(D,{variant:"text",startIcon:e(Ze,{}),onClick:u,ariaLabel:"settings"})})}),m&&e(Me,{onClose:h,title:Co,className:"vm-graph-settings-modal",children:e("div",{className:"vm-graph-settings-body",ref:l,children:[e("div",{className:"vm-graph-settings-body-section",children:[e("h3",{className:"vm-graph-settings-body-section__title",children:"Graph Options"}),e("div",{className:"vm-graph-settings-body-section-content",children:[e(bm,{yaxis:n,setYaxisLimits:r,toggleEnableLimits:a}),e(ym,{spanGaps:o.value,onChange:o.onChange}),d&&e(wm,{onChange:h})]})]}),e("div",{className:"vm-graph-settings-body-section",children:[e("h3",{className:"vm-graph-settings-body-section__title",children:"Legend Options"}),e("div",{className:"vm-graph-settings-body-section-content",children:e(gi,{data:t})})]})]})})]})},_i=({isHistogram:t,graphData:n,controlsRef:r,isAnomalyView:a})=>{const{isMobile:o}=J(),{customStep:s,yaxis:i,spanGaps:l}=He(),{period:c}=ge(),{query:d}=xe(),m=Be(),u=vt(),h=g=>{u({type:"SET_YAXIS_LIMITS",payload:g})},p=()=>{u({type:"TOGGLE_ENABLE_YAXIS_LIMITS"})},v=g=>{u({type:"SET_SPAN_GAPS",payload:g})},b=({from:g,to:_})=>{m({type:"SET_PERIOD",payload:{from:g,to:_}})},f=e("div",{className:"vm-custom-panel-body-header__graph-controls",children:[e(Ca,{}),e(Qa,{data:n,yaxis:i,isHistogram:t,setYaxisLimits:h,toggleEnableLimits:p,spanGaps:{value:l,onChange:v}})]});return e(V,{children:[r.current&&pt(f,r.current),e(ar,{data:n,period:c,customStep:s,query:d,yaxis:i,setYaxisLimits:h,setPeriod:b,height:o?window.innerHeight*.5:500,isHistogram:t,isAnomalyView:a,spanGaps:l})]})},or=({data:t})=>{const n=Fe(),r=M(()=>JSON.stringify(t,null,2),[t]);return e("div",{className:"vm-json-view",children:[e("div",{className:"vm-json-view__copy",children:e(D,{variant:"outlined",onClick:async()=>{await n(r,"Formatted JSON has been copied")},children:"Copy JSON"})}),e("pre",{className:"vm-json-view__code",children:e("code",{children:r})})]})},Ya=t=>{const n={};return t.forEach(r=>Object.entries(r.metric).forEach(a=>n[a[0]]?n[a[0]].options.add(a[1]):n[a[0]]={options:new Set([a[1]])})),Object.entries(n).map(r=>({key:r[0],variations:r[1].options.size})).sort((r,a)=>r.variations-a.variations)},No=(t,n)=>M(()=>n?Ya(t).filter(a=>n.includes(a.key)):[],[t,n]),bi=({data:t,displayColumns:n})=>{const r=Fe(),{isMobile:a}=J(),{tableCompact:o}=je(),s=q(null),[i,l]=N(""),[c,d]=N("asc"),m=o?No([{group:0,metric:{Data:"Data"}}],["Data"]):No(t,n),u=y=>{const{__name__:S,...T}=y;return!S&&!Object.keys(T).length?"":S?`${S} ${JSON.stringify(T)}`:`${JSON.stringify(T)}`},p=new Set(t==null?void 0:t.map(y=>y.group)).size>1,v=M(()=>{const y=t==null?void 0:t.map(w=>({metadata:m.map(C=>o?Ir(w,"",p):w.metric[C.key]||"-"),value:w.value?w.value[1]:"-",values:w.values?w.values.map(([C,k])=>`${k} @${C}`):[],copyValue:u(w.metric)})),S=i==="Value",T=m.findIndex(w=>w.key===i);return!S&&T===-1?y:y.sort((w,C)=>{const k=S?Number(w.value):w.metadata[T],L=S?Number(C.value):C.metadata[T];return(c==="asc"?k<L:k>L)?-1:1})},[m,t,i,c,o]),b=M(()=>v.some(y=>y.copyValue),[v]),f=y=>{d(S=>S==="asc"&&i===y?"desc":"asc"),l(y)},g=y=>()=>{f(y)},_=y=>async()=>{await r(y,"Row has been copied")};return v.length?e("div",{className:I({"vm-table-view":!0,"vm-table-view_mobile":a}),children:e("table",{className:"vm-table",ref:s,children:[e("thead",{className:"vm-table-header",children:e("tr",{className:"vm-table__row vm-table__row_header",children:[m.map((y,S)=>e("td",{className:"vm-table-cell vm-table-cell_header vm-table-cell_sort",onClick:g(y.key),children:e("div",{className:"vm-table-cell__content",children:[y.key,e("div",{className:I({"vm-table__sort-icon":!0,"vm-table__sort-icon_active":i===y.key,"vm-table__sort-icon_desc":c==="desc"&&i===y.key}),children:e(Je,{})})]})},S)),e("td",{className:"vm-table-cell vm-table-cell_header vm-table-cell_right vm-table-cell_sort",onClick:g("Value"),children:e("div",{className:"vm-table-cell__content",children:[e("div",{className:I({"vm-table__sort-icon":!0,"vm-table__sort-icon_active":i==="Value","vm-table__sort-icon_desc":c==="desc"}),children:e(Je,{})}),"Value"]})}),b&&e("td",{className:"vm-table-cell vm-table-cell_header"})]})}),e("tbody",{className:"vm-table-body",children:v.map((y,S)=>e("tr",{className:"vm-table__row",children:[y.metadata.map((T,w)=>e("td",{className:I({"vm-table-cell vm-table-cell_no-wrap":!0,"vm-table-cell_gray":v[S-1]&&v[S-1].metadata[w]===T}),children:T},w)),e("td",{className:"vm-table-cell vm-table-cell_right vm-table-cell_no-wrap",children:y.values.length?y.values.map(T=>e("p",{children:T},T)):y.value}),b&&e("td",{className:"vm-table-cell vm-table-cell_right",children:y.copyValue&&e("div",{className:"vm-table-cell__content",children:e(j,{title:"Copy row",children:e(D,{variant:"text",color:"gray",size:"small",startIcon:e(Xe,{}),onClick:_(y.copyValue),ariaLabel:"copy row"})})})})]},S))})]})}):e(le,{variant:"warning",children:"No data to show"})},Or=({checked:t=!1,disabled:n=!1,label:r,color:a="secondary",onChange:o})=>{const s=()=>{n||o(!t)},i=I({"vm-checkbox":!0,"vm-checkbox_disabled":n,"vm-checkbox_active":t,[`vm-checkbox_${a}_active`]:t,[`vm-checkbox_${a}`]:a});return e("div",{className:i,onClick:s,children:[e("div",{className:"vm-checkbox-track",children:e("div",{className:"vm-checkbox-track__thumb",children:e(Wn,{})})}),r&&e("span",{className:"vm-checkbox__label",children:r})]})},_r="Table settings",Ga=({columns:t,selectedColumns:n=[],tableCompact:r,onChangeColumns:a,toggleTableCompact:o})=>{const[s,i]=oe(),l=q(null),{value:c,toggle:d,setFalse:m}=ae(!1),[u,h]=N(""),[p,v]=N(-1),b=M(()=>n.filter(k=>!t.includes(k)),[t,n]),f=M(()=>{const k=b.concat(t);return(u?k.filter(x=>x.includes(u)):k).sort((x,E)=>x.localeCompare(E))},[t,b,u]),g=M(()=>f.every(k=>n.includes(k)),[n,f]),_=k=>{a(k);const L=new URLSearchParams(s.toString());k.length===t.length?L.delete("columns"):L.set("columns",k.map(encodeURIComponent).join(",")),i(L)},y=k=>{const L=n.includes(k)?n.filter(x=>x!==k):[...n,k];_(L)},S=()=>{_(g?n.filter(k=>!f.includes(k)):f)},T=k=>()=>{y(k)},w=()=>{v(-1)},C=k=>{const L=k.key==="ArrowUp",x=k.key==="ArrowDown",E=k.key==="Enter";(x||L||E)&&k.preventDefault(),x?v(P=>P+1>f.length-1?P:P+1):L?v(P=>P-1<0?P:P-1):E&&y(f[p])};return A(()=>{Zn(t,n)||s.has("columns")||a(t)},[t]),A(()=>{if(!s.has("columns"))return;const x=(s.get("columns")||"").split(",").map(decodeURIComponent).filter(Boolean);a(x)},[]),e("div",{className:"vm-table-settings",children:[e(j,{title:_r,children:e("div",{ref:l,children:e(D,{variant:"text",startIcon:e(Ze,{}),onClick:d,ariaLabel:_r})})}),c&&e(Me,{title:_r,className:"vm-table-settings-modal",onClose:m,children:[e("div",{className:"vm-table-settings-modal-section",children:[e("div",{className:"vm-table-settings-modal-section__title",children:"Customize columns"}),e("div",{className:"vm-table-settings-modal-columns",children:[e("div",{className:"vm-table-settings-modal-columns__search",children:e(ce,{placeholder:"Search columns",startIcon:e(Cs,{}),value:u,onChange:h,onBlur:w,onKeyDown:C,type:"search"})}),e("div",{className:"vm-table-settings-modal-columns-list",children:[!!f.length&&e("div",{className:"vm-table-settings-modal-columns-list__item vm-table-settings-modal-columns-list__item_all",children:e(Or,{checked:g,onChange:S,label:g?"Uncheck all":"Check all",disabled:r})}),!f.length&&e("div",{className:"vm-table-settings-modal-columns-no-found",children:e("p",{className:"vm-table-settings-modal-columns-no-found__info",children:"No columns found."})}),f.map((k,L)=>e("div",{className:I({"vm-table-settings-modal-columns-list__item":!0,"vm-table-settings-modal-columns-list__item_focus":L===p,"vm-table-settings-modal-columns-list__item_custom":b.includes(k)}),children:e(Or,{checked:n.includes(k),onChange:T(k),label:k,disabled:r})},k))]})]})]}),o&&r!==void 0&&e("div",{className:"vm-table-settings-modal-section",children:[e("div",{className:"vm-table-settings-modal-section__title",children:"Table view"}),e("div",{className:"vm-table-settings-modal-columns-list__item",children:e(_e,{label:"Compact view",value:r,onChange:o})})]})]})]})},Cm=({liveData:t,controlsRef:n})=>{const{tableCompact:r}=je(),a=Gt(),[o,s]=N(),i=M(()=>Ya(t||[]).map(d=>d.key),[t]),c=e(Ga,{columns:i,selectedColumns:o,onChangeColumns:s,tableCompact:r,toggleTableCompact:()=>{a({type:"TOGGLE_TABLE_COMPACT"})}});return e(V,{children:[n.current&&pt(c,n.current),e(bi,{data:t,displayColumns:o})]})},yi=({graphData:t,liveData:n,isHistogram:r,displayType:a,controlsRef:o})=>a===Ne.code&&n?e(or,{data:n}):a===Ne.table&&n?e(Cm,{liveData:n,controlsRef:o}):a===Ne.chart&&t?e(_i,{graphData:t,isHistogram:r,controlsRef:o}):null,Nm=e(V,{children:[e("p",{children:"Filename - specify the name for your report file."}),e("p",{children:["Default format: ",e("code",{children:["vmui_report_$",Wr,".json"]}),"."]}),e("p",{children:"This name will be used when saving your report on your device."})]}),Sm=e(V,{children:[e("p",{children:["Title - specify the title that will be displayed on the ",e(Bn,{to:Z.queryAnalyzer,target:"_blank",rel:"noreferrer",className:"vm-link vm-link_underlined",children:gt[Z.queryAnalyzer].title})," page."]}),e("p",{children:"This helps identify your report in the interface."})]}),km=e(V,{children:[e("p",{children:"Comment (optional) - add a comment to your report."}),e("p",{children:"This can be any additional information that will be useful when reviewing the report later."})]}),Tm=e(V,{children:[e("p",{children:"Query trace - enable this option to include a query trace in your report."}),e("p",{children:"This will assist in analyzing and diagnosing the query processing."})]}),Lm=e(V,{children:[e("p",{children:"Generate Report - click this button to generate and save your report. "}),e("p",{children:["After creation, the report can be downloaded and examined on the ",e(Bn,{to:Z.queryAnalyzer,target:"_blank",rel:"noreferrer",className:"vm-link vm-link_underlined",children:gt[Z.queryAnalyzer].title})," page."]})]}),Am=[Nm,Sm,km,Tm,Lm],wi=t=>{try{return JSON.parse(t)}catch{return null}},Em=[{title:"Write",value:!1},{title:"Preview",value:!0}],xm=({value:t,onChange:n})=>{const{value:r,setTrue:a,setFalse:o}=ae(!1);return e("div",{className:"vm-markdown-editor",children:[e("div",{className:"vm-markdown-editor-header",children:[e("div",{className:"vm-markdown-editor-header-tabs",children:Em.map(({title:s,value:i})=>e("div",{className:I({"vm-markdown-editor-header-tabs__tab":!0,"vm-markdown-editor-header-tabs__tab_active":r===i}),onClick:i?a:o,children:s},s))}),e("span",{className:"vm-markdown-editor-header__info",children:"Markdown is supported"})]}),r?e("div",{className:"vm-markdown-editor-preview vm-markdown",dangerouslySetInnerHTML:{__html:Bt(t)}}):e(ce,{type:"textarea",value:t,onChange:n})]})};var Ci=(t=>(t[t.QUERY_DATA=0]="QUERY_DATA",t[t.RAW_DATA=1]="RAW_DATA",t))(Ci||{});const Mm=t=>{switch(t){case 1:return"Raw report";default:return"Report"}},Im=t=>{const n=U().utc().format(Wr);return`vmui_${t.toLowerCase().replace(/ /g,"_")}_${n}`},Ni=({fetchUrl:t,reportType:n=0})=>{const{query:r}=xe(),a=Mm(n),o=Im(a),[s,i]=N(a),[l,c]=N(o),[d,m]=N(""),[u,h]=N(n===0),[p,v]=N(),[b,f]=N(!1),g=q(null),_=q(null),y=q(null),S=q(null),T=q(null),w=[_,g,y,S,T],[C,k]=N(0),{value:L,toggle:x,setFalse:E}=ae(!1),{value:P,toggle:F,setFalse:O}=ae(!1),H=W(()=>{if(t)try{return t.map((R,$)=>{const B=new URL(R);return u?B.searchParams.set("trace","1"):B.searchParams.delete("trace"),{id:$,url:B}})}catch(R){v(String(R))}},[t,u]),z=W(R=>{const $=JSON.stringify(R,null,2);Pa($,`${l||o}.json`),E()},[l]),Y=({id:R,url:$,comment:B,title:ee})=>({id:R,title:ee||a,comment:B,endpoint:nl($.pathname)||"",params:Object.fromEntries($.searchParams)}),G=async(R,$)=>{const B=[],ee=await R.text();return R.ok?ee.split(`
`).filter(ue=>ue).forEach(ue=>{const he=wi(ue);he&&B.push({metric:he.metric,values:he.values.map((Ye,ye)=>[he.timestamps[ye]/1e3,Ye])})}):v(String(ee)),{data:{result:B,resultType:"matrix"},vmui:Y($)}},K=async(R,$)=>{const B=await R.json();if(R.ok)return B.vmui=Y($),B;{const ee=B.errorType?`${B.errorType}\r
`:"";v(`${ee}${(B==null?void 0:B.error)||(B==null?void 0:B.message)||"unknown error"}`)}},re=async(R,$)=>{switch(n){case 1:return await G(R,$);default:return await K(R,$)}},Q=W(async()=>{const R=H();if(!R){v($=>$||Ce.validQuery);return}v(""),f(!0);try{const $=[];for await(const B of R){if(!B)continue;const{url:ee,id:te}=B,ue=await fetch(ee),he=await re(ue,{id:te,url:ee,comment:d,title:s});$.push(he)}$.length&&z($)}catch($){$ instanceof Error&&$.name!=="AbortError"&&v(`${$.name}: ${$.message}`)}finally{f(!1)}},[H,d,z,r,s]),ie=R=>()=>{const $=B=>{var te;const ee=B+R;return(te=w[ee])!=null&&te.current?ee:$(ee)};k($)};return A(()=>{v(""),c(o),m("")},[L]),A(()=>{k(0)},[P]),e(V,{children:[e(j,{title:"Export query",children:e(D,{variant:"text",startIcon:e(fn,{}),onClick:x,ariaLabel:"export query"})}),L&&e(Me,{title:"Export query",onClose:E,isOpen:L,children:e("div",{className:"vm-download-report",children:[e("div",{className:"vm-download-report-settings",children:[e("div",{ref:_,children:[e("div",{className:"vm-download-report-settings__title",children:"Filename"}),e(ce,{value:l,onChange:c})]}),e("div",{ref:g,children:[e("div",{className:"vm-download-report-settings__title",children:"Report title"}),e(ce,{value:s,onChange:i})]}),e("div",{ref:y,children:[e("div",{className:"vm-download-report-settings__title",children:"Comment"}),e(xm,{value:d,onChange:m})]}),n===0&&e(V,{children:[e("div",{ref:S,children:e(Or,{checked:u,onChange:h,label:"Include query trace"})}),e(le,{variant:"info",children:["If confused with the query results, try viewing the raw samples for selected series in ",e(()=>e(Bn,{className:"vm-link vm-link_underlined vm-link_colored",to:Z.rawQuery,children:"Raw Query"}),{})," tab."]})]})]}),p&&e(le,{variant:"error",children:p}),e("div",{className:"vm-download-report__buttons",children:[e(D,{variant:"text",onClick:F,children:"Help"}),e("div",{ref:T,children:e(D,{onClick:Q,disabled:b,children:b?"Loading data...":"Generate Report"})})]}),e(Ie,{open:P,buttonRef:w[C],placement:"top-left",variant:"dark",onClose:O,children:e("div",{className:"vm-download-report-helper",children:[e("div",{className:"vm-download-report-helper__description",children:Am[C]}),e("div",{className:"vm-download-report-helper__buttons",children:[C!==0&&e(D,{onClick:ie(-1),size:"small",color:"white",children:"Prev"}),e(D,{onClick:C===w.length-1?O:ie(1),size:"small",color:"white",variant:"text",children:C===w.length-1?"Close":"Next"})]})]})})]})})]})},Si=()=>{const{isEmptyHistogram:t}=He(),{handleChange:n}=fi();return t?e(le,{variant:"warning",children:e("div",{className:"vm-warning-heatmap-to-line",children:[e("p",{className:"vm-warning-heatmap-to-line__text",children:'The expression cannot be displayed as a heatmap. To make the graph work, disable the heatmap in the "Graph settings" or modify the expression.'}),e(D,{size:"small",color:"primary",variant:"text",onClick:()=>n(!1),children:"Switch to line chart"})]})}):null},ki=()=>{Ia();const{isMobile:t}=J(),{displayType:n}=je(),{query:r}=xe(),{customStep:a}=He(),o=vt(),[s,i]=N([]),[l,c]=N(!r[0]),[d,m]=N(!1),u=q(null),{fetchUrl:h,isLoading:p,liveData:v,graphData:b,error:f,queryErrors:g,setQueryErrors:_,queryStats:y,warning:S,traces:T,isHistogram:w,abortFetch:C}=Xn({visible:!0,customStep:a,hideQuery:s,showAllSeries:d}),k=!(v!=null&&v.length)&&n!==Ne.chart,L=!l&&f,x=P=>{i(P)},E=()=>{c(!1)};return A(()=>{o({type:"SET_IS_HISTOGRAM",payload:w})},[b]),e("div",{className:I({"vm-custom-panel":!0,"vm-custom-panel_mobile":t}),children:[e(xa,{queryErrors:l?[]:g,setQueryErrors:_,setHideError:c,stats:y,isLoading:p,onHideQuery:x,onRunQuery:E,abortFetch:C,hideButtons:{reduceMemUsage:!0}}),e(Nd,{traces:T,displayType:n}),L&&e(le,{variant:"error",children:f}),k&&e(le,{variant:"info",children:e(wd,{})}),e(Si,{}),S&&e(tr,{warning:S,query:r,onChange:m}),e("div",{className:I({"vm-custom-panel-body":!0,"vm-custom-panel-body_mobile":t,"vm-block":!0,"vm-block_mobile":t}),children:[p&&e(er,{}),e("div",{className:"vm-custom-panel-body-header",ref:u,children:[e("div",{className:"vm-custom-panel-body-header__tabs",children:e(Es,{})}),(b||v)&&e(Ni,{fetchUrl:h})]}),e(yi,{graphData:b,liveData:v,isHistogram:w,displayType:n,controlsRef:u})]})]})},Pm=({title:t,description:n,unit:r,expr:a,showLegend:o,filename:s,alias:i})=>{const{isMobile:l}=J(),{period:c}=ge(),{customStep:d}=He(),m=Be(),u=q(null),[h,p]=N(!1),[v,b]=N(!1),[f,g]=N({limits:{enable:!1,range:{1:[0,0]}}}),_=M(()=>Array.isArray(a)&&a.every(E=>E),[a]),{isLoading:y,graphData:S,error:T,warning:w}=Xn({predefinedQuery:_?a:[],display:Ne.chart,visible:h,customStep:d}),C=E=>{const P={...f};P.limits.range=E,g(P)},k=()=>{const E={...f};E.limits.enable=!E.limits.enable,g(E)},L=({from:E,to:P})=>{m({type:"SET_PERIOD",payload:{from:E,to:P}})};return A(()=>{const E=new IntersectionObserver(P=>{P.forEach(F=>p(F.isIntersecting))},{threshold:.1});return u.current&&E.observe(u.current),()=>{u.current&&E.unobserve(u.current)}},[u]),_?e("div",{className:"vm-predefined-panel",ref:u,children:[e("div",{className:"vm-predefined-panel-header",children:[e(j,{title:e(()=>e("div",{className:"vm-predefined-panel-header__description vm-default-styles",children:[n&&e(V,{children:[e("div",{children:[e("span",{children:"Description:"}),e("div",{dangerouslySetInnerHTML:{__html:Bt(n)}})]}),e("hr",{})]}),e("div",{children:[e("span",{children:"Queries:"}),e("div",{children:a.map((E,P)=>e("div",{children:E},`${P}_${E}`))})]})]}),{}),children:e("div",{className:"vm-predefined-panel-header__info",children:e(mt,{})})}),e("h3",{className:"vm-predefined-panel-header__title",children:t||""}),e(Qa,{data:S||[],yaxis:f,setYaxisLimits:C,toggleEnableLimits:k,spanGaps:{value:v,onChange:b}})]}),e("div",{className:"vm-predefined-panel-body",children:[y&&e(Qe,{}),T&&e(le,{variant:"error",children:T}),w&&e(le,{variant:"warning",children:w}),S&&e(ar,{isPredefinedPanel:!0,data:S,period:c,customStep:d,query:a,yaxis:f,unit:r,alias:i,showLegend:o,setYaxisLimits:C,setPeriod:L,fullWidth:!1,height:l?window.innerHeight*.5:500,spanGaps:v})]})]}):e(le,{variant:"error",children:[e("code",{children:'"expr"'})," not found. Check the configuration file ",e("b",{children:s}),"."]})},Dm=({index:t,title:n,panels:r,filename:a})=>{const o=Pt(),s=M(()=>o.width/12,[o]),[i,l]=N(!t),[c,d]=N([]);A(()=>{d(r&&r.map(_=>_.width||12))},[r]);const[m,u]=N({start:0,target:0,enable:!1}),h=W(_=>{if(!m.enable)return;const{start:y}=m,S=Math.ceil((y-_.clientX)/s);if(Math.abs(S)>=12)return;const T=c.map((w,C)=>w-(C===m.target?S:0));d(T)},[m,s]),p=(_,y)=>{u({start:_.clientX,target:y,enable:!0})},v=W(()=>{u({...m,enable:!1})},[m]),b=_=>l(_),f=_=>y=>{p(y,_)};return me("mousemove",h),me("mouseup",v),e("div",{className:"vm-predefined-dashboard",children:e(Kn,{defaultExpanded:i,onChange:b,title:e(()=>e("div",{className:I({"vm-predefined-dashboard-header":!0,"vm-predefined-dashboard-header_open":i}),children:[(n||a)&&e("span",{className:"vm-predefined-dashboard-header__title",children:n||`${t+1}. ${a}`}),r&&e("span",{className:"vm-predefined-dashboard-header__count",children:["(",r.length," panels)"]})]}),{}),children:e("div",{className:"vm-predefined-dashboard-panels",children:Array.isArray(r)&&r.length?r.map((_,y)=>e("div",{className:"vm-predefined-dashboard-panels-panel vm-block vm-block_empty-padding",style:{gridColumn:`span ${c[y]}`},children:[e(Pm,{title:_.title,description:_.description,unit:_.unit,expr:_.expr,alias:_.alias,filename:a,showLegend:_.showLegend}),e("button",{className:"vm-predefined-dashboard-panels-panel__resizer",onMouseDown:f(y),"aria-label":"resize the panel"})]},y)):e("div",{className:"vm-predefined-dashboard-panels-panel__alert",children:e(le,{variant:"error",children:[e("code",{children:'"panels"'})," not found. Check the configuration file ",e("b",{children:a}),"."]})})})})})};function Om(t,n){return Object.fromEntries(Object.entries(t).filter(n))}function Ti(t){return Om(t,n=>!!n[1]||typeof n[1]=="number")}function Rm(t){return Object.keys(t).length===0}const $m=()=>{const{duration:t,relativeTime:n,period:{date:r}}=ge(),{customStep:a}=He(),{setSearchParamsFromKeys:o}=rt(),s=()=>{const i=Ti({"g0.range_input":t,"g0.end_input":r,"g0.step_input":a,"g0.relative_time":n});o(i)};A(s,[t,n,r,a]),A(s,[])},Fm=()=>{$m();const{isMobile:t}=J(),{dashboardsSettings:n,dashboardsLoading:r,dashboardsError:a}=Ms(),[o,s]=N(0),i=M(()=>n.map((p,v)=>({label:p.title||"",value:v})),[n]),l=M(()=>n[o]||{},[n,o]),c=M(()=>l==null?void 0:l.rows,[l]),d=M(()=>l.title||l.filename||"",[l]),m=M(()=>Array.isArray(c)&&!!c.length,[c]),u=p=>{s(p)},h=p=>()=>{u(p)};return e("div",{className:"vm-predefined-panels",children:[r&&e(Qe,{}),!n.length&&a&&e(le,{variant:"error",children:a}),!n.length&&e(le,{variant:"info",children:"Dashboards not found"}),i.length>1&&e("div",{className:I({"vm-predefined-panels-tabs":!0,"vm-predefined-panels-tabs_mobile":t}),children:i.map(p=>e("div",{className:I({"vm-predefined-panels-tabs__tab":!0,"vm-predefined-panels-tabs__tab_active":p.value==o}),onClick:h(p.value),children:p.label},p.value))}),e("div",{className:"vm-predefined-panels__dashboards",children:[m&&c.map((p,v)=>e(Dm,{index:v,filename:d,title:p.title,panels:p.panels},`${o}_${v}`)),!!n.length&&!m&&e(le,{variant:"error",children:[e("code",{children:'"rows"'})," not found. Check the configuration file ",e("b",{children:d}),"."]})]})]})},br=(t,n)=>{const r=n.match?"&match[]="+encodeURIComponent(n.match):"",a=n.focusLabel?"&focusLabel="+encodeURIComponent(n.focusLabel):"";return`${t}/api/v1/status/tsdb?topN=${n.topN}&date=${n.date}${r}${a}`},zm=(t,n)=>{const r=new URLSearchParams(Object.entries(n).filter(([a,o])=>o!=null)).toString();return`${t}/api/v1/status/metric_names_stats?${r}`},bn={id:"action",label:"",modifiers:["action"]},yn={id:"diff",label:"1d",info:"Shows the absolute difference compared to the previous day.",sortable:!0,modifiers:["compact"]},wn={id:"diffPercent",label:"1d %",info:"Shows the percentage difference compared to the previous day.",sortable:!0,modifiers:["compact"]},sr={id:"value",label:"Number of series",sortable:!0,modifiers:["compact"]},Hm=[{id:"name",label:"Metric name",sortable:!0},sr,{id:"requestsCount",label:"Requests count",sortable:!0,modifiers:["compact"],info:"The number of times this metric was queried since stats collection began."},{id:"lastRequestTimestamp",label:"Last request",sortable:!0,modifiers:["compact"],info:"The last time this metric was used in a query since stats collection began."},yn,wn,{id:"percentage",label:"Share in total",info:"Shows the share of a metric to the total number of series"},bn],Vm=[{id:"name",label:"Label name",sortable:!0},sr,yn,wn,{id:"percentage",label:"Share in total",info:"Shows the share of the label to the total number of series"},bn],qm=[{id:"name",label:"Label value",sortable:!0},sr,yn,wn,{id:"percentage",label:"Share in total"},bn],Um=[{id:"name",label:"Label=value pair",sortable:!0},sr,yn,wn,{id:"percentage",label:"Share in total",info:"Shows the share of the label value pair to the total number of series"},bn],Bm=[{id:"name",label:"Label name",sortable:!0},{id:"value",label:"Number of unique values",sortable:!0,modifiers:["compact"]},yn,wn,bn];class jm{constructor(){we(this,"tsdbStatus");we(this,"metricNameStats");we(this,"tabsNames");we(this,"isPrometheus");this.tsdbStatus=this.defaultTSDBStatus,this.metricNameStats=this.defaultMetricNameStats,this.tabsNames=["table","graph"],this.isPrometheus=!1,this.getDefaultState=this.getDefaultState.bind(this)}set tsdbStatusData(n){this.isPrometheus=!!(n!=null&&n.headStats),this.tsdbStatus=n}set metricNameStatsData(n){this.metricNameStats=n}get tsdbStatusData(){return this.tsdbStatus}get metricNameStatsData(){return this.metricNameStats}get defaultTSDBStatus(){return{totalSeries:0,totalSeriesPrev:0,totalSeriesByAll:0,totalLabelValuePairs:0,seriesCountByMetricName:[],seriesCountByLabelName:[],seriesCountByFocusLabelValue:[],seriesCountByLabelValuePair:[],labelValueCountByLabelName:[]}}get defaultMetricNameStats(){return{statsCollectedSince:0,statsCollectedRecordsTotal:0,trackerMemoryMaxSizeBytes:0,trackerCurrentMemoryUsageBytes:0}}get isPrometheusData(){return this.isPrometheus}keys(n,r){const a=n&&/__name__=".+"/.test(n),o=n&&/{.+=".+"}/g.test(n),s=n&&/__name__=".+", .+!=""/g.test(n);let i=[];return r||s?i=i.concat("seriesCountByFocusLabelValue"):a?i=i.concat("labelValueCountByLabelName"):o?i=i.concat("seriesCountByMetricName","seriesCountByLabelName"):i=i.concat("seriesCountByMetricName","seriesCountByLabelName","seriesCountByLabelValuePair","labelValueCountByLabelName"),i}getDefaultState(n,r){return this.keys(n,r).reduce((a,o)=>({...a,tabs:{...a.tabs,[o]:this.tabsNames},containerRefs:{...a.containerRefs,[o]:q(null)}}),{tabs:{},containerRefs:{}})}sectionsTitles(n){return{seriesCountByMetricName:"Metric names with the highest number of series",seriesCountByLabelName:"Labels with the highest number of series",seriesCountByFocusLabelValue:`Values for "${n}" label with the highest number of series`,seriesCountByLabelValuePair:"Label=value pairs with the highest number of series",labelValueCountByLabelName:"Labels with the highest number of unique values"}}get sectionsTips(){return{seriesCountByMetricName:`
        <p>
          This table returns a list of metrics with the highest cardinality.
          The cardinality of a metric is the number of time series associated with that metric,
          where each time series is defined as a unique combination of key-value label pairs.
        </p>
        <p>
          When looking to reduce the number of active series in your data source,
          you can start by inspecting individual metrics with high cardinality
          (i.e. that have lots of active time series associated with them),
          since that single metric contributes a large fraction of the series that make up your total series count.
        </p>`,seriesCountByLabelName:`
        <p>
          This table returns a list of the labels with the highest number of series.
        </p>
        <p>
          Use this table to identify labels that are storing dimensions with high cardinality
          (many different label values).
        </p>
        <p>
          It is recommended to choose labels such that they have a finite set of values,
          since every unique combination of key-value label pairs creates a new time series
          and therefore can dramatically increase the number of time series in your system.
        </p>`,seriesCountByFocusLabelValue:`
       <p>
          This table returns a list of unique label values per selected label.
       </p>
       <p>
          Use this table to identify label values that are storing per each selected series.
       </p>`,labelValueCountByLabelName:`
       <p>
          This table returns a list of labels with the highest number of the unique values.
       </p>
      `,seriesCountByLabelValuePair:`
        <p>
          This table returns a list of the label values pairs with the highest number of series.
        </p>
        <p>
          Use this table to identify unique label values pairs. This helps to identify same labels 
          is applied to count timeseries in your system, since every unique combination of key-value label pairs 
          creates a new time series and therefore can dramatically increase the number of time series in your system
        </p>`}}get tablesHeaders(){return{seriesCountByMetricName:Hm,seriesCountByLabelName:Vm,seriesCountByFocusLabelValue:qm,seriesCountByLabelValuePair:Um,labelValueCountByLabelName:Bm}}totalSeries(n,r=!1){return n==="labelValueCountByLabelName"?-1:r?this.tsdbStatus.totalSeriesPrev:this.tsdbStatus.totalSeries}}const Qm=()=>{const t=new jm,[n]=oe(),r=n.get("match"),a=n.get("focusLabel"),o=+(n.get("topN")||10),s=n.get("date")||U().tz().format(kt),i=qt(s),l=q(),{serverUrl:c}=se(),[d,m]=N(!1),[u,h]=N(),[p,v]=N(t.defaultTSDBStatus),[b,f]=N(t.defaultMetricNameStats),[g,_]=N(!1),y=async C=>{const k=await fetch(C),L=await k.json();if(k.ok)return L;console.error(`Error fetching ${C}:`,L);const x=L.errorType||Ce.unknownType,E=(L==null?void 0:L.error)||(L==null?void 0:L.message)||"see console for more details",P=[x,E].join(`\r
`);throw new Error(P)},S=(C,k)=>{Object.keys(C).forEach(L=>{const x=L,E=C[x],P=k[x];Array.isArray(E)&&Array.isArray(P)&&E.forEach(F=>{var Y;const O=(Y=P.find(G=>G.name===F.name))==null?void 0:Y.value,H=O?F.value-O:0,z=O?H/O*100:0;F.diff=H,F.diffPercent=z,F.valuePrev=O||0})})},T=async C=>{var E,P,F,O,H,z,Y,G,K,re;if(!c)return;h(""),m(!0),v(t.defaultTSDBStatus);const k={...C,date:C.date,topN:0,match:"",focusLabel:""},L={...C,date:U(C.date).subtract(1,"day").format(kt)},x=[br(c,C),br(c,L)];i!==s&&(C.match||C.focusLabel)&&x.push(br(c,k));try{const[Q,ie,X]=await Promise.all(x.map(y)),R={...ie.data},{data:$}=X||l.current||Q;l.current={data:$};const B={...Q.data,totalSeries:((E=Q.data)==null?void 0:E.totalSeries)||((F=(P=Q.data)==null?void 0:P.headStats)==null?void 0:F.numSeries)||0,totalLabelValuePairs:((O=Q.data)==null?void 0:O.totalLabelValuePairs)||((z=(H=Q.data)==null?void 0:H.headStats)==null?void 0:z.numLabelValuePairs)||0,seriesCountByLabelName:((Y=Q.data)==null?void 0:Y.seriesCountByLabelName)||[],seriesCountByFocusLabelValue:((G=Q.data)==null?void 0:G.seriesCountByFocusLabelValue)||[],totalSeriesByAll:($==null?void 0:$.totalSeries)||((K=$==null?void 0:$.headStats)==null?void 0:K.numSeries)||p.totalSeriesByAll||0,totalSeriesPrev:(R==null?void 0:R.totalSeries)||((re=R==null?void 0:R.headStats)==null?void 0:re.numSeries)||0},ee=r==null?void 0:r.replace(/[{}"]/g,"");B.seriesCountByLabelValuePair=B.seriesCountByLabelValuePair.filter(te=>te.name!==ee),S(B,R),v(B),m(!1)}catch(Q){m(!1),Q instanceof Error&&h(`${Q.name}: ${Q.message}`)}},w=async()=>{if(!c)return;h(""),m(!0);const C=zm(c,{limit:1});try{const k=await y(C);f(k),m(!1)}catch(k){m(!1),f(t.defaultMetricNameStats),console.error(k)}};return A(()=>{T({topN:o,match:r,date:s,focusLabel:a})},[c,r,a,o,s]),A(()=>{w()},[c]),A(()=>{u&&(v(t.defaultTSDBStatus),m(!1))},[u]),A(()=>{const C=dn(c);_(!!C)},[c]),t.tsdbStatusData=p,t.metricNameStatsData=b,{isLoading:d,appConfigurator:t,error:u,isCluster:g}},Ym={seriesCountByMetricName:({query:t})=>yr("__name__",t),seriesCountByLabelName:({query:t})=>`{${t}!=""}`,seriesCountByFocusLabelValue:({query:t,focusLabel:n})=>yr(n,t),seriesCountByLabelValuePair:({query:t})=>{const n=t.split("="),r=n[0],a=n.slice(1).join("=");return yr(r,a)},labelValueCountByLabelName:({query:t,match:n})=>n===""?`{${t}!=""}`:`${n.replace("}","")}, ${t}!=""}`},yr=(t,n)=>t?"{"+t+"="+JSON.stringify(n)+"}":"",Gm=({metricNameStats:t})=>{const{statsCollectedSince:n,statsCollectedRecordsTotal:r=0,trackerMemoryMaxSizeBytes:a=0,trackerCurrentMemoryUsageBytes:o=0}=t,s=n?U.unix(n).format(qe):" - ",i=a?`${(o/a*100).toFixed(2)}%`:" - ",l=r.toLocaleString("en-US");return e("div",{className:"vm-cardinality-totals-card",children:[e("h4",{className:"vm-cardinality-totals-card__title",children:[e(j,{placement:"bottom-left",title:e("div",{className:"vm-cardinality-totals-card__tooltip",children:n?e(V,{children:[e("p",{children:["Total entries in cache since ",s]}),e("p",{children:["Cache utilization: ",i]})]}):e(V,{children:[e("p",{children:"Metric names tracker is likely disabled."}),e("p",{children:"No data available. See documentation for enabling the metric names tracker."})]})}),children:e("div",{className:"vm-cardinality-totals-card__info-icon",children:e(un,{})})}),"Total metric names"]}),e("span",{className:"vm-cardinality-totals-card__value",children:l}),e("span",{className:"vm-cardinality-totals-card__link",children:e(Te,{href:"https://docs.victoriametrics.com/victoriametrics/single-server-victoriametrics/#track-ingested-metrics-usage",children:"Docs "})})]})},Wm=({totalSeries:t=0,totalSeriesPrev:n=0,totalSeriesAll:r=0,seriesCountByMetricName:a=[],metricNameStats:o,isPrometheus:s})=>{var b;const{isMobile:i}=J(),[l]=oe(),c=l.get("match"),d=l.get("focusLabel"),m=/__name__/.test(c||""),u=((b=a[0])==null?void 0:b.value)/r*100,h=t-n,p=Math.abs(h)/n*100,v=[{title:"Total series",value:t.toLocaleString("en-US"),dynamic:!t||!n||s?"":`${p.toFixed(2)}%`,display:!d,info:`The total number of unique time series for a selected day.
             A time series is uniquely identified by its name plus a set of its labels. 
             For example, temperature{city="NY",country="US"} and temperature{city="SF",country="US"} 
             are two distinct series, since they differ by the "city" label.`},{title:"Percentage from total",value:isNaN(u)?"-":`${u.toFixed(2)}%`,display:m,info:"The share of these series in the total number of time series."}].filter(f=>f.display);return v.length?e("div",{className:I({"vm-cardinality-totals":!0,"vm-cardinality-totals_mobile":i}),children:[v.map(({title:f,value:g,info:_,dynamic:y})=>e("div",{className:"vm-cardinality-totals-card",children:[e("h4",{className:"vm-cardinality-totals-card__title",children:[_&&e(j,{title:e("p",{className:"vm-cardinality-totals-card__tooltip",children:_}),children:e("div",{className:"vm-cardinality-totals-card__info-icon",children:e(un,{})})}),f]}),e("span",{className:"vm-cardinality-totals-card__value",children:g}),!!y&&e(j,{title:`in relation to the previous day: ${n.toLocaleString("en-US")}`,placement:"bottom-left",children:e("span",{className:I({"vm-dynamic-number":!0,"vm-dynamic-number_positive vm-dynamic-number_down":h<0,"vm-dynamic-number_negative vm-dynamic-number_up":h>0}),children:y})})]},f)),e(Gm,{metricNameStats:o})]}):null},Se=(t,n)=>{const[r]=oe(),a=r.get(n)?r.get(n):t,[o,s]=N(a);return A(()=>{a!==o&&s(a)},[a]),[o,s]},Jm=({isPrometheus:t,isCluster:n,...r})=>{const{isMobile:a}=J(),[o]=oe(),{setSearchParamsFromKeys:s}=rt(),i=o.get("tips")||"",[l,c]=Se("","match"),[d,m]=Se("","focusLabel"),[u,h]=Se(10,"topN"),p=M(()=>u<0?"Number must be bigger than zero":"",[u]),v=_=>{const y=+_;h(isNaN(y)?0:y)},b=()=>{s({match:l,topN:u,focusLabel:d})},f=()=>{s({match:"",focusLabel:""})},g=()=>{const _=o.get("tips")||"";s({tips:_?"":"true"})};return A(()=>{const _=o.get("match"),y=+(o.get("topN")||10),S=o.get("focusLabel");_!==l&&c(_||""),y!==u&&h(y),S!==d&&m(S||"")},[o]),e("div",{className:I({"vm-cardinality-configurator":!0,"vm-cardinality-configurator_mobile":a,"vm-block":!0,"vm-block_mobile":a}),children:[e("div",{className:"vm-cardinality-configurator-controls",children:[e("div",{className:"vm-cardinality-configurator-controls__query",children:e(ce,{label:"Time series selector",type:"string",value:l,onChange:c,onEnter:b})}),e("div",{className:"vm-cardinality-configurator-controls__item",children:e(ce,{label:"Focus label",type:"text",value:d||"",onChange:m,onEnter:b,endIcon:e(j,{title:e("div",{children:e("p",{children:"To identify values with the highest number of series for the selected label."})}),children:e(la,{})})})}),e("div",{className:"vm-cardinality-configurator-controls__item vm-cardinality-configurator-controls__item_limit",children:e(ce,{label:"Limit entries",type:"number",value:t?10:u,error:p,disabled:t,helperText:t?"not available for Prometheus":"",onChange:v,onEnter:b})})]}),e("div",{className:"vm-cardinality-configurator-bottom",children:[e(Wm,{isPrometheus:t,isCluster:n,...r}),n&&e("div",{className:"vm-cardinality-configurator-bottom-helpful",children:e(Te,{href:"https://docs.victoriametrics.com/victoriametrics/single-server-victoriametrics/#cardinality-explorer-statistic-inaccuracy",withIcon:!0,children:[e(ut,{}),"Statistic inaccuracy explanation"]})}),e("div",{className:"vm-cardinality-configurator-bottom-helpful",children:e(Te,{href:"https://docs.victoriametrics.com/victoriametrics/single-server-victoriametrics/#cardinality-explorer",withIcon:!0,children:[e(ut,{}),"Documentation"]})}),e("div",{className:"vm-cardinality-configurator-bottom__execute",children:[e(j,{title:i?"Hide tips":"Show tips",children:e(D,{variant:"text",color:i?"warning":"gray",startIcon:e(vn,{}),onClick:g,ariaLabel:"visibility tips"})}),e(D,{variant:"text",startIcon:e(ct,{}),onClick:f,children:"Reset"}),e(D,{startIcon:e(nt,{}),onClick:b,children:"Execute Query"})]})]})]})};function Km(t){const{order:n,orderBy:r,onRequestSort:a,headerCells:o}=t,s=i=>l=>{a(l,i)};return e("thead",{className:"vm-table-header vm-cardinality-panel-table__header",children:e("tr",{className:"vm-table__row vm-table__row_header",children:o.map(i=>e("th",{className:I({"vm-table-cell vm-table-cell_header":!0,"vm-table-cell_sort":i.sortable,"vm-table-cell_right":i.id==="action"}),onClick:i.sortable?s(i.id):void 0,children:e("div",{className:"vm-table-cell__content",children:[i.info&&e(j,{title:i.info,children:e("div",{className:"vm-metrics-content-header__tip-icon",children:e(un,{})})}),i.label,i.sortable&&e("div",{className:I({"vm-table__sort-icon":!0,"vm-table__sort-icon_active":r===i.id,"vm-table__sort-icon_desc":n==="desc"&&r===i.id}),children:e(Je,{})})]})},i.id))})})}const Zm=["date","timestamp","time"];function So(t,n,r){const a=t[r],o=n[r];if(a==null&&o==null)return 0;if(a==null)return 1;if(o==null)return-1;const s=String(a),i=String(o);if(Zm.includes(String(r))){const u=oo(s),h=oo(i);return h<u?-1:h>u?1:0}const c=Number(s),d=Number(i);return!isNaN(c)&&!isNaN(d)?d-c:i<s?-1:i>s?1:0}function Wa(t,n){return t==="desc"?(r,a)=>So(r,a,n):(r,a)=>-So(r,a,n)}function Ja(t,n){const r=t.map((a,o)=>[a,o]);return r.sort((a,o)=>{const s=n(a[0],o[0]);return s!==0?s:a[1]-o[1]}),r.map(a=>a[0])}const Xm=({rows:t,headerCells:n,defaultSortColumn:r,tableCells:a})=>{const[o,s]=N("desc"),[i,l]=N(r),c=(m,u)=>{s(i===u&&o==="asc"?"desc":"asc"),l(u)},d=Ja(t,Wa(o,i));return e("table",{className:"vm-table vm-cardinality-panel-table",children:[e(Km,{order:o,orderBy:i,onRequestSort:c,rowCount:t.length,headerCells:n}),e("tbody",{className:"vm-table-header",children:d.map(m=>e("tr",{className:"vm-table__row",children:a(m)},m.name))})]})},eu=({row:t,tableHeaderCells:n,totalSeries:r,totalSeriesPrev:a,onActionClick:o})=>{const s=r>0?t.value/r*100:-1,i=a>0?t.valuePrev/a*100:-1,l=[s,i].some(x=>x===-1),c=t.value.toLocaleString("en-US"),d=t.valuePrev.toLocaleString("en-US"),m=Math.abs(t.diff).toLocaleString("en-US"),u=s-i,h=l?"":`${Math.abs(u).toFixed(2)}%`,p=`${Math.abs(t.diffPercent).toFixed(2)}%`,v=t.requestsCount===0,f=t.requestsCount==null?"n/a":t.requestsCount.toLocaleString("en-US"),g=t.lastRequestTimestamp===0,_=t.lastRequestTimestamp==null,y=!g&&!_,S=g?"never":"n/a",T=y?U().diff(t.lastRequestTimestamp*1e3,"seconds"):0,w=y?U.unix(t.lastRequestTimestamp).format(qe):"-",C=y?U.duration(-T,"seconds").humanize(!0):S,k=()=>{o(t.name)},L=x=>{switch(x.id){case"name":return e("span",{className:"vm-link vm-link_colored",onClick:k,children:t.name});case"value":return c;case"requestsCount":return e("div",{className:I({"vm-dynamic-number":!0,"vm-dynamic-number_negative":v}),children:f});case"lastRequestTimestamp":return e(j,{title:`${w}`,children:e("span",{className:I({"vm-dynamic-number":!0,"vm-dynamic-number_negative":g||T>=30*86400,"vm-dynamic-number_warning":T>=7*86400&&T<30*86400}),children:C})});case"diff":return e(j,{title:`in relation to the previous day: ${d}`,children:e("span",{className:I({"vm-dynamic-number":!0,"vm-dynamic-number_positive vm-dynamic-number_down":t.diff<0,"vm-dynamic-number_negative vm-dynamic-number_up":t.diff>0}),children:m})});case"diffPercent":return e(j,{title:`in relation to the previous day: ${d}`,children:e("div",{className:I({"vm-dynamic-number":!0,"vm-dynamic-number_positive vm-dynamic-number_down":t.diff<0,"vm-dynamic-number_negative vm-dynamic-number_up":t.diff>0}),children:p})});case"percentage":return e("div",{className:"vm-cardinality-panel-table__progress",children:[e(Js,{value:s,hideValue:!0}),e("span",{className:"vm-dynamic-number vm-dynamic-number_static",children:[s.toFixed(2),"%"]}),e(j,{title:"in relation to the previous day",children:e("span",{className:I({"vm-dynamic-number":!0,"vm-dynamic-number_no-change":u===0,"vm-dynamic-number_positive vm-dynamic-number_down":u<0,"vm-dynamic-number_negative vm-dynamic-number_up":u>0}),children:h})})]});case"action":return e("div",{className:"vm-table-cell__content",children:e(j,{title:e("span",{children:["Filter by ",e("code",{children:["`",t.name,"`"]})]}),children:e(D,{variant:"text",size:"small",onClick:k,startIcon:e(hn,{})})})});default:return st(t,x.id,"")}};return e(V,{children:n.map(x=>{var E;return e("td",{className:I("vm-table-cell",...((E=x.modifiers)==null?void 0:E.map(P=>`vm-table-cell_${P}`))??[]),children:L(x)},x.id)})})},tu=({data:t})=>{const[n,r]=N([]),[a,o]=N([0,0]),s=i=>{const l=i.map(u=>u.value),c=Math.ceil(l[0]||1),d=10,m=c/(d-1);return new Array(d+1).fill(c+m).map((u,h)=>Math.round(u-m*h))};return A(()=>{const i=t.sort((c,d)=>d.value-c.value),l=s(i);o(l),r(i.map(c=>({...c,percentage:c.value/l[0]*100})))},[t]),e("div",{className:"vm-simple-bar-chart",children:[e("div",{className:"vm-simple-bar-chart-y-axis",children:a.map(i=>e("div",{className:"vm-simple-bar-chart-y-axis__tick",children:i},i))}),e("div",{className:"vm-simple-bar-chart-data",children:n.map(({name:i,value:l,percentage:c})=>e(j,{title:`${i}: ${l}`,placement:"top-center",children:e("div",{className:"vm-simple-bar-chart-data-item",style:{maxHeight:`${c||0}%`}})},`${i}_${l}`))})]})},nu=({rows:t,tabs:n=[],chartContainer:r,totalSeries:a,totalSeriesPrev:o,onActionClick:s,sectionTitle:i,tip:l,tableHeaderCells:c,isPrometheus:d})=>{const{isMobile:m}=J(),[u,h]=N("table"),p=d&&!t.length,v=f=>e(eu,{row:f,tableHeaderCells:c,totalSeries:a,totalSeriesPrev:o,onActionClick:s}),b=M(()=>n.map((f,g)=>({value:f,label:f,icon:g===0?e(pn,{}):e(aa,{})})),[n]);return e("div",{className:I({"vm-metrics-content":!0,"vm-metrics-content_mobile":m,"vm-block":!0,"vm-block_mobile":m}),children:[e("div",{className:"vm-metrics-content-header vm-section-header",children:[e("h5",{className:I({"vm-metrics-content-header__title":!0,"vm-section-header__title":!0,"vm-section-header__title_mobile":m}),children:[!m&&l&&e(j,{title:e("p",{dangerouslySetInnerHTML:{__html:l},className:"vm-metrics-content-header__tip"}),children:e("div",{className:"vm-metrics-content-header__tip-icon",children:e(un,{})})}),i]}),e("div",{className:"vm-section-header__tabs",children:e(Yt,{activeItem:u,items:b,onChange:h})})]}),p&&e("div",{className:"vm-metrics-content-prom-data",children:[e("div",{className:"vm-metrics-content-prom-data__icon",children:e(mt,{})}),e("h3",{className:"vm-metrics-content-prom-data__title",children:"Prometheus Data Limitation"}),e("p",{className:"vm-metrics-content-prom-data__text",children:["Due to missing data from your Prometheus source, some tables may appear empty.",e("br",{}),"This does not indicate an issue with your system or our tool."]})]}),!p&&u==="table"&&e("div",{ref:r,className:I({"vm-metrics-content__table":!0,"vm-metrics-content__table_mobile":m}),children:e(Xm,{rows:t,headerCells:c,defaultSortColumn:"value",tableCells:v})}),!p&&u==="graph"&&e("div",{className:"vm-metrics-content__chart",children:e(tu,{data:t.map(({name:f,value:g})=>({name:f,value:g}))})})]})},ir=({title:t,children:n})=>e("div",{className:"vm-cardinality-tip",children:[e("div",{className:"vm-cardinality-tip-header",children:[e("div",{className:"vm-cardinality-tip-header__tip-icon",children:e(vn,{})}),e("h4",{className:"vm-cardinality-tip-header__title",children:t||"Tips"})]}),e("p",{className:"vm-cardinality-tip__description",children:n})]}),ru=()=>e(ir,{title:"Metrics with a high number of series",children:e("ul",{children:[e("li",{children:["Identify and eliminate labels with frequently changed values to reduce their",e(Te,{href:"https://docs.victoriametrics.com/victoriametrics/faq/#what-is-high-cardinality",children:"cardinality"}),"and",e(Te,{href:"https://docs.victoriametrics.com/victoriametrics/faq/#what-is-high-churn-rate",children:"high churn rate"})]}),e("li",{children:["Find unused time series and",e(Te,{href:"https://docs.victoriametrics.com/victoriametrics/relabeling/",children:"drop entire metrics"})]}),e("li",{children:["Aggregate time series before they got ingested into the database via",e(Te,{href:"https://docs.victoriametrics.com/victoriametrics/stream-aggregation/",children:"streaming aggregation"})]})]})}),au=()=>e(ir,{title:"Labels with a high number of unique values",children:e("ul",{children:[e("li",{children:"Decrease the number of unique label values to reduce cardinality"}),e("li",{children:["Drop the label entirely via",e(Te,{href:"https://docs.victoriametrics.com/victoriametrics/relabeling/",children:"relabeling"})]}),e("li",{children:"For volatile label values (such as URL path, user session, etc.) consider printing them to the log file instead of adding to time series"})]})}),ou=()=>e(ir,{title:"Dashboard of a single metric",children:[e("p",{children:"This dashboard helps to understand the cardinality of a single metric."}),e("p",{children:"Each time series is a unique combination of key-value label pairs. Therefore a label key with many values can create a lot of time series for a particular metric. If youre trying to decrease the cardinality of a metric, start by looking at the labels with the highest number of values."}),e("p",{children:"Use the series selector at the top of the page to apply additional filters."})]}),su=()=>e(ir,{title:"Dashboard of a label",children:[e("p",{children:"This dashboard helps you understand the count of time series per label."}),e("p",{children:"Use the selector at the top of the page to pick a label name youd like to inspect. For the selected label name, youll see the label values that have the highest number of series associated with them. So if youve chosen `instance` as your label name, you may see that `657` time series have value host-1 attached to them and `580` time series have value `host-2` attached to them."}),e("p",{children:"This can be helpful in allowing you to determine where the bulk of your time series are coming from. If the label instance=host-1 was applied to 657 series and the label instance=host-2 was only applied to 580 series, youd know, for example, that host-01 was responsible for sending the majority of the time series."})]}),iu=`Please wait while cardinality stats is calculated. 
                        This may take some time if the db contains big number of time series.`,lu=()=>{const{isMobile:t}=J(),[n]=oe(),{setSearchParamsFromKeys:r}=rt(),a=n.get("tips")||"",o=n.get("match")||"",s=n.get("focusLabel")||"",{isLoading:i,appConfigurator:l,error:c,isCluster:d}=Qm(),{tsdbStatusData:m,metricNameStatsData:u,getDefaultState:h,tablesHeaders:p,sectionsTips:v}=l,b=h(o,s),f=g=>_=>{const S={match:Ym[g]({query:_,focusLabel:s,match:o})};(g==="labelValueCountByLabelName"||g=="seriesCountByLabelName")&&(S.focusLabel=_),g=="seriesCountByFocusLabelValue"&&(S.focusLabel=""),r(S)};return e("div",{className:I({"vm-cardinality-panel":!0,"vm-cardinality-panel_mobile":t}),children:[i&&e(Qe,{message:iu}),e(Jm,{isPrometheus:l.isPrometheusData,totalSeries:m.totalSeries,totalSeriesPrev:m.totalSeriesPrev,totalSeriesAll:m.totalSeriesByAll,totalLabelValuePairs:m.totalLabelValuePairs,seriesCountByMetricName:m.seriesCountByMetricName,metricNameStats:u,isCluster:d}),a&&e("div",{className:"vm-cardinality-panel-tips",children:[!o&&!s&&e(ru,{}),o&&!s&&e(ou,{}),!o&&!s&&e(au,{}),s&&e(su,{})]}),c&&e(le,{variant:"error",children:c}),l.keys(o,s).map(g=>e(nu,{sectionTitle:l.sectionsTitles(s)[g],tip:v[g],rows:m[g],onActionClick:f(g),tabs:b.tabs[g],chartContainer:b.containerRefs[g],totalSeriesPrev:l.totalSeries(g,!0),totalSeries:l.totalSeries(g),tableHeaderCells:p[g],isPrometheus:l.isPrometheusData},g))]})},cu=(t,n,r)=>`${t}/api/v1/status/top_queries?topN=${n||""}&maxLifetime=${r||""}`,du=(t,n)=>{var i;const{query:r,timeRangeSeconds:a}=t,o=[`g0.expr=${encodeURIComponent(r)}`],s=(i=nn.find(l=>l.duration===n))==null?void 0:i.id;return s&&o.push(`g0.relative_time=${s}`),a&&o.push(`g0.range_input=${n}`),`${Z.home}?${o.join("&")}`},mu=t=>(["topByAvgDuration","topByCount","topBySumDuration"].forEach(r=>{const a=t[r];Array.isArray(a)&&a.forEach(o=>{const s=Qn(o.timeRangeSeconds*1e3);o.url=du(o,s),o.timeRange=s})}),t),uu=({topN:t,maxLifetime:n})=>{const{serverUrl:r}=se(),{setSearchParamsFromKeys:a}=rt(),[o,s]=N(null),[i,l]=N(!1),[c,d]=N(),m=M(()=>cu(r,t,n),[r,t,n]);return{data:o,error:c,loading:i,fetch:async()=>{l(!0),a({topN:t,maxLifetime:n});try{const h=await fetch(m),p=await h.json();s(h.ok?mu(p):null),d(String(p.error||""))}catch(h){h instanceof Error&&h.name!=="AbortError"&&d(`${h.name}: ${h.message}`)}l(!1)}}},hu=({rows:t,columns:n,defaultOrderBy:r})=>{const a=Fe(),[o,s]=N(r||"count"),[i,l]=N("desc"),c=M(()=>Ja(t,Wa(i,o)),[t,o,i]),d=h=>{l(p=>p==="asc"&&o===h?"desc":"asc"),s(h)},m=h=>()=>{d(h)},u=({query:h})=>async()=>{await a(h,"Query has been copied")};return e("table",{className:"vm-table",children:[e("thead",{className:"vm-table-header",children:e("tr",{className:"vm-table__row vm-table__row_header",children:[n.map(h=>e("th",{className:"vm-table-cell vm-table-cell_header vm-table-cell_sort",onClick:m(h.sortBy||h.key),children:e("div",{className:"vm-table-cell__content",children:[h.title||h.key,e("div",{className:I({"vm-table__sort-icon":!0,"vm-table__sort-icon_active":o===h.key,"vm-table__sort-icon_desc":i==="desc"&&o===h.key}),children:e(Je,{})})]})},h.key)),e("th",{className:"vm-table-cell vm-table-cell_header"})," "]})}),e("tbody",{className:"vm-table-body",children:c.map((h,p)=>e("tr",{className:"vm-table__row",children:[n.map(v=>e("td",{className:"vm-table-cell",children:h[v.key]||"-"},v.key)),e("td",{className:"vm-table-cell vm-table-cell_no-padding",children:e("div",{className:"vm-top-queries-panels__table-actions",children:[h.url&&e(j,{title:"Execute query",children:e(Bn,{to:h.url,target:"_blank",rel:"noreferrer","aria-disabled":!0,children:e(D,{variant:"text",size:"small",startIcon:e(hn,{}),ariaLabel:"execute query"})})}),e(j,{title:"Copy query",children:e(D,{variant:"text",size:"small",startIcon:e(Xe,{}),onClick:u(h),ariaLabel:"copy query"})})]})})]},p))})]})},pu=["table","JSON"].map((t,n)=>({value:String(n),label:t,icon:n===0?e(pn,{}):e(It,{})})),wr=({rows:t,title:n,columns:r,defaultOrderBy:a})=>{const{isMobile:o}=J(),[s,i]=N(0),l=c=>{i(+c)};return e("div",{className:I({"vm-top-queries-panel":!0,"vm-block":!0,"vm-block_mobile":o}),children:[e("div",{className:I({"vm-top-queries-panel-header":!0,"vm-section-header":!0,"vm-top-queries-panel-header_mobile":o}),children:[e("h5",{className:I({"vm-section-header__title":!0,"vm-section-header__title_mobile":o}),children:n}),e("div",{className:"vm-section-header__tabs",children:e(Yt,{activeItem:String(s),items:pu,onChange:l})})]}),e("div",{className:I({"vm-top-queries-panel__table":!0,"vm-top-queries-panel__table_mobile":o}),children:[s===0&&e(hu,{rows:t,columns:r,defaultOrderBy:a}),s===1&&e(or,{data:t})]})]})},gu="30ms, 15s, 3d4h, 1y2w",vu=()=>{const{isMobile:t}=J(),[n,r]=Se(10,"topN"),[a,o]=Se("10m","maxLifetime"),{data:s,error:i,loading:l,fetch:c}=uu({topN:n,maxLifetime:a}),d=M(()=>{const _=a.trim().split(" ").reduce((S,T)=>{const w=es(T);return w?{...S,...w}:{...S}},{});return!!U.duration(_).asMilliseconds()},[a]),m=M(()=>!!n&&n<1,[n]),u=M(()=>m?"Number must be bigger than zero":"",[m]),h=M(()=>d?"":"Invalid duration value",[d]),p=g=>{if(!s)return g;const _=s[g];return typeof _=="number"?bt(_,_,_):_||g},v=g=>{r(+g)},b=g=>{o(g)},f=g=>{g.key==="Enter"&&c()};return A(()=>{s&&(n||r(+s.topN),a||o(s.maxLifetime))},[s]),A(()=>(c(),window.addEventListener("popstate",c),()=>{window.removeEventListener("popstate",c)}),[]),e("div",{className:I({"vm-top-queries":!0,"vm-top-queries_mobile":t}),children:[l&&e(Qe,{containerStyles:{height:"500px"}}),e("div",{className:I({"vm-top-queries-controls":!0,"vm-block":!0,"vm-block_mobile":t}),children:[e("div",{className:"vm-top-queries-controls-fields",children:[e("div",{className:"vm-top-queries-controls-fields__item",children:e(ce,{label:"Max lifetime",value:a,error:h,helperText:`For example ${gu}`,onChange:b,onKeyDown:f})}),e("div",{className:"vm-top-queries-controls-fields__item",children:e(ce,{label:"Number of returned queries",type:"number",value:n||"",error:u,onChange:v,onKeyDown:f})})]}),e("div",{className:I({"vm-top-queries-controls-bottom":!0,"vm-top-queries-controls-bottom_mobile":t}),children:[e("div",{className:"vm-top-queries-controls-bottom__info",children:["VictoriaMetrics tracks the last",e(j,{title:"search.queryStats.lastQueriesCount",children:e("b",{children:p("search.queryStats.lastQueriesCount")})}),"queries with durations at least",e(j,{title:"search.queryStats.minQueryDuration",children:e("b",{children:p("search.queryStats.minQueryDuration")})})]}),e("div",{className:"vm-top-queries-controls-bottom__button",children:e(D,{startIcon:e(nt,{}),onClick:c,children:"Execute"})})]})]}),i&&e(le,{variant:"error",children:i}),s&&e(V,{children:e("div",{className:"vm-top-queries-panels",children:[e(wr,{rows:s.topBySumDuration,title:"Queries with most summary time to execute",columns:[{key:"query"},{key:"sumDurationSeconds",title:"sum duration, sec"},{key:"timeRange",sortBy:"timeRangeSeconds",title:"query time interval"},{key:"count"}],defaultOrderBy:"sumDurationSeconds"}),e(wr,{rows:s.topByAvgDuration,title:"Most heavy queries",columns:[{key:"query"},{key:"avgDurationSeconds",title:"avg duration, sec"},{key:"timeRange",sortBy:"timeRangeSeconds",title:"query time interval"},{key:"count"}],defaultOrderBy:"avgDurationSeconds"}),e(wr,{rows:s.topByCount,title:"Most frequently executed queries",columns:[{key:"query"},{key:"timeRange",sortBy:"timeRangeSeconds",title:"query time interval"},{key:"count"}]})]})})]})},Cr={"color-primary":"#589DF6","color-secondary":"#316eca","color-error":"#e5534b","color-warning":"#c69026","color-info":"#539bf5","color-success":"#57ab5a","color-background-body":"#22272e","color-background-block":"#2d333b","color-background-tooltip":"rgba(22, 22, 22, 0.8)","color-text":"#cdd9e5","color-text-secondary":"#768390","color-text-disabled":"#636e7b","box-shadow":"rgba(0, 0, 0, 0.16) 1px 2px 6px","box-shadow-popper":"rgba(0, 0, 0, 0.2) 0px 2px 8px 0px","border-divider":"1px solid rgba(99, 110, 123, 0.5)","color-hover-black":"rgba(0, 0, 0, 0.2)","color-log-hits-bar-0":"rgba(255, 255, 255, 0.18)","color-log-hits-bar-1":"#FFB74D","color-log-hits-bar-2":"#81C784","color-log-hits-bar-3":"#64B5F6","color-log-hits-bar-4":"#E57373","color-log-hits-bar-5":"#8a62f0"},Nr={"color-primary":"#3F51B5","color-secondary":"#E91E63","color-error":"#FD080E","color-warning":"#FF8308","color-info":"#03A9F4","color-success":"#4CAF50","color-background-body":"#FEFEFF","color-background-block":"#FFFFFF","color-background-tooltip":"rgba(80,80,80,0.9)","color-text":"#110f0f","color-text-secondary":"#706F6F","color-text-disabled":"#A09F9F","box-shadow":"rgba(0, 0, 0, 0.08) 1px 2px 6px","box-shadow-popper":"rgba(0, 0, 0, 0.1) 0px 2px 8px 0px","border-divider":"1px solid rgba(0, 0, 0, 0.15)","color-hover-black":"rgba(0, 0, 0, 0.06)","color-log-hits-bar-0":"rgba(0, 0, 0, 0.18)","color-log-hits-bar-1":"#FFB74D","color-log-hits-bar-2":"#81C784","color-log-hits-bar-3":"#64B5F6","color-log-hits-bar-4":"#E57373","color-log-hits-bar-5":"#8a62f0"},fu=()=>{const[t,n]=N(Dn()),r=a=>{n(a.matches)};return A(()=>{const a=window.matchMedia("(prefers-color-scheme: dark)");return a.addEventListener("change",r),()=>a.removeEventListener("change",r)},[]),t},Sr=["primary","secondary","error","warning","info","success"],Ka=({onLoaded:t})=>{const n=Ee(),{palette:r={}}=cn(),{theme:a}=se(),o=fu(),s=xt(),i=Pt(),[l,c]=N({[Ge.dark]:Cr,[Ge.light]:Nr,[Ge.system]:Dn()?Cr:Nr}),d=()=>{const{innerWidth:v,innerHeight:b}=window,{clientWidth:f,clientHeight:g}=document.documentElement;Rt("scrollbar-width",`${v-f}px`),Rt("scrollbar-height",`${b-g}px`),Rt("vh",`${b*.01}px`)},m=()=>{Sr.forEach((v,b)=>{const f=tt(`color-${v}`),g=Dd(f);Rt(`${v}-text`,g),b===Sr.length-1&&(s({type:"SET_DARK_THEME"}),t(!0))})},u=()=>{Sr.forEach(v=>{const b=r[v];b&&Rt(`color-${v}`,b)}),m()},h=()=>{const v=Ae("THEME")||Ge.system,b=l[v];Object.entries(b).forEach(([f,g])=>{Rt(f,g)}),m(),n&&u()},p=()=>{const v=Dn()?Cr:Nr;if(l[Ge.system]===v){h();return}c(b=>({...b,[Ge.system]:v}))};return A(()=>{d(),h()},[l]),A(d,[i]),A(p,[a,o]),A(()=>{n&&s({type:"SET_THEME",payload:Ge.light})},[]),null},Li=()=>{const[t,n]=N([]),[r,a]=N(!1),o=q(document.body),s=d=>{const m=Array.from(d||[]);n(m)},i=d=>{d.preventDefault(),d.stopPropagation(),d.type==="dragenter"||d.type==="dragover"?a(!0):d.type==="dragleave"&&a(!1)},l=d=>{var m;d.preventDefault(),d.stopPropagation(),a(!1),(m=d==null?void 0:d.dataTransfer)!=null&&m.files&&d.dataTransfer.files[0]&&s(d.dataTransfer.files)},c=d=>{var h;const m=(h=d.clipboardData)==null?void 0:h.items;if(!m)return;const u=Array.from(m).filter(p=>p.type==="application/json").map(p=>p.getAsFile()).filter(p=>p!==null);n(u)};return me("dragenter",i,o),me("dragleave",i,o),me("dragover",i,o),me("drop",l,o),me("paste",c,o),{files:t,dragging:r}},Vn=({onOpenModal:t,onChange:n})=>e("div",{className:"vm-upload-json-buttons",children:[e(D,{variant:"outlined",onClick:t,children:"Paste JSON"}),e("div",{className:"vm-upload-json-buttons__upload",children:[e(D,{children:"Upload Files"}),e("input",{id:"json",name:"json",type:"file",accept:"application/json",multiple:!0,title:" ",onChange:n})]})]}),_u=()=>{const[t,n]=N([]),[r,a]=N([]),o=M(()=>!!t.length,[t]),{value:s,setTrue:i,setFalse:l}=ae(!1),c=(g,_="")=>{a(y=>[{filename:_,text:`: ${g.message}`},...y])},d=(g,_)=>{try{const y=JSON.parse(g),S=y.trace||y;if(!S.duration_msec){c(new Error(Ce.traceNotFound),_);return}const T=new At(S,_);n(w=>[T,...w])}catch(y){y instanceof Error&&c(y,_)}},m=g=>{g.map(_=>{const y=new FileReader,S=(_==null?void 0:_.name)||"";y.onload=T=>{var C;const w=String((C=T.target)==null?void 0:C.result);d(w,S)},y.readAsText(_)})},u=g=>{if(!g.target)return;const _=g.target;a([]);const y=Array.from(_.files||[]);m(y),_.value=""},h=g=>{const _=t.filter(y=>y.idValue!==g.idValue);n([..._])},p=g=>{a(_=>_.filter((y,S)=>S!==g))},v=g=>()=>{p(g)},{files:b,dragging:f}=Li();return A(()=>{m(b)},[b]),e("div",{className:"vm-trace-page",children:[e("div",{className:"vm-trace-page-header",children:[e("div",{className:"vm-trace-page-header-errors",children:r.map((g,_)=>e("div",{className:"vm-trace-page-header-errors-item",children:[e(le,{variant:"error",children:[e("b",{className:"vm-trace-page-header-errors-item__filename",children:g.filename}),e("span",{children:g.text})]}),e(D,{className:"vm-trace-page-header-errors-item__close",startIcon:e(Ue,{}),variant:"text",color:"error",onClick:v(_)})]},`${g}_${_}`))}),e("div",{children:o&&e(Vn,{onOpenModal:i,onChange:u})})]}),o&&e("div",{children:e(Da,{jsonEditor:!0,traces:t,onDeleteClick:h})}),!o&&e("div",{className:"vm-trace-page-preview",children:[e("p",{className:"vm-trace-page-preview__text",children:["Please, upload file with JSON response content.",`
`,"The file must contain tracing information in JSON format.",`
`,"In order to use tracing please refer to the doc:",e("a",{className:"vm-link vm-link_colored",href:"https://docs.victoriametrics.com/victoriametrics/single-server-victoriametrics/#query-tracing",target:"_blank",rel:"help noreferrer",children:"https://docs.victoriametrics.com/victoriametrics/single-server-victoriametrics/#query-tracing"}),`
`,"Tracing graph will be displayed after file upload.",`
`,"Attach files by dragging & dropping, selecting or pasting them."]}),e(Vn,{onOpenModal:i,onChange:u})]}),s&&e(Me,{title:"Paste JSON",onClose:l,children:e(Zs,{editable:!0,displayTitle:!0,defaultTile:`JSON ${t.length+1}`,onClose:l,onUpload:d})}),f&&e("div",{className:"vm-trace-page__dropzone"})]})},bu=({job:t,instance:n,metrics:r,size:a})=>{const{duration:o,relativeTime:s,period:{date:i}}=ge(),{customStep:l}=He(),{setSearchParamsFromKeys:c}=rt(),d=()=>{const m=Ti({"g0.range_input":o,"g0.end_input":i,"g0.step_input":l,"g0.relative_time":s,size:a,job:t,instance:n,metrics:r});c(m)};A(d,[o,s,i,l,t,n,r,a]),A(d,[])},yu=(t,n)=>`${t}/api/v1/label/job/values?start=${n.start}&end=${n.end}`,wu=(t,n,r)=>{const a=`{job=${JSON.stringify(r)}}`;return`${t}/api/v1/label/instance/values?match[]=${encodeURIComponent(a)}&start=${n.start}&end=${n.end}`},Cu=(t,n,r,a)=>{const s=`{${Object.entries({job:r,instance:a}).filter(i=>i[1]).map(([i,l])=>`${i}=${JSON.stringify(l)}`).join(",")}}`;return`${t}/api/v1/label/__name__/values?match[]=${encodeURIComponent(s)}&start=${n.start}&end=${n.end}`},Nu=()=>{const{serverUrl:t}=se(),{period:n}=ge(),[r,a]=N([]),[o,s]=N(!1),[i,l]=N(),c=M(()=>yu(t,n),[t,n]);return A(()=>{(async()=>{s(!0);try{const m=await fetch(c),u=await m.json(),h=u.data||[];a(h.sort((p,v)=>p.localeCompare(v))),m.ok?l(void 0):l(`${u.errorType}\r
${u==null?void 0:u.error}`)}catch(m){m instanceof Error&&l(`${m.name}: ${m.message}`)}s(!1)})().catch(console.error)},[c]),{jobs:r,isLoading:o,error:i}},Su=t=>{const{serverUrl:n}=se(),{period:r}=ge(),[a,o]=N([]),[s,i]=N(!1),[l,c]=N(),d=M(()=>wu(n,r,t),[n,r,t]);return A(()=>{if(!t)return;(async()=>{i(!0);try{const u=await fetch(d),h=await u.json(),p=h.data||[];o(p.sort((v,b)=>v.localeCompare(b))),u.ok?c(void 0):c(`${h.errorType}\r
${h==null?void 0:h.error}`)}catch(u){u instanceof Error&&c(`${u.name}: ${u.message}`)}i(!1)})().catch(console.error)},[d]),{instances:a,isLoading:s,error:l}},ku=(t,n)=>{const{serverUrl:r}=se(),{period:a}=ge(),[o,s]=N([]),[i,l]=N(!1),[c,d]=N(),m=M(()=>Cu(r,a,t,n),[r,a,t,n]);return A(()=>{if(!t)return;(async()=>{l(!0);try{const h=await fetch(m),p=await h.json(),v=p.data||[];s(v.sort((b,f)=>b.localeCompare(f))),h.ok?d(void 0):d(`${p.errorType}\r
${p==null?void 0:p.error}`)}catch(h){h instanceof Error&&d(`${h.name}: ${h.message}`)}l(!1)})().catch(console.error)},[m]),{names:o,isLoading:i,error:c}},Tu=({name:t,job:n,instance:r,rateEnabled:a,isBucket:o,height:s})=>{const{isMobile:i}=J(),{customStep:l,yaxis:c}=He(),{period:d}=ge(),m=vt(),u=Be(),h=mn(d.end-d.start),p=Zr(l),v=Qn(p*10*1e3),[b,f]=N(!1),[g,_]=N(!1),y=b&&l===h?v:l,S=M(()=>{const F=Object.entries({job:n,instance:r}).filter(z=>z[1]).map(([z,Y])=>`${z}=${JSON.stringify(Y)}`);F.push(`__name__=${JSON.stringify(t)}`),t=="node_cpu_seconds_total"&&F.push('mode!="idle"');const O=`{${F.join(",")}}`;return o?`sum(rate(${O})) by (vmrange, le)`:`
with (q = ${a?`rollup_rate(${O})`:`rollup(${O})`}) (
  alias(min(label_match(q, "rollup", "min")), "min"),
  alias(max(label_match(q, "rollup", "max")), "max"),
  alias(avg(label_match(q, "rollup", "avg")), "avg"),
)`},[t,n,r,a,o]),{isLoading:T,graphData:w,error:C,queryErrors:k,warning:L,isHistogram:x}=Xn({predefinedQuery:[S],visible:!0,customStep:y,showAllSeries:g}),E=F=>{m({type:"SET_YAXIS_LIMITS",payload:F})},P=({from:F,to:O})=>{u({type:"SET_PERIOD",payload:{from:F,to:O}})};return A(()=>{f(x)},[x]),e("div",{className:I({"vm-explore-metrics-graph":!0,"vm-explore-metrics-graph_mobile":i}),children:[T&&e(Qe,{}),C&&e(le,{variant:"error",children:C}),k[0]&&e(le,{variant:"error",children:k[0]}),L&&e(tr,{warning:L,query:[S],onChange:_}),w&&d&&e(ar,{data:w,period:d,customStep:y,query:[S],yaxis:c,setYaxisLimits:E,setPeriod:P,showLegend:!1,height:s,isHistogram:x})]})},Lu=({name:t,index:n,length:r,isBucket:a,rateEnabled:o,onChangeRate:s,onRemoveItem:i,onChangeOrder:l})=>{const{isMobile:c}=J(),{value:d,setTrue:m,setFalse:u}=ae(!1),h=()=>{i(t)},p=()=>{l(t,n,n+1)},v=()=>{l(t,n,n-1)};return c?e("div",{className:"vm-explore-metrics-item-header vm-explore-metrics-item-header_mobile",children:[e("div",{className:"vm-explore-metrics-item-header__name",children:t}),e(D,{variant:"text",size:"small",startIcon:e(ca,{}),onClick:m,ariaLabel:"open panel settings"}),d&&e(Me,{title:t,onClose:u,children:e("div",{className:"vm-explore-metrics-item-header-modal",children:[e("div",{className:"vm-explore-metrics-item-header-modal-order",children:[e(D,{startIcon:e(gs,{}),variant:"outlined",onClick:v,disabled:n===0,ariaLabel:"move graph up"}),e("p",{children:["position:",e("span",{className:"vm-explore-metrics-item-header-modal-order__index",children:["#",n+1]})]}),e(D,{endIcon:e(oa,{}),variant:"outlined",onClick:p,disabled:n===r-1,ariaLabel:"move graph down"})]}),!a&&e("div",{className:"vm-explore-metrics-item-header-modal__rate",children:[e(_e,{label:e("span",{children:["enable ",e("code",{children:"rate()"})]}),value:o,onChange:s,fullWidth:!0}),e("p",{children:"calculates the average per-second speed of metrics change"})]}),e(D,{startIcon:e(Ue,{}),color:"error",variant:"outlined",onClick:h,fullWidth:!0,children:"Remove graph"})]})})]}):e("div",{className:"vm-explore-metrics-item-header",children:[e("div",{className:"vm-explore-metrics-item-header-order",children:[e(j,{title:"move graph up",children:e(D,{className:"vm-explore-metrics-item-header-order__up",startIcon:e(be,{}),variant:"text",color:"gray",size:"small",onClick:v,ariaLabel:"move graph up"})}),e("div",{className:"vm-explore-metrics-item-header__index",children:["#",n+1]}),e(j,{title:"move graph down",children:e(D,{className:"vm-explore-metrics-item-header-order__down",startIcon:e(be,{}),variant:"text",color:"gray",size:"small",onClick:p,ariaLabel:"move graph down"})})]}),e("div",{className:"vm-explore-metrics-item-header__name",children:t}),!a&&e("div",{className:"vm-explore-metrics-item-header__rate",children:e(j,{title:"calculates the average per-second speed of metric's change",children:e(_e,{label:e("span",{children:["enable ",e("code",{children:"rate()"})]}),value:o,onChange:s})})}),e("div",{className:"vm-explore-metrics-item-header__close",children:e(j,{title:"close graph",children:e(D,{startIcon:e(Ue,{}),variant:"text",color:"gray",size:"small",onClick:h,ariaLabel:"close graph"})})})]})},Au=({name:t,job:n,instance:r,index:a,length:o,size:s,onRemoveItem:i,onChangeOrder:l})=>{const c=M(()=>/_sum?|_total?|_count?/.test(t),[t]),d=M(()=>/_bucket?/.test(t),[t]),[m,u]=N(c),h=Pt(),p=M(s.height,[s,h]);return A(()=>{u(c)},[n]),e("div",{className:"vm-explore-metrics-item vm-block vm-block_empty-padding",children:[e(Lu,{name:t,index:a,length:o,isBucket:d,rateEnabled:m,size:s.id,onChangeRate:u,onRemoveItem:i,onChangeOrder:l}),e(Tu,{name:t,job:n,instance:r,rateEnabled:m,isBucket:d,height:p},`${t}_${n}_${r}_${m}`)]})},Eu=Pn.map(t=>t.id),xu=({jobs:t,instances:n,names:r,job:a,instance:o,size:s,selectedMetrics:i,onChangeJob:l,onChangeInstance:c,onToggleMetric:d,onChangeSize:m})=>{const u=M(()=>a?"":"No instances. Please select job",[a]),h=M(()=>a?"":"No metric names. Please select job",[a]),{isMobile:p}=J(),{value:v,toggle:b,setFalse:f}=ae(Ae("EXPLORE_METRICS_TIPS")!=="false");return A(()=>{Le("EXPLORE_METRICS_TIPS",`${v}`)},[v]),e(V,{children:[e("div",{className:I({"vm-explore-metrics-header":!0,"vm-explore-metrics-header_mobile":p,"vm-block":!0,"vm-block_mobile":p}),children:[e("div",{className:"vm-explore-metrics-header__job",children:e(it,{value:a,list:t,label:"Job",placeholder:"Please select job",onChange:l,autofocus:!a&&!!t.length&&!p,searchable:!0})}),e("div",{className:"vm-explore-metrics-header__instance",children:e(it,{value:o,list:n,label:"Instance",placeholder:"Please select instance",onChange:c,noOptionsText:u,clearable:!0,searchable:!0})}),e("div",{className:"vm-explore-metrics-header__size",children:[e(it,{label:"Size graphs",value:s,list:Eu,onChange:m}),e(j,{title:`${v?"Hide":"Show"} tip`,children:e(D,{variant:"text",color:v?"warning":"gray",startIcon:e(vn,{}),onClick:b,ariaLabel:"visibility tips"})})]}),e("div",{className:"vm-explore-metrics-header-metrics",children:e(it,{label:"Metrics",value:i,list:r,placeholder:"Search metric name",onChange:d,noOptionsText:h,clearable:!0,searchable:!0})})]}),v&&e(le,{variant:"warning",children:e("div",{className:"vm-explore-metrics-header-description",children:[e("p",{children:["Please note: this page is solely designed for exploring Prometheus metrics. Prometheus metrics always contain ",e("code",{children:"job"})," and ",e("code",{children:"instance"})," labels (see ",e("a",{className:"vm-link vm-link_colored",href:"https://prometheus.io/docs/concepts/jobs_instances/",children:"these docs"}),"), and this page relies on them as filters. ",e("br",{}),"Please use this page for Prometheus metrics only, in accordance with their naming conventions."]}),e(D,{variant:"text",size:"small",startIcon:e(Ue,{}),onClick:f,ariaLabel:"close tips"})]})})]})},Mu=ze("job",""),Iu=ze("instance",""),ko=ze("metrics",""),To=ze("size",""),Pu=Pn.find(t=>To?t.id===To:t.isDefault)||Pn[0],Du=()=>{const[t,n]=N(Mu),[r,a]=N(Iu),[o,s]=N(ko?ko.split("&"):[]),[i,l]=N(Pu);bu({job:t,instance:r,metrics:o.join("&"),size:i.id});const{jobs:c,isLoading:d,error:m}=Nu(),{instances:u,isLoading:h,error:p}=Su(t),{names:v,isLoading:b,error:f}=ku(t,r),g=M(()=>d||h||b,[d,h,b]),_=M(()=>m||p||f,[m,p,f]),y=w=>{s(w?C=>C.includes(w)?C.filter(k=>k!==w):[...C,w]:[])},S=w=>{const C=Pn.find(k=>k.id===w);C&&l(C)},T=(w,C,k)=>{const L=k>o.length-1;k<0||L||s(E=>{const P=[...E],[F]=P.splice(C,1);return P.splice(k,0,F),P})};return A(()=>{r&&u.length&&!u.includes(r)&&a("")},[u,r]),e("div",{className:"vm-explore-metrics",children:[e(xu,{jobs:c,instances:u,names:v,job:t,size:i.id,instance:r,selectedMetrics:o,onChangeJob:n,onChangeSize:S,onChangeInstance:a,onToggleMetric:y}),g&&e(Qe,{}),_&&e(le,{variant:"error",children:_}),!t&&e(le,{variant:"info",children:"Please select job to see list of metric names."}),t&&!o.length&&e(le,{variant:"info",children:"Please select metric names to see the graphs."}),e("div",{className:"vm-explore-metrics-body",children:o.map((w,C)=>e(Au,{name:w,job:t,instance:r,index:C,length:o.length,size:i,onRemoveItem:y,onChangeOrder:T},w))})]})},Ou=()=>{const t=Fe(),n=r=>async()=>{await t(`<${r}/>`,`<${r}/> has been copied`)};return e("div",{className:"vm-preview-icons",children:Object.entries(Il).map(([r,a])=>e("div",{className:"vm-preview-icons-item",onClick:n(r),children:[e("div",{className:"vm-preview-icons-item__svg",children:a()}),e("div",{className:"vm-preview-icons-item__name",children:`<${r}/>`})]},r))})},ot=({code:t})=>{const n=Fe(),[r,a]=N("Copy"),o=async()=>{await n(t),a("Copied")};return A(()=>{let s=null;return r==="Copied"&&(s=setTimeout(()=>a("Copy"),1e3)),()=>{s&&clearTimeout(s)}},[r]),e("code",{className:"vm-code-example",children:[t,e("div",{className:"vm-code-example__copy",children:e(j,{title:r,children:e(D,{size:"small",variant:"text",onClick:o,startIcon:e(Xe,{}),ariaLabel:"close"})})})]})},Ru=()=>e("a",{className:"vm-link vm-link_colored",href:"https://docs.victoriametrics.com/victoriametrics/metricsql/",target:"_blank",rel:"help noreferrer",children:"MetricsQL"}),Lo=()=>e("a",{className:"vm-link vm-link_colored",href:"https://grafana.com/grafana/dashboards/1860",target:"_blank",rel:"help noreferrer",children:"Node Exporter Full"}),$u=()=>e("section",{className:"vm-with-template-tutorial",children:[e("h2",{className:"vm-with-template-tutorial__title",children:["Tutorial for WITH expressions in ",e(Ru,{})]}),e("div",{className:"vm-with-template-tutorial-section",children:[e("p",{className:"vm-with-template-tutorial-section__text",children:["Let's look at the following real query from ",e(Lo,{})," dashboard:"]}),e(ot,{code:`(
  (
    node_memory_MemTotal_bytes{instance=~"$node:$port", job=~"$job"}
      -
    node_memory_MemFree_bytes{instance=~"$node:$port", job=~"$job"}
  )
    /
  node_memory_MemTotal_bytes{instance=~"$node:$port", job=~"$job"}
) * 100`}),e("p",{className:"vm-with-template-tutorial-section__text",children:"It is clear the query calculates the percentage of used memory for the given $node, $port and $job. Isn't it? :)"})]}),e("div",{className:"vm-with-template-tutorial-section",children:[e("p",{className:"vm-with-template-tutorial-section__text",children:"What's wrong with this query? Copy-pasted label filters for distinct timeseries which makes it easy to mistype these filters during modification. Let's simplify the query with WITH expressions:"}),e(ot,{code:`WITH (
    commonFilters = {instance=~"$node:$port",job=~"$job"}
)
(
  node_memory_MemTotal_bytes{commonFilters}
    -
  node_memory_MemFree_bytes{commonFilters}
)
  /
node_memory_MemTotal_bytes{commonFilters} * 100`})]}),e("div",{className:"vm-with-template-tutorial-section",children:[e("p",{className:"vm-with-template-tutorial-section__text",children:["Now label filters are located in a single place instead of three distinct places. The query mentions node_memory_MemTotal_bytes metric twice and ","{commonFilters}"," three times. WITH expressions may improve this:"]}),e(ot,{code:`WITH (
    my_resource_utilization(free, limit, filters) = (limit{filters} - free{filters}) / limit{filters} * 100
)
my_resource_utilization(
  node_memory_MemFree_bytes,
  node_memory_MemTotal_bytes,
  {instance=~"$node:$port",job=~"$job"},
)`}),e("p",{className:"vm-with-template-tutorial-section__text",children:"Now the template function my_resource_utilization() may be used for monitoring arbitrary resources - memory, CPU, network, storage, you name it."})]}),e("div",{className:"vm-with-template-tutorial-section",children:[e("p",{className:"vm-with-template-tutorial-section__text",children:["Let's take another nice query from ",e(Lo,{})," dashboard:"]}),e(ot,{code:`(
  (
    (
      count(
        count(node_cpu_seconds_total{instance=~"$node:$port",job=~"$job"}) by (cpu)
      )
    )
      -
    avg(
      sum by (mode) (rate(node_cpu_seconds_total{mode='idle',instance=~"$node:$port",job=~"$job"}[5m]))
    )
  )
    *
  100
)
  /
count(
  count(node_cpu_seconds_total{instance=~"$node:$port",job=~"$job"}) by (cpu)
)`}),e("p",{className:"vm-with-template-tutorial-section__text",children:"Do you understand what does this mess do? Is it manageable? :) WITH expressions are happy to help in a few iterations."})]}),e("div",{className:"vm-with-template-tutorial-section",children:[e("p",{className:"vm-with-template-tutorial-section__text",children:"1. Extract common filters used in multiple places into a commonFilters variable:"}),e(ot,{code:`WITH (
    commonFilters = {instance=~"$node:$port",job=~"$job"}
)
(
  (
    (
      count(
        count(node_cpu_seconds_total{commonFilters}) by (cpu)
      )
    )
      -
    avg(
      sum by (mode) (rate(node_cpu_seconds_total{mode='idle',commonFilters}[5m]))
    )
  )
    *
  100
)
  /
count(
  count(node_cpu_seconds_total{commonFilters}) by (cpu)
)`})]}),e("div",{className:"vm-with-template-tutorial-section",children:[e("p",{className:"vm-with-template-tutorial-section__text",children:'2. Extract "count(count(...) by (cpu))" into cpuCount variable:'}),e(ot,{code:`WITH (
    commonFilters = {instance=~"$node:$port",job=~"$job"},
    cpuCount = count(count(node_cpu_seconds_total{commonFilters}) by (cpu))
)
(
  (
    cpuCount
      -
    avg(
      sum by (mode) (rate(node_cpu_seconds_total{mode='idle',commonFilters}[5m]))
    )
  )
    *
  100
) / cpuCount`})]}),e("div",{className:"vm-with-template-tutorial-section",children:[e("p",{className:"vm-with-template-tutorial-section__text",children:"3. Extract rate(...) part into cpuIdle variable, since it is clear now that this part calculates the number of idle CPUs:"}),e(ot,{code:`WITH (
    commonFilters = {instance=~"$node:$port",job=~"$job"},
    cpuCount = count(count(node_cpu_seconds_total{commonFilters}) by (cpu)),
    cpuIdle = sum(rate(node_cpu_seconds_total{mode='idle',commonFilters}[5m]))
)
((cpuCount - cpuIdle) * 100) / cpuCount`})]}),e("div",{className:"vm-with-template-tutorial-section",children:[e("p",{className:"vm-with-template-tutorial-section__text",children:["4. Put node_cpu_seconds_total","{commonFilters}"," into its own variable with the name cpuSeconds:"]}),e(ot,{code:`WITH (
    cpuSeconds = node_cpu_seconds_total{instance=~"$node:$port",job=~"$job"},
    cpuCount = count(count(cpuSeconds) by (cpu)),
    cpuIdle = sum(rate(cpuSeconds{mode='idle'}[5m]))
)
((cpuCount - cpuIdle) * 100) / cpuCount`}),e("p",{className:"vm-with-template-tutorial-section__text",children:"Now the query became more clear comparing to the initial query."})]}),e("div",{className:"vm-with-template-tutorial-section",children:[e("p",{className:"vm-with-template-tutorial-section__text",children:"WITH expressions may be nested and may be put anywhere. Try expanding the following query:"}),e(ot,{code:`WITH (
    f(a, b) = WITH (
        f1(x) = b-x,
        f2(x) = x+x
    ) f1(a)*f2(b)
) f(foo, with(x=bar) x)`})]})]}),Fu=(t,n)=>`${t}/expand-with-exprs?query=${encodeURIComponent(n)}&format=json`,zu=()=>{const{serverUrl:t}=se(),[n,r]=oe(),[a,o]=N(""),[s,i]=N(!1),[l,c]=N();return{data:a,error:l,loading:s,expand:async m=>{n.set("expr",m),r(n);const u=Fu(t,m);i(!0);try{const p=await(await fetch(u)).json();o((p==null?void 0:p.expr)||""),c(String(p.error||""))}catch(h){h instanceof Error&&h.name!=="AbortError"&&c(`${h.name}: ${h.message}`)}i(!1)}}},Hu=()=>{const[t]=oe(),{data:n,loading:r,error:a,expand:o}=zu(),[s,i]=N(t.get("expr")||""),l=d=>{i(d)},c=()=>{o(s)};return A(()=>{s&&o(s)},[]),e("section",{className:"vm-with-template",children:[r&&e(Qe,{}),e("div",{className:"vm-with-template-body vm-block",children:[e("div",{className:"vm-with-template-body__expr",children:e(ce,{type:"textarea",label:"MetricsQL query with optional WITH expressions",value:s,error:a,autofocus:!0,onEnter:c,onChange:l})}),e("div",{className:"vm-with-template-body__result",children:e(ce,{type:"textarea",label:"MetricsQL query after expanding WITH expressions and applying other optimizations",value:n,disabled:!0})}),e("div",{className:"vm-with-template-body-top",children:e(D,{variant:"contained",onClick:c,startIcon:e(nt,{}),children:"Expand"})})]}),e("div",{className:"vm-block",children:e($u,{})})]})},Vu=(t,n,r)=>{const a=["format=json",`relabel_configs=${encodeURIComponent(n)}`,`metric=${encodeURIComponent(r)}`];return`${t}/metric-relabel-debug?${a.join("&")}`},qu=()=>{const{serverUrl:t}=se(),[n,r]=N(null),[a,o]=N(!1),[s,i]=N();return{data:n,error:s,loading:a,fetchData:async(c,d)=>{const m=Vu(t,c,d);o(!0);try{const h=await(await fetch(m)).json();r(h.error?null:h),i(String(h.error||""))}catch(u){u instanceof Error&&u.name!=="AbortError"&&i(`${u.name}: ${u.message}`)}o(!1)}}},Uu={config:`- if: '{bar_label=~"b.*"}'
  source_labels: [foo_label, bar_label]
  separator: "_"
  target_label: foobar
- action: labeldrop
  regex: "foo_.*"
- target_label: job
  replacement: "my-application-2"`,labels:'{__name__="my_metric", bar_label="bar", foo_label="foo", job="my-application", instance="192.168.0.1"}'},Bu=()=>{const[t,n]=oe(),{data:r,loading:a,error:o,fetchData:s}=qu(),[i,l]=Se("","config"),[c,d]=Se("","labels"),m=v=>{l(v||"")},u=v=>{d(v||"")},h=W(()=>{s(i,c),t.set("config",i),t.set("labels",c),n(t)},[i,c]),p=()=>{const{config:v,labels:b}=Uu;l(v),d(b),s(v,b),t.set("config",v),t.set("labels",b),n(t)};return A(()=>{const v=t.get("config")||"",b=t.get("labels")||"";(b||v)&&(s(v,b),l(v),d(b))},[]),e("section",{className:"vm-relabeling",children:[a&&e(Qe,{}),e("div",{className:"vm-relabeling-header vm-block",children:[e("div",{className:"vm-relabeling-header-configs",children:e(ce,{type:"textarea",label:"Relabel configs",value:i,autofocus:!0,onChange:m,onEnter:h})}),e("div",{className:"vm-relabeling-header__labels",children:e(ce,{type:"textarea",label:"Labels",value:c,onChange:u,onEnter:h})}),e("div",{className:"vm-relabeling-header-bottom",children:[e("a",{className:"vm-link vm-link_with-icon",target:"_blank",href:"https://docs.victoriametrics.com/victoriametrics/relabeling/",rel:"help noreferrer",children:[e(mt,{}),"Relabeling cookbook"]}),e("a",{className:"vm-link vm-link_with-icon",target:"_blank",href:"https://docs.victoriametrics.com/victoriametrics/relabeling/",rel:"help noreferrer",children:[e(ut,{}),"Documentation"]}),e(D,{variant:"text",onClick:p,children:"Try example"}),e(D,{variant:"contained",onClick:h,startIcon:e(nt,{}),children:"Submit"})]})]}),o&&e(le,{variant:"error",children:o}),r&&e("div",{className:"vm-relabeling-steps vm-block",children:[r.originalLabels&&e("div",{className:"vm-relabeling-steps-item",children:e("div",{className:"vm-relabeling-steps-item__row",children:[e("span",{children:"Original labels:"}),e("code",{dangerouslySetInnerHTML:{__html:r.originalLabels}})]})}),r.steps.map((v,b)=>{var f,g;return e("div",{className:"vm-relabeling-steps-item",children:[e("div",{className:"vm-relabeling-steps-item__row",children:[e("span",{children:"Step:"}),b+1]}),e("div",{className:"vm-relabeling-steps-item__row",children:[e("span",{children:"Relabeling Rule:"}),e("code",{children:e("pre",{children:v.rule})})]}),e("div",{className:"vm-relabeling-steps-item__row",children:[e("span",{children:"Input Labels:"}),e("code",{children:e("pre",{dangerouslySetInnerHTML:{__html:((f=v.errors)==null?void 0:f.inLabels)||v.inLabels}})})]}),e("div",{className:"vm-relabeling-steps-item__row",children:[e("span",{children:"Output labels:"}),e("code",{children:e("pre",{dangerouslySetInnerHTML:{__html:((g=v.errors)==null?void 0:g.outLabels)||v.outLabels}})})]})]},b)}),r.resultingLabels&&e("div",{className:"vm-relabeling-steps-item",children:e("div",{className:"vm-relabeling-steps-item__row",children:[e("span",{children:"Resulting labels:"}),e("code",{dangerouslySetInnerHTML:{__html:r.resultingLabels}})]})})]})]})},ju=t=>`${t}/api/v1/status/active_queries`,Qu=()=>{const{serverUrl:t}=se(),[n,r]=N([]),[a,o]=N(U().format(On)),[s,i]=N(!1),[l,c]=N(),d=M(()=>ju(t),[t]),m=async()=>{i(!0);try{const u=await fetch(d),h=await u.json();r(h.data),o(U().format("HH:mm:ss:SSS")),u.ok?c(void 0):c(`${h.errorType}\r
${h==null?void 0:h.error}`)}catch(u){u instanceof Error&&c(`${u.name}: ${u.message}`)}i(!1)};return A(()=>{m().catch(console.error)},[d]),{data:n,lastUpdated:a,isLoading:s,error:l,fetchData:m}},Ai=({rows:t,columns:n,defaultOrderBy:r,defaultOrderDir:a,copyToClipboard:o,paginationOffset:s})=>{const i=Fe(),[l,c]=N(r),[d,m]=N(a||"desc"),[u,h]=N(null),p=M(()=>{const{startIndex:f,endIndex:g}=s;return Ja(t,Wa(d,l)).slice(f,g)},[t,l,d,s]),v=f=>()=>{m(g=>g==="asc"&&l===f?"desc":"asc"),c(f)},b=(f,g)=>async()=>{if(u!==g)try{await i(String(f)),h(g)}catch(_){console.error(_)}};return A(()=>{if(u===null)return;const f=setTimeout(()=>h(null),2e3);return()=>clearTimeout(f)},[u]),e("table",{className:"vm-table",children:[e("thead",{className:"vm-table-header",children:e("tr",{className:"vm-table__row vm-table__row_header",children:[n.map(f=>e("th",{className:"vm-table-cell vm-table-cell_header vm-table-cell_sort",onClick:v(f.key),children:e("div",{className:"vm-table-cell__content",children:[e("div",{children:String(f.title||f.key)}),e("div",{className:I({"vm-table__sort-icon":!0,"vm-table__sort-icon_active":l===f.key,"vm-table__sort-icon_desc":d==="desc"&&l===f.key}),children:e(Je,{})})]})},String(f.key))),o&&e("th",{className:"vm-table-cell vm-table-cell_header"})]})}),e("tbody",{className:"vm-table-body",children:p.map((f,g)=>e("tr",{className:"vm-table__row",children:[n.map(_=>e("td",{className:I({"vm-table-cell":!0,[`${_.className}`]:_.className}),children:f[_.key]||"-"},String(_.key))),o&&e("td",{className:"vm-table-cell vm-table-cell_right",children:f[o]&&e("div",{className:"vm-table-cell__content",children:e(j,{title:u===g?"Copied":"Copy row",children:e(D,{variant:"text",color:u===g?"success":"gray",size:"small",startIcon:u===g?e(Wn,{}):e(Xe,{}),onClick:b(f[o],g),ariaLabel:"copy row"})})})})]},g))})]})},Yu=()=>{const{isMobile:t}=J(),{timezone:n}=ge(),{data:r,lastUpdated:a,isLoading:o,error:s,fetchData:i}=Qu(),l=M(()=>r.map(m=>{const u=U(m.start).tz().format(qe),h=U(m.end).tz().format(qe);return{duration:m.duration,remote_addr:m.remote_addr,query:m.query,args:`${u} to ${h}, step=${Er(m.step)}`,data:JSON.stringify(m,null,2)}}),[r,n]),c=M(()=>{if(!(l!=null&&l.length))return[];const m=Object.keys(l[0]),u={remote_addr:"client address"},h=["data"];return m.filter(p=>!h.includes(p)).map(p=>({key:p,title:u[p]||p}))},[l]),d=async()=>{i().catch(console.error)};return e("div",{className:"vm-active-queries",children:[o&&e(Qe,{}),e("div",{className:"vm-active-queries-header",children:[!l.length&&!s&&e(le,{variant:"info",children:"There are currently no active queries running"}),s&&e(le,{variant:"error",children:s}),e("div",{className:"vm-active-queries-header-controls",children:[e(D,{variant:"contained",onClick:d,startIcon:e(Gn,{}),children:"Update"}),e("div",{className:"vm-active-queries-header__update-msg",children:["Last updated: ",a]})]})]}),!!l.length&&e("div",{className:I({"vm-block":!0,"vm-block_mobile":t}),children:e(Ai,{rows:l,columns:c,defaultOrderBy:"duration",copyToClipboard:"data",paginationOffset:{startIndex:0,endIndex:1/0}})})]})},Gu=({onClose:t,onUpload:n})=>{const{isMobile:r}=J(),[a,o]=N(""),[s,i]=N(""),l=M(()=>{try{return JSON.parse(a),""}catch(m){return m instanceof Error?m.message:"Unknown error"}},[a]),c=m=>{i(""),o(m)},d=()=>{i(l),!l&&(n(a),t())};return e("div",{className:I({"vm-json-form vm-json-form_one-field":!0,"vm-json-form_mobile vm-json-form_one-field_mobile":r}),children:[e(ce,{value:a,label:"JSON",type:"textarea",error:s,autofocus:!0,onChange:c,onEnter:d}),e("div",{className:"vm-json-form-footer",children:e("div",{className:"vm-json-form-footer__controls vm-json-form-footer__controls_right",children:[e(D,{variant:"outlined",color:"error",onClick:t,children:"Cancel"}),e(D,{variant:"contained",onClick:d,children:"apply"})]})})]})},Wu=({data:t,period:n})=>{const{isMobile:r}=J(),[a,o]=oe(),{tableCompact:s}=je(),i=Gt(),[l,c]=N([]),[d,m]=N(),[u,h]=N(),[p,v]=N(!1),[b,f]=N([]),[g,_]=N(),y=M(()=>Ya(u||[]).map(z=>z.key),[u]),S=M(()=>{const z=t.some(G=>G.data.resultType==="matrix");return t.some(G=>G.data.resultType==="vector")&&z?zt:z?zt.filter(G=>G.value==="chart"):zt.filter(G=>G.value!=="chart")},[t]),[T,w]=N(S[0].value),{yaxis:C,spanGaps:k}=He(),L=vt(),x=z=>{L({type:"SET_YAXIS_LIMITS",payload:z})},E=()=>{L({type:"TOGGLE_ENABLE_YAXIS_LIMITS"})},P=z=>{L({type:"SET_SPAN_GAPS",payload:z})},F=z=>{w(z)},O=z=>{c(Y=>Y.filter(G=>G.idValue!==z.idValue))},H=()=>{i({type:"TOGGLE_TABLE_COMPACT"})};return A(()=>{const z=T==="chart"?"matrix":"vector",Y=t.filter(G=>G.data.resultType===z&&G.trace).map(G=>{var K,re;return G.trace?new At(G.trace,((re=(K=G==null?void 0:G.vmui)==null?void 0:K.params)==null?void 0:re.query)||"Query"):null});c(Y.filter(Boolean))},[t,T]),A(()=>{const z=[],Y=[],G=[];t.forEach((K,re)=>{var ie,X;const Q=K.data.result.map(R=>{var $,B;return{...R,group:Number(((B=($=K.vmui)==null?void 0:$.params)==null?void 0:B.id)??re)+1}});K.data.resultType==="matrix"?(Y.push(...Q),z.push(((X=(ie=K.vmui)==null?void 0:ie.params)==null?void 0:X.query)||"Query")):G.push(...Q)}),f(z),m(Y),h(G),a.delete("display_mode"),o(a)},[t]),A(()=>{const z=!a.get("display_mode");v(!!d&&z&&Ma(d))},[d,a]),e("div",{className:I({"vm-query-analyzer-view":!0,"vm-query-analyzer-view_mobile":r}),children:[!!l.length&&e(Da,{traces:l,onDeleteClick:O}),e(Si,{}),e("div",{className:I({"vm-block":!0,"vm-block_mobile":r}),children:[e("div",{className:"vm-custom-panel-body-header",children:[e("div",{className:"vm-custom-panel-body-header__tabs",children:e(Yt,{activeItem:T,items:S,onChange:F})}),e("div",{className:"vm-custom-panel-body-header__graph-controls",children:[T==="chart"&&e(Ca,{}),T==="chart"&&e(Qa,{data:d||[],yaxis:C,isHistogram:p,setYaxisLimits:x,toggleEnableLimits:E,spanGaps:{value:k,onChange:P}}),T==="table"&&e(Ga,{columns:y,selectedColumns:g,onChangeColumns:_,tableCompact:s,toggleTableCompact:H})]})]}),d&&n&&T==="chart"&&e(ar,{data:d,period:n,customStep:n.step||"1s",query:b,yaxis:C,setYaxisLimits:x,setPeriod:()=>null,height:r?window.innerHeight*.5:500,isHistogram:p,spanGaps:k}),u&&T==="code"&&e(or,{data:u}),u&&T==="table"&&e(bi,{data:u,displayColumns:g})]})]})},Ju=({data:t,period:n})=>{var m,u,h,p,v;const r=M(()=>t.filter(b=>b.vmui||b.stats),[t]),a=((u=(m=r.find(b=>{var f;return(f=b==null?void 0:b.vmui)==null?void 0:f.title}))==null?void 0:m.vmui)==null?void 0:u.title)||"Report",o=(p=(h=r.find(b=>{var f;return(f=b==null?void 0:b.vmui)==null?void 0:f.comment}))==null?void 0:h.vmui)==null?void 0:p.comment,s=M(()=>["vmui.endpoint",...new Set(r.flatMap(b=>{var f;return[...Object.keys(((f=b.vmui)==null?void 0:f.params)||[]).map(g=>`vmui.params.${g}`),...Object.keys(b.stats||[]).map(g=>`stats.${g}`),"isPartial"]}))].map(b=>({column:b.split(".").pop(),values:r.map(f=>st(f,b,"-"))})).filter(({values:b})=>b.length&&b.every(f=>f!=="-")),[r]),i=M(()=>{if(!n)return"";const b=U(n.start*1e3).tz().format(qe),f=U(n.end*1e3).tz().format(qe);return`${b} - ${f}`},[n]),{value:l,setTrue:c,setFalse:d}=ae(!1);return e(V,{children:[e("div",{className:"vm-query-analyzer-info-header",children:[e("h1",{className:"vm-query-analyzer-info-header__title",children:a}),i&&e("div",{className:"vm-query-analyzer-info-header__timerange",children:[e(rn,{})," ",i]}),(n==null?void 0:n.step)&&e("div",{className:"vm-query-analyzer-info-header__timerange",children:[e($n,{})," step ",n.step]}),(o||!!s.length)&&e("div",{className:"vm-query-analyzer-info-header__info",children:e(D,{startIcon:e(mt,{}),variant:"outlined",color:"warning",onClick:c,children:["Show stats",o&&" & comments"]})})]}),l&&e(Me,{title:a,onClose:d,children:e("div",{className:"vm-query-analyzer-info__modal",children:[!!s.length&&e("div",{className:"vm-query-analyzer-info-stats",children:[e("div",{className:"vm-query-analyzer-info-comment-header",children:[e(mt,{}),"Stats"]}),e("table",{children:[e("thead",{children:e("tr",{children:s.map(({column:b})=>e("th",{children:b},b))})}),e("tbody",{children:(v=s[0])==null?void 0:v.values.map((b,f)=>e("tr",{children:s.map(({values:g},_)=>e("td",{children:g[f]},_))},f))})]})]}),o&&e("div",{className:"vm-query-analyzer-info-comment",children:[e("div",{className:"vm-query-analyzer-info-comment-header",children:[e(Ns,{}),"Comments"]}),e("div",{className:"vm-query-analyzer-info-comment-body vm-markdown",dangerouslySetInnerHTML:{__html:Bt(o)||o}})]})]})})]})},Ku=t=>{const n=t.slice(1).map((s,i)=>s-t[i]),r={};n.forEach(s=>{const i=s.toString();r[i]=(r[i]||0)+1});let a=0,o=0;for(const s in r)r[s]>o&&(o=r[s],a=Number(s));return a},Zu=()=>{const[t,n]=N([]),[r,a]=N(""),o=M(()=>!!t.length,[t]),{value:s,setTrue:i,setFalse:l}=ae(!1),c=M(()=>{var _,y;if(!t)return;const f=(y=(_=t[0])==null?void 0:_.vmui)==null?void 0:y.params,g={start:+((f==null?void 0:f.start)||0),end:+((f==null?void 0:f.end)||0),step:f==null?void 0:f.step,date:""};if(!f){const T=t.filter(C=>C.data.resultType==="matrix").map(C=>C.data.result).flat().map(C=>{var k;return C.values?(k=C.values)==null?void 0:k.map(L=>L[0]):[0]}).flat(),w=Array.from(new Set(T.filter(Boolean))).sort((C,k)=>C-k);g.start=w[0],g.end=w[w.length-1],g.step=Kr(Ku(w))}return g.date=ts(We(g.end)),g},[t]),d=f=>f.every(g=>{if(typeof g=="object"&&g!==null){const _=g.data;if(typeof _=="object"&&_!==null){const y=_.result,S=_.resultType;return Array.isArray(y)&&typeof S=="string"}}return!1}),m=f=>{try{const g=JSON.parse(f),_=Array.isArray(g)?g:[g];d(_)?n(_):(a("Invalid structure - JSON does not match the expected format"),n([]))}catch(g){g instanceof Error&&(a(`${g.name}: ${g.message}`),n([]))}},u=f=>{f.map(g=>{const _=new FileReader;_.onload=y=>{var T;const S=String((T=y.target)==null?void 0:T.result);m(S)},_.readAsText(g)})},h=f=>{if(!f.target)return;const g=f.target;a("");const _=Array.from(g.files||[]);u(_),g.value=""},p=()=>{a("")},{files:v,dragging:b}=Li();return A(()=>{u(v)},[v]),e("div",{className:"vm-query-analyzer",children:[o&&e("div",{className:"vm-query-analyzer-header",children:[e(Ju,{data:t,period:c}),e(Vn,{onOpenModal:i,onChange:h})]}),o&&e(Wu,{data:t,period:c}),!o&&e("div",{className:"vm-trace-page-preview",children:[e("p",{className:"vm-trace-page-preview__text",children:["Please, upload file with JSON response content.",`
`,"The file must contain query information in JSON format.",`
`,"Graph will be displayed after file upload.",`
`,"Attach files by dragging & dropping, selecting or pasting them."]}),e(Vn,{onOpenModal:i,onChange:h})]}),r&&e("div",{className:"vm-query-analyzer-error",children:[e(le,{variant:"error",children:r}),e(D,{className:"vm-query-analyzer-error__close",startIcon:e(Ue,{}),variant:"text",color:"error",onClick:p})]}),s&&e(Me,{title:"Paste JSON",onClose:l,children:e(Gu,{onClose:l,onUpload:m})}),b&&e("div",{className:"vm-trace-page__dropzone"})]})},Xu=(t,n,r)=>{const a=[`flags=${encodeURIComponent(n)}`,`metrics=${encodeURIComponent(r)}`];return`${t}/downsampling-filters-debug?${a.join("&")}`},eh=()=>{const{serverUrl:t}=se(),[n,r]=oe(),[a,o]=N(new Map),[s,i]=N(!1),[l,c]=N(),[d,m]=N(),[u,h]=N(),p=W(async(v,b)=>{var g,_;if(c(b?"":"metrics are required"),m(v?"":"flags are required"),!b||!v)return;n.set("flags",v),n.set("metrics",b),r(n);const f=Xu(t,v,b);i(!0);try{const S=await(await fetch(f)).json();o(new Map(Object.entries(S.result||{}))),c(((g=S.error)==null?void 0:g.metrics)||""),m(((_=S.error)==null?void 0:_.flags)||""),h("")}catch(y){y instanceof Error&&y.name!=="AbortError"&&h(`${y.name}: ${y.message}`)}i(!1)},[t]);return{data:a,error:u,metricsError:l,flagsError:d,loading:s,applyFilters:p}},Ao={flags:`-downsampling.period={env="dev"}:7d:5m,{env="dev"}:30d:30m
-downsampling.period=30d:1m
-downsampling.period=60d:5m
`,metrics:`up
up{env="dev"}
up{env="prod"}`},th=()=>{const[t]=oe(),{data:n,loading:r,error:a,metricsError:o,flagsError:s,applyFilters:i}=eh(),[l,c]=N(t.get("metrics")||""),[d,m]=N(t.get("flags")||""),u=W(f=>{c(f)},[c]),h=W(f=>{m(f)},[m]),p=W(()=>{i(d,l)},[i,d,l]),v=W(()=>{const{flags:f,metrics:g}=Ao;m(f),c(g),i(f,g),t.set("flags",f),t.set("metrics",g)},[Ao,m,c,t]);A(()=>{d&&l&&p()},[]);const b=[];for(const[f,g]of n)b.push(e("tr",{className:"vm-table__row",children:[e("td",{className:"vm-table-cell",children:f}),e("td",{className:I({"vm-table-cell":!0,"vm-table-cell_empty":!g}),children:g?g.join(" "):"No matching rules found!"})]}));return e("section",{className:"vm-downsampling-filters",children:[r&&e(Qe,{}),e("div",{className:"vm-downsampling-filters-body vm-block",children:[e("div",{className:"vm-downsampling-filters-body__expr",children:[e("div",{className:"vm-retention-filters-body__title",children:e("p",{children:["Provide a list of flags for downsampling configuration. Note that only ",e("code",{children:"-downsampling.period"})," and ",e("code",{children:"-dedup.minScrapeInterval"})," flags are supported"]})}),e(ce,{type:"textarea",label:"Flags",value:d,error:a||s,autofocus:!0,onEnter:p,onChange:h,placeholder:"-downsampling.period=30d:1m -downsampling.period=7d:5m -dedup.minScrapeInterval=30s"})]}),e("div",{className:"vm-downsampling-filters-body__expr",children:[e("div",{className:"vm-retention-filters-body__title",children:e("p",{children:"Provide a list of metrics to check downsampling configuration."})}),e(ce,{type:"textarea",label:"Metrics",value:l,error:a||o,onEnter:p,onChange:u,placeholder:`up{env="dev"}
up{env="prod"}
`})]}),e("div",{className:"vm-downsampling-filters-body__result",children:e("table",{className:"vm-table",children:[e("thead",{className:"vm-table-header",children:e("tr",{children:[e("th",{className:"vm-table-cell vm-table-cell_header",children:"Metric"}),e("th",{className:"vm-table-cell vm-table-cell_header",children:"Applied downsampling rules"})]})}),e("tbody",{className:"vm-table-body",children:b})]})}),e("div",{className:"vm-downsampling-filters-body-top",children:[e("a",{className:"vm-link vm-link_with-icon",target:"_blank",href:"https://docs.victoriametrics.com/victoriametrics/single-server-victoriametrics/#downsampling",rel:"help noreferrer",children:[e(ut,{}),"Documentation"]}),e(D,{variant:"text",onClick:v,children:"Try example"}),e(D,{variant:"contained",onClick:p,startIcon:e(nt,{}),children:"Apply"})]})]})]})},nh=(t,n,r)=>{const a=[`flags=${encodeURIComponent(n)}`,`metrics=${encodeURIComponent(r)}`];return`${t}/retention-filters-debug?${a.join("&")}`},rh=()=>{const{serverUrl:t}=se(),[n,r]=oe(),[a,o]=N(new Map),[s,i]=N(!1),[l,c]=N(),[d,m]=N(),[u,h]=N(),p=W(async(v,b)=>{var g,_;if(c(b?"":"metrics are required"),m(v?"":"flags are required"),!b||!v)return;n.set("flags",v),n.set("metrics",b),r(n);const f=nh(t,v,b);i(!0);try{const S=await(await fetch(f)).json();o(new Map(Object.entries(S.result||{}))),c(((g=S.error)==null?void 0:g.metrics)||""),m(((_=S.error)==null?void 0:_.flags)||""),h("")}catch(y){y instanceof Error&&y.name!=="AbortError"&&h(`${y.name}: ${y.message}`)}i(!1)},[t]);return{data:a,error:u,metricsError:l,flagsError:d,loading:s,applyFilters:p}},Eo={flags:`-retentionPeriod=1y
-retentionFilter={env!="prod"}:2w
`,metrics:`up
up{env="dev"}
up{env="prod"}`},ah=()=>{const[t]=oe(),{data:n,loading:r,error:a,metricsError:o,flagsError:s,applyFilters:i}=rh(),[l,c]=N(t.get("metrics")||""),[d,m]=N(t.get("flags")||""),u=W(f=>{c(f)},[c]),h=W(f=>{m(f)},[m]),p=W(()=>{i(d,l)},[i,d,l]),v=W(()=>{const{flags:f,metrics:g}=Eo;m(f),c(g),i(f,g),t.set("flags",f),t.set("metrics",g)},[Eo,m,c,t]);A(()=>{d&&l&&p()},[]);const b=[];for(const[f,g]of n)b.push(e("tr",{className:"vm-table__row",children:[e("td",{className:"vm-table-cell",children:f}),e("td",{className:"vm-table-cell",children:g})]}));return e("section",{className:"vm-retention-filters",children:[r&&e(Qe,{}),e("div",{className:"vm-retention-filters-body vm-block",children:[e("div",{className:"vm-retention-filters-body__expr",children:[e("div",{className:"vm-retention-filters-body__title",children:e("p",{children:["Provide a list of flags for retention configuration. Note that only ",e("code",{children:"-retentionPeriod"})," and ",e("code",{children:"-retentionFilter"})," flags are supported."]})}),e(ce,{type:"textarea",label:"Flags",value:d,error:a||s,autofocus:!0,onEnter:p,onChange:h,placeholder:'-retentionPeriod=4w -retentionFilter=up{env="dev"}:2w'})]}),e("div",{className:"vm-retention-filters-body__expr",children:[e("div",{className:"vm-retention-filters-body__title",children:e("p",{children:"Provide a list of metrics to check retention configuration."})}),e(ce,{type:"textarea",label:"Metrics",value:l,error:a||o,onEnter:p,onChange:u,placeholder:`up{env="dev"}
up{env="prod"}
`})]}),e("div",{className:"vm-retention-filters-body__result",children:e("table",{className:"vm-table",children:[e("thead",{className:"vm-table-header",children:e("tr",{children:[e("th",{className:"vm-table-cell vm-table-cell_header",children:"Metric"}),e("th",{className:"vm-table-cell vm-table-cell_header",children:"Applied retention"})]})}),e("tbody",{className:"vm-table-body",children:b})]})}),e("div",{className:"vm-retention-filters-body-top",children:[e("a",{className:"vm-link vm-link_with-icon",target:"_blank",href:"https://docs.victoriametrics.com/victoriametrics/single-server-victoriametrics/#retention-filters",rel:"help noreferrer",children:[e(ut,{}),"Documentation"]}),e(D,{variant:"text",onClick:v,children:"Try example"}),e(D,{variant:"contained",onClick:p,startIcon:e(nt,{}),children:"Apply"})]})]})]})},oh=({hideQuery:t,showAllSeries:n})=>{const{query:r}=xe(),{period:a}=ge(),{displayType:o,reduceMemUsage:s,seriesLimits:i}=je(),{serverUrl:l}=se(),[c,d]=N(!1),[m,u]=N(),[h,p]=N(),[v,b]=N([]),[f,g]=N(),_=q(new AbortController),y=M(()=>{if(p(""),b([]),!!a)if(!l)p(Ce.emptyServer);else if(r.every(w=>!w.trim()))b(r.map(()=>Ce.validQuery));else if(Qr(l)){const w={...a};return r.map(C=>fd(l,C,w,s))}else p(Ce.validServer)},[l,a,t,s]),S=W(async({fetchUrl:w,stateSeriesLimits:C,showAllSeries:k})=>{_.current.abort(),_.current=new AbortController;const{signal:L}=_.current;d(!0);try{const x=Math.floor(window.innerWidth/4),E=30*1024*1024,P=[],F=k?1/0:+C[o]||1/0;let O=1,H=0;for await(const Y of w){if(t==null?void 0:t.includes(O-1)){b(ie=>[...ie,""]),O++;continue}const K=await fetch(Y,{signal:L}),re=await K.text();if(new TextEncoder().encode(re).length>E){const ie="Response too large to display (over 30 MiB). Please narrow your query.";p(ie),b(X=>[...X,ie]);continue}if(!K.ok||!K.body)P.push({metric:{},values:[],group:O}),p(re),b(ie=>[...ie,`${re}`]);else{b($=>[...$,""]);const ie=F-P.length,X=re.split(`
`).filter($=>$),R=X.slice(0,ie).sort();for(const $ of R){const B=wi($);if(!B)continue;const{values:ee,timestamps:te}=B,ue=ee.length,he=ue>x,Ye=he?x:ue,ye=he?ue/x:1,Pe=Array.from({length:Ye},(De,Ve)=>{const pe=he?Math.floor(Ve*ye):Ve;return[te[pe]/1e3,ee[pe]]});P.push({group:O,metric:B.metric,values:Pe})}H+=X.length}O++}const z=`Showing ${P.length} series out of ${H} series due to performance reasons. Please narrow down the query, so it returns less series`;g(H>F?z:""),u(P),d(!1)}catch(x){d(!1),x instanceof Error&&x.name!=="AbortError"&&(p(String(x)),console.error(x))}},[o,t]),T=W(()=>{_.current.abort(),u([])},[_]);return A(()=>{if(!(y!=null&&y.length))return;const w=setTimeout(S,400,{fetchUrl:y,stateSeriesLimits:i,showAllSeries:n});return()=>{var C;(C=_.current)==null||C.abort(),clearTimeout(w)}},[y,i,n]),{fetchUrl:y,isLoading:c,data:m,error:h,queryErrors:v,setQueryErrors:b,warning:f,abortFetch:T}},sh=()=>e(Te,{href:"https://docs.victoriametrics.com/victoriametrics/keyconcepts/#raw-samples",underlined:!0,children:"raw samples"}),ih=()=>e(Te,{underlined:!0,href:"https://docs.victoriametrics.com/victoriametrics/keyconcepts/#query-data",children:"Query API"}),lh=()=>e(Te,{underlined:!0,href:"https://docs.victoriametrics.com/victoriametrics/keyconcepts/#filtering",children:"time series selector"}),ch=()=>{Ia();const{isMobile:t}=J(),{displayType:n}=je(),{query:r}=xe(),[a,o]=N([]),[s,i]=N(!r[0]),[l,c]=N(!1),[d,m]=N(!0),{data:u,error:h,isLoading:p,warning:v,queryErrors:b,setQueryErrors:f,abortFetch:g,fetchUrl:_}=oh({hideQuery:a,showAllSeries:l}),y=q(null),S=!s&&h,T=k=>{o(k)},w=()=>{i(!1)},C=()=>{m(!1)};return e("div",{className:I({"vm-custom-panel":!0,"vm-custom-panel_mobile":t}),children:[e(xa,{label:"Time series selector",queryErrors:s?[]:b,setQueryErrors:f,setHideError:i,stats:[],isLoading:p,onHideQuery:T,onRunQuery:w,abortFetch:g,hideButtons:{traceQuery:!0,disableCache:!0},includeFunctions:!1}),d&&e(le,{variant:"info",children:e("div",{className:"vm-explore-metrics-header-description",children:[e("ul",{children:[e("li",{children:["This page provides a dedicated view for querying and displaying ",e(sh,{})," from VictoriaMetrics."]}),e("li",{children:["It expects only ",e(lh,{})," as a query argument."]}),e("li",{children:["Deduplication can only be disabled if it was previously enabled on the server (",e("code",{children:"-dedup.minScrapeInterval"}),")."]}),e("li",{children:["Users often assume that the ",e(ih,{})," returns data exactly as stored, but data samples and timestamps may be modified by the API."]})]}),e(D,{variant:"text",size:"small",startIcon:e(Ue,{}),onClick:C,ariaLabel:"close tips"})]})}),S&&e(le,{variant:"error",children:h}),v&&e(tr,{warning:v,query:r,onChange:c}),e("div",{className:I({"vm-custom-panel-body":!0,"vm-custom-panel-body_mobile":t,"vm-block":!0,"vm-block_mobile":t}),children:[p&&e(er,{}),e("div",{className:"vm-custom-panel-body-header",ref:y,children:[e("div",{className:"vm-custom-panel-body-header__tabs",children:e(Es,{tabFilter:k=>k.value!==Ne.table})}),u&&e(Ni,{fetchUrl:_,reportType:Ci.RAW_DATA})]}),e(yi,{graphData:u,liveData:u,isHistogram:!1,displayType:n,controlsRef:y})]})]})},dh=()=>{const[t,n]=N(!1);return e(V,{children:e(qr,{children:e(wa,{children:e(V,{children:[e(Ka,{onLoaded:n}),t&&e(Ur,{children:e(fe,{path:"/",element:e(Uc,{}),children:[e(fe,{path:Z.home,element:e(ki,{})}),e(fe,{path:Z.rawQuery,element:e(ch,{})}),e(fe,{path:Z.metrics,element:e(Du,{})}),e(fe,{path:Z.cardinality,element:e(lu,{})}),e(fe,{path:Z.topQueries,element:e(vu,{})}),e(fe,{path:Z.trace,element:e(_u,{})}),e(fe,{path:Z.queryAnalyzer,element:e(Zu,{})}),e(fe,{path:Z.dashboards,element:e(Fm,{})}),e(fe,{path:Z.withTemplate,element:e(Hu,{})}),e(fe,{path:Z.relabel,element:e(Bu,{})}),e(fe,{path:Z.activeQueries,element:e(Yu,{})}),e(fe,{path:Z.icons,element:e(Ou,{})}),e(fe,{path:Z.downsamplingDebug,element:e(th,{})}),e(fe,{path:Z.retentionDebug,element:e(ah,{})})]})})]})})})})},mh=()=>{const t={0:"#000000",1:"#AA0000",2:"#00AA00",3:"#AA5500",4:"#0000AA",5:"#AA00AA",6:"#00AAAA",7:"#AAAAAA",8:"#555555",9:"#FF5555",10:"#55FF55",11:"#FFFF55",12:"#5555FF",13:"#FF55FF",14:"#55FFFF",15:"#FFFFFF"};for(let n=0;n<6;n++)for(let r=0;r<6;r++)for(let a=0;a<6;a++){const o=16+n*36+r*6+a,s=n>0?n*40+55:0,i=r>0?r*40+55:0,l=a>0?a*40+55:0;t[o]=`rgb(${s},${i},${l})`}for(let n=0;n<24;n++){const r=232+n,a=8+n*10;t[r]=`rgb(${a},${a},${a})`}return t},uh=mh(),Xt=t=>uh[t]||null,hh="(?:\\u0007|\\u001B\\u005C|\\u009C)",ph=[`[\\u001B\\u009B][[\\]()#;?]*(?:(?:(?:(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]+)*|[a-zA-Z\\d]+(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]*)*)?${hh})`,"(?:(?:\\d{1,4}(?:;\\d{0,4})*)?[\\dA-PR-TZcf-nq-uy=><~]))"].join("|"),xo=new RegExp(ph,"g"),gh=(t,n,r)=>{switch(n){case 0:return{color:null,fontWeight:null,fontStyle:null,textDecoration:null,backgroundColor:null};case 30:case 31:case 32:case 33:case 34:case 35:case 36:case 37:return{...t,color:Xt(n-30)};case 90:case 91:case 92:case 93:case 94:case 95:case 96:case 97:return{...t,color:Xt(8+(n-90))};case 38:return r.length>2&&r[1]===5?{...t,color:Xt(r[2])}:t;case 40:case 41:case 42:case 43:case 44:case 45:case 46:case 47:return{...t,backgroundColor:Xt(n-40)};case 100:case 101:case 102:case 103:case 104:case 105:case 106:case 107:return{...t,backgroundColor:Xt(8+(n-100))};case 1:return{...t,fontWeight:"bold"};case 3:return{...t,fontStyle:"italic"};case 4:return{...t,textDecoration:"underline"};case 7:case 27:return{...t,color:t.backgroundColor,backgroundColor:t.color};case 22:return{...t,fontWeight:null};case 23:return{...t,fontStyle:null};case 24:return{...t,textDecoration:null};default:return t}},vh=t=>{var s;let n=0;const r=[];let a={color:null,fontWeight:null,fontStyle:null,textDecoration:null,backgroundColor:null},o;for(;(o=xo.exec(t))!==null;){const i=t.slice(n,o.index);i&&r.push(e("span",{style:{color:a.color||"inherit",fontWeight:a.fontWeight||"inherit",fontStyle:a.fontStyle||"inherit",textDecoration:a.textDecoration||"inherit",backgroundColor:a.backgroundColor||"inherit"},children:i},n));const l=((s=o[0].match(/\d+/g))==null?void 0:s.map(Number))||[];l.forEach(c=>{a=gh(a,c,l)}),n=xo.lastIndex}return n<t.length&&r.push(e("span",{style:{color:a.color||"inherit",fontWeight:a.fontWeight||"inherit",fontStyle:a.fontStyle||"inherit",textDecoration:a.textDecoration||"inherit",backgroundColor:a.backgroundColor||"inherit"},children:t.slice(n)},n)),r},fh=({field:t,value:n,hideGroupButton:r})=>{const a=Fe(),[o,s]=oe(),[i,l]=N(!1),c=o.get(ke.GROUP_BY)||Re,d=o.get(ke.DISPLAY_FIELDS)||"",m=d?d.split(","):[],u=m.includes(t),h=c===t,p=W(async()=>{if(!i)try{await a(`${t}: "${n}"`),l(!0)}catch(f){console.error(f)}},[i,a]),v=()=>{const f=m,g=f.includes(t)?f.filter(_=>_!==t):[...f,t];o.set(ke.DISPLAY_FIELDS,g.join(",")),s(o)},b=()=>{h?o.delete(ke.GROUP_BY):o.set(ke.GROUP_BY,t),s(o)};return A(()=>{if(i===null)return;const f=setTimeout(()=>l(!1),2e3);return()=>clearTimeout(f)},[i]),e("tr",{className:"vm-group-logs-row-fields-item",children:[e("td",{className:"vm-group-logs-row-fields-item-controls",children:e("div",{className:"vm-group-logs-row-fields-item-controls__wrapper",children:[e(j,{title:i?"Copied":"Copy to clipboard",children:e(D,{className:"vm-group-logs-row-fields-item-controls__button",variant:"text",color:"gray",size:"small",startIcon:e(Xe,{}),onClick:p,ariaLabel:"copy to clipboard"})}),e(j,{title:u?"Hide this field":"Show this field instead of the message",children:e(D,{className:"vm-group-logs-row-fields-item-controls__button",variant:"text",color:u?"secondary":"gray",size:"small",startIcon:u?e(Vt,{}):e(Vt,{}),onClick:v,ariaLabel:u?"Hide this field":"Show this field instead of the message"})}),!r&&e(j,{title:h?"Ungroup this field":"Group by this field",children:e(D,{className:"vm-group-logs-row-fields-item-controls__button",variant:"text",color:h?"secondary":"gray",size:"small",startIcon:e(Lt,{}),onClick:b,ariaLabel:h?"Ungroup this field":"Group by this field"})})]})}),e("td",{className:"vm-group-logs-row-fields-item__key",children:t}),e("td",{className:"vm-group-logs-row-fields-item__value",children:n})]})},_h=zr(fh),lr=t=>{const[n,r]=N(!!Ae(t)),a=W(()=>{const s=!!Ae(t);s!==n&&r(s)},[t,n]),o=W(s=>{Le(t,s)},[t]);return me("storage",a),M(()=>[n,o],[n,o])},bh=({log:t,hideGroupButton:n})=>{const r=M(()=>Object.entries(t).sort(([o],[s])=>o.localeCompare(s)),[t]),[a]=lr("LOGS_DISABLED_HOVERS");return e("div",{className:I({"vm-group-logs-row-fields":!0,"vm-group-logs-row-fields_interactive":!a}),children:e("table",{children:e("tbody",{children:r.map(([o,s])=>e(_h,{field:o,value:s,hideGroupButton:n},o))})})})},yh=({log:t,displayFields:n=["_msg"],onItemClick:r,hideGroupButton:a})=>{const{value:o,toggle:s}=ae(!1),[i,l]=N(!1),c=Fe(),[d]=oe(),{markdownParsing:m,ansiParsing:u}=ya(),{timezone:h}=ge(),p=d.get(ke.NO_WRAP_LINES)==="true",v=d.get(ke.DATE_FORMAT)||$t,b=M(()=>t._time?U(t._time).tz().format(v):"",[t._time,h,v]),f=M(()=>!m||!t._msg?"":Bt(t._msg.replace(/```/g,"\n```\n")),[t._msg,m]),g=Object.keys(t).length>0,_=M(()=>{const w=[];return g||w.push("-"),n.some(C=>t[C])?n.filter(C=>t[C]).forEach(C=>{const k=C==="_msg"&&u?vh(t[C]):t[C];w.push(k)}):Object.entries(t).forEach(([C,k])=>{w.push(`${C}: ${k}`)}),w},[t,g,n,u]),[y]=lr("LOGS_DISABLED_HOVERS"),S=()=>{s(),r==null||r(t)},T=W(async w=>{if(w.stopPropagation(),!i)try{await c(JSON.stringify(t,null,2)),l(!0)}catch(C){console.error(C)}},[i,c]);return A(()=>{if(i===null)return;const w=setTimeout(()=>l(!1),2e3);return()=>clearTimeout(w)},[i]),e("div",{className:"vm-group-logs-row",children:[e("div",{className:I({"vm-group-logs-row-content":!0,"vm-group-logs-row-content_interactive":!y}),onClick:S,children:[e(j,{title:i?"Copied":"Copy to clipboard",children:e(D,{className:"vm-group-logs-row-content__copy-row",variant:"text",color:"gray",size:"small",startIcon:e(Xe,{}),onClick:T,ariaLabel:"copy to clipboard"})}),g&&e("div",{className:I({"vm-group-logs-row-content__arrow":!0,"vm-group-logs-row-content__arrow_open":o}),children:e(be,{})}),e("div",{className:I({"vm-group-logs-row-content__time":!0,"vm-group-logs-row-content__time_missing":!b}),children:b||"timestamp missing"}),e("div",{className:I({"vm-group-logs-row-content__msg":!0,"vm-group-logs-row-content__msg_empty-msg":!t._msg,"vm-group-logs-row-content__msg_missing":!_,"vm-group-logs-row-content__msg_single-line":p}),dangerouslySetInnerHTML:f?{__html:f}:void 0,children:_.map((w,C)=>e("span",{className:"vm-group-logs-row-content__sub-msg",children:w},`${w}_${C}`))})]}),g&&o&&e(bh,{hideGroupButton:a,log:t})]})},Ei=zr(yh);var lt=(t=>(t.BAR="Bars",t.LINE="Lines",t.LINE_STEPPED="Stepped lines",t.POINTS="Points",t))(lt||{});const wh=(t,n,r,a)=>{var i,l,c;const o=t.under.clientWidth/hi-1,s=(c=(l=(i=jt)==null?void 0:i.paths)==null?void 0:l.bars)==null?void 0:c.call(l,{size:[.96,o]});return s?s(t,n,r,a):null},Ch=(t,n,r,a)=>{var s,i,l;const o=(l=(i=(s=jt)==null?void 0:s.paths)==null?void 0:i.stepped)==null?void 0:l.call(i,{align:1});return o?o(t,n,r,a):null},Nh=t=>{switch(t){case lt.BAR:return wh;case lt.LINE_STEPPED:return Ch;default:return}},Sh=["color-log-hits-bar-1","color-log-hits-bar-2","color-log-hits-bar-3","color-log-hits-bar-4","color-log-hits-bar-5"],kh={[lt.BAR]:1,[lt.LINE_STEPPED]:2,[lt.LINE]:1.2,[lt.POINTS]:0},Rr="other",xi=t=>t!=null&&t._isOther?Rr:Object.values((t==null?void 0:t.fields)||{}).map(r=>r||'""').join(", "),Th=(t,n=0,r=1)=>{const a=t.series.filter(({scale:s})=>s==="y").map(({max:s})=>s||r),o=nr(a);return rr(0,o||r)},Lh=({data:t,logHits:n,xRange:r,bands:a,containerSize:o,onReadyChart:s,setPlotScale:i,graphOptions:l})=>{const{isDarkTheme:c}=se(),[d,m]=N(-1),u=v=>{const b=v.cursor.idx??-1;m(b)},h=M(()=>{let v=0;return t.map((b,f)=>{if(f===0)return{};const g=n==null?void 0:n[f-1],_=xi(g),y=g==null?void 0:g._isOther,S=y?"color-log-hits-bar-0":Sh[v++],T=tt(S);return{label:_,width:kh[l.graphStyle],spanGaps:!0,show:!0,stroke:T,fill:l.fill&&!y?`${T}80`:l.fill?T:"",paths:Nh(l.graphStyle)}})},[c,t,l]);return{options:{series:h,bands:a,width:o.width||window.innerWidth/2,height:o.height||200,cursor:{points:{width:(v,b,f)=>f/4,size:(v,b)=>{var f,g,_;return(((_=(g=(f=v.series)==null?void 0:f[b])==null?void 0:g.points)==null?void 0:_.size)||1)*1.5},stroke:(v,b)=>{var f;return`${((f=h==null?void 0:h[b])==null?void 0:f.stroke)||"#ffffff"}`},fill:()=>"#ffffff"}},scales:{x:{time:!0,range:()=>[r.min,r.max]},y:{range:Th}},hooks:{drawSeries:[],ready:[s],setCursor:[u],setSelect:[Ha(i)],destroy:[za]},legend:{show:!1},axes:Ra([{},{scale:"y"}]),tzDate:v=>U(Ft(We(v))).local().toDate()},series:h,focusDataIdx:d}},Mi=t=>(/^{.+}$/.test(t)?t.slice(1,-1).split(","):[t]).filter(Boolean),Ii=t=>{const n=U(t.start*1e3),r=U(t.end*1e3),a=r.diff(n,"milliseconds"),o=Math.ceil(a/hi)||1;return{start:n,end:r,step:o}},Pi=(t,n=Re)=>/(.+)?=(".+")/.test(t)?t.replace(/=/,": "):`${n}: "${t}"`,Ah=t=>t.reduce((n,r)=>n+(r.total||0),0),Di=t=>(n,r)=>{if(n.label===Rr)return 1;if(r.label===Rr)return-1;const a=n[t];return r[t]-a},Eh=()=>{const{isMobile:t}=J(),{markdownParsing:n,ansiParsing:r}=ya(),a=Is();return e(V,{children:[e("div",{className:"vm-group-logs-configurator-item",children:[e(_e,{label:"Enable markdown parsing",value:n,onChange:i=>{a({type:"SET_MARKDOWN_PARSING",payload:i}),r&&a({type:"SET_ANSI_PARSING",payload:!1})},fullWidth:t}),e("div",{className:"vm-group-logs-configurator-item__info",children:"Toggle this switch to enable or disable the Markdown formatting for log entries. Enabling this will parse log texts to Markdown."})]}),e("div",{className:"vm-group-logs-configurator-item",children:[e(_e,{label:"Enable ANSI parsing",value:r,onChange:i=>{a({type:"SET_ANSI_PARSING",payload:i}),n&&a({type:"SET_MARKDOWN_PARSING",payload:!1})},fullWidth:t}),e("div",{className:"vm-group-logs-configurator-item__info",children:"Toggle this switch to enable or disable ANSI escape sequence parsing for log entries. Enabling this will interpret ANSI codes to render colored log output."})]})]})},{GROUP_BY:Mo,NO_WRAP_LINES:Io,COMPACT_GROUP_HEADER:Po,DISPLAY_FIELDS:kr,DATE_FORMAT:Tr}=ke,En="Group view settings",xh=({logs:t})=>{const[n,r]=oe(),a=n.get(Mo)||Re,o=n.get(Io)==="true",s=n.get(Po)==="true",i=n.get(kr)||"",l=i?i.split(","):[tn],[c,d]=N(n.get(Tr)||$t),[m,u]=N(""),[h,p]=lr("LOGS_DISABLED_HOVERS"),v=a!==Re,b=l.length!==1||l[0]!==tn,f=c!==$t,g=[v,b,o,s,f].some(Boolean),_=M(()=>{const O=new Set(t.map(H=>Object.keys(H)).flat());return Array.from(O).sort((H,z)=>H.localeCompare(z))},[t]),{value:y,toggle:S,setFalse:T}=ae(!1),w=O=>{n.set(Mo,O),r(n)},C=O=>{const H=l,z=H.includes(O)?H.filter(Y=>Y!==O):[...H,O];n.set(kr,z.join(",")),r(n)},k=()=>{n.delete(kr),r(n)},L=()=>{n.set(Io,String(!o)),r(n)},x=()=>{n.set(Po,String(!s)),r(n)},E=O=>{U(new Date,O,!0).isValid()||u("Invalid date format"),d(O)},P=()=>{c===$t?n.delete(Tr):n.set(Tr,c),r(n),T()};return e(V,{children:[e("div",{className:"vm-group-logs-configurator-button",children:[e(j,{title:g?e("div",{className:"vm-group-logs-configurator__tooltip",children:[e("p",{children:En}),e("hr",{}),e("ul",{children:[v&&e("li",{children:["Group by ",e("code",{children:`"${a}"`})]}),b&&e("li",{children:["Display fields: ",l.length||1]}),o&&e("li",{children:"Single-line text is enabled"}),s&&e("li",{children:"Compact group header is enabled"}),f&&e("li",{children:["Date format: ",e("code",{children:c})]})]})]}):En,children:e(D,{variant:"text",startIcon:e(Ze,{}),onClick:S,ariaLabel:En})}),g&&e("span",{className:"vm-group-logs-configurator-button__marker"})]}),y&&e(Me,{title:En,onClose:P,children:e("div",{className:"vm-group-logs-configurator",children:[e("div",{className:"vm-group-logs-configurator-item",children:[e(it,{value:a,list:[Ut,..._],label:"Group by field",placeholder:"Group by field",onChange:w,searchable:!0}),e(j,{title:"Reset grouping",children:e(D,{variant:"text",color:"primary",startIcon:e(ct,{}),onClick:()=>w(Re)})}),e("span",{className:"vm-group-logs-configurator-item__info",children:["Select a field to group logs by (default: ",e("code",{children:Re}),")."]})]}),e("div",{className:"vm-group-logs-configurator-item",children:[e(it,{value:l,list:_,label:"Display fields",placeholder:"Display fields",onChange:C,searchable:!0}),e(j,{title:"Clear fields",children:e(D,{variant:"text",color:"primary",startIcon:e(ct,{}),onClick:k})}),e("span",{className:"vm-group-logs-configurator-item__info",children:["Select fields to display instead of the message (default: ",e("code",{children:tn}),")."]})]}),e("div",{className:"vm-group-logs-configurator-item",children:[e(ce,{autofocus:!0,label:"Date format",value:c,onChange:E,error:m}),e(j,{title:"Reset format",children:e(D,{variant:"text",color:"primary",startIcon:e(ct,{}),onClick:()=>d($t)})}),e("span",{className:"vm-group-logs-configurator-item__info vm-group-logs-configurator-item__info_input",children:["Set the date format (e.g., ",e("code",{children:"YYYY-MM-DD HH:mm:ss"}),"). Learn more in ",e(Te,{href:"https://day.js.org/docs/en/display/format",children:"this documentation"}),". ",e("br",{}),"Your current date format: ",e("code",{children:U().format(c||$t)})]})]}),e(Eh,{}),e("div",{className:"vm-group-logs-configurator-item",children:[e(_e,{value:o,onChange:L,label:"Single-line message"}),e("span",{className:"vm-group-logs-configurator-item__info",children:"Displays message in a single line and truncates it with an ellipsis if it exceeds the available space."})]}),e("div",{className:"vm-group-logs-configurator-item",children:[e(_e,{value:s,onChange:x,label:"Compact group header"}),e("span",{className:"vm-group-logs-configurator-item__info",children:'Shows group headers in one line with a "+N more" badge for extra fields.'})]}),e("div",{className:"vm-group-logs-configurator-item",children:[e(_e,{value:h,onChange:p,label:"Disable hover effects"}),e("span",{className:"vm-group-logs-configurator-item__info",children:"Disable row highlighting on hover to improve performance with large datasets."})]})]})})]})},Do=({pair:t,isHide:n})=>{const{isDarkTheme:r}=se(),a=Fe(),[o]=oe(),[s,i]=N(null),l=o.get(ke.GROUP_BY)||Re,c=d=>async m=>{m.stopPropagation();const u=Pi(d,l);await a(u)&&i(d)};return A(()=>{if(s===null)return;const d=setTimeout(()=>i(null),2e3);return()=>clearTimeout(d)},[s]),e(j,{title:s===t?"Copied":"Copy to clipboard",placement:"top-center",children:e("div",{className:I({"vm-group-logs-section-keys__pair":!0,"vm-group-logs-section-keys__pair_hide":n,"vm-group-logs-section-keys__pair_dark":r}),onClick:c(t),children:t})})},Mh=({group:t,index:n})=>{const{isDarkTheme:r}=se(),[a]=oe(),o=q(null),s=q(null),{value:i,toggle:l,setFalse:c}=ae(!1),[d,m]=N(0),u=a.get(ke.GROUP_BY)||Re,h=a.get(ke.COMPACT_GROUP_HEADER)==="true",p=t.pairs,v=p.length-d-1,b=g=>{g.stopPropagation(),l()},f=W(()=>{if(!h||!o.current){m(0);return}const g=o.current,_=g.getBoundingClientRect(),S=Array.from(g.querySelectorAll(".vm-group-logs-section-keys__pair:not(.vm-group-logs-section-keys__pair_more)"));let T=0;for(const w of S){const{right:C}=w.getBoundingClientRect();C+220>_.width&&T++}m(T)},[h,o]);return A(f,[t.pairs,h,o]),me("resize",f),e("div",{className:I({"vm-group-logs-section-keys":!0,"vm-group-logs-section-keys_compact":h}),ref:o,children:[e("span",{className:"vm-group-logs-section-keys__title",children:u===Ut?Ut:e(V,{children:[n+1,". Group by ",e("code",{children:u}),":"]})}),p.map((g,_)=>e(Do,{pair:g,isHide:d?_>v:!1},`${t.keysString}_${g}`)),d>0&&e(V,{children:[e("div",{className:I({"vm-group-logs-section-keys__pair":!0,"vm-group-logs-section-keys__pair_more":!0,"vm-group-logs-section-keys__pair_dark":r}),ref:s,onClick:b,children:["+",d," more"]}),e(Ie,{open:i,buttonRef:s,placement:"bottom-left",onClose:c,children:e("div",{className:"vm-group-logs-section-keys vm-group-logs-section-keys_popper",children:p.slice(v+1).map(g=>e(Do,{pair:g},`${t.keysString}_${g}`))})})]}),e("span",{className:"vm-group-logs-section-keys__count",children:[t.total," entries"]})]})},Oi=({currentPage:t,totalItems:n,itemsPerPage:r,onPageChange:a,maxVisiblePages:o=10})=>{const s=Math.ceil(n/r),i=m=>{m<1||m>s||a(m)},l=M(()=>{const m=[];if(s<=o)for(let u=1;u<=s;u++)m.push(u);else{const u=Math.max(1,t-Math.floor(o/2)),h=Math.min(s,u+o-1);u>1&&(m.push(1),u>2&&m.push("..."));for(let p=u;p<=h;p++)m.push(p);h<s&&(h<s-1&&m.push("..."),m.push(s))}return m},[s,t,o]),c=m=>()=>{i(t+m)},d=m=>()=>{typeof m=="number"&&i(m)};return l.length<=1?null:e("div",{className:"vm-pagination",children:[e("button",{className:"vm-pagination__page vm-pagination__arrow vm-pagination__arrow_prev",onClick:c(-1),disabled:t===1,children:e(be,{})}),l.map((m,u)=>e("button",{onClick:d(m),className:I({"vm-pagination__page":!0,"vm-pagination__page_active":t===m,"vm-pagination__page_disabled":m==="..."}),disabled:m==="...",children:m},u)),e("button",{className:"vm-pagination__page vm-pagination__arrow vm-pagination__arrow_next",onClick:c(1),disabled:t===s,children:e(be,{})})]})},Oo=[10,25,50,100,250,500,1e3],Za=({limit:t,allowUnlimited:n,onChange:r,onOpenSelect:a})=>{const{isMobile:o}=J(),s=q(null),i=M(()=>n?[...Oo,0]:Oo,[n]),{value:l,toggle:c,setFalse:d}=ae(!1),m=()=>{c(),l||a==null||a()},u=h=>()=>{r(h),d()};return e(V,{children:[e("div",{className:"vm-select-limits-button",onClick:m,ref:s,children:[e("div",{children:["Rows per page: ",e("b",{children:t||"All"})]}),e(Je,{})]}),e(Ie,{open:l,onClose:d,placement:"bottom-right",buttonRef:s,children:e("div",{className:"vm-select-limits",children:i.map(h=>e("div",{className:I({"vm-list-item":!0,"vm-list-item_mobile":o,"vm-list-item_active":h===t}),onClick:u(h),children:h||"All"},h))})})]})},Ih=(t,n,r)=>M(()=>{if(!r)return t;const a=(n-1)*r,o=a+r;let s=0;const i=[];for(const l of t){const c=l.values.length,d=s,m=s+c;if(m<=a){s=m;continue}if(d>=o)break;const u=Math.max(0,a-d),h=Math.min(c,o-d),p={...l,values:l.values.slice(u,h)};if(i.push(p),s=m,s>=o)break}return i},[t,n,r]),Ph=({title:t,downloadFormatOptions:n,onDownload:r})=>{const{value:a,setTrue:o,setFalse:s}=ae(!1),i=q(null),l=W(()=>{if(a){s();return}n&&n.length>0?o():(r(),s())},[r,s,a,o]),c=W(d=>{const m=d.currentTarget;r(m.textContent??void 0)},[r]);return e(V,{children:[e("div",{ref:i,children:e(j,{title:t,children:e(D,{variant:"text",startIcon:e(fn,{}),onClick:l,ariaLabel:t})})}),n&&n.length>0&&e(Ie,{open:a,onClose:s,buttonRef:i,placement:"bottom-right",children:n.map(d=>e("div",{className:"vm-download-button__format-option",children:e(D,{variant:"text",onClick:c,className:"vm-download-button__format-option-button",children:d})},d))})]})},cr=({getLogs:t})=>{const{fileExtensions:n,getDownloaderByExtension:r}=M(()=>{const o=[{extension:"csv",downloader:Cd},{extension:"json",downloader:(l,c)=>{const d=JSON.stringify(l,null,2);Pa(d,c)}}],s=l=>{var c;return(c=o.find(({extension:d})=>d===l))==null?void 0:c.downloader};return{fileExtensions:o.map(({extension:l})=>l),getDownloaderByExtension:s}},[]),a=W(o=>{if(!o)return;const s=t(),i=r(o);if(i){const l=U().utc().format(Wr);i(s,`vmui_logs_${l}.${o}`)}},[t]);return e(Ph,{title:"Download logs",onDownload:a,downloadFormatOptions:n})},Dh=/(?:^|\|)\s*(?:sort|order)\b/i;function Oh(t){return Dh.test(t)}const Rh=({logs:t,settingsRef:n})=>{const{isMobile:r}=J(),[a,o]=oe(),s=a.get("query")||"",i=Oh(s),[l,c]=N(1),[d,m]=N([]),u=a.get(ke.GROUP_BY)||Re,h=a.get(ke.DISPLAY_FIELDS)||tn,p=M(()=>h.split(","),[h]),v=Number(a.get(ke.ROWS_PER_PAGE)),b=isNaN(v)?0:v,f=M(()=>d.every(Boolean),[d]),g=M(()=>js(t,[u]).map(k=>{var P;const L=((P=k.values[0])==null?void 0:P[u])||"",x=Mi(L),E=i?k.values:k.values.toReversed();return{keys:k.keys,keysString:k.keys.join(""),values:E,pairs:x,total:E.length}}).sort((k,L)=>L.total-k.total),[t,u,i]),_=Ih(g,l,b),y=W(()=>{m(new Array(g.length).fill(!f))},[f,g.length]),S=W(k=>L=>{m(x=>{const E=[...x];return E[k]=L,E})},[]),T=k=>{k?a.set(ke.ROWS_PER_PAGE,String(k)):a.delete(ke.ROWS_PER_PAGE),o(a)},w=k=>{c(k),window.scrollTo({top:0})},C=W(()=>t,[t]);return A(()=>{m(new Array(g.length).fill(!r))},[g]),A(()=>{c(1)},[b]),e(V,{children:[e("div",{className:"vm-group-logs",children:[_.map((k,L)=>e("div",{className:"vm-group-logs-section",children:e(Kn,{defaultExpanded:d[L],onChange:S(L),title:e(Mh,{group:k,index:L}),children:e("div",{className:"vm-group-logs-section-rows",children:k.values.map((x,E)=>e(Ei,{log:x,displayFields:p},`${L}_${E}_${x._time}`))})})},k.keysString)),e(Oi,{currentPage:l,totalItems:t.length,itemsPerPage:b||1/0,onPageChange:w})]}),n.current&&jn.createPortal(e("div",{className:"vm-group-logs-header",children:[e("div",{className:"vm-explore-logs-body-header__log-info",children:["Total groups: ",e("b",{children:g.length})]}),e(Za,{allowUnlimited:!0,limit:b,onChange:T}),e(j,{title:f?"Collapse All":"Expand All",children:e(D,{variant:"text",startIcon:f?e(ua,{}):e(ma,{}),onClick:y,ariaLabel:f?"Collapse All":"Expand All"})}),e(cr,{getLogs:C}),e(xh,{logs:t})]}),n.current)]})},Xa=()=>e("div",{className:"vm-explore-logs-body__empty",children:"No logs found"}),$h=jn.memo(Rh),Fh=({data:t,settingsRef:n})=>t.length?e(V,{children:e($h,{logs:t,settingsRef:n})}):e(Xa,{}),zh=t=>{switch(t){case"_time":return"vm-table-cell_logs-time";default:return"vm-table-cell_logs"}},Hh=[{key:"_vmui_data",title:"Data",className:"vm-table-cell_logs vm-table-cell_pre"}],Vh=({logs:t,displayColumns:n,tableCompact:r,columns:a,rowsPerPage:o})=>{const s=q(null),[i,l]=N(1),c=M(()=>t.map(p=>{const v=JSON.stringify(p,null,2);return{...p,_vmui_data:v}}),[t]),d=M(()=>a.map(p=>({key:p,title:p,className:zh(p)})),[a]),m=M(()=>r?Hh:n!=null&&n.length?d.filter(p=>n.includes(p.key)):[],[d,n,r]),u=M(()=>{const p=(i-1)*o,v=p+o;return{startIndex:p,endIndex:v}},[i,o]),h=p=>{if(l(p),s.current){const v=s.current.getBoundingClientRect().top+window.scrollY-50;window.scrollTo({top:v})}};return A(()=>{l(1)},[t,o]),e(V,{children:[e("div",{ref:s,children:e(Ai,{rows:c,columns:m,defaultOrderBy:"_time",defaultOrderDir:"desc",copyToClipboard:"_vmui_data",paginationOffset:u})}),e(Oi,{currentPage:i,totalItems:c.length,itemsPerPage:o,onPageChange:h})]})},qh=jn.memo(Vh),Uh=({data:t,settingsRef:n})=>{const{setSearchParamsFromKeys:r}=rt(),[a,o]=N([]),[s,i]=Se(100,"rows_per_page"),l=M(()=>{const u=new Set;for(const h of t)for(const p in h)u.add(p);return Array.from(u).sort((h,p)=>h.localeCompare(p))},[t]),c=u=>{i(u),r({rows_per_page:u})},d=W(()=>t,[t]),m=()=>n.current?pt(e("div",{className:"vm-table-view__settings",children:[e(Za,{limit:s,onChange:c}),e("div",{className:"vm-table-view__settings-buttons",children:[t.length>0&&e(cr,{getLogs:d}),e(Ga,{columns:l,selectedColumns:a,onChangeColumns:o})]})]}),n.current):null;return t.length?e(V,{children:[m(),e(qh,{logs:t,displayColumns:a,tableCompact:!1,columns:l,rowsPerPage:Number(s)})]}):e(Xa,{})},Lr="JSON settings",Ro=["asc","desc"],Bh=({fields:t,sortQueryParamName:n,fieldSortQueryParamName:r})=>{const[a,o]=oe(),s=q(null),[i,l]=N(null),{value:c,toggle:d,setFalse:m}=ae(!1),[u,h]=N(null),[p,v]=N(null);A(()=>{const w=a.get(n),C=L=>Ro.includes(L);if(w){const[L,x]=w.split(":").map(decodeURIComponent);L&&C(x)&&(h(L),v(x))}const k=a.get(r);(k==="asc"||k==="desc")&&l(k)},[a,n,r,h,v,l]);const b=W((w,C)=>{const k=new URLSearchParams(a.toString());!w||!C?k.delete(n):k.set(n,`${w}:${C||""}`),o(k)},[a,n]),f=w=>{const C=p||"asc";h(w),v(C),b(w,C)},g=()=>{h(null),v(null),b(null,null)},_=W(()=>{let w=null;i===null?w="asc":i==="asc"&&(w="desc"),l(w);const C=new URLSearchParams(a.toString());w?C.set(r,encodeURIComponent(w)):C.delete(r),o(C)},[i,a,r]),y=w=>{const C=u||t[0];h(C),v(w),b(C,w)},S=M(()=>({default:{title:"Set field sort order. Click to sort in ascending order",icon:e(Ts,{})},asc:{title:"Fields sorted ascending. Click to sort in descending order",icon:e(Ls,{})},desc:{title:"Fields sorted descending. Click to reset sort",icon:e(As,{})}}),[]),T=M(()=>{const{title:w,icon:C}=S[i??"default"];return e(j,{title:w,children:e(D,{variant:"text",startIcon:C,onClick:_,ariaLabel:w})})},[i,d,_,S]);return e("div",{className:"vm-json-settings",children:[T,e(j,{title:Lr,children:e("div",{ref:s,children:e(D,{variant:"text",startIcon:e(Ze,{}),onClick:d,ariaLabel:Lr})})}),c&&e(Me,{title:Lr,className:"vm-json-settings-modal",onClose:m,children:e("div",{className:"vm-json-settings-modal-section",children:e("div",{className:"vm-json-settings-modal-section__sort-settings-container",children:[e(it,{value:u||"",onChange:f,list:t,label:"Select field"}),e(it,{value:p||"",onChange:y,list:Ro,label:"Sort direction"}),(u||p)&&e(D,{variant:"outlined",color:"error",onClick:g,children:"Reset sort"})]})})})]})},jh=jn.memo(or),$o="json_sort",Fo="json_field_sort",Qh=({data:t,settingsRef:n})=>{const r=W(()=>t,[t]),[a]=oe(),o=a.get($o),s=a.get(Fo),[i,l]=M(()=>{const[h,p]=(o==null?void 0:o.split(":").map(decodeURIComponent))||[];return[h,p]},[o]),c=M(()=>{const h=new Set(t.flatMap(Object.keys));return Array.from(h)},[t]),d=M(()=>{if(!s)return t;const h=c.toSorted((p,v)=>s==="asc"?p.localeCompare(v):v.localeCompare(p));return t.map(p=>h.reduce((v,b)=>(p[b]&&(v[b]=p[b]),v),{}))},[c,s,t]),m=M(()=>!i||!l?d:Yi(d,[i],[l]),[d,i,l]),u=()=>n.current?pt(t.length>0&&e("div",{className:"vm-json-view__settings-container",children:[e(cr,{getLogs:r}),e(Bh,{fields:c,sortQueryParamName:$o,fieldSortQueryParamName:Fo})]}),n.current):null;return t.length?e(V,{children:[u(),e(jh,{data:m})]}):e(Xa,{})},dr=()=>{const[t]=oe();return M(()=>({AccountID:t.get("accountID")||"0",ProjectID:t.get("projectID")||"0"}),[t])};class Yh{constructor(n=200,r=10,a=6,o=2){we(this,"threshold");we(this,"windowSize");we(this,"minHighCount");we(this,"minNormalCount");we(this,"window");we(this,"state");this.threshold=n,this.windowSize=r,this.minHighCount=a,this.minNormalCount=o,this.window=[],this.state="normal"}update(n){this.window.push(n),this.window.length>this.windowSize&&this.window.shift();const r=this.window.filter(a=>a>this.threshold).length;return this.state==="normal"?r>=this.minHighCount&&(this.state="high"):this.state==="high"&&r<this.minNormalCount&&(this.state="normal"),this.state}}const Gh=200,zo=5e3,Ho=1e3,Wh=(t,n,r,a)=>async o=>{let s=Date.now();const i=setInterval(()=>{if(Date.now()-s>zo){clearInterval(i),a();return}},zo);try{for(;;){const{done:l,value:c}=await o.read();if(l)break;s=Date.now();const d=new TextDecoder().decode(c),m=(t.current+d).split(`
`);t.current=m.pop()||"",n.current=[...n.current,...m]}}catch(l){l instanceof Error&&l.name!=="AbortError"&&(console.error("Stream processing error:",l),a())}finally{clearInterval(i)}},Jh=(t,n)=>t.map(r=>{try{const a=r&&JSON.parse(r);return a._log_id=n.current++,a}catch(a){return console.error(`Failed to parse "${r}" to JSON
`,a),null}}).filter(Boolean),Kh=({lines:t,limit:n,counterRef:r,setIsLimitedLogsPerUpdate:a,setLogs:o,bufferLinesRef:s,logFlowAnalyzerRef:i})=>{var m;const l=((m=i==null?void 0:i.current)==null?void 0:m.update(t.length))==="high",c=l&&t.length>Gh?t.slice(-200):t,d=Jh(c,r);a(l),o(u=>{const h=[...u,...d];return h.length>n?h.slice(-n):h}),s.current=[]},Zh=(t,n)=>{const{serverUrl:r}=se(),[a,o]=N([]),{value:s,setTrue:i,setFalse:l}=ae(!1),c=dr(),[d,m]=N(),[u,h]=N(!1),p=q(0n),v=q(new AbortController),b=q(null),f=q(null),g=q(""),_=q([]),y=q(new Yh),S=W(()=>{b.current&&(b.current.cancel(),b.current=null),f.current&&clearInterval(f.current),g.current&&(g.current=""),v.current.abort()},[]),T=W(async()=>{S(),v.current=new AbortController;const{signal:C}=v.current;m(void 0);try{const k=await fetch(`${r}/select/logsql/tail`,{signal:C,method:"POST",headers:{...c},body:new URLSearchParams({query:t.trim()})});if(!k.ok||!k.body){const E=await k.text();return m(E),o([]),!1}const L=k.body.getReader();return b.current=L,Wh(g,_,m,T)(L),!0}catch(k){return k instanceof Error&&k.name!=="AbortError"&&(m(String(k)),console.error(k),o([])),!1}},[t,S]);A(()=>{if(s){const k=setInterval(()=>{_.current.length>n&&(_.current=_.current.slice(-n))},Ho);return()=>{clearInterval(k)}}const C=setInterval(()=>{const k=_.current;Kh({lines:k,limit:n,counterRef:p,setIsLimitedLogsPerUpdate:h,setLogs:o,bufferLinesRef:_,logFlowAnalyzerRef:y})},Ho);return()=>clearInterval(C)},[n,s,u]);const w=W(()=>{o([])},[]);return{logs:a,isPaused:s,error:d,startLiveTailing:T,stopLiveTailing:S,pauseLiveTailing:i,resumeLiveTailing:l,clearLogs:w,isLimitedLogsPerUpdate:u}},Xh=({settingsRef:t,rowsPerPage:n,handleSetRowsPerPage:r,logs:a,isPaused:o,handleResumeLiveTailing:s,pauseLiveTailing:i,clearLogs:l,isRawJsonView:c,onRawJsonViewChange:d})=>{const m=q(null),{value:u,setFalse:h,setTrue:p}=ae(!1),v=W(()=>a.map(({_log_id:b,...f})=>f),[a]);return t.current?pt(e("div",{className:"vm-live-tailing-view__settings",children:[e(Za,{limit:n,onChange:r,onOpenSelect:i}),e("div",{className:"vm-live-tailing-view__settings-buttons",children:[a.length>0&&e(cr,{getLogs:v}),o?e(j,{title:"Resume live tailing",children:e(D,{variant:"text",color:"primary",onClick:s,startIcon:e(hn,{}),ariaLabel:"Resume live tailing"})}):e(j,{title:"Pause live tailing",children:e(D,{variant:"text",color:"primary",onClick:i,startIcon:e(Ss,{}),ariaLabel:"Pause live tailing"})}),e(j,{title:"Clear logs",children:e(D,{variant:"text",color:"secondary",onClick:l,startIcon:e(gn,{}),ariaLabel:"Clear logs"})}),e(j,{title:"Settings",children:e(D,{ref:m,variant:"text",color:"secondary",onClick:p,startIcon:e(Ze,{}),ariaLabel:"Settings"})}),u&&e(Me,{onClose:h,title:"Live tailing settings",children:e("div",{className:"vm-live-tailing-view__settings-modal",children:e("div",{className:"vm-live-tailing-view__settings-modal-item",children:[e(_e,{label:"Raw JSON View",value:c,onChange:d}),e("span",{className:"vm-group-logs-configurator-item__info",children:"When this option is enabled, logs will be displayed in raw JSON format. This improves performance and uses less CPU and memory."})]})})})]})]}),t.current):null},ep=({className:t})=>{const[n,r]=N(!1),a=()=>{const s=window.pageYOffset||document.documentElement.scrollTop,i=window.innerHeight;r(s>i)},o=W(()=>{window.scrollTo({top:0,behavior:"smooth"})},[]);return A(()=>(window.addEventListener("scroll",a),a(),()=>{window.removeEventListener("scroll",a)}),[]),e("div",{className:I({"vm-scroll-to-top-button":!0,"vm-scroll-to-top-button_visible":n},t),children:e(j,{title:"Scroll to top",children:e(D,{variant:"contained",color:"primary",onClick:o,ariaLabel:"Scroll to top",startIcon:e(ks,{})})})})},tp=100,np=()=>window.scrollTo({top:document.documentElement.scrollHeight,behavior:"smooth"}),Vo=Gi(np,200),rp=({settingsRef:t})=>{const n=q(null),[r,a]=N(!0),[o]=oe(),{setSearchParamsFromKeys:s}=rt(),[i,l]=Se(100,"rows_per_page"),[c,d]=Se("*","query"),[m,u]=lr("RAW_JSON_LIVE_VIEW"),{logs:h,isPaused:p,error:v,startLiveTailing:b,stopLiveTailing:f,pauseLiveTailing:g,resumeLiveTailing:_,clearLogs:y,isLimitedLogsPerUpdate:S}=Zh(c,i),T=o.get(ke.DISPLAY_FIELDS)||tn,w=M(()=>T.split(","),[T]),C=W(()=>{Vo(),_()},[_]),k=W(L=>{s({rows_per_page:L})},[l,s]);return A(()=>(b(),()=>f()),[b,f]),A(()=>{if(!n.current)return;let x=[];const E=()=>{const{scrollTop:P,scrollHeight:F,clientHeight:O}=document.documentElement,H=Math.abs(F-P-O)<tp;a(H),x.push(P),x=x.slice(-3);const z=Yc(x);!H&&!p&&z&&g()};return document.addEventListener("scroll",E),()=>document.removeEventListener("scroll",E)},[p,g,_]),A(()=>{r&&!p&&Vo()},[h,r]),A(()=>{C()},[i]),v?e("div",{className:"vm-live-tailing-view__error",children:v}):e(V,{children:[e(Xh,{settingsRef:t,rowsPerPage:i,handleSetRowsPerPage:k,logs:h,isPaused:p,handleResumeLiveTailing:C,pauseLiveTailing:g,clearLogs:y,isRawJsonView:m,onRawJsonViewChange:u}),e(ep,{}),e("div",{ref:n,className:"vm-live-tailing-view__container",children:h.length===0?e("div",{className:"vm-live-tailing-view__empty",children:"Waiting for logs..."}):e("div",{className:"vm-live-tailing-view__logs",children:h.map(({_log_id:L,...x},E)=>m?e("pre",{className:"vm-live-tailing-view__log-row",onMouseDown:g,children:JSON.stringify(x)},E):e(Ei,{log:x,onItemClick:g,hideGroupButton:!0,displayFields:w},L))})}),S&&e(le,{variant:"warning",children:"Too many logs per second detected. Large volumes of log data are difficult to process and may impact performance. We recommend adding filters to your query for better analysis and system performance."})]})},qo=[{label:"Group",value:"group",icon:e(bs,{}),Component:Fh},{label:"Table",value:"table",icon:e(pn,{}),Component:Uh},{label:"JSON",value:"json",icon:e(It,{}),Component:Qh},{label:"Live",value:"liveTailing",icon:e(nt,{}),Component:rp}],ap=({data:t,isLoading:n})=>{var d;const{isMobile:r}=J(),{setSearchParamsFromKeys:a}=rt(),[o,s]=Se("group","view"),i=q(null),l=m=>{s(m),a({view:m})},c=(d=qo.find(m=>m.value===o))==null?void 0:d.Component;return e("div",{className:I({"vm-explore-logs-body":!0,"vm-block":!0,"vm-block_mobile":r}),children:[n&&e(er,{}),e("div",{className:I({"vm-explore-logs-body-header":!0,"vm-section-header":!0,"vm-explore-logs-body-header_mobile":r}),children:[e("div",{className:I({"vm-section-header__tabs":!0,"vm-explore-logs-body-header__tabs_mobile":r}),children:[e(Yt,{activeItem:String(o),items:qo,onChange:l}),o!=="liveTailing"&&e("div",{className:"vm-explore-logs-body-header__log-info",children:["Total logs returned: ",e("b",{children:t.length})]})]}),e("div",{className:"vm-explore-logs-body-header__settings",ref:i})]}),e("div",{className:I({"vm-explore-logs-body__table":!0,"vm-explore-logs-body__table_mobile":r}),children:c&&e(c,{data:t,settingsRef:i})})]})},op=t=>`${t}/select/logsql/query`,sp=t=>`${t}/select/logsql/hits`,ip=(t,n,r)=>{const a=dr(),[o,s]=N([]),[i,l]=N({}),[c,d]=N(),m=q(new AbortController),u=M(()=>op(t),[t]),h=(v,b,f,g)=>({signal:g,method:"POST",headers:{...a,Accept:"application/stream+json"},body:new URLSearchParams({query:v.trim(),limit:`${f}`,start:U(b.start*1e3).tz().toISOString(),end:U(b.end*1e3).tz().toISOString()})}),p=W(async v=>{m.current.abort(),m.current=new AbortController;const{signal:b}=m.current,f=Date.now();l(g=>({...g,[f]:!0})),d(void 0);try{const g=h(n,v,r,b),_=await fetch(u,g),y=await _.text();if(!_.ok||!_.body)return d(y),s([]),!1;const S=y.split(`
`,r).map(lp).filter(T=>T);return s(S),!0}catch(g){return g instanceof Error&&g.name!=="AbortError"&&(d(String(g)),console.error(g),s([])),!1}finally{l(g=>{const{[f]:_,...y}=g;return y})}},[u,n,r,a]);return A(()=>()=>{m.current.abort()},[]),{logs:o,isLoading:Object.values(i).some(v=>v),error:c,fetchLogs:p,abortController:m.current}},lp=t=>{try{return t&&JSON.parse(t)}catch(n){return console.error(`Failed to parse "${t}" to JSON
`,n),null}};var Ke=(t=>(t.Filter="Filter",t.Pipe="Pipe",t.Operator="Operator",t.FilterOrPipe="FilterOrPipe",t))(Ke||{}),de=(t=>(t.FilterName="FilterName",t.FilterUnknown="FilterUnknown",t.FilterValue="FilterValue",t.PipeName="Pipes",t.PipeValue="PipeValue",t.Unknown="Unknown",t.FilterOrPipeName="FilterOrPipeName",t))(de||{});const cp="https://docs.victoriametrics.com/victorialogs/logsql",dp="vm-link vm-link_colored",mp=t=>{const n=`$1 target="_blank" class="${dp}" $2`,r=`$1 $2${cp}#`;return t.replace(/(<a) (href=")#/gm,r).replace(/(<a) (href="[^"]+")/gm,n)},$r=[{value:"copy",description:'<a href="#copy-pipe"><code>copy</code></a> copies <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log fields</a>.'},{value:"delete",description:'<a href="#delete-pipe"><code>delete</code></a> deletes <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log fields</a>.'},{value:"drop_empty_fields",description:'<a href="#drop_empty_fields-pipe"><code>drop_empty_fields</code></a> drops <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log fields</a> with empty values.'},{value:"extract",description:'<a href="#extract-pipe"><code>extract</code></a> extracts the specified text into the given log fields.'},{value:"extract_regexp",description:'<a href="#extract_regexp-pipe"><code>extract_regexp</code></a> extracts the specified text into the given log fields via <a href="https://github.com/google/re2/wiki/Syntax" rel="external" target="_blank">RE2 regular expressions</a>.'},{value:"field_names",description:'<a href="#field_names-pipe"><code>field_names</code></a> returns all the names of <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log fields</a>.'},{value:"field_values",description:'<a href="#field_values-pipe"><code>field_values</code></a> returns all the values for the given <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log field</a>.'},{value:"fields",description:'<a href="#fields-pipe"><code>fields</code></a> selects the given set of <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log fields</a>.'},{value:"filter",description:'<a href="#filter-pipe"><code>filter</code></a> applies additional <a href="#filters">filters</a> to results.'},{value:"format",description:'<a href="#format-pipe"><code>format</code></a> formats output field from input <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log fields</a>.'},{value:"limit",description:'<a href="#limit-pipe"><code>limit</code></a> limits the number selected logs.'},{value:"math",description:'<a href="#math-pipe"><code>math</code></a> performs mathematical calculations over <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log fields</a>.'},{value:"offset",description:'<a href="#offset-pipe"><code>offset</code></a> skips the given number of selected logs.'},{value:"pack_json",description:'<a href="#pack_json-pipe"><code>pack_json</code></a> packs <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log fields</a> into JSON object.'},{value:"pack_logfmt",description:'<a href="#pack_logfmt-pipe"><code>pack_logfmt</code></a> packs <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log fields</a> into <a href="https://brandur.org/logfmt" rel="external" target="_blank">logfmt</a> message.'},{value:"rename",description:'<a href="#rename-pipe"><code>rename</code></a> renames <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log fields</a>.'},{value:"replace",description:'<a href="#replace-pipe"><code>replace</code></a> replaces substrings in the specified <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log fields</a>.'},{value:"replace_regexp",description:'<a href="#replace_regexp-pipe"><code>replace_regexp</code></a> updates <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log fields</a> with regular expressions.'},{value:"sort",description:'<a href="#sort-pipe"><code>sort</code></a> sorts logs by the given <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">fields</a>.'},{value:"stats",description:'<a href="#stats-pipe"><code>stats</code></a> calculates various stats over the selected logs.'},{value:"stream_context",description:`<a href="#stream_context-pipe"><code>stream_context</code></a> allows selecting surrounding logs in front and after the matching logs
per each <a href="/victorialogs/keyconcepts/#stream-fields">log stream</a>.`},{value:"top",description:'<a href="#top-pipe"><code>top</code></a> returns top <code>N</code> field sets with the maximum number of matching logs.'},{value:"uniq",description:'<a href="#uniq-pipe"><code>uniq</code></a> returns unique log entries.'},{value:"unpack_json",description:'<a href="#unpack_json-pipe"><code>unpack_json</code></a> unpacks JSON messages from <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log fields</a>.'},{value:"unpack_logfmt",description:'<a href="#unpack_logfmt-pipe"><code>unpack_logfmt</code></a> unpacks <a href="https://brandur.org/logfmt" rel="external" target="_blank">logfmt</a> messages from <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log fields</a>.'},{value:"unpack_syslog",description:'<a href="#unpack_syslog-pipe"><code>unpack_syslog</code></a> unpacks <a href="https://en.wikipedia.org/wiki/Syslog" rel="external" target="_blank">syslog</a> messages from <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log fields</a>.'},{value:"unroll",description:'<a href="#unroll-pipe"><code>unroll</code></a> unrolls JSON arrays from <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log fields</a>.'}].map(t=>({...t,type:de.PipeName,icon:e(an,{}),description:mp(t.description)})),up=["AND","OR","NOT"],hp=$r.map(t=>t.value),pp=t=>{var v,b;const n=t,r=[];let a="",o,s=!1;const i=["'",'"',"`"];let l=!1,c="";const d=["(","[","{"],m=[")","]","}"],u=[...d,...m];let h=0,p=0;for(let f=0;f<n.length;f++){const g=n[f];if(i.includes(g)){const _=l&&g===c;l=!_,c=_?"":g}if(!l&&u.includes(g)){const _=d.includes(g)?1:-1;h+=_}if(!l&&!h&&g==="|"){s=!0;const _=((v=a.match(/^ */))==null?void 0:v[0].length)||0,y=((b=a.match(/ *$/))==null?void 0:b[0].length)||0;Ar(a,!0,[p+_,f-y-1],r,o),a="",o="|",p=f+1;continue}if(!s&&!l&&!h&&g===" "){const _=n.slice(f).replace(/^\s*/,""),y=n.slice(0,f).replace(/\s*$/,"");if(!_.startsWith(":")&&!y.endsWith(":")){Ar(a,!1,[p,f-1],r,o),o=" ",a="",p=f+1;continue}}a+=g}return Ar(a,s,[p,n.length],r,o),r},Ar=(t,n,r,a,o)=>{const s=t.trim();if(!s)return;const i=up.includes(s.toUpperCase()),l=[Ke.Pipe,Ke.FilterOrPipe],c=a.length>0&&l.includes(a[a.length-1].type),d=()=>c?Ke.FilterOrPipe:n?Ke.Pipe:i?Ke.Operator:Ke.Filter;a.push({id:a.length,value:s,position:r,type:d(),separator:o})},gp=(t,n)=>{const r=t.value.substring(0,n),a=t.value.substring(n),o={valueBeforeCursor:r,valueAfterCursor:a,valueContext:t.value,contextType:de.Unknown};return fp(t,r,a,o),o.valueContext=o.valueContext.replace(/^["']|["']$/g,""),o},Ri=t=>hp.some(n=>t.startsWith(n)),vp=(t,n)=>!t.includes(":")&&!n.includes(":"),$i=(t,n)=>{const[r,...a]=t.split(":");n.contextType=de.FilterValue,n.filterName=r;const s=["=","-","!","~","<",">","<=",">="].find(i=>i===a[0]);s?(n.valueContext=a.slice(1).join(":"),n.operator=`:${s}`):(n.valueContext=a.join(":"),n.operator=":")},fp=(t,n,r,a)=>{switch(t.type){case Ke.Filter:_p(n,r,a);break;case Ke.Pipe:a.contextType=Ri(t.value)?de.PipeValue:de.PipeName;break;case Ke.FilterOrPipe:bp(t.value,n,a);break}},_p=(t,n,r)=>{vp(t,n)?r.contextType=de.FilterUnknown:t.includes(":")?$i(t,r):r.contextType=de.FilterName},bp=(t,n,r)=>{Ri(t)?r.contextType=de.PipeValue:n.includes(":")?$i(n,r):r.contextType=de.FilterOrPipeName},yp=t=>{if(t.includes("=")){const[n,r]=t.split("=");if(r)return`_stream:${n}=~${r}.*"}`}return"*"},Uo=(t,n)=>{const r=t.lastIndexOf(n);return r!==-1?t.slice(0,r):""},wp=t=>{let n="";return t.valueContext.includes(":")?n=Uo(t.valueContext,":"):t.valueContext.includes("-")&&(n=Uo(t.valueContext,"-")),n?`${t.filterName}:${n}`:"*"},Cp=t=>{let n="";return!t.filterName||!t.query||["_msg","_stream_id"].includes(t.filterName)?n="*":t.filterName==="_stream"?n=yp(t.valueContext):t.filterName==="_time"?n=wp(t):n=`${t.filterName}:${t.valueContext}*`,t.queryBeforeIncompleteFilter?`${t.queryBeforeIncompleteFilter}${t.separator??" "}${n}`:n},Np={[de.FilterName]:e(Fn,{}),[de.FilterUnknown]:e(Fn,{}),[de.FilterValue]:e(zn,{}),[de.PipeName]:e(an,{}),[de.PipeValue]:e(da,{}),[de.Unknown]:e(zn,{}),[de.FilterOrPipeName]:e(an,{})},Sp=t=>{const{serverUrl:n}=se(),{period:{start:r,end:a}}=ge(),{autocompleteCache:o}=ya(),s=Is(),i=dr(),[l,c]=N(!1),[d,m]=N([]),[u,h]=N([]),p=q(new AbortController),v=W(g=>{const _=U(r*1e3).startOf("day").valueOf()/1e3,y=U(a*1e3).endOf("day").valueOf()/1e3;return new URLSearchParams({...g||{},limit:`${Tt.queryLimit}`,start:`${_}`,end:`${y}`})},[r,a]),b=(g,_)=>g.map(y=>({value:y.value,type:`${_}`,icon:Np[_]})),f=async({urlSuffix:g,setter:_,params:y})=>{p.current.abort(),p.current=new AbortController;const{signal:S}=p.current,T=new URLSearchParams(i).toString(),w=`${g}?${y==null?void 0:y.toString()}&${T}`;c(!0);try{const C=o.get(w);if(C){_(C),c(!1);return}const k=await fetch(`${n}/select/logsql/${g}?${y}`,{signal:S,headers:{...i}});if(k.ok){const L=await k.json(),x=(L==null?void 0:L.values)||[];_(x||[]),s({type:"SET_AUTOCOMPLETE_CACHE",payload:{key:w,value:x}})}c(!1)}catch(C){C instanceof Error&&C.name!=="AbortError"&&(s({type:"SET_AUTOCOMPLETE_CACHE",payload:{key:w,value:[]}}),c(!1),console.error(C))}};return A(()=>{const _=![de.FilterName,de.FilterUnknown,de.FilterOrPipeName].includes((t==null?void 0:t.contextType)||de.Unknown);return!n||_?void 0:(m([]),f({urlSuffix:"field_names",setter:S=>{m(b(S,de.FilterName))},params:v({query:(t==null?void 0:t.queryBeforeIncompleteFilter)||"*"})}),()=>{var S;return(S=p.current)==null?void 0:S.abort()})},[n,t]),A(()=>{const g=(t==null?void 0:t.contextType)!==de.FilterValue;return!n||g||!(t!=null&&t.filterName)?void 0:(h([]),f({urlSuffix:"field_values",setter:y=>{h(b(y,de.FilterValue))},params:v({query:Cp(t),field:t.filterName})}),()=>{var y;return(y=p.current)==null?void 0:y.abort()})},[n,t]),{fieldNames:d,fieldValues:u,loading:l}},kp=({value:t,anchorEl:n,caretPosition:r,hasHelperText:a,onSelect:o,onFoundOptions:s})=>{const[i,l]=N({top:0,left:0}),c=M(()=>{if(r[0]!==r[1])return{valueBeforeCursor:t,valueAfterCursor:""};const _=t.substring(0,r[0]),y=t.substring(r[1]);return{valueBeforeCursor:_,valueAfterCursor:y}},[t,r]),d=M(()=>pp(t),[t]),m=M(()=>{if(r[0]!==r[1])return;const _=d.find(w=>r[0]>=w.position[0]&&r[0]<=w.position[1]);if(!_)return;const y=r[0]-_.position[0],S=d.find(w=>w.id===_.id-1),T=S?t.substring(0,S.position[1]+1):void 0;return{..._,queryBeforeIncompleteFilter:T,query:t,...gp(_,y)}},[d,r]),{fieldNames:u,fieldValues:h,loading:p}=Sp(m),v=M(()=>{switch(m==null?void 0:m.contextType){case de.FilterName:case de.FilterUnknown:return u;case de.FilterValue:return h;case de.PipeName:return $r;case de.FilterOrPipeName:return[...u,...$r];default:return[]}},[m,u,h]),b=(_,y,S)=>y.reduce((T,w)=>{const C=w.id===S?_:w.value,k=w.separator==="|"?" | ":" ";return`${T}${k}${C}`},"").trim(),f=(_,y,S="",T)=>{let w=_;if(T===de.FilterName)w+=":";else if(y===de.FilterValue){const C=S.startsWith("_stream:")?w:`${JSON.stringify(w)}`;w=`${(m==null?void 0:m.filterName)||""}${(m==null?void 0:m.operator)||":"}${C}`}return w},g=W((_,y)=>{const{id:S,contextType:T=de.FilterUnknown,value:w="",position:C=[0,0]}=m||{},k=f(_,T,w,y.type),L=b(k,d,S),x=d.find(F=>F.id===S),E=()=>(x==null?void 0:x.type)===Ke.FilterOrPipe||y.type===de.PipeName?1:0,P=(C[0]||1)+k.length+E();o(L,P)},[m,d]);return A(()=>{if(!n.current){l({top:0,left:0});return}const _=n.current.querySelector("textarea")||n.current,y=window.getComputedStyle(_),S=`${y.getPropertyValue("font-size")}`,T=`${y.getPropertyValue("font-family")}`,w=parseInt(`${y.getPropertyValue("line-height")}`),C=document.createElement("div");C.style.font=`${S} ${T}`,C.style.padding=y.getPropertyValue("padding"),C.style.lineHeight=`${w}px`,C.style.width=`${_.offsetWidth}px`,C.style.maxWidth=`${_.offsetWidth}px`,C.style.whiteSpace=y.getPropertyValue("white-space"),C.style.overflowWrap=y.getPropertyValue("overflow-wrap");const k=document.createElement("span");C.appendChild(document.createTextNode(c.valueBeforeCursor||"")),C.appendChild(k),C.appendChild(document.createTextNode(c.valueAfterCursor||"")),document.body.appendChild(C);const L=C.getBoundingClientRect(),x=k.getBoundingClientRect(),E=x.left-L.left,P=x.bottom-L.bottom-(a?w:0);l({top:P,left:E}),C.remove(),k.remove()},[n,r,a,c]),e(V,{children:e(Ea,{loading:p,disabledFullScreen:!0,value:(m==null?void 0:m.valueContext)||"",options:v,anchor:n,minLength:0,offset:i,onSelect:g,onFoundOptions:s,maxDisplayResults:{limit:Tt.displayResults,message:"Please, specify the query more precisely."}})})},Tp=({query:t,limit:n,error:r,isLoading:a,onChange:o,onChangeLimit:s,onRun:i})=>{const{isMobile:l}=J(),{autocomplete:c,queryHistory:d}=xe(),m=Mt(),[u,h]=N(""),[p,v]=N(n),{value:b,setValue:f}=ae(!1),g=w=>{const C=+w;v(C),isNaN(C)||C<0?h("Number must be bigger than zero"):(h(""),s(C))},_=()=>{m({type:"TOGGLE_AUTOCOMPLETE"})};A(()=>{v(n)},[n]);const y=w=>{const{values:C,index:k}=d[0],L=k+w;L<0||L>=C.length||(o(C[L]||""),m({type:"SET_QUERY_HISTORY_BY_INDEX",payload:{value:{values:C,index:L},queryNumber:0}}))},S=w=>{o(w),f(!0)},T=w=>()=>{y(w)};return A(()=>{b&&(i(),f(!1))},[t,b]),e("div",{className:I({"vm-explore-logs-header":!0,"vm-block":!0,"vm-block_mobile":l}),children:[e("div",{className:"vm-explore-logs-header-top",children:[e(Bs,{value:t,autocomplete:c,autocompleteEl:kp,onArrowUp:T(-1),onArrowDown:T(1),onEnter:i,onChange:o,label:"Log query",error:r}),e(ce,{label:"Limit entries",type:"number",value:p,error:u,onChange:g,onEnter:i})]}),e("div",{className:"vm-explore-logs-header-bottom",children:[e("div",{className:"vm-explore-logs-header-bottom-contols",children:e(_e,{label:"Autocomplete",value:c,onChange:_,fullWidth:l})}),e("div",{className:"vm-explore-logs-header-bottom-helpful",children:[e("a",{className:"vm-link vm-link_with-icon",target:"_blank",href:"https://docs.victoriametrics.com/victorialogs/logsql/",rel:"help noreferrer",children:[e(mt,{}),"Query language docs"]}),e("a",{className:"vm-link vm-link_with-icon",target:"_blank",href:"https://docs.victoriametrics.com/victorialogs/",rel:"help noreferrer",children:[e(ut,{}),"Documentation"]})]}),e("div",{className:"vm-explore-logs-header-bottom-buttons",children:[e(Qs,{handleSelectQuery:S,historyKey:"LOGS_QUERY_HISTORY"}),e("div",{className:"vm-explore-logs-header-bottom-execute",children:e(D,{startIcon:a?e(ha,{}):e(nt,{}),onClick:i,fullWidth:!0,children:e("div",{children:[e("span",{className:"vm-explore-logs-header-bottom-execute__text",children:a?"Cancel Query":"Execute Query"}),e("span",{className:"vm-explore-logs-header-bottom-execute__text_hidden",children:"Execute Query"})]})})})]})]})]})},Lp=({onChange:t})=>{const[n,r]=oe(),a=q(null),{value:o,toggle:s,setFalse:i}=ae(!1),[l,c]=Se(!1,"stacked"),[d,m]=Se("true","fill"),[u,h]=Se(!1,"hide_chart"),p=M(()=>({graphStyle:lt.BAR,stacked:l,fill:d==="true",hideChart:u}),[l,d,u]),v=g=>{m(`${g}`),n.set("fill",`${g}`),r(n)},b=g=>{c(g),g?n.set("stacked","true"):n.delete("stacked"),r(n)},f=()=>{h(g=>{const _=!g;return _?n.set("hide_chart","true"):n.delete("hide_chart"),r(n),_})};return A(()=>{t(p)},[p]),e("div",{className:"vm-bar-hits-options",children:[e(j,{title:u?"Show chart and resume hits updates":"Hide chart and pause hits updates",children:e(D,{variant:"text",color:"primary",startIcon:u?e(sa,{}):e(Vt,{}),onClick:f,ariaLabel:"settings"})}),e("div",{ref:a,children:e(j,{title:"Graph settings",children:e(D,{variant:"text",color:"primary",startIcon:e(Ze,{}),onClick:s,ariaLabel:"settings"})})}),e(Ie,{open:o,placement:"bottom-right",onClose:i,buttonRef:a,title:"Graph settings",children:e("div",{className:"vm-bar-hits-options-settings",children:[e("div",{className:"vm-bar-hits-options-settings-item",children:e(_e,{label:"Stacked",value:l,onChange:b})}),e("div",{className:"vm-bar-hits-options-settings-item",children:e(_e,{label:"Fill",value:d==="true",onChange:v})})]})})]})};function Ap(t,n){const r=[];let a=[];const o=t[0].length,s=Array(o);for(let i=0;i<o;i++)s[i]=0;for(let i=1;i<t.length;i++)r.push(n(i)?t[i]:t[i].map((l,c)=>s[c]+=+(l??0)));for(let i=1;i<t.length;i++)!n(i)&&a.push({series:[t.findIndex((l,c)=>c>i&&!n(c)),i]});return a=a.filter(i=>i.series[1]>-1),{data:[t[0]].concat(r),bands:a}}const Bo=t=>U(t*1e3).tz().format(qe),Ep=({data:t,focusDataIdx:n,uPlotInst:r})=>{const a=q(null),o=M(()=>{var p,v;const i=(r==null?void 0:r.series)||[],[l,...c]=t.map(b=>b[n]||0),d=t[0][1]-t[0][0],m=l+d,u=c.map((b,f)=>{var T;const g=i[f+1],_=(T=g==null?void 0:g.stroke)==null?void 0:T.call(g),y=g==null?void 0:g.label,S=g==null?void 0:g.show;return{label:y,stroke:_,value:b,show:S}}).filter(b=>b.value>0&&b.show).sort(Di("value"));return{point:{top:u[0]&&((p=r==null?void 0:r.valToPos)==null?void 0:p.call(r,u[0].value,"y"))||0,left:((v=r==null?void 0:r.valToPos)==null?void 0:v.call(r,l,"x"))||0},values:u,total:u.reduce((b,f)=>b+f.value,0),timestamp:`${Bo(l)} - ${Bo(m)}`}},[n,r,t]),s=M(()=>{if(!r||!o.total||!a.current)return;const{top:i,left:l}=o.point,c={left:parseFloat(r.over.style.left),top:parseFloat(r.over.style.top)},{width:d,height:m}=r.over.getBoundingClientRect(),{width:u,height:h}=a.current.getBoundingClientRect(),p=50,v=l+u>=d?u+2*p:0,b=i+h>=m?h+2*p:0,f={top:i+c.top+p-b,left:l+c.left+p-v};return f.left<0&&(f.left=20),f.top<0&&(f.top=20),f},[o,r,a.current]);return e("div",{className:I({"vm-chart-tooltip":!0,"vm-chart-tooltip_hits":!0,"vm-bar-hits-tooltip":!0,"vm-bar-hits-tooltip_visible":n!==-1&&o.values.length}),ref:a,style:s,children:[e("div",{children:o.values.map((i,l)=>e("div",{className:"vm-chart-tooltip-data",children:[e("span",{className:"vm-chart-tooltip-data__marker",style:{background:i.stroke}}),e("p",{className:"vm-bar-hits-tooltip-item",children:[e("span",{className:"vm-bar-hits-tooltip-item__label",children:i.label}),e("span",{children:i.value.toLocaleString("en-US")})]})]},l))}),o.values.length>1&&e("div",{className:"vm-chart-tooltip-data",children:[e("span",{}),e("p",{className:"vm-bar-hits-tooltip-item",children:[e("span",{className:"vm-bar-hits-tooltip-item__label",children:"Total"}),e("span",{children:o.total.toLocaleString("en-US")})]})]}),e("div",{className:"vm-chart-tooltip-header",children:e("div",{className:"vm-chart-tooltip-header__title vm-bar-hits-tooltip__date",children:o.timestamp})})]})},xp=({legend:t})=>{const n=t.total.toLocaleString("en-US"),r=Math.round(t.total/t.totalHits*100);return e("div",{className:"vm-legend-hits-menu-section",children:e("div",{className:"vm-legend-hits-menu-row",children:e("div",{className:"vm-legend-hits-menu-row__title",children:["Total: ",n," (",r,"%)"]})})})},mr=({title:t,handler:n,iconStart:r,iconEnd:a,className:o,submenu:s})=>{const i=q(null),l=q(null),c=q(null),[d,m]=N(!1),[u,h]=N(!1),[p,v]=N(!1),b=!!(s!=null&&s.length),f=()=>{h(S=>!S)},g=()=>{h(!1)},_=()=>{n&&n(),b&&f()};A(()=>{l.current&&m(l.current.scrollWidth>l.current.clientWidth)},[t,l]),A(()=>{requestAnimationFrame(()=>{if(!u||!c.current){v(!1);return}const{left:S,width:T}=c.current.getBoundingClientRect();v(S+T>window.innerWidth)})},[c,u]),_n(i,g);const y=e("div",{ref:l,className:"vm-legend-hits-menu-row__title",children:t});return e("div",{ref:i,className:I({"vm-legend-hits-menu-row":!0,"vm-legend-hits-menu-row_interactive":!!n||b,[`${o}`]:o}),onClick:_,children:[r&&e("div",{className:"vm-legend-hits-menu-row__icon",children:r}),d?e(j,{title:t,children:y}):y,a&&!b&&e("div",{className:"vm-legend-hits-menu-row__icon",children:a}),b&&e("div",{className:"vm-legend-hits-menu-row__icon vm-legend-hits-menu-row__icon_drop",children:e(Je,{})}),u&&s&&e("div",{ref:c,className:I({"vm-legend-hits-menu":!0,"vm-legend-hits-menu_submenu":!0,"vm-legend-hits-menu_submenu_left":p}),children:e("div",{className:"vm-legend-hits-menu-section",children:s.map(({icon:S,title:T,handler:w})=>e(mr,{iconStart:S,title:T,handler:w},T))})})]})},Mp=({legend:t,onApplyFilter:n,onClose:r})=>{const a=Fe(),o=()=>{n(`${Re}: ${t.label}`),r()},s=()=>{n(`(NOT ${Re}: ${t.label})`),r()},i=async()=>{await a(t.label,`${t.label} has been copied`),r()},l=[{title:`Copy ${Re} name`,icon:e(Xe,{}),handler:i},{title:`Add ${Re} to filter`,icon:e(pa,{}),handler:o},{title:`Exclude ${Re} to filter`,icon:e(ga,{}),handler:s}];return e("div",{className:"vm-legend-hits-menu-section",children:l.map(({icon:c,title:d,handler:m})=>e(mr,{iconStart:c,title:d,handler:m},d))})},Ip=({fields:t,onApplyFilter:n,onClose:r})=>{const a=Fe(),o=d=>async()=>{await a(d,`${d} has been copied`),r()},s=d=>()=>{n(d),r()},i=d=>()=>{n(`-${d}`),r()},l=d=>[{title:"Copy",icon:e(Xe,{}),handler:o(d)},{title:"Add to filter",icon:e(pa,{}),handler:s(d)},{title:"Exclude to filter",icon:e(ga,{}),handler:i(d)}],c=M(()=>t.map(d=>{const m=Pi(d);return{title:m,submenu:l(m)}}),[t]);return e("div",{className:"vm-legend-hits-menu-section",children:c==null?void 0:c.map(d=>e(mr,{...d},d.title))})},Pp=`aggregated results for fields not in the top ${pi}`,Dp=({legend:t,fields:n,onApplyFilter:r,onClose:a})=>e("div",{className:"vm-legend-hits-menu",children:[e("div",{className:"vm-legend-hits-menu-section",children:e(mr,{className:"vm-legend-hits-menu-row_info",title:t.isOther?Pp:t.label})}),!t.isOther&&e(Mp,{legend:t,onApplyFilter:r,onClose:a}),!t.isOther&&e(Ip,{fields:n,onApplyFilter:r,onClose:a}),e(xp,{legend:t})]}),Op=({legend:t,series:n,onRedrawGraph:r,onApplyFilter:a})=>{const{value:o,setTrue:s,setFalse:i}=ae(!1),l=q(null),[c,d]=N(null),m=M(()=>n.find(f=>f.label===t.label),[n]),u=M(()=>Mi(t.label),[t.label]),h=u.join(", "),p=Ld(t.total),v=f=>{if(m){if(f.metaKey||f.ctrlKey)m.show=!m.show;else{const g=n.every(_=>_===m||!_.show);n.forEach(_=>{_.show=g||_===m})}r()}},b=f=>{f.preventDefault(),d({top:f.clientY,left:f.clientX}),s()};return e("div",{ref:l,className:I({"vm-bar-hits-legend-item":!0,"vm-bar-hits-legend-item_other":t.isOther,"vm-bar-hits-legend-item_hide":!(m!=null&&m.show)}),onClick:v,onContextMenu:b,children:[e("div",{className:"vm-bar-hits-legend-item__marker",style:{backgroundColor:`${t.stroke}`}}),e("div",{className:"vm-bar-hits-legend-item__label",children:h}),e("span",{className:"vm-bar-hits-legend-item__total",children:["(",p,")"]}),e(Ie,{placement:"fixed",open:o,buttonRef:l,placementPosition:c,onClose:i,children:e(Dp,{legend:t,fields:u,onApplyFilter:a,onClose:i})})]})},Rp=({uPlotInst:t,legendDetails:n,onApplyFilter:r})=>{var c;const[a,o]=N([]),s=((c=n[0])==null?void 0:c.totalHits)||0,i=()=>t.series.filter(d=>d.scale!=="x"),l=()=>{t.redraw()};return A(()=>{t.hooks.draw||(t.hooks.draw=[]),t.hooks.draw.push(()=>{o(i())})},[t]),e("div",{className:"vm-bar-hits-legend",children:[n.map(d=>e(Op,{legend:d,series:a,onRedrawGraph:l,onApplyFilter:r},d.label)),e("div",{className:"vm-bar-hits-legend-info",children:[e("div",{children:["Total hits: ",e("b",{children:s.toLocaleString("en-US")})]}),e("div",{children:[e("code",{children:"L-Click"})," toggles visibility.",e("code",{children:"R-Click"})," opens menu."]})]})]})},$p=({graphOptions:t,logHits:n,data:r,period:a,setPeriod:o,onApplyFilter:s})=>{const[i,l]=vi(),c=q(null),[d,m]=N(),{xRange:u,setPlotScale:h}=Ua({period:a,setPeriod:o}),{onReadyChart:p,isPanning:v}=Va(h);qa({uPlotInst:d,xRange:u,setPlotScale:h});const{data:b,bands:f}=M(()=>t.stacked?Ap(r,()=>!1):{data:r,bands:[]},[t,r]),{options:g,series:_,focusDataIdx:y}=Lh({data:b,logHits:n,bands:f,xRange:u,containerSize:l,onReadyChart:p,setPlotScale:h,graphOptions:t}),S=W((w,C)=>w.map(k=>{var E;const L=xi(k);return{label:L,isOther:k._isOther,fields:k.fields,total:k.total||0,totalHits:C,stroke:(E=_.find(P=>P.label===L))==null?void 0:E.stroke}}).sort(Di("total")),[_]),T=M(()=>{const w=Ah(n);return S(n,w)},[n,S]);return A(()=>{if(!d)return;const w=new Map(d.series.map(k=>[k.label,k])),C=_.map(k=>{const L=w.get(k.label);return L?{...k,show:L.show}:k});Fa(d),ai(d,C,!0),li(d,C),d.redraw()},[_,d]),A(()=>{d&&(d.delBand(),f.forEach(w=>{d.addBand(w)}),d.redraw())},[f]),A(()=>{if(!c.current)return;const w=new jt(g,b,c.current);return m(w),()=>w.destroy()},[c.current]),A(()=>{d&&(d.scales.x.range=()=>[u.min,u.max],d.redraw())},[u]),A(()=>{d&&(d.setSize(l),d.redraw())},[l]),A(()=>{d&&(d.setData(b),d.redraw())},[b]),e(V,{children:[e("div",{className:I({"vm-bar-hits-chart":!0,"vm-bar-hits-chart_panning":v}),ref:i,children:[e("div",{className:"vm-line-chart__u-plot",ref:c}),e(Ep,{uPlotInst:d,data:r,focusDataIdx:y})]}),d&&e(Rp,{uPlotInst:d,onApplyFilter:s,legendDetails:T})]})},Fp=({logHits:t,data:n,period:r,setPeriod:a,onApplyFilter:o})=>{const[s,i]=N({graphStyle:lt.LINE_STEPPED,stacked:!1,fill:!1,hideChart:!1});return e("div",{className:I({"vm-bar-hits-chart__wrapper":!0,"vm-bar-hits-chart__wrapper_hidden":s.hideChart}),children:[!s.hideChart&&e($p,{logHits:t,data:n,period:r,setPeriod:a,onApplyFilter:o,graphOptions:s}),e(Lp,{onChange:i})]})},zp=({logHits:t,period:n,error:r,isLoading:a,onApplyFilter:o})=>{const{isMobile:s}=J(),i=Be(),[l]=oe(),c=M(()=>l.get("hide_chart"),[l]),d=(v,b)=>v.map(f=>{const g=new Map;return f.timestamps.forEach((_,y)=>{const S=U(_).unix();g.set(S,f.values[y]||null)}),b.map(_=>g.get(_)||null)}),m=W(v=>{const b=[],{start:f,end:g,step:_}=Ii(n),y=Math.ceil(f.diff(v,"milliseconds")/_);let S=v.add(y*_,"milliseconds");S.isBefore(f)&&(S=f.clone());const T=Math.floor(g.diff(S,"milliseconds")/_);for(let w=0;w<=T;w++)b.push(S.add(w*_,"milliseconds").unix());return b},[n]),u=M(()=>{if(!t.length)return[[],[]];const v=m(U(t[0].timestamps[0])),b=d(t,v);return[v,...b]},[t]),h=M(()=>{const v=u.every(g=>g.length===0),b=u[0].length===0,f=u[1].length===0;return c?"Chart hidden. Hits updates paused.":v?`No logs volume available
No volume information available for the current queries and time range.`:b?"No timestamp information available for the current queries and time range.":f?"No value information available for the current queries and time range.":""},[u,c]),p=({from:v,to:b})=>{i({type:"SET_PERIOD",payload:{from:v,to:b}})};return e("section",{className:I({"vm-explore-logs-chart":!0,"vm-block":!0,"vm-block_mobile":s}),children:[a&&e(er,{}),!r&&h&&e("div",{className:"vm-explore-logs-chart__empty",children:e(le,{variant:"info",children:h})}),r&&h&&e("div",{className:"vm-explore-logs-chart__empty",children:e(le,{variant:"error",children:r})}),u&&e(Fp,{logHits:t,data:u,period:n,setPeriod:p,onApplyFilter:o})]})},Hp=(t,n)=>{const r=dr(),[a,o]=N([]),[s,i]=N([]),[l,c]=N(),d=q(new AbortController),m=M(()=>sp(t),[t]),u=(p,v,b)=>{const{start:f,end:g,step:_}=Ii(v);return{signal:b,method:"POST",headers:{...r},body:new URLSearchParams({query:p.trim(),step:`${_}ms`,start:f.toISOString(),end:g.toISOString(),fields_limit:`${pi}`,field:Re})}},h=W(async p=>{d.current.abort(),d.current=new AbortController;const{signal:v}=d.current,b=Date.now();i(f=>({...f,[b]:!0})),c(void 0);try{const f=u(n,p,v),g=await fetch(m,f);if(!g.ok||!g.body){const S=await g.text();c(S),o([]),i(T=>({...T,[b]:!1}));return}const _=await g.json(),y=_==null?void 0:_.hits;y||c("Error: No 'hits' field in response"),o(y.map(Vp).sort(qp))}catch(f){f instanceof Error&&f.name!=="AbortError"&&(c(String(f)),console.error(f),o([]))}i(f=>({...f,[b]:!1}))},[m,n,r]);return A(()=>()=>{d.current.abort()},[]),{logHits:a,isLoading:Object.values(s).some(p=>p),error:l,fetchLogHits:h,abortController:d.current}},Vp=t=>({...t,_isOther:Rm(t.fields)}),qp=(t,n)=>t._isOther!==n._isOther?t._isOther?-1:1:n.total-t.total;function Up(t){const n=q(t);A(()=>{n.current=t},[t]),A(()=>()=>{n.current()},[])}function Bp(t,n=500,r){const a=q(t);a.current=t;const o=M(()=>{const s=ln((...l)=>a.current(...l),n,r),i=(...l)=>{s(...l)};return i.cancel=s.cancel,i.flush=s.flush,i},[n,r]);return Up(()=>{o.cancel()}),o}const jo=Number(Ae("LOGS_LIMIT")),jp=isNaN(jo)?lm:jo,Qp=()=>{const{serverUrl:t}=se(),{queryHistory:n}=xe(),r=Mt(),{duration:a,relativeTime:o,period:s}=ge(),{setSearchParamsFromKeys:i}=rt(),[l]=oe(),c=M(()=>l.get("hide_chart"),[l]),d=qt(c),[m,u]=Se(jp,"limit"),[h,p]=Se("*","query"),v=()=>{const K=is(h,n[0]);r({type:"SET_QUERY_HISTORY",payload:{key:"LOGS_QUERY_HISTORY",history:[K]}})},[b,f]=N(!1),[g,_]=N(s),[y,S]=N(""),{logs:T,isLoading:w,error:C,fetchLogs:k,abortController:L}=ip(t,h,m),{fetchLogHits:x,...E}=Hp(t,h),F=Bp((K,re)=>{k(K).then(Q=>{Q&&re&&x(K)}).catch(()=>{})},300),O=()=>{const K=nn.find(ie=>ie.id===o);if(!K)return s;const{duration:re,until:Q}=K;return Nt(re,Q())},H=()=>{if(!h){S(Ce.validQuery);return}S("");const K=O();_(K),F(K,!c),i({query:h,"g0.range_input":a,"g0.end_input":K.date,"g0.relative_time":o||"none"}),v()},z=K=>{u(K),i({limit:K}),Le("LOGS_LIMIT",`${K}`)},Y=K=>{p(re=>`${K} AND (${re})`),f(!0)},G=()=>{var K,re,Q;w||E.isLoading?((K=L.abort)==null||K.call(L),(Q=(re=E.abortController).abort)==null||Q.call(re)):H()};return A(()=>{h&&H()},[s]),A(()=>{b&&(H(),f(!1))},[h,b]),A(()=>{!c&&d&&x(g)},[c,d,g]),e("div",{className:"vm-explore-logs",children:[e(Tp,{query:h,error:y,limit:m,onChange:p,onChangeLimit:z,onRun:G,isLoading:w||E.isLoading}),C&&e(le,{variant:"error",children:C}),!C&&e(zp,{...E,query:h,period:g,onApplyFilter:Y}),e(ap,{data:T,isLoading:w})]})},Yp=()=>{const t=Ee(),{isMobile:n}=J(),r=Be(),[a,o]=oe(),[s,i]=Se("0","accountID"),[l,c]=Se("0","projectID"),d=`${s}:${l}`,m=q(null),{value:u,toggle:h,setFalse:p}=ae(!1),v=()=>{a.set("accountID",s),a.set("projectID",l),o(a),p(),r({type:"RUN_QUERY"})},b=()=>{i(a.get("accountID")||"0"),c(a.get("projectID")||"0")};return A(()=>{u||b()},[u]),e("div",{className:"vm-tenant-input",children:[e(j,{title:"Define Tenant ID if you need request to another storage",children:e("div",{ref:m,children:n?e("div",{className:"vm-mobile-option",onClick:h,children:[e("span",{className:"vm-mobile-option__icon",children:e(Lt,{})}),e("div",{className:"vm-mobile-option-text",children:[e("span",{className:"vm-mobile-option-text__label",children:"Tenant ID"}),e("span",{className:"vm-mobile-option-text__value",children:d})]}),e("span",{className:"vm-mobile-option__arrow",children:e(be,{})})]}):e(D,{className:t?"":"vm-header-button",variant:"contained",color:"primary",fullWidth:!0,startIcon:e(Lt,{}),endIcon:e("div",{className:I({"vm-execution-controls-buttons__arrow":!0,"vm-execution-controls-buttons__arrow_open":u}),children:e(be,{})}),onClick:h,children:d})})}),e(Ie,{open:u,placement:"bottom-right",onClose:p,buttonRef:m,title:n?"Define Tenant ID":void 0,children:e("div",{className:I({"vm-list vm-tenant-input-list":!0,"vm-list vm-tenant-input-list_mobile":n,"vm-tenant-input-list_inline":!0}),children:[e(ce,{autofocus:!0,label:"accountID",value:s,onChange:i,type:"number"}),e(ce,{autofocus:!0,label:"projectID",value:l,onChange:c,type:"number"}),e("div",{className:"vm-tenant-input-list__buttons",children:[e(j,{title:"Multitenancy in VictoriaLogs documentation",children:e("a",{href:"https://docs.victoriametrics.com/victorialogs/#multitenancy",target:"_blank",rel:"help noreferrer",children:e(D,{variant:"text",color:"gray",startIcon:e(la,{})})})}),e(D,{variant:"contained",color:"primary",onClick:v,children:"Apply"})]})]})})]})},Gp=({isMobile:t})=>e("div",{className:I({"vm-header-controls":!0,"vm-header-controls_mobile":t}),children:[e(Yp,{}),e(ka,{}),e(Ta,{}),e(La,{})]}),Wp=()=>{const t=Ee(),{isMobile:n}=J(),{pathname:r}=ht();return Aa(),A(()=>{var i;const o="vmui for VictoriaLogs",s=(i=gt[Z.logs])==null?void 0:i.title;document.title=`${s} - ${o}`},[r]),e("section",{className:"vm-container",children:[e(Na,{controlsComponent:Gp}),e("div",{className:I({"vm-container-body":!0,"vm-container-body_mobile":n,"vm-container-body_app":t}),children:e(Vr,{})}),!t&&e(Sa,{links:wc})]})},Jp={100:"",1234:"",grinning:"",smiley:"",smile:"",grin:"",laughing:"",satisfied:"",sweat_smile:"",rofl:"",joy:"",slightly_smiling_face:"",upside_down_face:"",melting_face:"",wink:"",blush:"",innocent:"",smiling_face_with_three_hearts:"",heart_eyes:"",star_struck:"",kissing_heart:"",kissing:"",relaxed:"",kissing_closed_eyes:"",kissing_smiling_eyes:"",smiling_face_with_tear:"",yum:"",stuck_out_tongue:"",stuck_out_tongue_winking_eye:"",zany_face:"",stuck_out_tongue_closed_eyes:"",money_mouth_face:"",hugs:"",hand_over_mouth:"",face_with_open_eyes_and_hand_over_mouth:"",face_with_peeking_eye:"",shushing_face:"",thinking:"",saluting_face:"",zipper_mouth_face:"",raised_eyebrow:"",neutral_face:"",expressionless:"",no_mouth:"",dotted_line_face:"",face_in_clouds:"",smirk:"",unamused:"",roll_eyes:"",grimacing:"",face_exhaling:"",lying_face:"",shaking_face:"",relieved:"",pensive:"",sleepy:"",drooling_face:"",sleeping:"",mask:"",face_with_thermometer:"",face_with_head_bandage:"",nauseated_face:"",vomiting_face:"",sneezing_face:"",hot_face:"",cold_face:"",woozy_face:"",dizzy_face:"",face_with_spiral_eyes:"",exploding_head:"",cowboy_hat_face:"",partying_face:"",disguised_face:"",sunglasses:"",nerd_face:"",monocle_face:"",confused:"",face_with_diagonal_mouth:"",worried:"",slightly_frowning_face:"",frowning_face:"",open_mouth:"",hushed:"",astonished:"",flushed:"",pleading_face:"",face_holding_back_tears:"",frowning:"",anguished:"",fearful:"",cold_sweat:"",disappointed_relieved:"",cry:"",sob:"",scream:"",confounded:"",persevere:"",disappointed:"",sweat:"",weary:"",tired_face:"",yawning_face:"",triumph:"",rage:"",pout:"",angry:"",cursing_face:"",smiling_imp:"",imp:"",skull:"",skull_and_crossbones:"",hankey:"",poop:"",shit:"",clown_face:"",japanese_ogre:"",japanese_goblin:"",ghost:"",alien:"",space_invader:"",robot:"",smiley_cat:"",smile_cat:"",joy_cat:"",heart_eyes_cat:"",smirk_cat:"",kissing_cat:"",scream_cat:"",crying_cat_face:"",pouting_cat:"",see_no_evil:"",hear_no_evil:"",speak_no_evil:"",love_letter:"",cupid:"",gift_heart:"",sparkling_heart:"",heartpulse:"",heartbeat:"",revolving_hearts:"",two_hearts:"",heart_decoration:"",heavy_heart_exclamation:"",broken_heart:"",heart_on_fire:"",mending_heart:"",heart:"",pink_heart:"",orange_heart:"",yellow_heart:"",green_heart:"",blue_heart:"",light_blue_heart:"",purple_heart:"",brown_heart:"",black_heart:"",grey_heart:"",white_heart:"",kiss:"",anger:"",boom:"",collision:"",dizzy:"",sweat_drops:"",dash:"",hole:"",speech_balloon:"",eye_speech_bubble:"",left_speech_bubble:"",right_anger_bubble:"",thought_balloon:"",zzz:"",wave:"",raised_back_of_hand:"",raised_hand_with_fingers_splayed:"",hand:"",raised_hand:"",vulcan_salute:"",rightwards_hand:"",leftwards_hand:"",palm_down_hand:"",palm_up_hand:"",leftwards_pushing_hand:"",rightwards_pushing_hand:"",ok_hand:"",pinched_fingers:"",pinching_hand:"",v:"",crossed_fingers:"",hand_with_index_finger_and_thumb_crossed:"",love_you_gesture:"",metal:"",call_me_hand:"",point_left:"",point_right:"",point_up_2:"",middle_finger:"",fu:"",point_down:"",point_up:"",index_pointing_at_the_viewer:"","+1":"",thumbsup:"","-1":"",thumbsdown:"",fist_raised:"",fist:"",fist_oncoming:"",facepunch:"",punch:"",fist_left:"",fist_right:"",clap:"",raised_hands:"",heart_hands:"",open_hands:"",palms_up_together:"",handshake:"",pray:"",writing_hand:"",nail_care:"",selfie:"",muscle:"",mechanical_arm:"",mechanical_leg:"",leg:"",foot:"",ear:"",ear_with_hearing_aid:"",nose:"",brain:"",anatomical_heart:"",lungs:"",tooth:"",bone:"",eyes:"",eye:"",tongue:"",lips:"",biting_lip:"",baby:"",child:"",boy:"",girl:"",adult:"",blond_haired_person:"",man:"",bearded_person:"",man_beard:"",woman_beard:"",red_haired_man:"",curly_haired_man:"",white_haired_man:"",bald_man:"",woman:"",red_haired_woman:"",person_red_hair:"",curly_haired_woman:"",person_curly_hair:"",white_haired_woman:"",person_white_hair:"",bald_woman:"",person_bald:"",blond_haired_woman:"",blonde_woman:"",blond_haired_man:"",older_adult:"",older_man:"",older_woman:"",frowning_person:"",frowning_man:"",frowning_woman:"",pouting_face:"",pouting_man:"",pouting_woman:"",no_good:"",no_good_man:"",ng_man:"",no_good_woman:"",ng_woman:"",ok_person:"",ok_man:"",ok_woman:"",tipping_hand_person:"",information_desk_person:"",tipping_hand_man:"",sassy_man:"",tipping_hand_woman:"",sassy_woman:"",raising_hand:"",raising_hand_man:"",raising_hand_woman:"",deaf_person:"",deaf_man:"",deaf_woman:"",bow:"",bowing_man:"",bowing_woman:"",facepalm:"",man_facepalming:"",woman_facepalming:"",shrug:"",man_shrugging:"",woman_shrugging:"",health_worker:"",man_health_worker:"",woman_health_worker:"",student:"",man_student:"",woman_student:"",teacher:"",man_teacher:"",woman_teacher:"",judge:"",man_judge:"",woman_judge:"",farmer:"",man_farmer:"",woman_farmer:"",cook:"",man_cook:"",woman_cook:"",mechanic:"",man_mechanic:"",woman_mechanic:"",factory_worker:"",man_factory_worker:"",woman_factory_worker:"",office_worker:"",man_office_worker:"",woman_office_worker:"",scientist:"",man_scientist:"",woman_scientist:"",technologist:"",man_technologist:"",woman_technologist:"",singer:"",man_singer:"",woman_singer:"",artist:"",man_artist:"",woman_artist:"",pilot:"",man_pilot:"",woman_pilot:"",astronaut:"",man_astronaut:"",woman_astronaut:"",firefighter:"",man_firefighter:"",woman_firefighter:"",police_officer:"",cop:"",policeman:"",policewoman:"",detective:"",male_detective:"",female_detective:"",guard:"",guardsman:"",guardswoman:"",ninja:"",construction_worker:"",construction_worker_man:"",construction_worker_woman:"",person_with_crown:"",prince:"",princess:"",person_with_turban:"",man_with_turban:"",woman_with_turban:"",man_with_gua_pi_mao:"",woman_with_headscarf:"",person_in_tuxedo:"",man_in_tuxedo:"",woman_in_tuxedo:"",person_with_veil:"",man_with_veil:"",woman_with_veil:"",bride_with_veil:"",pregnant_woman:"",pregnant_man:"",pregnant_person:"",breast_feeding:"",woman_feeding_baby:"",man_feeding_baby:"",person_feeding_baby:"",angel:"",santa:"",mrs_claus:"",mx_claus:"",superhero:"",superhero_man:"",superhero_woman:"",supervillain:"",supervillain_man:"",supervillain_woman:"",mage:"",mage_man:"",mage_woman:"",fairy:"",fairy_man:"",fairy_woman:"",vampire:"",vampire_man:"",vampire_woman:"",merperson:"",merman:"",mermaid:"",elf:"",elf_man:"",elf_woman:"",genie:"",genie_man:"",genie_woman:"",zombie:"",zombie_man:"",zombie_woman:"",troll:"",massage:"",massage_man:"",massage_woman:"",haircut:"",haircut_man:"",haircut_woman:"",walking:"",walking_man:"",walking_woman:"",standing_person:"",standing_man:"",standing_woman:"",kneeling_person:"",kneeling_man:"",kneeling_woman:"",person_with_probing_cane:"",man_with_probing_cane:"",woman_with_probing_cane:"",person_in_motorized_wheelchair:"",man_in_motorized_wheelchair:"",woman_in_motorized_wheelchair:"",person_in_manual_wheelchair:"",man_in_manual_wheelchair:"",woman_in_manual_wheelchair:"",runner:"",running:"",running_man:"",running_woman:"",woman_dancing:"",dancer:"",man_dancing:"",business_suit_levitating:"",dancers:"",dancing_men:"",dancing_women:"",sauna_person:"",sauna_man:"",sauna_woman:"",climbing:"",climbing_man:"",climbing_woman:"",person_fencing:"",horse_racing:"",skier:"",snowboarder:"",golfing:"",golfing_man:"",golfing_woman:"",surfer:"",surfing_man:"",surfing_woman:"",rowboat:"",rowing_man:"",rowing_woman:"",swimmer:"",swimming_man:"",swimming_woman:"",bouncing_ball_person:"",bouncing_ball_man:"",basketball_man:"",bouncing_ball_woman:"",basketball_woman:"",weight_lifting:"",weight_lifting_man:"",weight_lifting_woman:"",bicyclist:"",biking_man:"",biking_woman:"",mountain_bicyclist:"",mountain_biking_man:"",mountain_biking_woman:"",cartwheeling:"",man_cartwheeling:"",woman_cartwheeling:"",wrestling:"",men_wrestling:"",women_wrestling:"",water_polo:"",man_playing_water_polo:"",woman_playing_water_polo:"",handball_person:"",man_playing_handball:"",woman_playing_handball:"",juggling_person:"",man_juggling:"",woman_juggling:"",lotus_position:"",lotus_position_man:"",lotus_position_woman:"",bath:"",sleeping_bed:"",people_holding_hands:"",two_women_holding_hands:"",couple:"",two_men_holding_hands:"",couplekiss:"",couplekiss_man_woman:"",couplekiss_man_man:"",couplekiss_woman_woman:"",couple_with_heart:"",couple_with_heart_woman_man:"",couple_with_heart_man_man:"",couple_with_heart_woman_woman:"",family:"",family_man_woman_boy:"",family_man_woman_girl:"",family_man_woman_girl_boy:"",family_man_woman_boy_boy:"",family_man_woman_girl_girl:"",family_man_man_boy:"",family_man_man_girl:"",family_man_man_girl_boy:"",family_man_man_boy_boy:"",family_man_man_girl_girl:"",family_woman_woman_boy:"",family_woman_woman_girl:"",family_woman_woman_girl_boy:"",family_woman_woman_boy_boy:"",family_woman_woman_girl_girl:"",family_man_boy:"",family_man_boy_boy:"",family_man_girl:"",family_man_girl_boy:"",family_man_girl_girl:"",family_woman_boy:"",family_woman_boy_boy:"",family_woman_girl:"",family_woman_girl_boy:"",family_woman_girl_girl:"",speaking_head:"",bust_in_silhouette:"",busts_in_silhouette:"",people_hugging:"",footprints:"",monkey_face:"",monkey:"",gorilla:"",orangutan:"",dog:"",dog2:"",guide_dog:"",service_dog:"",poodle:"",wolf:"",fox_face:"",raccoon:"",cat:"",cat2:"",black_cat:"",lion:"",tiger:"",tiger2:"",leopard:"",horse:"",moose:"",donkey:"",racehorse:"",unicorn:"",zebra:"",deer:"",bison:"",cow:"",ox:"",water_buffalo:"",cow2:"",pig:"",pig2:"",boar:"",pig_nose:"",ram:"",sheep:"",goat:"",dromedary_camel:"",camel:"",llama:"",giraffe:"",elephant:"",mammoth:"",rhinoceros:"",hippopotamus:"",mouse:"",mouse2:"",rat:"",hamster:"",rabbit:"",rabbit2:"",chipmunk:"",beaver:"",hedgehog:"",bat:"",bear:"",polar_bear:"",koala:"",panda_face:"",sloth:"",otter:"",skunk:"",kangaroo:"",badger:"",feet:"",paw_prints:"",turkey:"",chicken:"",rooster:"",hatching_chick:"",baby_chick:"",hatched_chick:"",bird:"",penguin:"",dove:"",eagle:"",duck:"",swan:"",owl:"",dodo:"",feather:"",flamingo:"",peacock:"",parrot:"",wing:"",black_bird:"",goose:"",frog:"",crocodile:"",turtle:"",lizard:"",snake:"",dragon_face:"",dragon:"",sauropod:"","t-rex":"",whale:"",whale2:"",dolphin:"",flipper:"",seal:"",fish:"",tropical_fish:"",blowfish:"",shark:"",octopus:"",shell:"",coral:"",jellyfish:"",snail:"",butterfly:"",bug:"",ant:"",bee:"",honeybee:"",beetle:"",lady_beetle:"",cricket:"",cockroach:"",spider:"",spider_web:"",scorpion:"",mosquito:"",fly:"",worm:"",microbe:"",bouquet:"",cherry_blossom:"",white_flower:"",lotus:"",rosette:"",rose:"",wilted_flower:"",hibiscus:"",sunflower:"",blossom:"",tulip:"",hyacinth:"",seedling:"",potted_plant:"",evergreen_tree:"",deciduous_tree:"",palm_tree:"",cactus:"",ear_of_rice:"",herb:"",shamrock:"",four_leaf_clover:"",maple_leaf:"",fallen_leaf:"",leaves:"",empty_nest:"",nest_with_eggs:"",mushroom:"",grapes:"",melon:"",watermelon:"",tangerine:"",orange:"",mandarin:"",lemon:"",banana:"",pineapple:"",mango:"",apple:"",green_apple:"",pear:"",peach:"",cherries:"",strawberry:"",blueberries:"",kiwi_fruit:"",tomato:"",olive:"",coconut:"",avocado:"",eggplant:"",potato:"",carrot:"",corn:"",hot_pepper:"",bell_pepper:"",cucumber:"",leafy_green:"",broccoli:"",garlic:"",onion:"",peanuts:"",beans:"",chestnut:"",ginger_root:"",pea_pod:"",bread:"",croissant:"",baguette_bread:"",flatbread:"",pretzel:"",bagel:"",pancakes:"",waffle:"",cheese:"",meat_on_bone:"",poultry_leg:"",cut_of_meat:"",bacon:"",hamburger:"",fries:"",pizza:"",hotdog:"",sandwich:"",taco:"",burrito:"",tamale:"",stuffed_flatbread:"",falafel:"",egg:"",fried_egg:"",shallow_pan_of_food:"",stew:"",fondue:"",bowl_with_spoon:"",green_salad:"",popcorn:"",butter:"",salt:"",canned_food:"",bento:"",rice_cracker:"",rice_ball:"",rice:"",curry:"",ramen:"",spaghetti:"",sweet_potato:"",oden:"",sushi:"",fried_shrimp:"",fish_cake:"",moon_cake:"",dango:"",dumpling:"",fortune_cookie:"",takeout_box:"",crab:"",lobster:"",shrimp:"",squid:"",oyster:"",icecream:"",shaved_ice:"",ice_cream:"",doughnut:"",cookie:"",birthday:"",cake:"",cupcake:"",pie:"",chocolate_bar:"",candy:"",lollipop:"",custard:"",honey_pot:"",baby_bottle:"",milk_glass:"",coffee:"",teapot:"",tea:"",sake:"",champagne:"",wine_glass:"",cocktail:"",tropical_drink:"",beer:"",beers:"",clinking_glasses:"",tumbler_glass:"",pouring_liquid:"",cup_with_straw:"",bubble_tea:"",beverage_box:"",mate:"",ice_cube:"",chopsticks:"",plate_with_cutlery:"",fork_and_knife:"",spoon:"",hocho:"",knife:"",jar:"",amphora:"",earth_africa:"",earth_americas:"",earth_asia:"",globe_with_meridians:"",world_map:"",japan:"",compass:"",mountain_snow:"",mountain:"",volcano:"",mount_fuji:"",camping:"",beach_umbrella:"",desert:"",desert_island:"",national_park:"",stadium:"",classical_building:"",building_construction:"",bricks:"",rock:"",wood:"",hut:"",houses:"",derelict_house:"",house:"",house_with_garden:"",office:"",post_office:"",european_post_office:"",hospital:"",bank:"",hotel:"",love_hotel:"",convenience_store:"",school:"",department_store:"",factory:"",japanese_castle:"",european_castle:"",wedding:"",tokyo_tower:"",statue_of_liberty:"",church:"",mosque:"",hindu_temple:"",synagogue:"",shinto_shrine:"",kaaba:"",fountain:"",tent:"",foggy:"",night_with_stars:"",cityscape:"",sunrise_over_mountains:"",sunrise:"",city_sunset:"",city_sunrise:"",bridge_at_night:"",hotsprings:"",carousel_horse:"",playground_slide:"",ferris_wheel:"",roller_coaster:"",barber:"",circus_tent:"",steam_locomotive:"",railway_car:"",bullettrain_side:"",bullettrain_front:"",train2:"",metro:"",light_rail:"",station:"",tram:"",monorail:"",mountain_railway:"",train:"",bus:"",oncoming_bus:"",trolleybus:"",minibus:"",ambulance:"",fire_engine:"",police_car:"",oncoming_police_car:"",taxi:"",oncoming_taxi:"",car:"",red_car:"",oncoming_automobile:"",blue_car:"",pickup_truck:"",truck:"",articulated_lorry:"",tractor:"",racing_car:"",motorcycle:"",motor_scooter:"",manual_wheelchair:"",motorized_wheelchair:"",auto_rickshaw:"",bike:"",kick_scooter:"",skateboard:"",roller_skate:"",busstop:"",motorway:"",railway_track:"",oil_drum:"",fuelpump:"",wheel:"",rotating_light:"",traffic_light:"",vertical_traffic_light:"",stop_sign:"",construction:"",anchor:"",ring_buoy:"",boat:"",sailboat:"",canoe:"",speedboat:"",passenger_ship:"",ferry:"",motor_boat:"",ship:"",airplane:"",small_airplane:"",flight_departure:"",flight_arrival:"",parachute:"",seat:"",helicopter:"",suspension_railway:"",mountain_cableway:"",aerial_tramway:"",artificial_satellite:"",rocket:"",flying_saucer:"",bellhop_bell:"",luggage:"",hourglass:"",hourglass_flowing_sand:"",watch:"",alarm_clock:"",stopwatch:"",timer_clock:"",mantelpiece_clock:"",clock12:"",clock1230:"",clock1:"",clock130:"",clock2:"",clock230:"",clock3:"",clock330:"",clock4:"",clock430:"",clock5:"",clock530:"",clock6:"",clock630:"",clock7:"",clock730:"",clock8:"",clock830:"",clock9:"",clock930:"",clock10:"",clock1030:"",clock11:"",clock1130:"",new_moon:"",waxing_crescent_moon:"",first_quarter_moon:"",moon:"",waxing_gibbous_moon:"",full_moon:"",waning_gibbous_moon:"",last_quarter_moon:"",waning_crescent_moon:"",crescent_moon:"",new_moon_with_face:"",first_quarter_moon_with_face:"",last_quarter_moon_with_face:"",thermometer:"",sunny:"",full_moon_with_face:"",sun_with_face:"",ringed_planet:"",star:"",star2:"",stars:"",milky_way:"",cloud:"",partly_sunny:"",cloud_with_lightning_and_rain:"",sun_behind_small_cloud:"",sun_behind_large_cloud:"",sun_behind_rain_cloud:"",cloud_with_rain:"",cloud_with_snow:"",cloud_with_lightning:"",tornado:"",fog:"",wind_face:"",cyclone:"",rainbow:"",closed_umbrella:"",open_umbrella:"",umbrella:"",parasol_on_ground:"",zap:"",snowflake:"",snowman_with_snow:"",snowman:"",comet:"",fire:"",droplet:"",ocean:"",jack_o_lantern:"",christmas_tree:"",fireworks:"",sparkler:"",firecracker:"",sparkles:"",balloon:"",tada:"",confetti_ball:"",tanabata_tree:"",bamboo:"",dolls:"",flags:"",wind_chime:"",rice_scene:"",red_envelope:"",ribbon:"",gift:"",reminder_ribbon:"",tickets:"",ticket:"",medal_military:"",trophy:"",medal_sports:"","1st_place_medal":"","2nd_place_medal":"","3rd_place_medal":"",soccer:"",baseball:"",softball:"",basketball:"",volleyball:"",football:"",rugby_football:"",tennis:"",flying_disc:"",bowling:"",cricket_game:"",field_hockey:"",ice_hockey:"",lacrosse:"",ping_pong:"",badminton:"",boxing_glove:"",martial_arts_uniform:"",goal_net:"",golf:"",ice_skate:"",fishing_pole_and_fish:"",diving_mask:"",running_shirt_with_sash:"",ski:"",sled:"",curling_stone:"",dart:"",yo_yo:"",kite:"",gun:"","8ball":"",crystal_ball:"",magic_wand:"",video_game:"",joystick:"",slot_machine:"",game_die:"",jigsaw:"",teddy_bear:"",pinata:"",mirror_ball:"",nesting_dolls:"",spades:"",hearts:"",diamonds:"",clubs:"",chess_pawn:"",black_joker:"",mahjong:"",flower_playing_cards:"",performing_arts:"",framed_picture:"",art:"",thread:"",sewing_needle:"",yarn:"",knot:"",eyeglasses:"",dark_sunglasses:"",goggles:"",lab_coat:"",safety_vest:"",necktie:"",shirt:"",tshirt:"",jeans:"",scarf:"",gloves:"",coat:"",socks:"",dress:"",kimono:"",sari:"",one_piece_swimsuit:"",swim_brief:"",shorts:"",bikini:"",womans_clothes:"",folding_hand_fan:"",purse:"",handbag:"",pouch:"",shopping:"",school_satchel:"",thong_sandal:"",mans_shoe:"",shoe:"",athletic_shoe:"",hiking_boot:"",flat_shoe:"",high_heel:"",sandal:"",ballet_shoes:"",boot:"",hair_pick:"",crown:"",womans_hat:"",tophat:"",mortar_board:"",billed_cap:"",military_helmet:"",rescue_worker_helmet:"",prayer_beads:"",lipstick:"",ring:"",gem:"",mute:"",speaker:"",sound:"",loud_sound:"",loudspeaker:"",mega:"",postal_horn:"",bell:"",no_bell:"",musical_score:"",musical_note:"",notes:"",studio_microphone:"",level_slider:"",control_knobs:"",microphone:"",headphones:"",radio:"",saxophone:"",accordion:"",guitar:"",musical_keyboard:"",trumpet:"",violin:"",banjo:"",drum:"",long_drum:"",maracas:"",flute:"",iphone:"",calling:"",phone:"",telephone:"",telephone_receiver:"",pager:"",fax:"",battery:"",low_battery:"",electric_plug:"",computer:"",desktop_computer:"",printer:"",keyboard:"",computer_mouse:"",trackball:"",minidisc:"",floppy_disk:"",cd:"",dvd:"",abacus:"",movie_camera:"",film_strip:"",film_projector:"",clapper:"",tv:"",camera:"",camera_flash:"",video_camera:"",vhs:"",mag:"",mag_right:"",candle:"",bulb:"",flashlight:"",izakaya_lantern:"",lantern:"",diya_lamp:"",notebook_with_decorative_cover:"",closed_book:"",book:"",open_book:"",green_book:"",blue_book:"",orange_book:"",books:"",notebook:"",ledger:"",page_with_curl:"",scroll:"",page_facing_up:"",newspaper:"",newspaper_roll:"",bookmark_tabs:"",bookmark:"",label:"",moneybag:"",coin:"",yen:"",dollar:"",euro:"",pound:"",money_with_wings:"",credit_card:"",receipt:"",chart:"",envelope:"",email:"","e-mail":"",incoming_envelope:"",envelope_with_arrow:"",outbox_tray:"",inbox_tray:"",package:"",mailbox:"",mailbox_closed:"",mailbox_with_mail:"",mailbox_with_no_mail:"",postbox:"",ballot_box:"",pencil2:"",black_nib:"",fountain_pen:"",pen:"",paintbrush:"",crayon:"",memo:"",pencil:"",briefcase:"",file_folder:"",open_file_folder:"",card_index_dividers:"",date:"",calendar:"",spiral_notepad:"",spiral_calendar:"",card_index:"",chart_with_upwards_trend:"",chart_with_downwards_trend:"",bar_chart:"",clipboard:"",pushpin:"",round_pushpin:"",paperclip:"",paperclips:"",straight_ruler:"",triangular_ruler:"",scissors:"",card_file_box:"",file_cabinet:"",wastebasket:"",lock:"",unlock:"",lock_with_ink_pen:"",closed_lock_with_key:"",key:"",old_key:"",hammer:"",axe:"",pick:"",hammer_and_pick:"",hammer_and_wrench:"",dagger:"",crossed_swords:"",bomb:"",boomerang:"",bow_and_arrow:"",shield:"",carpentry_saw:"",wrench:"",screwdriver:"",nut_and_bolt:"",gear:"",clamp:"",balance_scale:"",probing_cane:"",link:"",chains:"",hook:"",toolbox:"",magnet:"",ladder:"",alembic:"",test_tube:"",petri_dish:"",dna:"",microscope:"",telescope:"",satellite:"",syringe:"",drop_of_blood:"",pill:"",adhesive_bandage:"",crutch:"",stethoscope:"",x_ray:"",door:"",elevator:"",mirror:"",window:"",bed:"",couch_and_lamp:"",chair:"",toilet:"",plunger:"",shower:"",bathtub:"",mouse_trap:"",razor:"",lotion_bottle:"",safety_pin:"",broom:"",basket:"",roll_of_paper:"",bucket:"",soap:"",bubbles:"",toothbrush:"",sponge:"",fire_extinguisher:"",shopping_cart:"",smoking:"",coffin:"",headstone:"",funeral_urn:"",nazar_amulet:"",hamsa:"",moyai:"",placard:"",identification_card:"",atm:"",put_litter_in_its_place:"",potable_water:"",wheelchair:"",men:"",women:"",restroom:"",baby_symbol:"",wc:"",passport_control:"",customs:"",baggage_claim:"",left_luggage:"",warning:"",children_crossing:"",no_entry:"",no_entry_sign:"",no_bicycles:"",no_smoking:"",do_not_litter:"","non-potable_water":"",no_pedestrians:"",no_mobile_phones:"",underage:"",radioactive:"",biohazard:"",arrow_up:"",arrow_upper_right:"",arrow_right:"",arrow_lower_right:"",arrow_down:"",arrow_lower_left:"",arrow_left:"",arrow_upper_left:"",arrow_up_down:"",left_right_arrow:"",leftwards_arrow_with_hook:"",arrow_right_hook:"",arrow_heading_up:"",arrow_heading_down:"",arrows_clockwise:"",arrows_counterclockwise:"",back:"",end:"",on:"",soon:"",top:"",place_of_worship:"",atom_symbol:"",om:"",star_of_david:"",wheel_of_dharma:"",yin_yang:"",latin_cross:"",orthodox_cross:"",star_and_crescent:"",peace_symbol:"",menorah:"",six_pointed_star:"",khanda:"",aries:"",taurus:"",gemini:"",cancer:"",leo:"",virgo:"",libra:"",scorpius:"",sagittarius:"",capricorn:"",aquarius:"",pisces:"",ophiuchus:"",twisted_rightwards_arrows:"",repeat:"",repeat_one:"",arrow_forward:"",fast_forward:"",next_track_button:"",play_or_pause_button:"",arrow_backward:"",rewind:"",previous_track_button:"",arrow_up_small:"",arrow_double_up:"",arrow_down_small:"",arrow_double_down:"",pause_button:"",stop_button:"",record_button:"",eject_button:"",cinema:"",low_brightness:"",high_brightness:"",signal_strength:"",wireless:"",vibration_mode:"",mobile_phone_off:"",female_sign:"",male_sign:"",transgender_symbol:"",heavy_multiplication_x:"",heavy_plus_sign:"",heavy_minus_sign:"",heavy_division_sign:"",heavy_equals_sign:"",infinity:"",bangbang:"",interrobang:"",question:"",grey_question:"",grey_exclamation:"",exclamation:"",heavy_exclamation_mark:"",wavy_dash:"",currency_exchange:"",heavy_dollar_sign:"",medical_symbol:"",recycle:"",fleur_de_lis:"",trident:"",name_badge:"",beginner:"",o:"",white_check_mark:"",ballot_box_with_check:"",heavy_check_mark:"",x:"",negative_squared_cross_mark:"",curly_loop:"",loop:"",part_alternation_mark:"",eight_spoked_asterisk:"",eight_pointed_black_star:"",sparkle:"",copyright:"",registered:"",tm:"",hash:"#",asterisk:"*",zero:"0",one:"1",two:"2",three:"3",four:"4",five:"5",six:"6",seven:"7",eight:"8",nine:"9",keycap_ten:"",capital_abcd:"",abcd:"",symbols:"",abc:"",a:"",ab:"",b:"",cl:"",cool:"",free:"",information_source:"",id:"",m:"",new:"",ng:"",o2:"",ok:"",parking:"",sos:"",up:"",vs:"",koko:"",sa:"",u6708:"",u6709:"",u6307:"",ideograph_advantage:"",u5272:"",u7121:"",u7981:"",accept:"",u7533:"",u5408:"",u7a7a:"",congratulations:"",secret:"",u55b6:"",u6e80:"",red_circle:"",orange_circle:"",yellow_circle:"",green_circle:"",large_blue_circle:"",purple_circle:"",brown_circle:"",black_circle:"",white_circle:"",red_square:"",orange_square:"",yellow_square:"",green_square:"",blue_square:"",purple_square:"",brown_square:"",black_large_square:"",white_large_square:"",black_medium_square:"",white_medium_square:"",black_medium_small_square:"",white_medium_small_square:"",black_small_square:"",white_small_square:"",large_orange_diamond:"",large_blue_diamond:"",small_orange_diamond:"",small_blue_diamond:"",small_red_triangle:"",small_red_triangle_down:"",diamond_shape_with_a_dot_inside:"",radio_button:"",white_square_button:"",black_square_button:"",checkered_flag:"",triangular_flag_on_post:"",crossed_flags:"",black_flag:"",white_flag:"",rainbow_flag:"",transgender_flag:"",pirate_flag:"",ascension_island:"",andorra:"",united_arab_emirates:"",afghanistan:"",antigua_barbuda:"",anguilla:"",albania:"",armenia:"",angola:"",antarctica:"",argentina:"",american_samoa:"",austria:"",australia:"",aruba:"",aland_islands:"",azerbaijan:"",bosnia_herzegovina:"",barbados:"",bangladesh:"",belgium:"",burkina_faso:"",bulgaria:"",bahrain:"",burundi:"",benin:"",st_barthelemy:"",bermuda:"",brunei:"",bolivia:"",caribbean_netherlands:"",brazil:"",bahamas:"",bhutan:"",bouvet_island:"",botswana:"",belarus:"",belize:"",canada:"",cocos_islands:"",congo_kinshasa:"",central_african_republic:"",congo_brazzaville:"",switzerland:"",cote_divoire:"",cook_islands:"",chile:"",cameroon:"",cn:"",colombia:"",clipperton_island:"",costa_rica:"",cuba:"",cape_verde:"",curacao:"",christmas_island:"",cyprus:"",czech_republic:"",de:"",diego_garcia:"",djibouti:"",denmark:"",dominica:"",dominican_republic:"",algeria:"",ceuta_melilla:"",ecuador:"",estonia:"",egypt:"",western_sahara:"",eritrea:"",es:"",ethiopia:"",eu:"",european_union:"",finland:"",fiji:"",falkland_islands:"",micronesia:"",faroe_islands:"",fr:"",gabon:"",gb:"",uk:"",grenada:"",georgia:"",french_guiana:"",guernsey:"",ghana:"",gibraltar:"",greenland:"",gambia:"",guinea:"",guadeloupe:"",equatorial_guinea:"",greece:"",south_georgia_south_sandwich_islands:"",guatemala:"",guam:"",guinea_bissau:"",guyana:"",hong_kong:"",heard_mcdonald_islands:"",honduras:"",croatia:"",haiti:"",hungary:"",canary_islands:"",indonesia:"",ireland:"",israel:"",isle_of_man:"",india:"",british_indian_ocean_territory:"",iraq:"",iran:"",iceland:"",it:"",jersey:"",jamaica:"",jordan:"",jp:"",kenya:"",kyrgyzstan:"",cambodia:"",kiribati:"",comoros:"",st_kitts_nevis:"",north_korea:"",kr:"",kuwait:"",cayman_islands:"",kazakhstan:"",laos:"",lebanon:"",st_lucia:"",liechtenstein:"",sri_lanka:"",liberia:"",lesotho:"",lithuania:"",luxembourg:"",latvia:"",libya:"",morocco:"",monaco:"",moldova:"",montenegro:"",st_martin:"",madagascar:"",marshall_islands:"",macedonia:"",mali:"",myanmar:"",mongolia:"",macau:"",northern_mariana_islands:"",martinique:"",mauritania:"",montserrat:"",malta:"",mauritius:"",maldives:"",malawi:"",mexico:"",malaysia:"",mozambique:"",namibia:"",new_caledonia:"",niger:"",norfolk_island:"",nigeria:"",nicaragua:"",netherlands:"",norway:"",nepal:"",nauru:"",niue:"",new_zealand:"",oman:"",panama:"",peru:"",french_polynesia:"",papua_new_guinea:"",philippines:"",pakistan:"",poland:"",st_pierre_miquelon:"",pitcairn_islands:"",puerto_rico:"",palestinian_territories:"",portugal:"",palau:"",paraguay:"",qatar:"",reunion:"",romania:"",serbia:"",ru:"",rwanda:"",saudi_arabia:"",solomon_islands:"",seychelles:"",sudan:"",sweden:"",singapore:"",st_helena:"",slovenia:"",svalbard_jan_mayen:"",slovakia:"",sierra_leone:"",san_marino:"",senegal:"",somalia:"",suriname:"",south_sudan:"",sao_tome_principe:"",el_salvador:"",sint_maarten:"",syria:"",swaziland:"",tristan_da_cunha:"",turks_caicos_islands:"",chad:"",french_southern_territories:"",togo:"",thailand:"",tajikistan:"",tokelau:"",timor_leste:"",turkmenistan:"",tunisia:"",tonga:"",tr:"",trinidad_tobago:"",tuvalu:"",taiwan:"",tanzania:"",ukraine:"",uganda:"",us_outlying_islands:"",united_nations:"",us:"",uruguay:"",uzbekistan:"",vatican_city:"",st_vincent_grenadines:"",venezuela:"",british_virgin_islands:"",us_virgin_islands:"",vietnam:"",vanuatu:"",wallis_futuna:"",samoa:"",kosovo:"",yemen:"",mayotte:"",south_africa:"",zambia:"",zimbabwe:"",england:"",scotland:"",wales:""};Bt.use(Wi({emojis:Jp,renderer:t=>t.emoji}));const Kp=()=>{const[t,n]=N(!1);return e(V,{children:e(qr,{children:e(wa,{children:e(V,{children:[e(Ka,{onLoaded:n}),t&&e(Ur,{children:e(fe,{path:"/",element:e(Wp,{}),children:e(fe,{path:"/",element:e(Qp,{})})})})]})})})})},Zp=({displaySidebar:t,isMobile:n,headerSetup:r,accountIds:a})=>e("div",{className:I({"vm-header-controls":!0,"vm-header-controls_mobile":n}),children:[(r==null?void 0:r.tenant)&&e(Hs,{accountIds:a||[]}),(r==null?void 0:r.stepControl)&&e(Vs,{}),(r==null?void 0:r.timeSelector)&&e(ka,{}),(r==null?void 0:r.cardinalityDatePicker)&&e(Us,{}),(r==null?void 0:r.executionControls)&&e(Ta,{}),e(La,{}),!t&&e(Fs,{})]}),Xp=()=>{const t=Ee(),{isMobile:n}=J(),{pathname:r}=ht(),[a,o]=oe();Aa();const s=()=>{var d;const l="vmui for vmanomaly",c=(d=gt[r])==null?void 0:d.title;document.title=c?`${c} - ${l}`:l},i=()=>{const{search:l,href:c}=window.location;if(l){const m=Fr.parse(l,{ignoreQueryPrefix:!0});Object.entries(m).forEach(([u,h])=>a.set(u,h)),o(a),window.location.search=""}const d=c.replace(/\/\?#\//,"/#/");d!==c&&window.location.replace(d)};return A(s,[r]),A(i,[]),e("section",{className:"vm-container",children:[e(Na,{controlsComponent:Zp}),e("div",{className:I({"vm-container-body":!0,"vm-container-body_mobile":n,"vm-container-body_app":t}),children:e(Vr,{})}),!t&&e(Sa,{})]})},eg=1,tg=()=>{Ia();const{isMobile:t}=J(),{query:n}=xe(),{customStep:r}=He(),a=q(null),[o]=N([]),[s,i]=N(!n[0]),[l,c]=N(!1),{isLoading:d,graphData:m,error:u,queryErrors:h,setQueryErrors:p,queryStats:v,warning:b}=Xn({visible:!0,customStep:r,hideQuery:o,showAllSeries:l}),f=M(()=>{if(!m)return[];const _=m.map(C=>({...ni(C.metric),...C})),y=_.filter(C=>C.value===ne.actual),S=_.filter(C=>C.value===ne.anomaly),T=y.map(C=>{const k=Pr(C.metric),L=S.find(x=>Pr(x.metric)===k);return{group:1,metric:{...C.metric,__name__:ne.anomaly},values:C.values.filter(([x])=>{if(!L)return!1;const E=L.values.find(([P])=>P===x);return E&&sn(E[1])>eg})}});return _.filter(C=>C.value!==ne.anomaly&&C.value).concat(T)},[m]),g=()=>{i(!1)};return e("div",{className:I({"vm-custom-panel":!0,"vm-custom-panel_mobile":t}),children:[e(xa,{queryErrors:s?[]:h,setQueryErrors:p,setHideError:i,stats:v,onRunQuery:g,hideButtons:{addQuery:!0,prettify:!1,autocomplete:!1,traceQuery:!0,anomalyConfig:!0,reduceMemUsage:!0}}),d&&e(Qe,{}),!s&&u&&e(le,{variant:"error",children:u}),b&&e(tr,{warning:b,query:n,onChange:c}),e("div",{className:I({"vm-custom-panel-body":!0,"vm-custom-panel-body_mobile":t,"vm-block":!0,"vm-block_mobile":t}),children:[e("div",{className:"vm-custom-panel-body-header",ref:a,children:e("div",{})}),f&&e(_i,{graphData:f,isHistogram:!1,controlsRef:a,isAnomalyView:!0})]})]})},ng=()=>{const[t,n]=N(!1);return e(V,{children:e(qr,{children:e(wa,{children:e(V,{children:[e(Ka,{onLoaded:n}),t&&e(Ur,{children:e(fe,{path:"/",element:e(Xp,{}),children:[e(fe,{path:"/",element:e(tg,{})}),e(fe,{path:Z.query,element:e(ki,{})})]})})]})})})})},rg=()=>{switch(Qt){case dt.victorialogs:return e(Kp,{});case dt.vmanomaly:return e(ng,{});default:return e(dh,{})}},Qo=document.getElementById("root");Qo&&Ji(rg(),Qo);
